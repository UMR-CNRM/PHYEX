<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "https://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml" lang="en-US">
<head>
<meta http-equiv="Content-Type" content="text/xhtml;charset=UTF-8"/>
<meta http-equiv="X-UA-Compatible" content="IE=11"/>
<meta name="generator" content="Doxygen 1.9.8"/>
<meta name="viewport" content="width=device-width, initial-scale=1"/>
<title>PHYEX: /home/runner/work/PHYEX/PHYEX/src/common/micro/lima.F90 Source File</title>
<link href="tabs.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="jquery.js"></script>
<script type="text/javascript" src="dynsections.js"></script>
<link href="search/search.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="search/searchdata.js"></script>
<script type="text/javascript" src="search/search.js"></script>
<link href="doxygen.css" rel="stylesheet" type="text/css" />
</head>
<body>
<div id="top"><!-- do not remove this div, it is closed by doxygen! -->
<div id="titlearea">
<table cellspacing="0" cellpadding="0">
 <tbody>
 <tr id="projectrow">
  <td id="projectalign">
   <div id="projectname">PHYEX
   </div>
   <div id="projectbrief">PHYsique EXternalisée</div>
  </td>
 </tr>
 </tbody>
</table>
</div>
<!-- end header part -->
<!-- Generated by Doxygen 1.9.8 -->
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:d3d9a9a6595521f9666a5e94cc830dab83b65699&amp;dn=expat.txt MIT */
var searchBox = new SearchBox("searchBox", "search/",'.html');
/* @license-end */
</script>
<script type="text/javascript" src="menudata.js"></script>
<script type="text/javascript" src="menu.js"></script>
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:d3d9a9a6595521f9666a5e94cc830dab83b65699&amp;dn=expat.txt MIT */
$(function() {
  initMenu('',true,false,'search.php','Search');
  $(document).ready(function() { init_search(); });
});
/* @license-end */
</script>
<div id="main-nav"></div>
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:d3d9a9a6595521f9666a5e94cc830dab83b65699&amp;dn=expat.txt MIT */
$(document).ready(function() { init_codefold(0); });
/* @license-end */
</script>
<!-- window showing the filter options -->
<div id="MSearchSelectWindow"
     onmouseover="return searchBox.OnSearchSelectShow()"
     onmouseout="return searchBox.OnSearchSelectHide()"
     onkeydown="return searchBox.OnSearchSelectKey(event)">
</div>

<!-- iframe showing the search results (closed by default) -->
<div id="MSearchResultsWindow">
<div id="MSearchResults">
<div class="SRPage">
<div id="SRIndex">
<div id="SRResults"></div>
<div class="SRStatus" id="Loading">Loading...</div>
<div class="SRStatus" id="Searching">Searching...</div>
<div class="SRStatus" id="NoMatches">No Matches</div>
</div>
</div>
</div>
</div>

<div id="nav-path" class="navpath">
  <ul>
<li class="navelem"><a class="el" href="dir_68267d1309a1af8e8297ef4c3efbcdba.html">src</a></li><li class="navelem"><a class="el" href="dir_fdedb0aba14d44ce9d99bc100e026e6a.html">common</a></li><li class="navelem"><a class="el" href="dir_c5d5b95b88135def9ba8c8b29e8b7b93.html">micro</a></li>  </ul>
</div>
</div><!-- top -->
<div class="header">
  <div class="headertitle"><div class="title">lima.F90</div></div>
</div><!--header-->
<div class="contents">
<a href="lima_8F90.html">Go to the documentation of this file.</a><div class="fragment"><div class="line"><a id="l00001" name="l00001"></a><span class="lineno">    1</span><span class="comment">!MNH_LIC Copyright 2013-2025 CNRS, Meteo-France and Universite Paul Sabatier</span></div>
<div class="line"><a id="l00002" name="l00002"></a><span class="lineno">    2</span><span class="comment">!MNH_LIC This is part of the Meso-NH software governed by the CeCILL-C licence</span></div>
<div class="line"><a id="l00003" name="l00003"></a><span class="lineno">    3</span><span class="comment">!MNH_LIC version 1. See LICENSE, CeCILL-C_V1-en.txt and CeCILL-C_V1-fr.txt</span></div>
<div class="line"><a id="l00004" name="l00004"></a><span class="lineno">    4</span><span class="comment">!MNH_LIC for details. version 1.</span></div>
<div class="line"><a id="l00005" name="l00005"></a><span class="lineno">    5</span><span class="comment">!-----------------------------------------------------------------</span></div>
<div class="line"><a id="l00006" name="l00006"></a><span class="lineno">    6</span><span class="comment">!     #####################################################################</span></div>
<div class="foldopen" id="foldopen00007" data-start="" data-end="">
<div class="line"><a id="l00007" name="l00007"></a><span class="lineno"><a class="line" href="lima_8F90.html#a45fe64d21afbc6cace563fda83cb1e79">    7</a></span><span class="keyword">SUBROUTINE </span><a class="code hl_function" href="lima_8F90.html#a45fe64d21afbc6cace563fda83cb1e79">lima</a> ( LIMAP, LIMAW, LIMAC, LIMAM, TNSV, D, CST, NEBN,         &amp;</div>
<div class="line"><a id="l00008" name="l00008"></a><span class="lineno">    8</span>                  ICED, ICEP, ELECD, ELECP,                               &amp;</div>
<div class="line"><a id="l00009" name="l00009"></a><span class="lineno">    9</span>                  BUCONF, TBUDGETS, HACTCCN, KBUDGETS, KRR,               &amp;</div>
<div class="line"><a id="l00010" name="l00010"></a><span class="lineno">   10</span>                  PTSTEP, OELEC,                                          &amp;</div>
<div class="line"><a id="l00011" name="l00011"></a><span class="lineno">   11</span>                  PRHODREF, PEXNREF, PDZZ, PTHVREFZIKB,                   &amp;</div>
<div class="line"><a id="l00012" name="l00012"></a><span class="lineno">   12</span>                  PRHODJ, PPABST,                                         &amp;</div>
<div class="line"><a id="l00013" name="l00013"></a><span class="lineno">   13</span>                  KCARB, KSOA, KSP, ODUST, OSALT, OORILAM,                &amp;</div>
<div class="line"><a id="l00014" name="l00014"></a><span class="lineno">   14</span>                  ODTHRAD, PDTHRAD, PTHT, PRT, PSVT, PW_NU,               &amp;</div>
<div class="line"><a id="l00015" name="l00015"></a><span class="lineno">   15</span>                  PAERO,PSOLORG, PMI, PTHS, PRS, PSVS,                    &amp;</div>
<div class="line"><a id="l00016" name="l00016"></a><span class="lineno">   16</span>                  PINPRC, PINDEP, PINPRR, PINPRI, PINPRS, PINPRG, PINPRH, &amp;</div>
<div class="line"><a id="l00017" name="l00017"></a><span class="lineno">   17</span>                  PEVAP3D, PCLDFR, PICEFR, PPRCFR, PFPR,                  &amp;</div>
<div class="line"><a id="l00018" name="l00018"></a><span class="lineno">   18</span>                  PLATHAM_IAGGS, PEFIELDW, PSV_ELEC_T, PSV_ELEC_S         )</div>
<div class="line"><a id="l00019" name="l00019"></a><span class="lineno">   19</span><span class="comment">!     #####################################################################</span></div>
<div class="line"><a id="l00020" name="l00020"></a><span class="lineno">   20</span><span class="comment">!</span></div>
<div class="line"><a id="l00021" name="l00021"></a><span class="lineno">   21</span><span class="comment">!!    PURPOSE</span></div>
<div class="line"><a id="l00022" name="l00022"></a><span class="lineno">   22</span><span class="comment">!!    -------</span></div>
<div class="line"><a id="l00023" name="l00023"></a><span class="lineno">   23</span><span class="comment">!!      Compute explicit microphysical sources using the 2-moment scheme LIMA     </span></div>
<div class="line"><a id="l00024" name="l00024"></a><span class="lineno">   24</span><span class="comment">!!    using the time-splitting method</span></div>
<div class="line"><a id="l00025" name="l00025"></a><span class="lineno">   25</span><span class="comment">!!</span></div>
<div class="line"><a id="l00026" name="l00026"></a><span class="lineno">   26</span><span class="comment">!!    REFERENCE</span></div>
<div class="line"><a id="l00027" name="l00027"></a><span class="lineno">   27</span><span class="comment">!!    ---------</span></div>
<div class="line"><a id="l00028" name="l00028"></a><span class="lineno">   28</span><span class="comment">!!      Vié et al. (GMD, 2016)</span></div>
<div class="line"><a id="l00029" name="l00029"></a><span class="lineno">   29</span><span class="comment">!!      Meso-NH scientific documentation</span></div>
<div class="line"><a id="l00030" name="l00030"></a><span class="lineno">   30</span><span class="comment">!!</span></div>
<div class="line"><a id="l00031" name="l00031"></a><span class="lineno">   31</span><span class="comment">!!    AUTHOR</span></div>
<div class="line"><a id="l00032" name="l00032"></a><span class="lineno">   32</span><span class="comment">!!    ------</span></div>
<div class="line"><a id="l00033" name="l00033"></a><span class="lineno">   33</span><span class="comment">!!      S. Riette  * CNRM *</span></div>
<div class="line"><a id="l00034" name="l00034"></a><span class="lineno">   34</span><span class="comment">!!      B. Vié     * CNRM *</span></div>
<div class="line"><a id="l00035" name="l00035"></a><span class="lineno">   35</span><span class="comment">!!</span></div>
<div class="line"><a id="l00036" name="l00036"></a><span class="lineno">   36</span><span class="comment">!!    MODIFICATIONS</span></div>
<div class="line"><a id="l00037" name="l00037"></a><span class="lineno">   37</span><span class="comment">!!    -------------</span></div>
<div class="line"><a id="l00038" name="l00038"></a><span class="lineno">   38</span><span class="comment">!!      Original   15/03/2018</span></div>
<div class="line"><a id="l00039" name="l00039"></a><span class="lineno">   39</span><span class="comment">!!</span></div>
<div class="line"><a id="l00040" name="l00040"></a><span class="lineno">   40</span><span class="comment">!  B. Vie         02/2019: minor correction on budget</span></div>
<div class="line"><a id="l00041" name="l00041"></a><span class="lineno">   41</span><span class="comment">!  P. Wautelet    02/2020: use the new data structures and subroutines for budgets (no more budget calls in this subroutine)</span></div>
<div class="line"><a id="l00042" name="l00042"></a><span class="lineno">   42</span><span class="comment">!  P. Wautelet 26/02/2020: bugfix: corrected condition to write budget CORR_BU_RRS</span></div>
<div class="line"><a id="l00043" name="l00043"></a><span class="lineno">   43</span><span class="comment">!  B. Vie      03/03/2020: use DTHRAD instead of dT/dt in Smax diagnostic computation</span></div>
<div class="line"><a id="l00044" name="l00044"></a><span class="lineno">   44</span><span class="comment">!  P. Wautelet 28/05/2020: bugfix: correct array start for PSVT and PSVS</span></div>
<div class="line"><a id="l00045" name="l00045"></a><span class="lineno">   45</span><span class="comment">!  P. Wautelet 03/02/2021: budgets: add new source if LIMA splitting: CORR2</span></div>
<div class="line"><a id="l00046" name="l00046"></a><span class="lineno">   46</span><span class="comment">!  B. Vie         06/2021: add subgrid condensation with LIMA</span></div>
<div class="line"><a id="l00047" name="l00047"></a><span class="lineno">   47</span><span class="comment">!  C. Barthe      04/2022: add cloud electrification</span></div>
<div class="line"><a id="l00048" name="l00048"></a><span class="lineno">   48</span><span class="comment">!  C. Barthe      03/2023: add CIBU, RDSF and 2 moments for s, g and h in cloud electrification</span></div>
<div class="line"><a id="l00049" name="l00049"></a><span class="lineno">   49</span><span class="comment">!</span></div>
<div class="line"><a id="l00050" name="l00050"></a><span class="lineno">   50</span><span class="comment">!-----------------------------------------------------------------</span></div>
<div class="line"><a id="l00051" name="l00051"></a><span class="lineno">   51</span><span class="comment">!</span></div>
<div class="line"><a id="l00052" name="l00052"></a><span class="lineno">   52</span><span class="comment">!*       0.    DECLARATIONS</span></div>
<div class="line"><a id="l00053" name="l00053"></a><span class="lineno">   53</span><span class="comment">!              ------------</span></div>
<div class="line"><a id="l00054" name="l00054"></a><span class="lineno">   54</span><span class="keywordtype">USE </span><a class="code hl_namespace" href="namespacemodd__param__lima__mixed.html">modd_param_lima_mixed</a>, <span class="keywordtype">ONLY</span>:<a class="code hl_struct" href="structmodd__param__lima__mixed_1_1param__lima__mixed__t.html">param_lima_mixed_t</a></div>
<div class="line"><a id="l00055" name="l00055"></a><span class="lineno">   55</span><span class="keywordtype">USE </span><a class="code hl_namespace" href="namespacemodd__param__lima__cold.html">modd_param_lima_cold</a>, <span class="keywordtype">ONLY</span>:<a class="code hl_struct" href="structmodd__param__lima__cold_1_1param__lima__cold__t.html">param_lima_cold_t</a></div>
<div class="line"><a id="l00056" name="l00056"></a><span class="lineno">   56</span><span class="keywordtype">USE </span><a class="code hl_namespace" href="namespacemodd__param__lima__warm.html">modd_param_lima_warm</a>, <span class="keywordtype">ONLY</span>:<a class="code hl_struct" href="structmodd__param__lima__warm_1_1param__lima__warm__t.html">param_lima_warm_t</a></div>
<div class="line"><a id="l00057" name="l00057"></a><span class="lineno">   57</span><span class="keywordtype">USE </span><a class="code hl_namespace" href="namespacemodd__param__lima.html">modd_param_lima</a>, <span class="keywordtype">ONLY</span>:<a class="code hl_struct" href="structmodd__param__lima_1_1param__lima__t.html">param_lima_t</a></div>
<div class="line"><a id="l00058" name="l00058"></a><span class="lineno">   58</span><span class="keywordtype">USE </span><a class="code hl_namespace" href="namespacemodd__dimphyex.html">modd_dimphyex</a>,        <span class="keywordtype">ONLY</span>: <a class="code hl_struct" href="structmodd__dimphyex_1_1dimphyex__t.html">dimphyex_t</a></div>
<div class="line"><a id="l00059" name="l00059"></a><span class="lineno">   59</span><span class="keywordtype">USE </span><a class="code hl_namespace" href="namespacemodd__rain__ice__descr__n.html">modd_rain_ice_descr_n</a>,<span class="keywordtype">ONLY</span>: <a class="code hl_struct" href="structmodd__rain__ice__descr__n_1_1rain__ice__descr__t.html">rain_ice_descr_t</a></div>
<div class="line"><a id="l00060" name="l00060"></a><span class="lineno">   60</span><span class="keywordtype">USE </span><a class="code hl_namespace" href="namespacemodd__rain__ice__param__n.html">modd_rain_ice_param_n</a>,<span class="keywordtype">ONLY</span>: <a class="code hl_struct" href="structmodd__rain__ice__param__n_1_1rain__ice__param__t.html">rain_ice_param_t</a></div>
<div class="line"><a id="l00061" name="l00061"></a><span class="lineno">   61</span><span class="keywordtype">USE </span><a class="code hl_namespace" href="namespacemodd__elec__param.html">modd_elec_param</a>,      <span class="keywordtype">ONLY</span>: <a class="code hl_struct" href="structmodd__elec__param_1_1elec__param__t.html">elec_param_t</a></div>
<div class="line"><a id="l00062" name="l00062"></a><span class="lineno">   62</span><span class="keywordtype">USE </span><a class="code hl_namespace" href="namespacemodd__elec__descr.html">modd_elec_descr</a>,      <span class="keywordtype">ONLY</span>: <a class="code hl_struct" href="structmodd__elec__descr_1_1elec__descr__t.html">elec_descr_t</a></div>
<div class="line"><a id="l00063" name="l00063"></a><span class="lineno">   63</span><span class="keywordtype">USE </span><a class="code hl_namespace" href="namespacemodd__budget.html">modd_budget</a>,          <span class="keywordtype">ONLY</span>: <a class="code hl_struct" href="structmodd__budget_1_1tbudgetdata.html">tbudgetdata</a>, <a class="code hl_struct" href="structmodd__budget_1_1tbudgetconf__t.html">tbudgetconf_t</a>, <a class="code hl_variable" href="namespacemodd__budget.html#a0d120a8b4c8fb6af560c814c1d3c2c19">nbudget_th</a>, <a class="code hl_variable" href="namespacemodd__budget.html#a032a9fef7c9e0c47fa34eae42fc05279">nbudget_rv</a>, <a class="code hl_variable" href="namespacemodd__budget.html#a685847647e25e21af43ab48da13b1797">nbudget_rc</a>, &amp;</div>
<div class="line"><a id="l00064" name="l00064"></a><span class="lineno">   64</span>                                <a class="code hl_variable" href="namespacemodd__budget.html#a4ea4532bcfa769b5ed97e4d1e68a8113">nbudget_ri</a>, <a class="code hl_variable" href="namespacemodd__budget.html#aac4cd9c30fac3b66cb3078dad55fb1e2">nbudget_rr</a>, <a class="code hl_variable" href="namespacemodd__budget.html#a4e4985c2c538a46dd511258704757086">nbudget_rs</a>, <a class="code hl_variable" href="namespacemodd__budget.html#aef76ce44ca163871fcb14427eae825a9">nbudget_rg</a>, <a class="code hl_variable" href="namespacemodd__budget.html#a07dc15edaf8cd68c1036451fc7b536b9">nbudget_rh</a>, <a class="code hl_variable" href="namespacemodd__budget.html#aab05ad1db5848733632fdbcefeb4a0a0">nbudget_sv1</a></div>
<div class="line"><a id="l00065" name="l00065"></a><span class="lineno">   65</span><span class="keywordtype">USE </span><a class="code hl_namespace" href="namespacemodd__cst.html">modd_cst</a>,             <span class="keywordtype">ONLY</span>: <a class="code hl_struct" href="structmodd__cst_1_1cst__t.html">cst_t</a></div>
<div class="line"><a id="l00066" name="l00066"></a><span class="lineno">   66</span><span class="keywordtype">USE </span><a class="code hl_namespace" href="namespacemodd__nsv.html">modd_nsv</a>,             <span class="keywordtype">ONLY</span>: <a class="code hl_struct" href="structmodd__nsv_1_1nsv__t.html">nsv_t</a></div>
<div class="line"><a id="l00067" name="l00067"></a><span class="lineno">   67</span><span class="keywordtype">USE </span><a class="code hl_namespace" href="namespacemodd__neb__n.html">modd_neb_n</a>,           <span class="keywordtype">ONLY</span>: <a class="code hl_struct" href="structmodd__neb__n_1_1neb__t.html">neb_t</a></div>
<div class="line"><a id="l00068" name="l00068"></a><span class="lineno">   68</span><span class="keywordtype">USE </span><a class="code hl_namespace" href="namespacemode__budget__phy.html">mode_budget_phy</a>,      <span class="keywordtype">ONLY</span>: <a class="code hl_function" href="namespacemode__budget__phy.html#aa498d2363e7683e361ea7dfdc83cf561">budget_store_add_phy</a>, <a class="code hl_function" href="namespacemode__budget__phy.html#a45dce5bc68868ab14b72a6c987fd5d08">budget_store_init_phy</a>, <a class="code hl_function" href="namespacemode__budget__phy.html#adb853e4fb0b59cc93057b507a52bd8ce">budget_store_end_phy</a></div>
<div class="line"><a id="l00069" name="l00069"></a><span class="lineno">   69</span><span class="keywordtype">USE </span>mode_tools,           <span class="keywordtype">only</span>: countjv</div>
<div class="line"><a id="l00070" name="l00070"></a><span class="lineno">   70</span> </div>
<div class="line"><a id="l00071" name="l00071"></a><span class="lineno">   71</span><span class="keywordtype">USE </span><a class="code hl_namespace" href="namespacemode__lima__compute__cloud__fractions.html">mode_lima_compute_cloud_fractions</a>, <span class="keywordtype">ONLY</span>: <a class="code hl_function" href="namespacemode__lima__compute__cloud__fractions.html#ab0ef7be0a4b7adc256c4aab0a9a31e7e">lima_compute_cloud_fractions</a></div>
<div class="line"><a id="l00072" name="l00072"></a><span class="lineno">   72</span><span class="keywordtype">USE </span><a class="code hl_namespace" href="namespacemode__lima__shape__compute__lbda.html">mode_lima_shape_compute_lbda</a>, <span class="keywordtype">ONLY</span> : <a class="code hl_function" href="namespacemode__lima__shape__compute__lbda.html#a6798cc7c83b4469883cdc6a4b13cd832">lima_shape_compute_lbda_3d</a></div>
<div class="line"><a id="l00073" name="l00073"></a><span class="lineno">   73</span><span class="keywordtype">USE </span><a class="code hl_namespace" href="namespacemode__lima__inst__procs.html">mode_lima_inst_procs</a>, <span class="keywordtype">ONLY</span>: <a class="code hl_function" href="namespacemode__lima__inst__procs.html#a6c03116b37ea1e7e88795475346cdf6c">lima_inst_procs</a></div>
<div class="line"><a id="l00074" name="l00074"></a><span class="lineno">   74</span><span class="keywordtype">USE </span><a class="code hl_namespace" href="namespacemode__lima__nucleation__procs.html">mode_lima_nucleation_procs</a>, <span class="keywordtype">ONLY</span>: <a class="code hl_function" href="namespacemode__lima__nucleation__procs.html#a72240eeca7448319f2b8eb01e72fc9df">lima_nucleation_procs</a></div>
<div class="line"><a id="l00075" name="l00075"></a><span class="lineno">   75</span><span class="keywordtype">USE </span><a class="code hl_namespace" href="namespacemode__lima__sedimentation.html">mode_lima_sedimentation</a>, <span class="keywordtype">ONLY</span>: <a class="code hl_function" href="namespacemode__lima__sedimentation.html#ad5d080255221def1b9da5ec90c72ca2e">lima_sedimentation</a></div>
<div class="line"><a id="l00076" name="l00076"></a><span class="lineno">   76</span><span class="keywordtype">USE </span><a class="code hl_namespace" href="namespacemode__lima__tendencies.html">mode_lima_tendencies</a>, <span class="keywordtype">ONLY</span>: <a class="code hl_function" href="namespacemode__lima__tendencies.html#acefa2d69ebd2194440988a2afd517425">lima_tendencies</a></div>
<div class="line"><a id="l00077" name="l00077"></a><span class="lineno">   77</span><span class="keywordtype">USE </span>yomhook, <span class="keywordtype">ONLY</span>:lhook, dr_hook, jphook</div>
<div class="line"><a id="l00078" name="l00078"></a><span class="lineno">   78</span><span class="comment">!</span></div>
<div class="line"><a id="l00079" name="l00079"></a><span class="lineno">   79</span><span class="keywordtype">USE </span><a class="code hl_namespace" href="namespacemode__elec__tendencies.html">mode_elec_tendencies</a>, <span class="keywordtype">ONLY</span> : <a class="code hl_function" href="namespacemode__elec__tendencies.html#ab701b2e9e36d93e528e034f7f34d98d4">elec_tendencies</a></div>
<div class="line"><a id="l00080" name="l00080"></a><span class="lineno">   80</span><span class="comment">!</span></div>
<div class="line"><a id="l00081" name="l00081"></a><span class="lineno">   81</span><span class="keywordtype">IMPLICIT NONE</span></div>
<div class="line"><a id="l00082" name="l00082"></a><span class="lineno">   82</span><span class="comment">!</span></div>
<div class="line"><a id="l00083" name="l00083"></a><span class="lineno">   83</span><span class="comment">!*       0.1   Declarations of dummy arguments :</span></div>
<div class="line"><a id="l00084" name="l00084"></a><span class="lineno">   84</span><span class="comment">!</span></div>
<div class="line"><a id="l00085" name="l00085"></a><span class="lineno">   85</span><span class="keywordtype">TYPE</span>(<a class="code hl_struct" href="structmodd__param__lima__mixed_1_1param__lima__mixed__t.html">param_lima_mixed_t</a>),<span class="keywordtype">INTENT(IN)</span>::LIMAM</div>
<div class="line"><a id="l00086" name="l00086"></a><span class="lineno">   86</span><span class="keywordtype">TYPE</span>(<a class="code hl_struct" href="structmodd__param__lima__cold_1_1param__lima__cold__t.html">param_lima_cold_t</a>),<span class="keywordtype">INTENT(IN)</span>::LIMAC</div>
<div class="line"><a id="l00087" name="l00087"></a><span class="lineno">   87</span><span class="keywordtype">TYPE</span>(<a class="code hl_struct" href="structmodd__param__lima__warm_1_1param__lima__warm__t.html">param_lima_warm_t</a>),<span class="keywordtype">INTENT(IN)</span>::LIMAW</div>
<div class="line"><a id="l00088" name="l00088"></a><span class="lineno">   88</span><span class="keywordtype">TYPE</span>(<a class="code hl_struct" href="structmodd__param__lima_1_1param__lima__t.html">param_lima_t</a>),<span class="keywordtype">INTENT(IN)</span>::LIMAP</div>
<div class="line"><a id="l00089" name="l00089"></a><span class="lineno">   89</span><span class="keywordtype">TYPE</span>(<a class="code hl_struct" href="structmodd__nsv_1_1nsv__t.html">nsv_t</a>),              <span class="keywordtype">INTENT(IN)</span>    :: TNSV</div>
<div class="line"><a id="l00090" name="l00090"></a><span class="lineno">   90</span><span class="keywordtype">TYPE</span>(<a class="code hl_struct" href="structmodd__dimphyex_1_1dimphyex__t.html">dimphyex_t</a>),         <span class="keywordtype">INTENT(IN)</span>    :: D</div>
<div class="line"><a id="l00091" name="l00091"></a><span class="lineno">   91</span><span class="keywordtype">TYPE</span>(<a class="code hl_struct" href="structmodd__cst_1_1cst__t.html">cst_t</a>),              <span class="keywordtype">INTENT(IN)</span>    :: CST</div>
<div class="line"><a id="l00092" name="l00092"></a><span class="lineno">   92</span><span class="keywordtype">TYPE</span>(<a class="code hl_struct" href="structmodd__neb__n_1_1neb__t.html">neb_t</a>),              <span class="keywordtype">INTENT(IN)</span>    :: NEBN</div>
<div class="line"><a id="l00093" name="l00093"></a><span class="lineno">   93</span><span class="keywordtype">TYPE</span>(<a class="code hl_struct" href="structmodd__rain__ice__descr__n_1_1rain__ice__descr__t.html">rain_ice_descr_t</a>),   <span class="keywordtype">INTENT(IN)</span>    :: ICED</div>
<div class="line"><a id="l00094" name="l00094"></a><span class="lineno">   94</span><span class="keywordtype">TYPE</span>(<a class="code hl_struct" href="structmodd__rain__ice__param__n_1_1rain__ice__param__t.html">rain_ice_param_t</a>),   <span class="keywordtype">INTENT(IN)</span>    :: ICEP</div>
<div class="line"><a id="l00095" name="l00095"></a><span class="lineno">   95</span><span class="keywordtype">TYPE</span>(<a class="code hl_struct" href="structmodd__elec__param_1_1elec__param__t.html">elec_param_t</a>),       <span class="keywordtype">INTENT(IN)</span>    :: ELECP   <span class="comment">! electrical parameters</span></div>
<div class="line"><a id="l00096" name="l00096"></a><span class="lineno">   96</span><span class="keywordtype">TYPE</span>(<a class="code hl_struct" href="structmodd__elec__descr_1_1elec__descr__t.html">elec_descr_t</a>),       <span class="keywordtype">INTENT(IN)</span>    :: ELECD   <span class="comment">! electrical descriptive csts</span></div>
<div class="line"><a id="l00097" name="l00097"></a><span class="lineno">   97</span><span class="keywordtype">TYPE</span>(<a class="code hl_struct" href="structmodd__budget_1_1tbudgetconf__t.html">tbudgetconf_t</a>),      <span class="keywordtype">INTENT(IN)</span>    :: BUCONF</div>
<div class="line"><a id="l00098" name="l00098"></a><span class="lineno">   98</span><span class="keywordtype">CHARACTER(LEN=4)</span>,         <span class="keywordtype">INTENT(IN)</span>    :: HACTCCN  <span class="comment">! kind of CCN activation</span></div>
<div class="line"><a id="l00099" name="l00099"></a><span class="lineno">   99</span><span class="keywordtype">TYPE</span>(<a class="code hl_struct" href="structmodd__budget_1_1tbudgetdata.html">tbudgetdata</a>), <span class="keywordtype">DIMENSION(KBUDGETS)</span>, <span class="keywordtype">INTENT(INOUT)</span> :: TBUDGETS</div>
<div class="line"><a id="l00100" name="l00100"></a><span class="lineno">  100</span><span class="keywordtype">INTEGER</span>,                  <span class="keywordtype">INTENT(IN)</span>    :: KBUDGETS</div>
<div class="line"><a id="l00101" name="l00101"></a><span class="lineno">  101</span><span class="keywordtype">INTEGER</span>,                  <span class="keywordtype">INTENT(IN)</span>    :: KRR</div>
<div class="line"><a id="l00102" name="l00102"></a><span class="lineno">  102</span><span class="comment">!</span></div>
<div class="line"><a id="l00103" name="l00103"></a><span class="lineno">  103</span><span class="keywordtype">REAL</span>,                     <span class="keywordtype">INTENT(IN)</span>    :: PTSTEP     <span class="comment">! Time step</span></div>
<div class="line"><a id="l00104" name="l00104"></a><span class="lineno">  104</span><span class="comment">!</span></div>
<div class="line"><a id="l00105" name="l00105"></a><span class="lineno">  105</span><span class="keywordtype">LOGICAL</span>,                  <span class="keywordtype">INTENT(IN)</span>    :: OELEC      <span class="comment">! if true, cloud electrification is activated</span></div>
<div class="line"><a id="l00106" name="l00106"></a><span class="lineno">  106</span><span class="comment">!</span></div>
<div class="line"><a id="l00107" name="l00107"></a><span class="lineno">  107</span><span class="keywordtype">REAL</span>, <span class="keywordtype">DIMENSION(D%NIJT, D%NKT)</span>,   <span class="keywordtype">INTENT(IN)</span>    :: PRHODREF   <span class="comment">! Reference density</span></div>
<div class="line"><a id="l00108" name="l00108"></a><span class="lineno">  108</span><span class="keywordtype">REAL</span>, <span class="keywordtype">DIMENSION(D%NIJT, D%NKT)</span>,   <span class="keywordtype">INTENT(IN)</span>    :: PEXNREF    <span class="comment">! Reference Exner function</span></div>
<div class="line"><a id="l00109" name="l00109"></a><span class="lineno">  109</span><span class="keywordtype">REAL</span>, <span class="keywordtype">DIMENSION(D%NIJT, D%NKT)</span>,   <span class="keywordtype">INTENT(IN)</span>    :: PDZZ       <span class="comment">! Layer thikness (m)</span></div>
<div class="line"><a id="l00110" name="l00110"></a><span class="lineno">  110</span><span class="comment">!</span></div>
<div class="line"><a id="l00111" name="l00111"></a><span class="lineno">  111</span><span class="keywordtype">REAL</span>, <span class="keywordtype">DIMENSION(D%NIJT, D%NKT)</span>,   <span class="keywordtype">INTENT(IN)</span>    :: PRHODJ     <span class="comment">! Dry density * Jacobian</span></div>
<div class="line"><a id="l00112" name="l00112"></a><span class="lineno">  112</span><span class="keywordtype">REAL</span>, <span class="keywordtype">DIMENSION(D%NIJT, D%NKT)</span>,   <span class="keywordtype">INTENT(IN)</span>    :: PPABST     <span class="comment">! absolute pressure at t</span></div>
<div class="line"><a id="l00113" name="l00113"></a><span class="lineno">  113</span><span class="keywordtype">INTEGER</span>,                  <span class="keywordtype">INTENT(IN)</span>    :: KCARB, KSOA, KSP <span class="comment">! for array size declarations</span></div>
<div class="line"><a id="l00114" name="l00114"></a><span class="lineno">  114</span><span class="keywordtype">LOGICAL</span>, <span class="keywordtype">INTENT(IN)</span> :: ODUST, OSALT, OORILAM</div>
<div class="line"><a id="l00115" name="l00115"></a><span class="lineno">  115</span><span class="comment">!</span></div>
<div class="line"><a id="l00116" name="l00116"></a><span class="lineno">  116</span><span class="keywordtype">LOGICAL</span>,                                 <span class="keywordtype">INTENT(IN)</span>   :: ODTHRAD    <span class="comment">! Use radiative temperature tendency</span></div>
<div class="line"><a id="l00117" name="l00117"></a><span class="lineno">  117</span><span class="keywordtype">REAL</span>, <span class="keywordtype">DIMENSION(MERGE(D%NIJT,0,ODTHRAD), &amp;
                MERGE(D%NKT,0,ODTHRAD))</span>,   <span class="keywordtype">INTENT(IN)</span> :: PDTHRAD   <span class="comment">! dT/dt due to radiation</span></div>
<div class="line"><a id="l00118" name="l00118"></a><span class="lineno">  118</span><span class="keywordtype">REAL</span>, <span class="keywordtype">DIMENSION(D%NIJT, D%NKT)</span>,   <span class="keywordtype">INTENT(IN)</span>    :: PTHT       <span class="comment">! Theta at time t</span></div>
<div class="line"><a id="l00119" name="l00119"></a><span class="lineno">  119</span><span class="keywordtype">REAL</span>, <span class="keywordtype">DIMENSION(D%NIJT, D%NKT, KRR)</span>, <span class="keywordtype">INTENT(IN)</span> :: PRT        <span class="comment">! Mixing ratios at time t</span></div>
<div class="line"><a id="l00120" name="l00120"></a><span class="lineno">  120</span><span class="keywordtype">REAL</span>, <span class="keywordtype">DIMENSION(D%NIJT, D%NKT, TNSV%NSV)</span>, <span class="keywordtype">INTENT(IN)</span> :: PSVT       <span class="comment">! Concentrations at time t</span></div>
<div class="line"><a id="l00121" name="l00121"></a><span class="lineno">  121</span><span class="keywordtype">REAL</span>, <span class="keywordtype">DIMENSION(D%NIJT, D%NKT)</span>,   <span class="keywordtype">INTENT(IN)</span>    :: PW_NU      <span class="comment">! w for CCN activation</span></div>
<div class="line"><a id="l00122" name="l00122"></a><span class="lineno">  122</span><span class="keywordtype">REAL</span>, <span class="keywordtype">DIMENSION(D%NIJT, D%NKT ,TNSV%NSV)</span>, <span class="keywordtype">INTENT(INOUT)</span> :: PAERO    <span class="comment">! Aerosol concentration</span></div>
<div class="line"><a id="l00123" name="l00123"></a><span class="lineno">  123</span><span class="keywordtype">REAL</span>, <span class="keywordtype">DIMENSION(D%NIJT, D%NKT, 10)</span>,  <span class="keywordtype">INTENT(IN)</span>    :: PSOLORG <span class="comment">![%] solubility fraction of soa</span></div>
<div class="line"><a id="l00124" name="l00124"></a><span class="lineno">  124</span><span class="keywordtype">REAL</span>, <span class="keywordtype">DIMENSION(D%NIJT, D%NKT, KSP+KCARB+KSOA)</span>, <span class="keywordtype">INTENT(IN)</span>    :: PMI</div>
<div class="line"><a id="l00125" name="l00125"></a><span class="lineno">  125</span><span class="comment">!</span></div>
<div class="line"><a id="l00126" name="l00126"></a><span class="lineno">  126</span><span class="keywordtype">REAL</span>, <span class="keywordtype">DIMENSION(D%NIJT, D%NKT)</span>,   <span class="keywordtype">INTENT(INOUT)</span>    :: PTHS       <span class="comment">! Theta source</span></div>
<div class="line"><a id="l00127" name="l00127"></a><span class="lineno">  127</span><span class="keywordtype">REAL</span>, <span class="keywordtype">DIMENSION(D%NIJT, D%NKT, KRR)</span>, <span class="keywordtype">INTENT(INOUT)</span> :: PRS        <span class="comment">! Mixing ratios sources</span></div>
<div class="line"><a id="l00128" name="l00128"></a><span class="lineno">  128</span><span class="keywordtype">REAL</span>, <span class="keywordtype">DIMENSION(D%NIJT, D%NKT, TNSV%NSV)</span>, <span class="keywordtype">INTENT(INOUT)</span> :: PSVS       <span class="comment">! Concentration sources</span></div>
<div class="line"><a id="l00129" name="l00129"></a><span class="lineno">  129</span><span class="comment">!</span></div>
<div class="line"><a id="l00130" name="l00130"></a><span class="lineno">  130</span><span class="keywordtype">REAL</span>, <span class="keywordtype">DIMENSION(D%NIJT)</span>,     <span class="keywordtype">INTENT(OUT)</span>        :: PINPRC     <span class="comment">! Cloud instant precip</span></div>
<div class="line"><a id="l00131" name="l00131"></a><span class="lineno">  131</span><span class="keywordtype">REAL</span>, <span class="keywordtype">DIMENSION(D%NIJT)</span>,     <span class="keywordtype">INTENT(OUT)</span>        :: PINDEP     <span class="comment">! Cloud droplets deposition</span></div>
<div class="line"><a id="l00132" name="l00132"></a><span class="lineno">  132</span><span class="keywordtype">REAL</span>, <span class="keywordtype">DIMENSION(D%NIJT)</span>,     <span class="keywordtype">INTENT(OUT)</span>        :: PINPRR     <span class="comment">! Rain instant precip</span></div>
<div class="line"><a id="l00133" name="l00133"></a><span class="lineno">  133</span><span class="keywordtype">REAL</span>, <span class="keywordtype">DIMENSION(D%NIJT)</span>,     <span class="keywordtype">INTENT(OUT)</span>        :: PINPRI     <span class="comment">! Rain instant precip</span></div>
<div class="line"><a id="l00134" name="l00134"></a><span class="lineno">  134</span><span class="keywordtype">REAL</span>, <span class="keywordtype">DIMENSION(D%NIJT)</span>,     <span class="keywordtype">INTENT(OUT)</span>        :: PINPRS     <span class="comment">! Snow instant precip</span></div>
<div class="line"><a id="l00135" name="l00135"></a><span class="lineno">  135</span><span class="keywordtype">REAL</span>, <span class="keywordtype">DIMENSION(D%NIJT)</span>,     <span class="keywordtype">INTENT(OUT)</span>        :: PINPRG     <span class="comment">! Graupel instant precip</span></div>
<div class="line"><a id="l00136" name="l00136"></a><span class="lineno">  136</span><span class="keywordtype">REAL</span>, <span class="keywordtype">DIMENSION(D%NIJT)</span>,     <span class="keywordtype">INTENT(OUT)</span>        :: PINPRH     <span class="comment">! Rain instant precip</span></div>
<div class="line"><a id="l00137" name="l00137"></a><span class="lineno">  137</span><span class="keywordtype">REAL</span>, <span class="keywordtype">DIMENSION(D%NIJT, D%NKT)</span>,   <span class="keywordtype">INTENT(OUT)</span>   :: PEVAP3D    <span class="comment">! Rain evap profile</span></div>
<div class="line"><a id="l00138" name="l00138"></a><span class="lineno">  138</span><span class="comment">!</span></div>
<div class="line"><a id="l00139" name="l00139"></a><span class="lineno">  139</span><span class="keywordtype">REAL</span>, <span class="keywordtype">DIMENSION(D%NIJT, D%NKT)</span>,   <span class="keywordtype">INTENT(INOUT)</span> :: PCLDFR     <span class="comment">! Cloud fraction</span></div>
<div class="line"><a id="l00140" name="l00140"></a><span class="lineno">  140</span><span class="keywordtype">REAL</span>, <span class="keywordtype">DIMENSION(D%NIJT, D%NKT)</span>,   <span class="keywordtype">INTENT(INOUT)</span> :: PICEFR     <span class="comment">! Cloud fraction</span></div>
<div class="line"><a id="l00141" name="l00141"></a><span class="lineno">  141</span><span class="keywordtype">REAL</span>, <span class="keywordtype">DIMENSION(D%NIJT, D%NKT)</span>,   <span class="keywordtype">INTENT(INOUT)</span> :: PPRCFR     <span class="comment">! Cloud fraction</span></div>
<div class="line"><a id="l00142" name="l00142"></a><span class="lineno">  142</span><span class="keywordtype">REAL</span>, <span class="keywordtype">DIMENSION(D%NIJT, D%NKT, KRR)</span>, <span class="keywordtype">INTENT(OUT)</span> :: PFPR    <span class="comment">! Precipitation fluxes in altitude</span></div>
<div class="line"><a id="l00143" name="l00143"></a><span class="lineno">  143</span><span class="comment">!</span></div>
<div class="line"><a id="l00144" name="l00144"></a><span class="lineno">  144</span><span class="keywordtype">REAL</span>, <span class="keywordtype">DIMENSION(D%NIJT, D%NKT)</span>,   <span class="keywordtype">OPTIONAL</span>, <span class="keywordtype">INTENT(IN)</span>       :: PLATHAM_IAGGS  <span class="comment">! Factor for IAGGS modification due to Efield</span></div>
<div class="line"><a id="l00145" name="l00145"></a><span class="lineno">  145</span><span class="keywordtype">REAL</span>, <span class="keywordtype">DIMENSION(D%NIJT, D%NKT)</span>,   <span class="keywordtype">OPTIONAL</span>, <span class="keywordtype">INTENT(IN)</span>       :: PEFIELDW   <span class="comment">! Vertical component of the electric field</span></div>
<div class="line"><a id="l00146" name="l00146"></a><span class="lineno">  146</span><span class="keywordtype">REAL</span>, <span class="keywordtype">DIMENSION(D%NIJT, D%NKT, TNSV%NSV)</span>, <span class="keywordtype">OPTIONAL</span>, <span class="keywordtype">INTENT(IN)</span>    :: PSV_ELEC_T <span class="comment">! Charge density at time t</span></div>
<div class="line"><a id="l00147" name="l00147"></a><span class="lineno">  147</span><span class="keywordtype">REAL</span>, <span class="keywordtype">DIMENSION(D%NIJT, D%NKT, TNSV%NSV)</span>, <span class="keywordtype">OPTIONAL</span>, <span class="keywordtype">INTENT(INOUT)</span> :: PSV_ELEC_S <span class="comment">! Charge density sources</span></div>
<div class="line"><a id="l00148" name="l00148"></a><span class="lineno">  148</span><span class="comment">!</span></div>
<div class="line"><a id="l00149" name="l00149"></a><span class="lineno">  149</span><span class="keywordtype">REAL</span>, <span class="keywordtype">INTENT(IN)</span>                :: PTHVREFZIKB <span class="comment">! Reference thv at IKB for electricity</span></div>
<div class="line"><a id="l00150" name="l00150"></a><span class="lineno">  150</span><span class="comment">!*       0.2   Declarations of local variables :</span></div>
<div class="line"><a id="l00151" name="l00151"></a><span class="lineno">  151</span><span class="comment">!</span></div>
<div class="line"><a id="l00152" name="l00152"></a><span class="lineno">  152</span><span class="comment">!</span></div>
<div class="line"><a id="l00153" name="l00153"></a><span class="lineno">  153</span><span class="comment">! Prognostic variables and sources</span></div>
<div class="line"><a id="l00154" name="l00154"></a><span class="lineno">  154</span><span class="keywordtype">REAL</span>, <span class="keywordtype">DIMENSION(D%NIJT,D%NKT)</span>      :: ZTHT, ZRVT, ZRCT, ZRRT, ZRIT, ZRST, ZRGT, ZRHT</div>
<div class="line"><a id="l00155" name="l00155"></a><span class="lineno">  155</span><span class="keywordtype">REAL</span>, <span class="keywordtype">DIMENSION(D%NIJT,D%NKT)</span>      :: ZCCT, ZCRT, ZCIT, ZCST, ZCGT, ZCHT</div>
<div class="line"><a id="l00156" name="l00156"></a><span class="lineno">  156</span><span class="keywordtype">REAL</span>, <span class="keywordtype">DIMENSION(D%NIJT,D%NKT)</span>      :: ZTHS, ZRVS, ZRCS, ZRRS, ZRIS, ZRSS, ZRGS, ZRHS</div>
<div class="line"><a id="l00157" name="l00157"></a><span class="lineno">  157</span><span class="keywordtype">REAL</span>, <span class="keywordtype">DIMENSION(D%NIJT,D%NKT)</span>      :: ZCCS, ZCRS, ZCIS, ZCSS, ZCGS, ZCHS</div>
<div class="line"><a id="l00158" name="l00158"></a><span class="lineno">  158</span><span class="keywordtype">REAL</span>, <span class="keywordtype">DIMENSION(D%NIJT,D%NKT,LIMAP%NMOD_CCN)</span> :: ZCCNFT, ZCCNAT</div>
<div class="line"><a id="l00159" name="l00159"></a><span class="lineno">  159</span><span class="keywordtype">REAL</span>, <span class="keywordtype">DIMENSION(D%NIJT,D%NKT,LIMAP%NMOD_CCN)</span> :: ZCCNFS, ZCCNAS</div>
<div class="line"><a id="l00160" name="l00160"></a><span class="lineno">  160</span><span class="keywordtype">REAL</span>, <span class="keywordtype">DIMENSION(D%NIJT,D%NKT,LIMAP%NMOD_IFN)</span> :: ZIFNFT, ZIFNNT</div>
<div class="line"><a id="l00161" name="l00161"></a><span class="lineno">  161</span><span class="keywordtype">REAL</span>, <span class="keywordtype">DIMENSION(D%NIJT,D%NKT,LIMAP%NMOD_IFN)</span> :: ZIFNFS, ZIFNNS</div>
<div class="line"><a id="l00162" name="l00162"></a><span class="lineno">  162</span><span class="keywordtype">REAL</span>, <span class="keywordtype">DIMENSION(D%NIJT,D%NKT,LIMAP%NMOD_IMM)</span> :: ZIMMNT</div>
<div class="line"><a id="l00163" name="l00163"></a><span class="lineno">  163</span><span class="keywordtype">REAL</span>, <span class="keywordtype">DIMENSION(D%NIJT,D%NKT,LIMAP%NMOD_IMM)</span> :: ZIMMNS</div>
<div class="line"><a id="l00164" name="l00164"></a><span class="lineno">  164</span><span class="keywordtype">REAL</span>, <span class="keywordtype">DIMENSION(D%NIJT,D%NKT)</span>      :: ZHOMFT</div>
<div class="line"><a id="l00165" name="l00165"></a><span class="lineno">  165</span><span class="keywordtype">REAL</span>, <span class="keywordtype">DIMENSION(D%NIJT,D%NKT)</span>      :: ZHOMFS</div>
<div class="line"><a id="l00166" name="l00166"></a><span class="lineno">  166</span> </div>
<div class="line"><a id="l00167" name="l00167"></a><span class="lineno">  167</span><span class="keywordtype">REAL</span>, <span class="keywordtype">DIMENSION(:,:,:)</span>, <span class="keywordtype">ALLOCATABLE</span> :: ZCIS_SHAPE  <span class="comment">! Nb concentration for each ice habit (source)</span></div>
<div class="line"><a id="l00168" name="l00168"></a><span class="lineno">  168</span><span class="keywordtype">REAL</span>, <span class="keywordtype">DIMENSION(:,:,:)</span>, <span class="keywordtype">ALLOCATABLE</span> :: ZRIS_SHAPE  <span class="comment">! Mixing ratio for each ice habit (source)</span></div>
<div class="line"><a id="l00169" name="l00169"></a><span class="lineno">  169</span><span class="keywordtype">REAL</span>, <span class="keywordtype">DIMENSION(:,:,:)</span>, <span class="keywordtype">ALLOCATABLE</span> :: ZCIT_SHAPE  <span class="comment">! Nb concentration for each ice habit (at t)</span></div>
<div class="line"><a id="l00170" name="l00170"></a><span class="lineno">  170</span><span class="keywordtype">REAL</span>, <span class="keywordtype">DIMENSION(:,:,:)</span>, <span class="keywordtype">ALLOCATABLE</span> :: ZRIT_SHAPE  <span class="comment">! Mixing ratio for each ice habit (at t)</span></div>
<div class="line"><a id="l00171" name="l00171"></a><span class="lineno">  171</span><span class="comment">!</span></div>
<div class="line"><a id="l00172" name="l00172"></a><span class="lineno">  172</span><span class="comment">! Other 3D thermodynamical variables</span></div>
<div class="line"><a id="l00173" name="l00173"></a><span class="lineno">  173</span><span class="keywordtype">REAL</span>, <span class="keywordtype">DIMENSION(D%NIJT,D%NKT)</span>      :: ZEXN, ZT</div>
<div class="line"><a id="l00174" name="l00174"></a><span class="lineno">  174</span> </div>
<div class="line"><a id="l00175" name="l00175"></a><span class="lineno">  175</span><span class="comment">!</span></div>
<div class="line"><a id="l00176" name="l00176"></a><span class="lineno">  176</span><span class="comment">! Packed prognostic &amp; thermo variables</span></div>
<div class="line"><a id="l00177" name="l00177"></a><span class="lineno">  177</span><span class="keywordtype">REAL</span>, <span class="keywordtype">DIMENSION(:)</span>,   <span class="keywordtype">ALLOCATABLE</span> ::                               &amp;</div>
<div class="line"><a id="l00178" name="l00178"></a><span class="lineno">  178</span>     ZP1D, ZRHODREF1D, ZEXNREF1D, ZEXN1D,                          &amp;</div>
<div class="line"><a id="l00179" name="l00179"></a><span class="lineno">  179</span>     ZTHT1D,                                                       &amp;</div>
<div class="line"><a id="l00180" name="l00180"></a><span class="lineno">  180</span>     ZRVT1D, ZRCT1D, ZRRT1D, ZRIT1D, ZRST1D, ZRGT1D, ZRHT1D,       &amp;</div>
<div class="line"><a id="l00181" name="l00181"></a><span class="lineno">  181</span>     ZCCT1D, ZCRT1D, ZCIT1D, ZCST1D, ZCGT1D, ZCHT1D,               &amp;</div>
<div class="line"><a id="l00182" name="l00182"></a><span class="lineno">  182</span>     ZEVAP1D</div>
<div class="line"><a id="l00183" name="l00183"></a><span class="lineno">  183</span><span class="keywordtype">REAL</span>, <span class="keywordtype">DIMENSION(:,:)</span>, <span class="keywordtype">ALLOCATABLE</span> :: ZIFNN1D</div>
<div class="line"><a id="l00184" name="l00184"></a><span class="lineno">  184</span><span class="keywordtype">REAL</span>, <span class="keywordtype">DIMENSION(:,:)</span>, <span class="keywordtype">ALLOCATABLE</span> :: ZCIT1D_SHAPE</div>
<div class="line"><a id="l00185" name="l00185"></a><span class="lineno">  185</span> </div>
<div class="line"><a id="l00186" name="l00186"></a><span class="lineno">  186</span><span class="comment">!</span></div>
<div class="line"><a id="l00187" name="l00187"></a><span class="lineno">  187</span><span class="comment">! for each process &amp; species inside the loop, we need 1D packed variables to store instant tendencies for hydrometeors</span></div>
<div class="line"><a id="l00188" name="l00188"></a><span class="lineno">  188</span><span class="keywordtype">REAL</span>, <span class="keywordtype">DIMENSION(:)</span>, <span class="keywordtype">ALLOCATABLE</span> ::                          &amp;</div>
<div class="line"><a id="l00189" name="l00189"></a><span class="lineno">  189</span><span class="comment">! mixing ratio &amp; concentration changes by instantaneous processes (kg/kg and #/kg) :</span></div>
<div class="line"><a id="l00190" name="l00190"></a><span class="lineno">  190</span>     z_cr_brku,                                             &amp; <span class="comment">! spontaneous break up of drops (BRKU) : Nr</span></div>
<div class="line"><a id="l00191" name="l00191"></a><span class="lineno">  191</span>     z_th_honr, z_rr_honr, z_cr_honr,                       &amp; <span class="comment">! rain drops homogeneous freezing (HONR) : rr, Nr, rg=-rr, th</span></div>
<div class="line"><a id="l00192" name="l00192"></a><span class="lineno">  192</span>     z_th_imlt, z_rc_imlt, z_cc_imlt,                       &amp; <span class="comment">! ice melting (IMLT) : rc, Nc, ri=-rc, Ni=-Nc, th, IFNF, IFNA</span></div>
<div class="line"><a id="l00193" name="l00193"></a><span class="lineno">  193</span><span class="comment">! mixing ratio &amp; concentration tendencies by continuous processes (kg/kg/s and #/kg/s) :</span></div>
<div class="line"><a id="l00194" name="l00194"></a><span class="lineno">  194</span>     z_th_honc, z_rc_honc, z_cc_honc,                       &amp; <span class="comment">! droplets homogeneous freezing (HONC) : rc, Nc, ri=-rc, Ni=-Nc, th</span></div>
<div class="line"><a id="l00195" name="l00195"></a><span class="lineno">  195</span>     z_cc_self,                                             &amp; <span class="comment">! self collection of droplets (SELF) : Nc</span></div>
<div class="line"><a id="l00196" name="l00196"></a><span class="lineno">  196</span>     z_rc_auto, z_cc_auto, z_cr_auto,                       &amp; <span class="comment">! autoconversion of cloud droplets (AUTO) : rc, Nc, rr=-rc, Nr</span></div>
<div class="line"><a id="l00197" name="l00197"></a><span class="lineno">  197</span>     z_rc_accr, z_cc_accr,                                  &amp; <span class="comment">! accretion of droplets by rain drops (ACCR) : rc, Nc, rr=-rr</span></div>
<div class="line"><a id="l00198" name="l00198"></a><span class="lineno">  198</span>     z_cr_scbu,                                             &amp; <span class="comment">! self collectio break up of drops (SCBU) : Nr</span></div>
<div class="line"><a id="l00199" name="l00199"></a><span class="lineno">  199</span><span class="comment">!      Z_TH_EVAP, Z_RC_EVAP, Z_CC_EVAP, Z_RR_EVAP, Z_CR_EVAP, &amp; ! evaporation of rain drops (EVAP) : rv=-rr-rc, rc, Nc, rr, Nr, th</span></div>
<div class="line"><a id="l00200" name="l00200"></a><span class="lineno">  200</span>     z_th_evap, z_rr_evap, z_cr_evap,                       &amp; <span class="comment">! evaporation of rain drops (EVAP) : rv=-rr-rc, rc, Nc, rr, Nr, th</span></div>
<div class="line"><a id="l00201" name="l00201"></a><span class="lineno">  201</span>     z_ri_cnvi, z_ci_cnvi,                                  &amp; <span class="comment">! conversion snow -&gt; ice (CNVI) : ri, Ni, rs=-ri</span></div>
<div class="line"><a id="l00202" name="l00202"></a><span class="lineno">  202</span>     z_th_deps, z_rs_deps,                                  &amp; <span class="comment">! deposition of vapor on snow (DEPS) : rv=-rs, rs, th</span></div>
<div class="line"><a id="l00203" name="l00203"></a><span class="lineno">  203</span>     z_th_depi, z_ri_depi,                                  &amp; <span class="comment">! deposition of vapor on ice (DEPI) : rv=-ri, ri, th</span></div>
<div class="line"><a id="l00204" name="l00204"></a><span class="lineno">  204</span>     z_ri_cnvs, z_ci_cnvs,                                  &amp; <span class="comment">! conversion ice -&gt; snow (CNVS) : ri, Ni, rs=-ri</span></div>
<div class="line"><a id="l00205" name="l00205"></a><span class="lineno">  205</span>     z_cs_ssc,                                              &amp; <span class="comment">! self collection of snow (SSC) : Ns</span></div>
<div class="line"><a id="l00206" name="l00206"></a><span class="lineno">  206</span>     z_ci_isc,                                              &amp; <span class="comment">! self collection of ice (ISC) : Ni      ++mt--</span></div>
<div class="line"><a id="l00207" name="l00207"></a><span class="lineno">  207</span>     z_ri_aggs, z_ci_aggs,                                  &amp; <span class="comment">! aggregation of ice on snow (AGGS) : ri, Ni, rs=-ri</span></div>
<div class="line"><a id="l00208" name="l00208"></a><span class="lineno">  208</span>     z_th_depg, z_rg_depg,                                  &amp; <span class="comment">! deposition of vapor on graupel (DEPG) : rv=-rg, rg, th</span></div>
<div class="line"><a id="l00209" name="l00209"></a><span class="lineno">  209</span>     z_th_berfi, z_rc_berfi,                                &amp; <span class="comment">! Bergeron (BERFI) : rc, ri=-rc, th</span></div>
<div class="line"><a id="l00210" name="l00210"></a><span class="lineno">  210</span>     z_th_rim, z_cc_rim, z_cs_rim, z_rc_rimss, z_rc_rimsg, z_rs_rimcg, &amp; <span class="comment">! cloud droplet riming (RIM) : rc, Nc, rs, rg, th</span></div>
<div class="line"><a id="l00211" name="l00211"></a><span class="lineno">  211</span>     z_ri_hms, z_ci_hms, z_rs_hms,                          &amp; <span class="comment">! hallett mossop snow (HMS) : ri, Ni, rs</span></div>
<div class="line"><a id="l00212" name="l00212"></a><span class="lineno">  212</span>     z_th_acc, z_cr_acc, z_cs_acc, z_rr_accss, z_rr_accsg, z_rs_accrg, &amp; <span class="comment">! rain accretion on aggregates (ACC) : rr, Nr, rs, rg, th</span></div>
<div class="line"><a id="l00213" name="l00213"></a><span class="lineno">  213</span>     z_rs_cmel, z_cs_cmel,                                  &amp; <span class="comment">! conversion-melting (CMEL) : rs, rg=-rs</span></div>
<div class="line"><a id="l00214" name="l00214"></a><span class="lineno">  214</span>     z_th_cfrz, z_rr_cfrz, z_cr_cfrz, z_ri_cfrz, z_ci_cfrz, &amp; <span class="comment">! rain freezing (CFRZ) : rr, Nr, ri, Ni, rg=-rr-ri, th</span></div>
<div class="line"><a id="l00215" name="l00215"></a><span class="lineno">  215</span>     z_ri_cibu, z_ci_cibu,                                  &amp; <span class="comment">! collisional ice break-up (CIBU) : ri, Ni, rs=-ri</span></div>
<div class="line"><a id="l00216" name="l00216"></a><span class="lineno">  216</span>     z_ri_rdsf, z_ci_rdsf,                                  &amp; <span class="comment">! rain drops freezing shattering (RDSF) : ri, Ni, rg=-ri</span></div>
<div class="line"><a id="l00217" name="l00217"></a><span class="lineno">  217</span>     z_th_wetg, z_rc_wetg, z_cc_wetg, z_rr_wetg, z_cr_wetg, &amp; <span class="comment">! wet growth of graupel (WETG) : rc, NC, rr, Nr, ri, Ni, rs, rg, rh, th</span></div>
<div class="line"><a id="l00218" name="l00218"></a><span class="lineno">  218</span>     z_ri_wetg, z_ci_wetg, z_rs_wetg, z_cs_wetg, z_rg_wetg, z_cg_wetg, z_rh_wetg, &amp; <span class="comment">! wet growth of graupel (WETG) : rc, NC, rr, Nr, ri, Ni, rs, Ns, rg, Ng, rh, Nh=-Ng, th</span></div>
<div class="line"><a id="l00219" name="l00219"></a><span class="lineno">  219</span>     z_th_dryg, z_rc_dryg, z_cc_dryg, z_rr_dryg, z_cr_dryg, &amp; <span class="comment">! dry growth of graupel (DRYG) : rc, Nc, rr, Nr, ri, Ni, rs, rg, th</span></div>
<div class="line"><a id="l00220" name="l00220"></a><span class="lineno">  220</span>     z_ri_dryg, z_ci_dryg, z_rs_dryg, z_cs_dryg, z_rg_dryg, &amp; <span class="comment">! dry growth of graupel (DRYG) : rc, Nc, rr, Nr, ri, Ni, rs, Ns, rg, th</span></div>
<div class="line"><a id="l00221" name="l00221"></a><span class="lineno">  221</span>     z_ri_hmg, z_ci_hmg, z_rg_hmg,                          &amp; <span class="comment">! hallett mossop graupel (HMG) : ri, Ni, rg</span></div>
<div class="line"><a id="l00222" name="l00222"></a><span class="lineno">  222</span>     z_th_gmlt, z_rr_gmlt, z_cr_gmlt, z_cg_gmlt,            &amp; <span class="comment">! graupel melting (GMLT) : rr, Nr, rg=-rr, th</span></div>
<div class="line"><a id="l00223" name="l00223"></a><span class="lineno">  223</span>     z_th_deph, z_rh_deph,                                  &amp; <span class="comment">! deposition of vapor on hail (DEPH) : rv=-rh, rh, th</span></div>
<div class="line"><a id="l00224" name="l00224"></a><span class="lineno">  224</span>     z_th_weth, z_rc_weth, z_cc_weth, z_rr_weth, z_cr_weth, &amp; <span class="comment">! wet growth of hail (WETH) : rc, Nc, rr, Nr, ri, Ni, rs, rg, rh, th</span></div>
<div class="line"><a id="l00225" name="l00225"></a><span class="lineno">  225</span>     z_ri_weth, z_ci_weth, z_rs_weth, z_cs_weth, z_rg_weth, z_cg_weth, z_rh_weth, &amp; <span class="comment">! wet growth of hail (WETH) : rc, Nc, rr, Nr, ri, Ni, rs, rg, rh, th</span></div>
<div class="line"><a id="l00226" name="l00226"></a><span class="lineno">  226</span>     z_rg_cohg, z_cg_cohg,                                  &amp; <span class="comment">! conversion of hail into graupel (COHG) : rg, rh</span></div>
<div class="line"><a id="l00227" name="l00227"></a><span class="lineno">  227</span>     z_th_hmlt, z_rr_hmlt, z_cr_hmlt, z_ch_hmlt,            &amp; <span class="comment">! hail melting (HMLT) : rr, Nr, rh=-rr, th</span></div>
<div class="line"><a id="l00228" name="l00228"></a><span class="lineno">  228</span>     z_rv_corr2, z_rc_corr2, z_rr_corr2, z_ri_corr2,        &amp;</div>
<div class="line"><a id="l00229" name="l00229"></a><span class="lineno">  229</span>     z_cc_corr2, z_cr_corr2, z_ci_corr2,                    &amp;</div>
<div class="line"><a id="l00230" name="l00230"></a><span class="lineno">  230</span>     z_ri_hind, z_rc_hinc, z_rv_henu, z_rv_honh</div>
<div class="line"><a id="l00231" name="l00231"></a><span class="lineno">  231</span><span class="comment">!--cb--</span></div>
<div class="line"><a id="l00232" name="l00232"></a><span class="lineno">  232</span><span class="comment">!</span></div>
<div class="line"><a id="l00233" name="l00233"></a><span class="lineno">  233</span><span class="comment">! for the conversion from rain to cloud, we need a 3D variable instead of a 1D packed variable</span></div>
<div class="line"><a id="l00234" name="l00234"></a><span class="lineno">  234</span><span class="keywordtype">REAL</span>, <span class="keywordtype">DIMENSION(D%NIJT,D%NKT)</span> ::  Z_RR_CVRC, Z_CR_CVRC        <span class="comment">! conversion of rain into cloud droplets (CVRC)</span></div>
<div class="line"><a id="l00235" name="l00235"></a><span class="lineno">  235</span> </div>
<div class="line"><a id="l00236" name="l00236"></a><span class="lineno">  236</span><span class="comment">!</span></div>
<div class="line"><a id="l00237" name="l00237"></a><span class="lineno">  237</span><span class="comment">! Packed variables for total tendencies</span></div>
<div class="line"><a id="l00238" name="l00238"></a><span class="lineno">  238</span><span class="keywordtype">REAL</span>, <span class="keywordtype">DIMENSION(:)</span>,   <span class="keywordtype">ALLOCATABLE</span> ::                                              &amp;</div>
<div class="line"><a id="l00239" name="l00239"></a><span class="lineno">  239</span>     ZA_TH, ZA_RV, ZA_RC, ZA_CC, ZA_RR, ZA_CR, ZA_RI, ZA_CI, ZA_RS, ZA_CS, ZA_RG, ZA_CG, ZA_RH, ZA_CH, &amp; <span class="comment">! ZA = continuous tendencies (kg/kg/s = S variable)</span></div>
<div class="line"><a id="l00240" name="l00240"></a><span class="lineno">  240</span>     ZB_TH, ZB_RV, ZB_RC, ZB_CC, ZB_RR, ZB_CR, ZB_RI, ZB_CI, ZB_RS, ZB_CS, ZB_RG, ZB_CG, ZB_RH, ZB_CH    <span class="comment">! ZB = instant mixing ratio change (kg/kg = T variable)</span></div>
<div class="line"><a id="l00241" name="l00241"></a><span class="lineno">  241</span><span class="keywordtype">REAL</span>, <span class="keywordtype">DIMENSION(:,:)</span>, <span class="keywordtype">ALLOCATABLE</span> :: ZB_IFNN</div>
<div class="line"><a id="l00242" name="l00242"></a><span class="lineno">  242</span> </div>
<div class="line"><a id="l00243" name="l00243"></a><span class="lineno">  243</span><span class="keywordtype">REAL</span>, <span class="keywordtype">DIMENSION(:,:)</span>, <span class="keywordtype">ALLOCATABLE</span> :: ZA_CI_SHAPE <span class="comment">! continuous tendencies (kg/kg/s = S variable) for ice shapes C.</span></div>
<div class="line"><a id="l00244" name="l00244"></a><span class="lineno">  244</span><span class="keywordtype">REAL</span>, <span class="keywordtype">DIMENSION(:,:)</span>, <span class="keywordtype">ALLOCATABLE</span> :: ZB_CI_SHAPE <span class="comment">! instant change (kg/kg = T variable) for ice shapes C.</span></div>
<div class="line"><a id="l00245" name="l00245"></a><span class="lineno">  245</span><span class="comment">!</span></div>
<div class="line"><a id="l00246" name="l00246"></a><span class="lineno">  246</span><span class="comment">! for each process &amp; species, we need 3D variables to store total mmr and conc change (kg/kg and #/kg and theta)</span></div>
<div class="line"><a id="l00247" name="l00247"></a><span class="lineno">  247</span><span class="keywordtype">REAL</span>, <span class="keywordtype">DIMENSION(:,:)</span>, <span class="keywordtype">ALLOCATABLE</span> ::                                       &amp;</div>
<div class="line"><a id="l00248" name="l00248"></a><span class="lineno">  248</span><span class="comment">! instantaneous processes :</span></div>
<div class="line"><a id="l00249" name="l00249"></a><span class="lineno">  249</span>     ztot_cr_brku,                                                         &amp; <span class="comment">! spontaneous break up of drops (BRKU)</span></div>
<div class="line"><a id="l00250" name="l00250"></a><span class="lineno">  250</span>     ztot_th_honr, ztot_rr_honr, ztot_cr_honr,                             &amp; <span class="comment">! rain drops homogeneous freezing (HONR)</span></div>
<div class="line"><a id="l00251" name="l00251"></a><span class="lineno">  251</span>     ztot_th_imlt, ztot_rc_imlt, ztot_cc_imlt,                             &amp; <span class="comment">! ice melting (IMLT)</span></div>
<div class="line"><a id="l00252" name="l00252"></a><span class="lineno">  252</span><span class="comment">! continuous processes :</span></div>
<div class="line"><a id="l00253" name="l00253"></a><span class="lineno">  253</span>     ztot_th_honc, ztot_rc_honc, ztot_cc_honc,                             &amp; <span class="comment">! droplets homogeneous freezing (HONC)</span></div>
<div class="line"><a id="l00254" name="l00254"></a><span class="lineno">  254</span>     ztot_cc_self,                                                         &amp; <span class="comment">! self collection of droplets (SELF)</span></div>
<div class="line"><a id="l00255" name="l00255"></a><span class="lineno">  255</span>     ztot_rc_auto, ztot_cc_auto, ztot_cr_auto,                             &amp; <span class="comment">! autoconversion of cloud droplets (AUTO)</span></div>
<div class="line"><a id="l00256" name="l00256"></a><span class="lineno">  256</span>     ztot_rc_accr, ztot_cc_accr,                                           &amp; <span class="comment">! accretion of droplets by rain drops (ACCR)</span></div>
<div class="line"><a id="l00257" name="l00257"></a><span class="lineno">  257</span>     ztot_cr_scbu,                                                         &amp; <span class="comment">! self collectio break up of drops (SCBU)</span></div>
<div class="line"><a id="l00258" name="l00258"></a><span class="lineno">  258</span><span class="comment">!      ZTOT_TH_EVAP, ZTOT_RC_EVAP, ZTOT_CC_EVAP, ZTOT_RR_EVAP, ZTOT_CR_EVAP, &amp; ! evaporation of rain drops (EVAP)</span></div>
<div class="line"><a id="l00259" name="l00259"></a><span class="lineno">  259</span>     ztot_th_evap, ztot_rr_evap, ztot_cr_evap,                             &amp; <span class="comment">! evaporation of rain drops (EVAP)</span></div>
<div class="line"><a id="l00260" name="l00260"></a><span class="lineno">  260</span>     ztot_ri_cnvi, ztot_ci_cnvi,                                           &amp; <span class="comment">! conversion snow -&gt; ice (CNVI)</span></div>
<div class="line"><a id="l00261" name="l00261"></a><span class="lineno">  261</span>     ztot_th_deps, ztot_rs_deps,                                           &amp; <span class="comment">! deposition of vapor on snow (DEPS)</span></div>
<div class="line"><a id="l00262" name="l00262"></a><span class="lineno">  262</span>     ztot_th_depi, ztot_ri_depi,                                           &amp; <span class="comment">! deposition of vapor on ice (DEPI)</span></div>
<div class="line"><a id="l00263" name="l00263"></a><span class="lineno">  263</span>     ztot_ri_cnvs, ztot_ci_cnvs,                                           &amp; <span class="comment">! conversion ice -&gt; snow (CNVS)</span></div>
<div class="line"><a id="l00264" name="l00264"></a><span class="lineno">  264</span>     ztot_cs_ssc,                                                          &amp; <span class="comment">! self collection of snow (SSC)</span></div>
<div class="line"><a id="l00265" name="l00265"></a><span class="lineno">  265</span>     ztot_ci_isc,                                                          &amp; <span class="comment">! self collection of ice (ISC)</span></div>
<div class="line"><a id="l00266" name="l00266"></a><span class="lineno">  266</span>     ztot_ri_aggs, ztot_ci_aggs,                                           &amp; <span class="comment">! aggregation of ice on snow (AGGS)</span></div>
<div class="line"><a id="l00267" name="l00267"></a><span class="lineno">  267</span>     ztot_th_depg, ztot_rg_depg,                                           &amp; <span class="comment">! deposition of vapor on graupel (DEPG)</span></div>
<div class="line"><a id="l00268" name="l00268"></a><span class="lineno">  268</span>     ztot_th_berfi, ztot_rc_berfi,                                         &amp; <span class="comment">! Bergeron (BERFI)</span></div>
<div class="line"><a id="l00269" name="l00269"></a><span class="lineno">  269</span>     ztot_th_rim, ztot_cc_rim, ztot_cs_rim, ztot_rc_rimss, ztot_rc_rimsg, ztot_rs_rimcg, &amp; <span class="comment">! cloud droplet riming (RIM)</span></div>
<div class="line"><a id="l00270" name="l00270"></a><span class="lineno">  270</span>     ztot_ri_hms, ztot_ci_hms, ztot_rs_hms,                                &amp; <span class="comment">! hallett mossop snow (HMS)</span></div>
<div class="line"><a id="l00271" name="l00271"></a><span class="lineno">  271</span>     ztot_th_acc, ztot_cr_acc, ztot_cs_acc, ztot_rr_accss, ztot_rr_accsg, ztot_rs_accrg, &amp; <span class="comment">! rain accretion on aggregates (ACC)</span></div>
<div class="line"><a id="l00272" name="l00272"></a><span class="lineno">  272</span>     ztot_rs_cmel, ztot_cs_cmel,                                                        &amp; <span class="comment">! conversion-melting (CMEL)</span></div>
<div class="line"><a id="l00273" name="l00273"></a><span class="lineno">  273</span>     ztot_th_cfrz, ztot_rr_cfrz, ztot_cr_cfrz, ztot_ri_cfrz, ztot_ci_cfrz, &amp; <span class="comment">! rain freezing (CFRZ)</span></div>
<div class="line"><a id="l00274" name="l00274"></a><span class="lineno">  274</span>     ztot_ri_cibu, ztot_ci_cibu,                                           &amp; <span class="comment">! collisional ice break-up (CIBU)</span></div>
<div class="line"><a id="l00275" name="l00275"></a><span class="lineno">  275</span>     ztot_ri_rdsf, ztot_ci_rdsf,                                           &amp; <span class="comment">! rain drops freezing shattering (RDSF)</span></div>
<div class="line"><a id="l00276" name="l00276"></a><span class="lineno">  276</span>     ztot_th_wetg, ztot_rc_wetg, ztot_cc_wetg, ztot_rr_wetg, ztot_cr_wetg, &amp; <span class="comment">! wet growth of graupel (WETG)</span></div>
<div class="line"><a id="l00277" name="l00277"></a><span class="lineno">  277</span>     ztot_ri_wetg, ztot_ci_wetg, ztot_rs_wetg, ztot_cs_wetg, ztot_rg_wetg, ztot_cg_wetg, ztot_rh_wetg, &amp; <span class="comment">! wet growth of graupel (WETG)</span></div>
<div class="line"><a id="l00278" name="l00278"></a><span class="lineno">  278</span>     ztot_th_dryg, ztot_rc_dryg, ztot_cc_dryg, ztot_rr_dryg, ztot_cr_dryg, &amp; <span class="comment">! dry growth of graupel (DRYG)</span></div>
<div class="line"><a id="l00279" name="l00279"></a><span class="lineno">  279</span>     ztot_ri_dryg, ztot_ci_dryg, ztot_rs_dryg, ztot_cs_dryg, ztot_rg_dryg,               &amp; <span class="comment">! dry growth of graupel (DRYG)</span></div>
<div class="line"><a id="l00280" name="l00280"></a><span class="lineno">  280</span>     ztot_ri_hmg, ztot_ci_hmg, ztot_rg_hmg,                                &amp; <span class="comment">! hallett mossop graupel (HMG)</span></div>
<div class="line"><a id="l00281" name="l00281"></a><span class="lineno">  281</span>     ztot_th_gmlt, ztot_rr_gmlt, ztot_cr_gmlt, ztot_cg_gmlt,               &amp; <span class="comment">! graupel melting (GMLT)</span></div>
<div class="line"><a id="l00282" name="l00282"></a><span class="lineno">  282</span>     ztot_th_deph, ztot_rh_deph,                                           &amp; <span class="comment">! deposition of vapor on hail (DEPH)</span></div>
<div class="line"><a id="l00283" name="l00283"></a><span class="lineno">  283</span>     ztot_th_weth, ztot_rc_weth, ztot_cc_weth, ztot_rr_weth, ztot_cr_weth, &amp; <span class="comment">! wet growth of hail (WETH)</span></div>
<div class="line"><a id="l00284" name="l00284"></a><span class="lineno">  284</span>     ztot_ri_weth, ztot_ci_weth, ztot_rs_weth, ztot_cs_weth, ztot_rg_weth, ztot_cg_weth, ztot_rh_weth, &amp; <span class="comment">! wet growth of hail (WETH)</span></div>
<div class="line"><a id="l00285" name="l00285"></a><span class="lineno">  285</span>     ztot_rg_cohg, ztot_cg_cohg,                                           &amp; <span class="comment">! conversion of hail into graupel (COHG)</span></div>
<div class="line"><a id="l00286" name="l00286"></a><span class="lineno">  286</span>     ztot_th_hmlt, ztot_rr_hmlt, ztot_cr_hmlt, ztot_ch_hmlt,               &amp; <span class="comment">! hail melting (HMLT)</span></div>
<div class="line"><a id="l00287" name="l00287"></a><span class="lineno">  287</span>     ztot_rr_cvrc, ztot_cr_cvrc,                                           &amp; <span class="comment">! conversion of rain into cloud droplets if diameter too small</span></div>
<div class="line"><a id="l00288" name="l00288"></a><span class="lineno">  288</span>     ztot_rv_corr2, ztot_rc_corr2, ztot_rr_corr2, ztot_ri_corr2,           &amp;</div>
<div class="line"><a id="l00289" name="l00289"></a><span class="lineno">  289</span>     ztot_cc_corr2, ztot_cr_corr2, ztot_ci_corr2,                          &amp;</div>
<div class="line"><a id="l00290" name="l00290"></a><span class="lineno">  290</span>     ztot_ri_hind, ztot_rc_hinc, ztot_rv_henu, ztot_rv_honh</div>
<div class="line"><a id="l00291" name="l00291"></a><span class="lineno">  291</span> </div>
<div class="line"><a id="l00292" name="l00292"></a><span class="lineno">  292</span><span class="keywordtype">REAL</span>, <span class="keywordtype">DIMENSION(:,:,:)</span>, <span class="keywordtype">ALLOCATABLE</span> :: ZTOT_IFNN_IMLT</div>
<div class="line"><a id="l00293" name="l00293"></a><span class="lineno">  293</span> </div>
<div class="line"><a id="l00294" name="l00294"></a><span class="lineno">  294</span><span class="keywordtype">REAL</span>, <span class="keywordtype">DIMENSION(:,:)</span>,     <span class="keywordtype">ALLOCATABLE</span> :: Z_SHCI_HONC, Z_SHCI_CNVI, &amp;</div>
<div class="line"><a id="l00295" name="l00295"></a><span class="lineno">  295</span>                                         Z_SHCI_HMS,  Z_SHCI_HMG,  &amp;</div>
<div class="line"><a id="l00296" name="l00296"></a><span class="lineno">  296</span>                                         Z_SHCI_CFRZ, Z_SHCI_CIBU, &amp;</div>
<div class="line"><a id="l00297" name="l00297"></a><span class="lineno">  297</span>                                         Z_SHCI_RDSF, Z_SHCI_WETG, &amp;</div>
<div class="line"><a id="l00298" name="l00298"></a><span class="lineno">  298</span>                                         Z_SHCI_DRYG, Z_SHCI_CORR2,&amp;</div>
<div class="line"><a id="l00299" name="l00299"></a><span class="lineno">  299</span>                                         Z_SHCI_IMLT, Z_SHCI_HACH, &amp;</div>
<div class="line"><a id="l00300" name="l00300"></a><span class="lineno">  300</span>                                         Z_SHCI_CNVS, Z_SHCI_AGGS</div>
<div class="line"><a id="l00301" name="l00301"></a><span class="lineno">  301</span><span class="keywordtype">REAL</span>, <span class="keywordtype">DIMENSION(:,:,:)</span>, <span class="keywordtype">ALLOCATABLE</span> :: ZTOT_SHCI_HONC, ZTOT_SHCI_CNVI, &amp;</div>
<div class="line"><a id="l00302" name="l00302"></a><span class="lineno">  302</span>                                         ZTOT_SHCI_HMS,  ZTOT_SHCI_HMG,  &amp;</div>
<div class="line"><a id="l00303" name="l00303"></a><span class="lineno">  303</span>                                         ZTOT_SHCI_CFRZ, ZTOT_SHCI_CIBU, &amp;</div>
<div class="line"><a id="l00304" name="l00304"></a><span class="lineno">  304</span>                                         ZTOT_SHCI_RDSF, ZTOT_SHCI_WETG, &amp;</div>
<div class="line"><a id="l00305" name="l00305"></a><span class="lineno">  305</span>                                         ZTOT_SHCI_DRYG, ZTOT_SHCI_CORR2,&amp;</div>
<div class="line"><a id="l00306" name="l00306"></a><span class="lineno">  306</span>                                         ZTOT_SHCI_IMLT, ZTOT_SHCI_HACH, &amp;</div>
<div class="line"><a id="l00307" name="l00307"></a><span class="lineno">  307</span>                                         ZTOT_SHCI_CNVS, ZTOT_SHCI_AGGS</div>
<div class="line"><a id="l00308" name="l00308"></a><span class="lineno">  308</span><span class="keywordtype">REAL</span>, <span class="keywordtype">DIMENSION(:,:,:)</span>, <span class="keywordtype">ALLOCATABLE</span> :: ZLBDAI_SHAPE</div>
<div class="line"><a id="l00309" name="l00309"></a><span class="lineno">  309</span><span class="keywordtype">REAL</span>, <span class="keywordtype">DIMENSION(:,:)</span>,     <span class="keywordtype">ALLOCATABLE</span> :: Z_SHCI_ISC  <span class="comment">! ISC  : Ni COL/PLA/DRO + COL/PLA/DRO --&gt; Ni BUR</span></div>
<div class="line"><a id="l00310" name="l00310"></a><span class="lineno">  310</span><span class="keywordtype">REAL</span>, <span class="keywordtype">DIMENSION(:,:)</span>,     <span class="keywordtype">ALLOCATABLE</span> :: Z_SHCI_ISCS <span class="comment">! ISCS : Ni BUR + COL/PLA/DRO/BUR --&gt; Ns</span></div>
<div class="line"><a id="l00311" name="l00311"></a><span class="lineno">  311</span><span class="keywordtype">REAL</span>, <span class="keywordtype">DIMENSION(:)</span>,       <span class="keywordtype">ALLOCATABLE</span> :: Z_SHRI_ISCS <span class="comment">! ISCS : ri --&gt; rs</span></div>
<div class="line"><a id="l00312" name="l00312"></a><span class="lineno">  312</span><span class="keywordtype">REAL</span>, <span class="keywordtype">DIMENSION(:,:,:)</span>, <span class="keywordtype">ALLOCATABLE</span> :: ZTOT_SHCI_ISC</div>
<div class="line"><a id="l00313" name="l00313"></a><span class="lineno">  313</span><span class="keywordtype">REAL</span>, <span class="keywordtype">DIMENSION(:,:,:)</span>, <span class="keywordtype">ALLOCATABLE</span> :: ZTOT_SHCI_ISCS <span class="comment">! perte pour chaque Ni, gain pour Ns = somme des pertes pour les Ni</span></div>
<div class="line"><a id="l00314" name="l00314"></a><span class="lineno">  314</span><span class="keywordtype">REAL</span>, <span class="keywordtype">DIMENSION(:,:)</span>,   <span class="keywordtype">ALLOCATABLE</span> :: ZTOT_SHRI_ISCS</div>
<div class="line"><a id="l00315" name="l00315"></a><span class="lineno">  315</span><span class="keywordtype">REAL</span>, <span class="keywordtype">DIMENSION(:,:)</span>,   <span class="keywordtype">ALLOCATABLE</span> :: ZAUX_ISCS  <span class="comment">! for snow budget: to take into account contribution from all shapes</span></div>
<div class="line"><a id="l00316" name="l00316"></a><span class="lineno">  316</span><span class="comment">!</span></div>
<div class="line"><a id="l00317" name="l00317"></a><span class="lineno">  317</span><span class="comment">!For mixing-ratio splitting</span></div>
<div class="line"><a id="l00318" name="l00318"></a><span class="lineno">  318</span><span class="keywordtype">REAL</span>, <span class="keywordtype">DIMENSION(D%NIJT,D%NKT)</span> :: Z0RVT,   Z0RCT,   Z0RRT,   Z0RIT,   Z0RST,   Z0RGT,   Z0RHT</div>
<div class="line"><a id="l00319" name="l00319"></a><span class="lineno">  319</span><span class="keywordtype">REAL</span>, <span class="keywordtype">DIMENSION(:)</span>, <span class="keywordtype">ALLOCATABLE</span>                      :: Z0RVT1D, Z0RCT1D, Z0RRT1D, Z0RIT1D, Z0RST1D, Z0RGT1D, Z0RHT1D </div>
<div class="line"><a id="l00320" name="l00320"></a><span class="lineno">  320</span> </div>
<div class="line"><a id="l00321" name="l00321"></a><span class="lineno">  321</span><span class="comment">!</span></div>
<div class="line"><a id="l00322" name="l00322"></a><span class="lineno">  322</span><span class="comment">! Loop control variables</span></div>
<div class="line"><a id="l00323" name="l00323"></a><span class="lineno">  323</span><span class="keywordtype">REAL</span>,    <span class="keywordtype">DIMENSION(D%NIJT,D%NKT)</span>   :: ZTIME,   ZTIME_LASTCALL</div>
<div class="line"><a id="l00324" name="l00324"></a><span class="lineno">  324</span><span class="keywordtype">INTEGER</span>, <span class="keywordtype">DIMENSION(D%NIJT,D%NKT)</span>   :: IITER</div>
<div class="line"><a id="l00325" name="l00325"></a><span class="lineno">  325</span><span class="keywordtype">REAL</span>,    <span class="keywordtype">DIMENSION(:)</span>, <span class="keywordtype">ALLOCATABLE</span> :: ZTIME1D, ZTIME_LASTCALL1D, ZMAXTIME, ZTIME_THRESHOLD</div>
<div class="line"><a id="l00326" name="l00326"></a><span class="lineno">  326</span><span class="keywordtype">INTEGER</span>, <span class="keywordtype">DIMENSION(:)</span>, <span class="keywordtype">ALLOCATABLE</span> :: IITER1D</div>
<div class="line"><a id="l00327" name="l00327"></a><span class="lineno">  327</span><span class="keywordtype">LOGICAL</span>, <span class="keywordtype">DIMENSION(D%NIJT,D%NKT)</span>   :: GLCOMPUTE</div>
<div class="line"><a id="l00328" name="l00328"></a><span class="lineno">  328</span><span class="keywordtype">LOGICAL</span>, <span class="keywordtype">DIMENSION(:)</span>, <span class="keywordtype">ALLOCATABLE</span> :: GLCOMPUTE1D</div>
<div class="line"><a id="l00329" name="l00329"></a><span class="lineno">  329</span><span class="keywordtype">REAL</span>                               :: ZTSTEP</div>
<div class="line"><a id="l00330" name="l00330"></a><span class="lineno">  330</span><span class="keywordtype">INTEGER</span>                            :: INB_ITER_MAX</div>
<div class="line"><a id="l00331" name="l00331"></a><span class="lineno">  331</span><span class="comment">!</span></div>
<div class="line"><a id="l00332" name="l00332"></a><span class="lineno">  332</span><span class="comment">!For subgrid clouds</span></div>
<div class="line"><a id="l00333" name="l00333"></a><span class="lineno">  333</span><span class="keywordtype">REAL</span>, <span class="keywordtype">DIMENSION(:)</span>, <span class="keywordtype">ALLOCATABLE</span>                      :: ZCF1D, ZIF1D, ZPF1D     <span class="comment">! 1D packed cloud, ice and precip. frac.</span></div>
<div class="line"><a id="l00334" name="l00334"></a><span class="lineno">  334</span> </div>
<div class="line"><a id="l00335" name="l00335"></a><span class="lineno">  335</span><span class="comment">!</span></div>
<div class="line"><a id="l00336" name="l00336"></a><span class="lineno">  336</span><span class="comment">! Various parameters</span></div>
<div class="line"><a id="l00337" name="l00337"></a><span class="lineno">  337</span><span class="comment">! domain size and levels (AROME compatibility)</span></div>
<div class="line"><a id="l00338" name="l00338"></a><span class="lineno">  338</span><span class="comment">! loops and packing</span></div>
<div class="line"><a id="l00339" name="l00339"></a><span class="lineno">  339</span><span class="keywordtype">INTEGER</span> :: II, IPACK, IN</div>
<div class="line"><a id="l00340" name="l00340"></a><span class="lineno">  340</span><span class="keywordtype">INTEGER</span> :: IDX</div>
<div class="line"><a id="l00341" name="l00341"></a><span class="lineno">  341</span><span class="keywordtype">INTEGER</span>, <span class="keywordtype">DIMENSION(:)</span>, <span class="keywordtype">ALLOCATABLE</span> :: I1, I2, I3</div>
<div class="line"><a id="l00342" name="l00342"></a><span class="lineno">  342</span><span class="comment">! Inverse ov PTSTEP</span></div>
<div class="line"><a id="l00343" name="l00343"></a><span class="lineno">  343</span><span class="keywordtype">REAL</span> :: ZINV_TSTEP</div>
<div class="line"><a id="l00344" name="l00344"></a><span class="lineno">  344</span><span class="comment">! Work arrays</span></div>
<div class="line"><a id="l00345" name="l00345"></a><span class="lineno">  345</span><span class="keywordtype">REAL</span>, <span class="keywordtype">DIMENSION(D%NIJT)</span>       :: ZW2D</div>
<div class="line"><a id="l00346" name="l00346"></a><span class="lineno">  346</span><span class="keywordtype">REAL</span>, <span class="keywordtype">DIMENSION(D%NIJT,D%NKT)</span> :: ZRT_SUM <span class="comment">! Total condensed water mr</span></div>
<div class="line"><a id="l00347" name="l00347"></a><span class="lineno">  347</span><span class="keywordtype">REAL</span>, <span class="keywordtype">DIMENSION(D%NIJT,D%NKT)</span> :: ZCPT    <span class="comment">! Total condensed water mr</span></div>
<div class="line"><a id="l00348" name="l00348"></a><span class="lineno">  348</span><span class="keywordtype">LOGICAL</span>, <span class="keywordtype">DIMENSION(D%NIJT)</span>          :: GDEP</div>
<div class="line"><a id="l00349" name="l00349"></a><span class="lineno">  349</span><span class="keywordtype">REAL</span>, <span class="keywordtype">DIMENSION(:,:)</span>, <span class="keywordtype">ALLOCATABLE</span> :: ZRHODJONTSTEP</div>
<div class="line"><a id="l00350" name="l00350"></a><span class="lineno">  350</span><span class="comment">!</span></div>
<div class="line"><a id="l00351" name="l00351"></a><span class="lineno">  351</span><span class="keywordtype">INTEGER</span> :: ISV_LIMA_NC</div>
<div class="line"><a id="l00352" name="l00352"></a><span class="lineno">  352</span><span class="keywordtype">INTEGER</span> :: ISV_LIMA_NR</div>
<div class="line"><a id="l00353" name="l00353"></a><span class="lineno">  353</span><span class="keywordtype">INTEGER</span> :: ISV_LIMA_CCN_FREE</div>
<div class="line"><a id="l00354" name="l00354"></a><span class="lineno">  354</span><span class="keywordtype">INTEGER</span> :: ISV_LIMA_CCN_ACTI</div>
<div class="line"><a id="l00355" name="l00355"></a><span class="lineno">  355</span><span class="keywordtype">INTEGER</span> :: ISV_LIMA_NI</div>
<div class="line"><a id="l00356" name="l00356"></a><span class="lineno">  356</span><span class="keywordtype">INTEGER</span> :: ISV_LIMA_NS</div>
<div class="line"><a id="l00357" name="l00357"></a><span class="lineno">  357</span><span class="keywordtype">INTEGER</span> :: ISV_LIMA_NG</div>
<div class="line"><a id="l00358" name="l00358"></a><span class="lineno">  358</span><span class="keywordtype">INTEGER</span> :: ISV_LIMA_NH</div>
<div class="line"><a id="l00359" name="l00359"></a><span class="lineno">  359</span><span class="keywordtype">INTEGER</span> :: ISV_LIMA_IFN_FREE</div>
<div class="line"><a id="l00360" name="l00360"></a><span class="lineno">  360</span><span class="keywordtype">INTEGER</span> :: ISV_LIMA_IFN_NUCL</div>
<div class="line"><a id="l00361" name="l00361"></a><span class="lineno">  361</span><span class="keywordtype">INTEGER</span> :: ISV_LIMA_IMM_NUCL</div>
<div class="line"><a id="l00362" name="l00362"></a><span class="lineno">  362</span><span class="keywordtype">INTEGER</span> :: ISV_LIMA_HOM_HAZE</div>
<div class="line"><a id="l00363" name="l00363"></a><span class="lineno">  363</span><span class="keywordtype">INTEGER</span> :: ISH <span class="comment">!++cb--</span></div>
<div class="line"><a id="l00364" name="l00364"></a><span class="lineno">  364</span><span class="comment">!</span></div>
<div class="line"><a id="l00365" name="l00365"></a><span class="lineno">  365</span><span class="keywordtype">REAL</span>(KIND=jphook) :: zhook_handle</div>
<div class="line"><a id="l00366" name="l00366"></a><span class="lineno">  366</span><span class="comment">!</span></div>
<div class="line"><a id="l00367" name="l00367"></a><span class="lineno">  367</span><span class="comment">! Variables for the electrification scheme</span></div>
<div class="line"><a id="l00368" name="l00368"></a><span class="lineno">  368</span><span class="keywordtype">LOGICAL</span>, <span class="keywordtype">DIMENSION(:,:)</span>, <span class="keywordtype">ALLOCATABLE</span> :: GMASK_ELEC</div>
<div class="line"><a id="l00369" name="l00369"></a><span class="lineno">  369</span><span class="keywordtype">INTEGER</span> :: IL    <span class="comment">! loop index</span></div>
<div class="line"><a id="l00370" name="l00370"></a><span class="lineno">  370</span><span class="keywordtype">INTEGER</span> :: IELEC <span class="comment">! nb of points where the electrification scheme may apply</span></div>
<div class="line"><a id="l00371" name="l00371"></a><span class="lineno">  371</span><span class="keywordtype">REAL</span>, <span class="keywordtype">DIMENSION(:,:)</span>, <span class="keywordtype">ALLOCATABLE</span> :: ZQPIT, ZQNIT, ZQCT, ZQRT, ZQIT, ZQST, ZQGT, ZQHT</div>
<div class="line"><a id="l00372" name="l00372"></a><span class="lineno">  372</span><span class="keywordtype">REAL</span>, <span class="keywordtype">DIMENSION(:,:)</span>, <span class="keywordtype">ALLOCATABLE</span> :: ZQPIS, ZQNIS, ZQCS, ZQRS, ZQIS, ZQSS, ZQGS, ZQHS</div>
<div class="line"><a id="l00373" name="l00373"></a><span class="lineno">  373</span><span class="keywordtype">REAL</span>, <span class="keywordtype">DIMENSION(:,:)</span>, <span class="keywordtype">ALLOCATABLE</span> :: ZRVT_ELEC, ZRCT_ELEC, ZRRT_ELEC, ZRIT_ELEC, ZRST_ELEC, ZRGT_ELEC, ZRHT_ELEC</div>
<div class="line"><a id="l00374" name="l00374"></a><span class="lineno">  374</span><span class="keywordtype">REAL</span>, <span class="keywordtype">DIMENSION(:,:)</span>, <span class="keywordtype">ALLOCATABLE</span> :: ZCCT_ELEC, ZCRT_ELEC, ZCIT_ELEC, ZCST_ELEC, ZCGT_ELEC, ZCHT_ELEC</div>
<div class="line"><a id="l00375" name="l00375"></a><span class="lineno">  375</span><span class="keywordtype">REAL</span>, <span class="keywordtype">DIMENSION(:)</span>,     <span class="keywordtype">ALLOCATABLE</span> :: ZLATHAM_IAGGS</div>
<div class="line"><a id="l00376" name="l00376"></a><span class="lineno">  376</span><span class="comment">!</span></div>
<div class="line"><a id="l00377" name="l00377"></a><span class="lineno">  377</span><span class="comment">!-------------------------------------------------------------------------------</span></div>
<div class="line"><a id="l00378" name="l00378"></a><span class="lineno">  378</span><span class="comment">!</span></div>
<div class="line"><a id="l00379" name="l00379"></a><span class="lineno">  379</span><span class="comment">!*       0.     Init</span></div>
<div class="line"><a id="l00380" name="l00380"></a><span class="lineno">  380</span><span class="comment">!               ----</span></div>
<div class="line"><a id="l00381" name="l00381"></a><span class="lineno">  381</span><span class="comment">!</span></div>
<div class="line"><a id="l00382" name="l00382"></a><span class="lineno">  382</span><span class="keywordflow">IF</span> (lhook) <span class="keyword">CALL </span>dr_hook(<span class="stringliteral">&#39;LIMA&#39;</span>, 0, zhook_handle)</div>
<div class="line"><a id="l00383" name="l00383"></a><span class="lineno">  383</span><span class="comment">!</span></div>
<div class="line"><a id="l00384" name="l00384"></a><span class="lineno">  384</span>isv_lima_nc       = tnsv%NSV_LIMA_NC       - tnsv%NSV_LIMA_BEG + 1</div>
<div class="line"><a id="l00385" name="l00385"></a><span class="lineno">  385</span>isv_lima_nr       = tnsv%NSV_LIMA_NR       - tnsv%NSV_LIMA_BEG + 1</div>
<div class="line"><a id="l00386" name="l00386"></a><span class="lineno">  386</span>isv_lima_ccn_free = tnsv%NSV_LIMA_CCN_FREE - tnsv%NSV_LIMA_BEG + 1</div>
<div class="line"><a id="l00387" name="l00387"></a><span class="lineno">  387</span>isv_lima_ccn_acti = tnsv%NSV_LIMA_CCN_ACTI - tnsv%NSV_LIMA_BEG + 1</div>
<div class="line"><a id="l00388" name="l00388"></a><span class="lineno">  388</span>isv_lima_ni       = tnsv%NSV_LIMA_NI       - tnsv%NSV_LIMA_BEG + 1</div>
<div class="line"><a id="l00389" name="l00389"></a><span class="lineno">  389</span>isv_lima_ns       = tnsv%NSV_LIMA_NS       - tnsv%NSV_LIMA_BEG + 1</div>
<div class="line"><a id="l00390" name="l00390"></a><span class="lineno">  390</span>isv_lima_ng       = tnsv%NSV_LIMA_NG       - tnsv%NSV_LIMA_BEG + 1</div>
<div class="line"><a id="l00391" name="l00391"></a><span class="lineno">  391</span>isv_lima_nh       = tnsv%NSV_LIMA_NH       - tnsv%NSV_LIMA_BEG + 1</div>
<div class="line"><a id="l00392" name="l00392"></a><span class="lineno">  392</span>isv_lima_ifn_free = tnsv%NSV_LIMA_IFN_FREE - tnsv%NSV_LIMA_BEG + 1</div>
<div class="line"><a id="l00393" name="l00393"></a><span class="lineno">  393</span>isv_lima_ifn_nucl = tnsv%NSV_LIMA_IFN_NUCL - tnsv%NSV_LIMA_BEG + 1</div>
<div class="line"><a id="l00394" name="l00394"></a><span class="lineno">  394</span>isv_lima_imm_nucl = tnsv%NSV_LIMA_IMM_NUCL - tnsv%NSV_LIMA_BEG + 1</div>
<div class="line"><a id="l00395" name="l00395"></a><span class="lineno">  395</span>isv_lima_hom_haze = tnsv%NSV_LIMA_HOM_HAZE - tnsv%NSV_LIMA_BEG + 1</div>
<div class="line"><a id="l00396" name="l00396"></a><span class="lineno">  396</span><span class="comment">!</span></div>
<div class="line"><a id="l00397" name="l00397"></a><span class="lineno">  397</span>zths(:,:) = pths(:,:)</div>
<div class="line"><a id="l00398" name="l00398"></a><span class="lineno">  398</span>ztht(:,:) = pths(:,:) * ptstep</div>
<div class="line"><a id="l00399" name="l00399"></a><span class="lineno">  399</span>zrvt(:,:) = 0.</div>
<div class="line"><a id="l00400" name="l00400"></a><span class="lineno">  400</span>zrvs(:,:) = 0.</div>
<div class="line"><a id="l00401" name="l00401"></a><span class="lineno">  401</span>zrct(:,:) = 0.</div>
<div class="line"><a id="l00402" name="l00402"></a><span class="lineno">  402</span>zrcs(:,:) = 0.</div>
<div class="line"><a id="l00403" name="l00403"></a><span class="lineno">  403</span>zrrt(:,:) = 0.</div>
<div class="line"><a id="l00404" name="l00404"></a><span class="lineno">  404</span>zrrs(:,:) = 0.</div>
<div class="line"><a id="l00405" name="l00405"></a><span class="lineno">  405</span>zrit(:,:) = 0.</div>
<div class="line"><a id="l00406" name="l00406"></a><span class="lineno">  406</span>zris(:,:) = 0.</div>
<div class="line"><a id="l00407" name="l00407"></a><span class="lineno">  407</span>zrst(:,:) = 0.</div>
<div class="line"><a id="l00408" name="l00408"></a><span class="lineno">  408</span>zrss(:,:) = 0.</div>
<div class="line"><a id="l00409" name="l00409"></a><span class="lineno">  409</span>zrgt(:,:) = 0.</div>
<div class="line"><a id="l00410" name="l00410"></a><span class="lineno">  410</span>zrgs(:,:) = 0.</div>
<div class="line"><a id="l00411" name="l00411"></a><span class="lineno">  411</span>zrht(:,:) = 0.</div>
<div class="line"><a id="l00412" name="l00412"></a><span class="lineno">  412</span>zrhs(:,:) = 0.</div>
<div class="line"><a id="l00413" name="l00413"></a><span class="lineno">  413</span>zrt_sum(:,:) = 0.</div>
<div class="line"><a id="l00414" name="l00414"></a><span class="lineno">  414</span>zcct(:,:)   = 0.</div>
<div class="line"><a id="l00415" name="l00415"></a><span class="lineno">  415</span>zccs(:,:)   = 0.</div>
<div class="line"><a id="l00416" name="l00416"></a><span class="lineno">  416</span>zcrt(:,:)   = 0.</div>
<div class="line"><a id="l00417" name="l00417"></a><span class="lineno">  417</span>zcrs(:,:)   = 0.</div>
<div class="line"><a id="l00418" name="l00418"></a><span class="lineno">  418</span>zcit(:,:)   = 0.</div>
<div class="line"><a id="l00419" name="l00419"></a><span class="lineno">  419</span>zcis(:,:)   = 0.</div>
<div class="line"><a id="l00420" name="l00420"></a><span class="lineno">  420</span>zcst(:,:)   = 0.</div>
<div class="line"><a id="l00421" name="l00421"></a><span class="lineno">  421</span>zcss(:,:)   = 0.</div>
<div class="line"><a id="l00422" name="l00422"></a><span class="lineno">  422</span>zcgt(:,:)   = 0.</div>
<div class="line"><a id="l00423" name="l00423"></a><span class="lineno">  423</span>zcgs(:,:)   = 0.</div>
<div class="line"><a id="l00424" name="l00424"></a><span class="lineno">  424</span>zcht(:,:)   = 0.</div>
<div class="line"><a id="l00425" name="l00425"></a><span class="lineno">  425</span>zchs(:,:)   = 0.</div>
<div class="line"><a id="l00426" name="l00426"></a><span class="lineno">  426</span>zccnft(:,:,:) = 0.</div>
<div class="line"><a id="l00427" name="l00427"></a><span class="lineno">  427</span>zccnat(:,:,:) = 0.</div>
<div class="line"><a id="l00428" name="l00428"></a><span class="lineno">  428</span>zccnfs(:,:,:) = 0.</div>
<div class="line"><a id="l00429" name="l00429"></a><span class="lineno">  429</span>zccnas(:,:,:) = 0.</div>
<div class="line"><a id="l00430" name="l00430"></a><span class="lineno">  430</span>zifnft(:,:,:) = 0.</div>
<div class="line"><a id="l00431" name="l00431"></a><span class="lineno">  431</span>zifnnt(:,:,:) = 0.</div>
<div class="line"><a id="l00432" name="l00432"></a><span class="lineno">  432</span>zifnfs(:,:,:) = 0.</div>
<div class="line"><a id="l00433" name="l00433"></a><span class="lineno">  433</span>zifnns(:,:,:) = 0.</div>
<div class="line"><a id="l00434" name="l00434"></a><span class="lineno">  434</span>zimmnt(:,:,:) = 0.</div>
<div class="line"><a id="l00435" name="l00435"></a><span class="lineno">  435</span>zimmns(:,:,:) = 0.</div>
<div class="line"><a id="l00436" name="l00436"></a><span class="lineno">  436</span>zhomft(:,:)   = 0.</div>
<div class="line"><a id="l00437" name="l00437"></a><span class="lineno">  437</span>zhomfs(:,:)   = 0.</div>
<div class="line"><a id="l00438" name="l00438"></a><span class="lineno">  438</span> </div>
<div class="line"><a id="l00439" name="l00439"></a><span class="lineno">  439</span><span class="comment">!++cb++</span></div>
<div class="line"><a id="l00440" name="l00440"></a><span class="lineno">  440</span><span class="keywordflow">IF</span> ( buconf%LBU_ENABLE .OR. oelec) <span class="keywordflow">then</span></div>
<div class="line"><a id="l00441" name="l00441"></a><span class="lineno">  441</span><span class="comment">!--cb--</span></div>
<div class="line"><a id="l00442" name="l00442"></a><span class="lineno">  442</span>  z_rr_cvrc(:,:) = 0.</div>
<div class="line"><a id="l00443" name="l00443"></a><span class="lineno">  443</span>  z_cr_cvrc(:,:) = 0.</div>
<div class="line"><a id="l00444" name="l00444"></a><span class="lineno">  444</span>  <span class="keyword">ALLOCATE</span>( ztot_cr_brku(d%NIJT, d%NKT ) ); ztot_cr_brku(:,:) = 0.</div>
<div class="line"><a id="l00445" name="l00445"></a><span class="lineno">  445</span>  <span class="keyword">ALLOCATE</span>( ztot_th_honr(d%NIJT, d%NKT ) ); ztot_th_honr(:,:) = 0.</div>
<div class="line"><a id="l00446" name="l00446"></a><span class="lineno">  446</span>  <span class="keyword">ALLOCATE</span>( ztot_rr_honr(d%NIJT, d%NKT ) ); ztot_rr_honr(:,:) = 0.</div>
<div class="line"><a id="l00447" name="l00447"></a><span class="lineno">  447</span>  <span class="keyword">ALLOCATE</span>( ztot_cr_honr(d%NIJT, d%NKT ) ); ztot_cr_honr(:,:) = 0.</div>
<div class="line"><a id="l00448" name="l00448"></a><span class="lineno">  448</span>  <span class="keyword">ALLOCATE</span>( ztot_th_imlt(d%NIJT, d%NKT ) ); ztot_th_imlt(:,:) = 0.</div>
<div class="line"><a id="l00449" name="l00449"></a><span class="lineno">  449</span>  <span class="keyword">ALLOCATE</span>( ztot_rc_imlt(d%NIJT, d%NKT ) ); ztot_rc_imlt(:,:) = 0.</div>
<div class="line"><a id="l00450" name="l00450"></a><span class="lineno">  450</span>  <span class="keyword">ALLOCATE</span>( ztot_cc_imlt(d%NIJT, d%NKT ) ); ztot_cc_imlt(:,:) = 0.</div>
<div class="line"><a id="l00451" name="l00451"></a><span class="lineno">  451</span>  <span class="keyword">ALLOCATE</span>( ztot_ifnn_imlt(d%NIJT, d%NKT, limap%NMOD_IFN ) ); ztot_ifnn_imlt(:,:,:) = 0.</div>
<div class="line"><a id="l00452" name="l00452"></a><span class="lineno">  452</span>  <span class="keyword">ALLOCATE</span>( ztot_th_honc(d%NIJT, d%NKT ) ); ztot_th_honc(:,:) = 0.</div>
<div class="line"><a id="l00453" name="l00453"></a><span class="lineno">  453</span>  <span class="keyword">ALLOCATE</span>( ztot_rc_honc(d%NIJT, d%NKT ) ); ztot_rc_honc(:,:) = 0.</div>
<div class="line"><a id="l00454" name="l00454"></a><span class="lineno">  454</span>  <span class="keyword">ALLOCATE</span>( ztot_cc_honc(d%NIJT, d%NKT ) ); ztot_cc_honc(:,:) = 0.</div>
<div class="line"><a id="l00455" name="l00455"></a><span class="lineno">  455</span>  <span class="keyword">ALLOCATE</span>( ztot_cc_self(d%NIJT, d%NKT ) ); ztot_cc_self(:,:) = 0.</div>
<div class="line"><a id="l00456" name="l00456"></a><span class="lineno">  456</span>  <span class="keyword">ALLOCATE</span>( ztot_rc_auto(d%NIJT, d%NKT ) ); ztot_rc_auto(:,:) = 0.</div>
<div class="line"><a id="l00457" name="l00457"></a><span class="lineno">  457</span>  <span class="keyword">ALLOCATE</span>( ztot_cc_auto(d%NIJT, d%NKT ) ); ztot_cc_auto(:,:) = 0.</div>
<div class="line"><a id="l00458" name="l00458"></a><span class="lineno">  458</span>  <span class="keyword">ALLOCATE</span>( ztot_cr_auto(d%NIJT, d%NKT ) ); ztot_cr_auto(:,:) = 0.</div>
<div class="line"><a id="l00459" name="l00459"></a><span class="lineno">  459</span>  <span class="keyword">ALLOCATE</span>( ztot_rc_accr(d%NIJT, d%NKT ) ); ztot_rc_accr(:,:) = 0.</div>
<div class="line"><a id="l00460" name="l00460"></a><span class="lineno">  460</span>  <span class="keyword">ALLOCATE</span>( ztot_cc_accr(d%NIJT, d%NKT ) ); ztot_cc_accr(:,:) = 0.</div>
<div class="line"><a id="l00461" name="l00461"></a><span class="lineno">  461</span>  <span class="keyword">ALLOCATE</span>( ztot_cr_scbu(d%NIJT, d%NKT ) ); ztot_cr_scbu(:,:) = 0.</div>
<div class="line"><a id="l00462" name="l00462"></a><span class="lineno">  462</span>  <span class="keyword">ALLOCATE</span>( ztot_th_evap(d%NIJT, d%NKT ) ); ztot_th_evap(:,:) = 0.</div>
<div class="line"><a id="l00463" name="l00463"></a><span class="lineno">  463</span><span class="comment">!   allocate( ZTOT_RC_EVAP (D%NIJT, D%NKT ) ); ZTOT_RC_EVAP(:,:) = 0.</span></div>
<div class="line"><a id="l00464" name="l00464"></a><span class="lineno">  464</span><span class="comment">!   allocate( ZTOT_CC_EVAP (D%NIJT, D%NKT ) ); ZTOT_CC_EVAP(:,:) = 0.</span></div>
<div class="line"><a id="l00465" name="l00465"></a><span class="lineno">  465</span>  <span class="keyword">ALLOCATE</span>( ztot_rr_evap(d%NIJT, d%NKT ) ); ztot_rr_evap(:,:) = 0.</div>
<div class="line"><a id="l00466" name="l00466"></a><span class="lineno">  466</span>  <span class="keyword">ALLOCATE</span>( ztot_cr_evap(d%NIJT, d%NKT ) ); ztot_cr_evap(:,:) = 0.</div>
<div class="line"><a id="l00467" name="l00467"></a><span class="lineno">  467</span>  <span class="keyword">ALLOCATE</span>( ztot_ri_cnvi(d%NIJT, d%NKT ) ); ztot_ri_cnvi(:,:) = 0.</div>
<div class="line"><a id="l00468" name="l00468"></a><span class="lineno">  468</span>  <span class="keyword">ALLOCATE</span>( ztot_ci_cnvi(d%NIJT, d%NKT ) ); ztot_ci_cnvi(:,:) = 0.</div>
<div class="line"><a id="l00469" name="l00469"></a><span class="lineno">  469</span>  <span class="keyword">ALLOCATE</span>( ztot_th_deps(d%NIJT, d%NKT ) ); ztot_th_deps(:,:) = 0.</div>
<div class="line"><a id="l00470" name="l00470"></a><span class="lineno">  470</span>  <span class="keyword">ALLOCATE</span>( ztot_rs_deps(d%NIJT, d%NKT ) ); ztot_rs_deps(:,:) = 0.</div>
<div class="line"><a id="l00471" name="l00471"></a><span class="lineno">  471</span>  <span class="keyword">ALLOCATE</span>( ztot_th_depi(d%NIJT, d%NKT ) ); ztot_th_depi(:,:) = 0.</div>
<div class="line"><a id="l00472" name="l00472"></a><span class="lineno">  472</span>  <span class="keyword">ALLOCATE</span>( ztot_ri_depi(d%NIJT, d%NKT ) ); ztot_ri_depi(:,:) = 0.</div>
<div class="line"><a id="l00473" name="l00473"></a><span class="lineno">  473</span>  <span class="keyword">ALLOCATE</span>( ztot_ri_cnvs(d%NIJT, d%NKT ) ); ztot_ri_cnvs(:,:) = 0.</div>
<div class="line"><a id="l00474" name="l00474"></a><span class="lineno">  474</span>  <span class="keyword">ALLOCATE</span>( ztot_ci_cnvs(d%NIJT, d%NKT ) ); ztot_ci_cnvs(:,:) = 0.</div>
<div class="line"><a id="l00475" name="l00475"></a><span class="lineno">  475</span>  <span class="keyword">ALLOCATE</span>( ztot_ci_isc(d%NIJT, d%NKT ) ); ztot_ci_isc(:,:)  = 0.</div>
<div class="line"><a id="l00476" name="l00476"></a><span class="lineno">  476</span>  <span class="keyword">ALLOCATE</span>( ztot_cs_ssc(d%NIJT, d%NKT ) ); ztot_cs_ssc(:,:) = 0.</div>
<div class="line"><a id="l00477" name="l00477"></a><span class="lineno">  477</span>  <span class="keyword">ALLOCATE</span>( ztot_ri_aggs(d%NIJT, d%NKT ) ); ztot_ri_aggs(:,:) = 0.</div>
<div class="line"><a id="l00478" name="l00478"></a><span class="lineno">  478</span>  <span class="keyword">ALLOCATE</span>( ztot_ci_aggs(d%NIJT, d%NKT ) ); ztot_ci_aggs(:,:) = 0.</div>
<div class="line"><a id="l00479" name="l00479"></a><span class="lineno">  479</span>  <span class="keyword">ALLOCATE</span>( ztot_th_depg(d%NIJT, d%NKT ) ); ztot_th_depg(:,:) = 0.</div>
<div class="line"><a id="l00480" name="l00480"></a><span class="lineno">  480</span>  <span class="keyword">ALLOCATE</span>( ztot_rg_depg(d%NIJT, d%NKT ) ); ztot_rg_depg(:,:) = 0.</div>
<div class="line"><a id="l00481" name="l00481"></a><span class="lineno">  481</span>  <span class="keyword">ALLOCATE</span>( ztot_th_berfi(d%NIJT, d%NKT ) ); ztot_th_berfi(:,:) = 0.</div>
<div class="line"><a id="l00482" name="l00482"></a><span class="lineno">  482</span>  <span class="keyword">ALLOCATE</span>( ztot_rc_berfi(d%NIJT, d%NKT ) ); ztot_rc_berfi(:,:) = 0.</div>
<div class="line"><a id="l00483" name="l00483"></a><span class="lineno">  483</span><span class="comment">!++cb++ need rcrimss, rcrimsg and rsrimcg to be consistent with ice3</span></div>
<div class="line"><a id="l00484" name="l00484"></a><span class="lineno">  484</span>  <span class="keyword">ALLOCATE</span>( ztot_th_rim(d%NIJT, d%NKT ) ); ztot_th_rim(:,:) = 0.</div>
<div class="line"><a id="l00485" name="l00485"></a><span class="lineno">  485</span><span class="comment">!  allocate( ZTOT_RC_RIM  (D%NIJT, D%NKT ) ); ZTOT_RC_RIM(:,:) = 0.</span></div>
<div class="line"><a id="l00486" name="l00486"></a><span class="lineno">  486</span>  <span class="keyword">ALLOCATE</span>( ztot_cc_rim(d%NIJT, d%NKT ) ); ztot_cc_rim(:,:) = 0.</div>
<div class="line"><a id="l00487" name="l00487"></a><span class="lineno">  487</span><span class="comment">!  allocate( ZTOT_RS_RIM  (D%NIJT, D%NKT ) ); ZTOT_RS_RIM(:,:) = 0.</span></div>
<div class="line"><a id="l00488" name="l00488"></a><span class="lineno">  488</span>  <span class="keyword">ALLOCATE</span>( ztot_cs_rim(d%NIJT, d%NKT ) ); ztot_cs_rim(:,:) = 0.</div>
<div class="line"><a id="l00489" name="l00489"></a><span class="lineno">  489</span><span class="comment">!  allocate( ZTOT_RG_RIM  (D%NIJT, D%NKT ) ); ZTOT_RG_RIM(:,:) = 0.</span></div>
<div class="line"><a id="l00490" name="l00490"></a><span class="lineno">  490</span>  <span class="keyword">ALLOCATE</span>( ztot_rc_rimss(d%NIJT, d%NKT ) ); ztot_rc_rimss(:,:) = 0.</div>
<div class="line"><a id="l00491" name="l00491"></a><span class="lineno">  491</span>  <span class="keyword">ALLOCATE</span>( ztot_rc_rimsg(d%NIJT, d%NKT ) ); ztot_rc_rimsg(:,:) = 0.</div>
<div class="line"><a id="l00492" name="l00492"></a><span class="lineno">  492</span>  <span class="keyword">ALLOCATE</span>( ztot_rs_rimcg(d%NIJT, d%NKT ) ); ztot_rs_rimcg(:,:) = 0.</div>
<div class="line"><a id="l00493" name="l00493"></a><span class="lineno">  493</span><span class="comment">!--cb--</span></div>
<div class="line"><a id="l00494" name="l00494"></a><span class="lineno">  494</span>  <span class="keyword">ALLOCATE</span>( ztot_ri_hms(d%NIJT, d%NKT ) ); ztot_ri_hms(:,:) = 0.</div>
<div class="line"><a id="l00495" name="l00495"></a><span class="lineno">  495</span>  <span class="keyword">ALLOCATE</span>( ztot_ci_hms(d%NIJT, d%NKT ) ); ztot_ci_hms(:,:) = 0.</div>
<div class="line"><a id="l00496" name="l00496"></a><span class="lineno">  496</span>  <span class="keyword">ALLOCATE</span>( ztot_rs_hms(d%NIJT, d%NKT ) ); ztot_rs_hms(:,:) = 0.</div>
<div class="line"><a id="l00497" name="l00497"></a><span class="lineno">  497</span><span class="comment">!++cb++ need rraccss, rraccsg and rsaccrg to be consistent with ice3</span></div>
<div class="line"><a id="l00498" name="l00498"></a><span class="lineno">  498</span>  <span class="keyword">ALLOCATE</span>( ztot_th_acc(d%NIJT, d%NKT ) ); ztot_th_acc(:,:) = 0.</div>
<div class="line"><a id="l00499" name="l00499"></a><span class="lineno">  499</span><span class="comment">!  allocate( ZTOT_RR_ACC  (D%NIJT, D%NKT ) ); ZTOT_RR_ACC(:,:) = 0.</span></div>
<div class="line"><a id="l00500" name="l00500"></a><span class="lineno">  500</span>  <span class="keyword">ALLOCATE</span>( ztot_cr_acc(d%NIJT, d%NKT ) ); ztot_cr_acc(:,:) = 0.</div>
<div class="line"><a id="l00501" name="l00501"></a><span class="lineno">  501</span><span class="comment">!  allocate( ZTOT_RS_ACC  (D%NIJT, D%NKT ) ); ZTOT_RS_ACC(:,:) = 0.</span></div>
<div class="line"><a id="l00502" name="l00502"></a><span class="lineno">  502</span>  <span class="keyword">ALLOCATE</span>( ztot_cs_acc(d%NIJT, d%NKT ) ); ztot_cs_acc(:,:) = 0.</div>
<div class="line"><a id="l00503" name="l00503"></a><span class="lineno">  503</span><span class="comment">!  allocate( ZTOT_RG_ACC  (D%NIJT, D%NKT ) ); ZTOT_RG_ACC(:,:) = 0.</span></div>
<div class="line"><a id="l00504" name="l00504"></a><span class="lineno">  504</span>  <span class="keyword">ALLOCATE</span>( ztot_rr_accss(d%NIJT, d%NKT ) ); ztot_rr_accss(:,:) = 0.</div>
<div class="line"><a id="l00505" name="l00505"></a><span class="lineno">  505</span>  <span class="keyword">ALLOCATE</span>( ztot_rr_accsg(d%NIJT, d%NKT ) ); ztot_rr_accsg(:,:) = 0.</div>
<div class="line"><a id="l00506" name="l00506"></a><span class="lineno">  506</span>  <span class="keyword">ALLOCATE</span>( ztot_rs_accrg(d%NIJT, d%NKT ) ); ztot_rs_accrg(:,:) = 0.</div>
<div class="line"><a id="l00507" name="l00507"></a><span class="lineno">  507</span><span class="comment">!--cb--</span></div>
<div class="line"><a id="l00508" name="l00508"></a><span class="lineno">  508</span>  <span class="keyword">ALLOCATE</span>( ztot_rs_cmel(d%NIJT, d%NKT ) ); ztot_rs_cmel(:,:) = 0.</div>
<div class="line"><a id="l00509" name="l00509"></a><span class="lineno">  509</span>  <span class="keyword">ALLOCATE</span>( ztot_cs_cmel(d%NIJT, d%NKT ) ); ztot_cs_cmel(:,:) = 0.</div>
<div class="line"><a id="l00510" name="l00510"></a><span class="lineno">  510</span>  <span class="keyword">ALLOCATE</span>( ztot_th_cfrz(d%NIJT, d%NKT ) ); ztot_th_cfrz(:,:) = 0.</div>
<div class="line"><a id="l00511" name="l00511"></a><span class="lineno">  511</span>  <span class="keyword">ALLOCATE</span>( ztot_rr_cfrz(d%NIJT, d%NKT ) ); ztot_rr_cfrz(:,:) = 0.</div>
<div class="line"><a id="l00512" name="l00512"></a><span class="lineno">  512</span>  <span class="keyword">ALLOCATE</span>( ztot_cr_cfrz(d%NIJT, d%NKT ) ); ztot_cr_cfrz(:,:) = 0.</div>
<div class="line"><a id="l00513" name="l00513"></a><span class="lineno">  513</span>  <span class="keyword">ALLOCATE</span>( ztot_ri_cfrz(d%NIJT, d%NKT ) ); ztot_ri_cfrz(:,:) = 0.</div>
<div class="line"><a id="l00514" name="l00514"></a><span class="lineno">  514</span>  <span class="keyword">ALLOCATE</span>( ztot_ci_cfrz(d%NIJT, d%NKT ) ); ztot_ci_cfrz(:,:) = 0.</div>
<div class="line"><a id="l00515" name="l00515"></a><span class="lineno">  515</span>  <span class="keyword">ALLOCATE</span>( ztot_ri_cibu(d%NIJT, d%NKT ) ); ztot_ri_cibu(:,:) = 0.</div>
<div class="line"><a id="l00516" name="l00516"></a><span class="lineno">  516</span>  <span class="keyword">ALLOCATE</span>( ztot_ci_cibu(d%NIJT, d%NKT ) ); ztot_ci_cibu(:,:) = 0.</div>
<div class="line"><a id="l00517" name="l00517"></a><span class="lineno">  517</span>  <span class="keyword">ALLOCATE</span>( ztot_ri_rdsf(d%NIJT, d%NKT ) ); ztot_ri_rdsf(:,:) = 0.</div>
<div class="line"><a id="l00518" name="l00518"></a><span class="lineno">  518</span>  <span class="keyword">ALLOCATE</span>( ztot_ci_rdsf(d%NIJT, d%NKT ) ); ztot_ci_rdsf(:,:) = 0.</div>
<div class="line"><a id="l00519" name="l00519"></a><span class="lineno">  519</span>  <span class="keyword">ALLOCATE</span>( ztot_th_wetg(d%NIJT, d%NKT ) ); ztot_th_wetg(:,:) = 0.</div>
<div class="line"><a id="l00520" name="l00520"></a><span class="lineno">  520</span>  <span class="keyword">ALLOCATE</span>( ztot_rc_wetg(d%NIJT, d%NKT ) ); ztot_rc_wetg(:,:) = 0.</div>
<div class="line"><a id="l00521" name="l00521"></a><span class="lineno">  521</span>  <span class="keyword">ALLOCATE</span>( ztot_cc_wetg(d%NIJT, d%NKT ) ); ztot_cc_wetg(:,:) = 0.</div>
<div class="line"><a id="l00522" name="l00522"></a><span class="lineno">  522</span>  <span class="keyword">ALLOCATE</span>( ztot_rr_wetg(d%NIJT, d%NKT ) ); ztot_rr_wetg(:,:) = 0.</div>
<div class="line"><a id="l00523" name="l00523"></a><span class="lineno">  523</span>  <span class="keyword">ALLOCATE</span>( ztot_cr_wetg(d%NIJT, d%NKT ) ); ztot_cr_wetg(:,:) = 0.</div>
<div class="line"><a id="l00524" name="l00524"></a><span class="lineno">  524</span>  <span class="keyword">ALLOCATE</span>( ztot_ri_wetg(d%NIJT, d%NKT ) ); ztot_ri_wetg(:,:) = 0.</div>
<div class="line"><a id="l00525" name="l00525"></a><span class="lineno">  525</span>  <span class="keyword">ALLOCATE</span>( ztot_ci_wetg(d%NIJT, d%NKT ) ); ztot_ci_wetg(:,:) = 0.</div>
<div class="line"><a id="l00526" name="l00526"></a><span class="lineno">  526</span>  <span class="keyword">ALLOCATE</span>( ztot_rs_wetg(d%NIJT, d%NKT ) ); ztot_rs_wetg(:,:) = 0.</div>
<div class="line"><a id="l00527" name="l00527"></a><span class="lineno">  527</span>  <span class="keyword">ALLOCATE</span>( ztot_cs_wetg(d%NIJT, d%NKT ) ); ztot_cs_wetg(:,:) = 0.</div>
<div class="line"><a id="l00528" name="l00528"></a><span class="lineno">  528</span>  <span class="keyword">ALLOCATE</span>( ztot_rg_wetg(d%NIJT, d%NKT ) ); ztot_rg_wetg(:,:) = 0.</div>
<div class="line"><a id="l00529" name="l00529"></a><span class="lineno">  529</span>  <span class="keyword">ALLOCATE</span>( ztot_cg_wetg(d%NIJT, d%NKT ) ); ztot_cg_wetg(:,:) = 0.</div>
<div class="line"><a id="l00530" name="l00530"></a><span class="lineno">  530</span>  <span class="keyword">ALLOCATE</span>( ztot_rh_wetg(d%NIJT, d%NKT ) ); ztot_rh_wetg(:,:) = 0.</div>
<div class="line"><a id="l00531" name="l00531"></a><span class="lineno">  531</span>  <span class="keyword">ALLOCATE</span>( ztot_th_dryg(d%NIJT, d%NKT ) ); ztot_th_dryg(:,:) = 0.</div>
<div class="line"><a id="l00532" name="l00532"></a><span class="lineno">  532</span>  <span class="keyword">ALLOCATE</span>( ztot_rc_dryg(d%NIJT, d%NKT ) ); ztot_rc_dryg(:,:) = 0.</div>
<div class="line"><a id="l00533" name="l00533"></a><span class="lineno">  533</span>  <span class="keyword">ALLOCATE</span>( ztot_cc_dryg(d%NIJT, d%NKT ) ); ztot_cc_dryg(:,:) = 0.</div>
<div class="line"><a id="l00534" name="l00534"></a><span class="lineno">  534</span>  <span class="keyword">ALLOCATE</span>( ztot_rr_dryg(d%NIJT, d%NKT ) ); ztot_rr_dryg(:,:) = 0.</div>
<div class="line"><a id="l00535" name="l00535"></a><span class="lineno">  535</span>  <span class="keyword">ALLOCATE</span>( ztot_cr_dryg(d%NIJT, d%NKT ) ); ztot_cr_dryg(:,:) = 0.</div>
<div class="line"><a id="l00536" name="l00536"></a><span class="lineno">  536</span>  <span class="keyword">ALLOCATE</span>( ztot_ri_dryg(d%NIJT, d%NKT ) ); ztot_ri_dryg(:,:) = 0.</div>
<div class="line"><a id="l00537" name="l00537"></a><span class="lineno">  537</span>  <span class="keyword">ALLOCATE</span>( ztot_ci_dryg(d%NIJT, d%NKT ) ); ztot_ci_dryg(:,:) = 0.</div>
<div class="line"><a id="l00538" name="l00538"></a><span class="lineno">  538</span>  <span class="keyword">ALLOCATE</span>( ztot_rs_dryg(d%NIJT, d%NKT ) ); ztot_rs_dryg(:,:) = 0.</div>
<div class="line"><a id="l00539" name="l00539"></a><span class="lineno">  539</span>  <span class="keyword">ALLOCATE</span>( ztot_cs_dryg(d%NIJT, d%NKT ) ); ztot_cs_dryg(:,:) = 0.</div>
<div class="line"><a id="l00540" name="l00540"></a><span class="lineno">  540</span>  <span class="keyword">ALLOCATE</span>( ztot_rg_dryg(d%NIJT, d%NKT ) ); ztot_rg_dryg(:,:) = 0.</div>
<div class="line"><a id="l00541" name="l00541"></a><span class="lineno">  541</span>  <span class="keyword">ALLOCATE</span>( ztot_ri_hmg(d%NIJT, d%NKT ) ); ztot_ri_hmg(:,:) = 0.</div>
<div class="line"><a id="l00542" name="l00542"></a><span class="lineno">  542</span>  <span class="keyword">ALLOCATE</span>( ztot_ci_hmg(d%NIJT, d%NKT ) ); ztot_ci_hmg(:,:) = 0.</div>
<div class="line"><a id="l00543" name="l00543"></a><span class="lineno">  543</span>  <span class="keyword">ALLOCATE</span>( ztot_rg_hmg(d%NIJT, d%NKT ) ); ztot_rg_hmg(:,:) = 0.</div>
<div class="line"><a id="l00544" name="l00544"></a><span class="lineno">  544</span>  <span class="keyword">ALLOCATE</span>( ztot_th_gmlt(d%NIJT, d%NKT ) ); ztot_th_gmlt(:,:) = 0.</div>
<div class="line"><a id="l00545" name="l00545"></a><span class="lineno">  545</span>  <span class="keyword">ALLOCATE</span>( ztot_rr_gmlt(d%NIJT, d%NKT ) ); ztot_rr_gmlt(:,:) = 0.</div>
<div class="line"><a id="l00546" name="l00546"></a><span class="lineno">  546</span>  <span class="keyword">ALLOCATE</span>( ztot_cr_gmlt(d%NIJT, d%NKT ) ); ztot_cr_gmlt(:,:) = 0.</div>
<div class="line"><a id="l00547" name="l00547"></a><span class="lineno">  547</span>  <span class="keyword">ALLOCATE</span>( ztot_cg_gmlt(d%NIJT, d%NKT ) ); ztot_cg_gmlt(:,:) = 0.</div>
<div class="line"><a id="l00548" name="l00548"></a><span class="lineno">  548</span>  <span class="keyword">ALLOCATE</span>( ztot_th_deph(d%NIJT, d%NKT ) ); ztot_th_deph(:,:) = 0.</div>
<div class="line"><a id="l00549" name="l00549"></a><span class="lineno">  549</span>  <span class="keyword">ALLOCATE</span>( ztot_rh_deph(d%NIJT, d%NKT ) ); ztot_rh_deph(:,:) = 0.</div>
<div class="line"><a id="l00550" name="l00550"></a><span class="lineno">  550</span>  <span class="keyword">ALLOCATE</span>( ztot_th_weth(d%NIJT, d%NKT ) ); ztot_th_weth(:,:) = 0.</div>
<div class="line"><a id="l00551" name="l00551"></a><span class="lineno">  551</span>  <span class="keyword">ALLOCATE</span>( ztot_rc_weth(d%NIJT, d%NKT ) ); ztot_rc_weth(:,:) = 0.</div>
<div class="line"><a id="l00552" name="l00552"></a><span class="lineno">  552</span>  <span class="keyword">ALLOCATE</span>( ztot_cc_weth(d%NIJT, d%NKT ) ); ztot_cc_weth(:,:) = 0.</div>
<div class="line"><a id="l00553" name="l00553"></a><span class="lineno">  553</span>  <span class="keyword">ALLOCATE</span>( ztot_rr_weth(d%NIJT, d%NKT ) ); ztot_rr_weth(:,:) = 0.</div>
<div class="line"><a id="l00554" name="l00554"></a><span class="lineno">  554</span>  <span class="keyword">ALLOCATE</span>( ztot_cr_weth(d%NIJT, d%NKT ) ); ztot_cr_weth(:,:) = 0.</div>
<div class="line"><a id="l00555" name="l00555"></a><span class="lineno">  555</span>  <span class="keyword">ALLOCATE</span>( ztot_ri_weth(d%NIJT, d%NKT ) ); ztot_ri_weth(:,:) = 0.</div>
<div class="line"><a id="l00556" name="l00556"></a><span class="lineno">  556</span>  <span class="keyword">ALLOCATE</span>( ztot_ci_weth(d%NIJT, d%NKT ) ); ztot_ci_weth(:,:) = 0.</div>
<div class="line"><a id="l00557" name="l00557"></a><span class="lineno">  557</span>  <span class="keyword">ALLOCATE</span>( ztot_rs_weth(d%NIJT, d%NKT ) ); ztot_rs_weth(:,:) = 0.</div>
<div class="line"><a id="l00558" name="l00558"></a><span class="lineno">  558</span>  <span class="keyword">ALLOCATE</span>( ztot_cs_weth(d%NIJT, d%NKT ) ); ztot_cs_weth(:,:) = 0.</div>
<div class="line"><a id="l00559" name="l00559"></a><span class="lineno">  559</span>  <span class="keyword">ALLOCATE</span>( ztot_rg_weth(d%NIJT, d%NKT ) ); ztot_rg_weth(:,:) = 0.</div>
<div class="line"><a id="l00560" name="l00560"></a><span class="lineno">  560</span>  <span class="keyword">ALLOCATE</span>( ztot_cg_weth(d%NIJT, d%NKT ) ); ztot_cg_weth(:,:) = 0.</div>
<div class="line"><a id="l00561" name="l00561"></a><span class="lineno">  561</span>  <span class="keyword">ALLOCATE</span>( ztot_rh_weth(d%NIJT, d%NKT ) ); ztot_rh_weth(:,:) = 0.</div>
<div class="line"><a id="l00562" name="l00562"></a><span class="lineno">  562</span>  <span class="keyword">ALLOCATE</span>( ztot_rg_cohg(d%NIJT, d%NKT ) ); ztot_rg_cohg(:,:) = 0.</div>
<div class="line"><a id="l00563" name="l00563"></a><span class="lineno">  563</span>  <span class="keyword">ALLOCATE</span>( ztot_cg_cohg(d%NIJT, d%NKT ) ); ztot_cg_cohg(:,:) = 0.</div>
<div class="line"><a id="l00564" name="l00564"></a><span class="lineno">  564</span>  <span class="keyword">ALLOCATE</span>( ztot_th_hmlt(d%NIJT, d%NKT ) ); ztot_th_hmlt(:,:) = 0.</div>
<div class="line"><a id="l00565" name="l00565"></a><span class="lineno">  565</span>  <span class="keyword">ALLOCATE</span>( ztot_rr_hmlt(d%NIJT, d%NKT ) ); ztot_rr_hmlt(:,:) = 0.</div>
<div class="line"><a id="l00566" name="l00566"></a><span class="lineno">  566</span>  <span class="keyword">ALLOCATE</span>( ztot_cr_hmlt(d%NIJT, d%NKT ) ); ztot_cr_hmlt(:,:) = 0.</div>
<div class="line"><a id="l00567" name="l00567"></a><span class="lineno">  567</span>  <span class="keyword">ALLOCATE</span>( ztot_ch_hmlt(d%NIJT, d%NKT ) ); ztot_ch_hmlt(:,:) = 0.</div>
<div class="line"><a id="l00568" name="l00568"></a><span class="lineno">  568</span>  <span class="keyword">ALLOCATE</span>( ztot_rr_cvrc(d%NIJT, d%NKT ) ); ztot_rr_cvrc(:,:) = 0.</div>
<div class="line"><a id="l00569" name="l00569"></a><span class="lineno">  569</span>  <span class="keyword">ALLOCATE</span>( ztot_cr_cvrc(d%NIJT, d%NKT ) ); ztot_cr_cvrc(:,:) = 0.</div>
<div class="line"><a id="l00570" name="l00570"></a><span class="lineno">  570</span> </div>
<div class="line"><a id="l00571" name="l00571"></a><span class="lineno">  571</span>  <span class="keyword">ALLOCATE</span>( ztot_rv_corr2(d%NIJT, d%NKT ) ); ztot_rv_corr2(:,:) = 0.</div>
<div class="line"><a id="l00572" name="l00572"></a><span class="lineno">  572</span>  <span class="keyword">ALLOCATE</span>( ztot_rc_corr2(d%NIJT, d%NKT ) ); ztot_rc_corr2(:,:) = 0.</div>
<div class="line"><a id="l00573" name="l00573"></a><span class="lineno">  573</span>  <span class="keyword">ALLOCATE</span>( ztot_rr_corr2(d%NIJT, d%NKT ) ); ztot_rr_corr2(:,:) = 0.</div>
<div class="line"><a id="l00574" name="l00574"></a><span class="lineno">  574</span>  <span class="keyword">ALLOCATE</span>( ztot_ri_corr2(d%NIJT, d%NKT ) ); ztot_ri_corr2(:,:) = 0.</div>
<div class="line"><a id="l00575" name="l00575"></a><span class="lineno">  575</span>  <span class="keyword">ALLOCATE</span>( ztot_cc_corr2(d%NIJT, d%NKT ) ); ztot_cc_corr2(:,:) = 0.</div>
<div class="line"><a id="l00576" name="l00576"></a><span class="lineno">  576</span>  <span class="keyword">ALLOCATE</span>( ztot_cr_corr2(d%NIJT, d%NKT ) ); ztot_cr_corr2(:,:) = 0.</div>
<div class="line"><a id="l00577" name="l00577"></a><span class="lineno">  577</span>  <span class="keyword">ALLOCATE</span>( ztot_ci_corr2(d%NIJT, d%NKT ) ); ztot_ci_corr2(:,:) = 0.</div>
<div class="line"><a id="l00578" name="l00578"></a><span class="lineno">  578</span><span class="keywordflow">END IF</span></div>
<div class="line"><a id="l00579" name="l00579"></a><span class="lineno">  579</span><span class="comment">!</span></div>
<div class="line"><a id="l00580" name="l00580"></a><span class="lineno">  580</span><span class="keywordflow">IF</span> ( buconf%LBU_ENABLE .AND. limap%LCRYSTAL_SHAPE ) <span class="keywordflow">THEN</span></div>
<div class="line"><a id="l00581" name="l00581"></a><span class="lineno">  581</span>  <span class="keyword">ALLOCATE</span>( ztot_shci_imlt(d%NIJT,d%NKT,limap%NNB_CRYSTAL_SHAPE) ) ; ztot_shci_imlt(:,:,:)  = 0.</div>
<div class="line"><a id="l00582" name="l00582"></a><span class="lineno">  582</span>  <span class="keyword">ALLOCATE</span>( ztot_shci_corr2(d%NIJT,d%NKT,limap%NNB_CRYSTAL_SHAPE) ); ztot_shci_corr2(:,:,:) = 0.</div>
<div class="line"><a id="l00583" name="l00583"></a><span class="lineno">  583</span>  <span class="keyword">ALLOCATE</span>( ztot_shci_honc(d%NIJT,d%NKT,limap%NNB_CRYSTAL_SHAPE) ) ; ztot_shci_honc(:,:,:)  = 0.</div>
<div class="line"><a id="l00584" name="l00584"></a><span class="lineno">  584</span>  <span class="keyword">ALLOCATE</span>( ztot_shci_aggs(d%NIJT,d%NKT,limap%NNB_CRYSTAL_SHAPE) ) ; ztot_shci_aggs(:,:,:)  = 0.</div>
<div class="line"><a id="l00585" name="l00585"></a><span class="lineno">  585</span>  <span class="keyword">ALLOCATE</span>( ztot_shci_cnvi(d%NIJT,d%NKT,limap%NNB_CRYSTAL_SHAPE) ) ; ztot_shci_cnvi(:,:,:)  = 0.</div>
<div class="line"><a id="l00586" name="l00586"></a><span class="lineno">  586</span>  <span class="keyword">ALLOCATE</span>( ztot_shci_hms(d%NIJT,d%NKT,limap%NNB_CRYSTAL_SHAPE) )  ; ztot_shci_hms(:,:,:)   = 0.</div>
<div class="line"><a id="l00587" name="l00587"></a><span class="lineno">  587</span>  <span class="keyword">ALLOCATE</span>( ztot_shci_cfrz(d%NIJT,d%NKT,limap%NNB_CRYSTAL_SHAPE) ) ; ztot_shci_cfrz(:,:,:)  = 0.</div>
<div class="line"><a id="l00588" name="l00588"></a><span class="lineno">  588</span>  <span class="keyword">ALLOCATE</span>( ztot_shci_cibu(d%NIJT,d%NKT,limap%NNB_CRYSTAL_SHAPE) ) ; ztot_shci_cibu(:,:,:)  = 0.</div>
<div class="line"><a id="l00589" name="l00589"></a><span class="lineno">  589</span>  <span class="keyword">ALLOCATE</span>( ztot_shci_rdsf(d%NIJT,d%NKT,limap%NNB_CRYSTAL_SHAPE) ) ; ztot_shci_rdsf(:,:,:)  = 0.</div>
<div class="line"><a id="l00590" name="l00590"></a><span class="lineno">  590</span>  <span class="keyword">ALLOCATE</span>( ztot_shci_wetg(d%NIJT,d%NKT,limap%NNB_CRYSTAL_SHAPE) ) ; ztot_shci_wetg(:,:,:)  = 0.</div>
<div class="line"><a id="l00591" name="l00591"></a><span class="lineno">  591</span>  <span class="keyword">ALLOCATE</span>( ztot_shci_dryg(d%NIJT,d%NKT,limap%NNB_CRYSTAL_SHAPE) ) ; ztot_shci_dryg(:,:,:)  = 0.</div>
<div class="line"><a id="l00592" name="l00592"></a><span class="lineno">  592</span>  <span class="keyword">ALLOCATE</span>( ztot_shci_hmg(d%NIJT,d%NKT,limap%NNB_CRYSTAL_SHAPE) )  ; ztot_shci_hmg(:,:,:)   = 0.</div>
<div class="line"><a id="l00593" name="l00593"></a><span class="lineno">  593</span>  <span class="keyword">ALLOCATE</span>( ztot_shci_cnvs(d%NIJT,d%NKT,limap%NNB_CRYSTAL_SHAPE) ) ; ztot_shci_cnvs(:,:,:)  = 0.</div>
<div class="line"><a id="l00594" name="l00594"></a><span class="lineno">  594</span>  <span class="keyword">ALLOCATE</span>( ztot_shci_hach(d%NIJT,d%NKT,limap%NNB_CRYSTAL_SHAPE) ) ; ztot_shci_hach(:,:,:)  = 0.</div>
<div class="line"><a id="l00595" name="l00595"></a><span class="lineno">  595</span>  <span class="keyword">ALLOCATE</span>( ztot_shci_isc(d%NIJT,d%NKT,limap%NNB_CRYSTAL_SHAPE) )  ; ztot_shci_isc(:,:,:)   = 0.</div>
<div class="line"><a id="l00596" name="l00596"></a><span class="lineno">  596</span>  <span class="keyword">ALLOCATE</span>( ztot_shci_iscs(d%NIJT,d%NKT,limap%NNB_CRYSTAL_SHAPE) ) ; ztot_shci_iscs(:,:,:)  = 0.</div>
<div class="line"><a id="l00597" name="l00597"></a><span class="lineno">  597</span>  <span class="keyword">ALLOCATE</span>( ztot_shri_iscs(d%NIJT,d%NKT) )                         ; ztot_shri_iscs(:,:)    = 0.</div>
<div class="line"><a id="l00598" name="l00598"></a><span class="lineno">  598</span><span class="keyword">END </span>if<span class="comment">!</span></div>
<div class="line"><a id="l00599" name="l00599"></a><span class="lineno">  599</span><span class="comment">!</span></div>
<div class="line"><a id="l00600" name="l00600"></a><span class="lineno">  600</span><span class="keyword">ALLOCATE</span> (ztot_ri_hind(d%NIJT,d%NKT)) ; ztot_ri_hind(:,:) = 0.</div>
<div class="line"><a id="l00601" name="l00601"></a><span class="lineno">  601</span><span class="keyword">ALLOCATE</span> (ztot_rc_hinc(d%NIJT,d%NKT)) ; ztot_rc_hinc(:,:) = 0.</div>
<div class="line"><a id="l00602" name="l00602"></a><span class="lineno">  602</span><span class="keyword">ALLOCATE</span> (ztot_rv_henu(d%NIJT,d%NKT)) ; ztot_rv_henu(:,:) = 0.</div>
<div class="line"><a id="l00603" name="l00603"></a><span class="lineno">  603</span><span class="keyword">ALLOCATE</span> (ztot_rv_honh(d%NIJT,d%NKT)) ; ztot_rv_honh(:,:) = 0.</div>
<div class="line"><a id="l00604" name="l00604"></a><span class="lineno">  604</span><span class="comment">!</span></div>
<div class="line"><a id="l00605" name="l00605"></a><span class="lineno">  605</span><span class="comment">!</span></div>
<div class="line"><a id="l00606" name="l00606"></a><span class="lineno">  606</span><span class="comment">! Initial values computed as source * PTSTEP</span></div>
<div class="line"><a id="l00607" name="l00607"></a><span class="lineno">  607</span><span class="comment">!</span></div>
<div class="line"><a id="l00608" name="l00608"></a><span class="lineno">  608</span><span class="comment">! Mixing ratios</span></div>
<div class="line"><a id="l00609" name="l00609"></a><span class="lineno">  609</span><span class="comment">!</span></div>
<div class="line"><a id="l00610" name="l00610"></a><span class="lineno">  610</span>zrvt(:,:) = prs(:,:,1) * ptstep</div>
<div class="line"><a id="l00611" name="l00611"></a><span class="lineno">  611</span>zrvs(:,:) = prs(:,:,1)</div>
<div class="line"><a id="l00612" name="l00612"></a><span class="lineno">  612</span><span class="keywordflow">IF</span> ( krr .GE. 2 ) zrct(:,:) = prs(:,:,2) * ptstep</div>
<div class="line"><a id="l00613" name="l00613"></a><span class="lineno">  613</span><span class="keywordflow">IF</span> ( krr .GE. 2 ) zrcs(:,:) = prs(:,:,2)</div>
<div class="line"><a id="l00614" name="l00614"></a><span class="lineno">  614</span><span class="keywordflow">IF</span> ( krr .GE. 3 ) zrrt(:,:) = prs(:,:,3) * ptstep</div>
<div class="line"><a id="l00615" name="l00615"></a><span class="lineno">  615</span><span class="keywordflow">IF</span> ( krr .GE. 3 ) zrrs(:,:) = prs(:,:,3)</div>
<div class="line"><a id="l00616" name="l00616"></a><span class="lineno">  616</span><span class="keywordflow">IF</span> ( krr .GE. 4 ) zrit(:,:) = prs(:,:,4) * ptstep</div>
<div class="line"><a id="l00617" name="l00617"></a><span class="lineno">  617</span><span class="keywordflow">IF</span> ( krr .GE. 4 ) zris(:,:) = prs(:,:,4)</div>
<div class="line"><a id="l00618" name="l00618"></a><span class="lineno">  618</span><span class="keywordflow">IF</span> ( krr .GE. 5 ) zrst(:,:) = prs(:,:,5) * ptstep</div>
<div class="line"><a id="l00619" name="l00619"></a><span class="lineno">  619</span><span class="keywordflow">IF</span> ( krr .GE. 5 ) zrss(:,:) = prs(:,:,5)</div>
<div class="line"><a id="l00620" name="l00620"></a><span class="lineno">  620</span><span class="keywordflow">IF</span> ( krr .GE. 6 ) zrgt(:,:) = prs(:,:,6) * ptstep</div>
<div class="line"><a id="l00621" name="l00621"></a><span class="lineno">  621</span><span class="keywordflow">IF</span> ( krr .GE. 6 ) zrgs(:,:) = prs(:,:,6)</div>
<div class="line"><a id="l00622" name="l00622"></a><span class="lineno">  622</span><span class="keywordflow">IF</span> ( krr .GE. 7 ) zrht(:,:) = prs(:,:,7) * ptstep</div>
<div class="line"><a id="l00623" name="l00623"></a><span class="lineno">  623</span><span class="keywordflow">IF</span> ( krr .GE. 7 ) zrhs(:,:) = prs(:,:,7)</div>
<div class="line"><a id="l00624" name="l00624"></a><span class="lineno">  624</span><span class="comment">!</span></div>
<div class="line"><a id="l00625" name="l00625"></a><span class="lineno">  625</span><span class="comment">! Concentrations</span></div>
<div class="line"><a id="l00626" name="l00626"></a><span class="lineno">  626</span><span class="comment">!</span></div>
<div class="line"><a id="l00627" name="l00627"></a><span class="lineno">  627</span><span class="keywordflow">IF</span> ( limap%NMOM_C.GE.2) <span class="keywordflow">THEN</span></div>
<div class="line"><a id="l00628" name="l00628"></a><span class="lineno">  628</span>   zcct(:,:)   = psvs(:,:,isv_lima_nc) * ptstep</div>
<div class="line"><a id="l00629" name="l00629"></a><span class="lineno">  629</span>   zccs(:,:)   = psvs(:,:,isv_lima_nc)</div>
<div class="line"><a id="l00630" name="l00630"></a><span class="lineno">  630</span><span class="keywordflow">ELSE</span></div>
<div class="line"><a id="l00631" name="l00631"></a><span class="lineno">  631</span>   zcct(:,:)   = 300.e6 / prhodref(:,:)</div>
<div class="line"><a id="l00632" name="l00632"></a><span class="lineno">  632</span>   zccs(:,:)   = zcct(:,:) / ptstep</div>
<div class="line"><a id="l00633" name="l00633"></a><span class="lineno">  633</span><span class="keywordflow">END IF</span></div>
<div class="line"><a id="l00634" name="l00634"></a><span class="lineno">  634</span><span class="keywordflow">IF</span> ( limap%NMOM_I.GE.2) <span class="keywordflow">THEN</span></div>
<div class="line"><a id="l00635" name="l00635"></a><span class="lineno">  635</span>  <span class="keywordflow">IF</span> (.NOT. limap%LCRYSTAL_SHAPE) <span class="keywordflow">THEN</span></div>
<div class="line"><a id="l00636" name="l00636"></a><span class="lineno">  636</span>    zcit(:,:)   = psvs(:,:,isv_lima_ni) * ptstep</div>
<div class="line"><a id="l00637" name="l00637"></a><span class="lineno">  637</span>    zcis(:,:)   = psvs(:,:,isv_lima_ni)</div>
<div class="line"><a id="l00638" name="l00638"></a><span class="lineno">  638</span>    <span class="keyword">ALLOCATE</span>(zcit_shape(0,0,0))</div>
<div class="line"><a id="l00639" name="l00639"></a><span class="lineno">  639</span>    <span class="keyword">ALLOCATE</span>(zcis_shape(0,0,0))</div>
<div class="line"><a id="l00640" name="l00640"></a><span class="lineno">  640</span>    <span class="keyword">ALLOCATE</span>(zrit_shape(0,0,0))</div>
<div class="line"><a id="l00641" name="l00641"></a><span class="lineno">  641</span>    <span class="keyword">ALLOCATE</span>(zris_shape(0,0,0))</div>
<div class="line"><a id="l00642" name="l00642"></a><span class="lineno">  642</span>  <span class="keywordflow">ELSE</span></div>
<div class="line"><a id="l00643" name="l00643"></a><span class="lineno">  643</span>    <span class="keyword">ALLOCATE</span>(zcit_shape(d%NIJT,d%NKT,limap%NNB_CRYSTAL_SHAPE)); zcit_shape(:,:,:) = 0.</div>
<div class="line"><a id="l00644" name="l00644"></a><span class="lineno">  644</span>    <span class="keyword">ALLOCATE</span>(zcis_shape(d%NIJT,d%NKT,limap%NNB_CRYSTAL_SHAPE)); zcis_shape(:,:,:) = 0.</div>
<div class="line"><a id="l00645" name="l00645"></a><span class="lineno">  645</span>    <span class="keyword">ALLOCATE</span>(zrit_shape(d%NIJT,d%NKT,limap%NNB_CRYSTAL_SHAPE)); zrit_shape(:,:,:) = 0.</div>
<div class="line"><a id="l00646" name="l00646"></a><span class="lineno">  646</span>    <span class="keyword">ALLOCATE</span>(zris_shape(d%NIJT,d%NKT,limap%NNB_CRYSTAL_SHAPE)); zris_shape(:,:,:) = 0.</div>
<div class="line"><a id="l00647" name="l00647"></a><span class="lineno">  647</span>    <span class="keywordflow">DO</span> ish = 1, limap%NNB_CRYSTAL_SHAPE</div>
<div class="line"><a id="l00648" name="l00648"></a><span class="lineno">  648</span>      zcit_shape(:,:,ish) = psvs(:,:,isv_lima_ni+ish-1) * ptstep</div>
<div class="line"><a id="l00649" name="l00649"></a><span class="lineno">  649</span>      zcis_shape(:,:,ish) = psvs(:,:,isv_lima_ni+ish-1)</div>
<div class="line"><a id="l00650" name="l00650"></a><span class="lineno">  650</span><span class="keywordflow">    END DO</span></div>
<div class="line"><a id="l00651" name="l00651"></a><span class="lineno">  651</span><span class="keywordflow">  END IF</span></div>
<div class="line"><a id="l00652" name="l00652"></a><span class="lineno">  652</span><span class="keywordflow">END IF</span></div>
<div class="line"><a id="l00653" name="l00653"></a><span class="lineno">  653</span><span class="keywordflow">IF</span> ( limap%NMOM_R.GE.2) zcrt(:,:)   = psvs(:,:,isv_lima_nr) * ptstep</div>
<div class="line"><a id="l00654" name="l00654"></a><span class="lineno">  654</span><span class="keywordflow">IF</span> ( limap%NMOM_R.GE.2) zcrs(:,:)   = psvs(:,:,isv_lima_nr)</div>
<div class="line"><a id="l00655" name="l00655"></a><span class="lineno">  655</span><span class="keywordflow">IF</span> ( limap%NMOM_I.GE.2) zcit(:,:)   = psvs(:,:,isv_lima_ni) * ptstep</div>
<div class="line"><a id="l00656" name="l00656"></a><span class="lineno">  656</span><span class="keywordflow">IF</span> ( limap%NMOM_I.GE.2) zcis(:,:)   = psvs(:,:,isv_lima_ni)</div>
<div class="line"><a id="l00657" name="l00657"></a><span class="lineno">  657</span><span class="keywordflow">IF</span> ( limap%NMOM_S.GE.2) zcst(:,:)   = psvs(:,:,isv_lima_ns) * ptstep</div>
<div class="line"><a id="l00658" name="l00658"></a><span class="lineno">  658</span><span class="keywordflow">IF</span> ( limap%NMOM_S.GE.2) zcss(:,:)   = psvs(:,:,isv_lima_ns)</div>
<div class="line"><a id="l00659" name="l00659"></a><span class="lineno">  659</span><span class="keywordflow">IF</span> ( limap%NMOM_G.GE.2) zcgt(:,:)   = psvs(:,:,isv_lima_ng) * ptstep</div>
<div class="line"><a id="l00660" name="l00660"></a><span class="lineno">  660</span><span class="keywordflow">IF</span> ( limap%NMOM_G.GE.2) zcgs(:,:)   = psvs(:,:,isv_lima_ng)</div>
<div class="line"><a id="l00661" name="l00661"></a><span class="lineno">  661</span><span class="keywordflow">IF</span> ( limap%NMOM_H.GE.2) zcht(:,:)   = psvs(:,:,isv_lima_nh) * ptstep</div>
<div class="line"><a id="l00662" name="l00662"></a><span class="lineno">  662</span><span class="keywordflow">IF</span> ( limap%NMOM_H.GE.2) zchs(:,:)   = psvs(:,:,isv_lima_nh)</div>
<div class="line"><a id="l00663" name="l00663"></a><span class="lineno">  663</span><span class="comment">!</span></div>
<div class="line"><a id="l00664" name="l00664"></a><span class="lineno">  664</span><span class="keywordflow">IF</span> ( limap%NMOD_CCN .GE. 1 ) zccnft(:,:,:) = psvs(:,:,isv_lima_ccn_free:isv_lima_ccn_free+limap%NMOD_CCN-1) * ptstep</div>
<div class="line"><a id="l00665" name="l00665"></a><span class="lineno">  665</span><span class="keywordflow">IF</span> ( limap%NMOD_CCN .GE. 1 ) zccnat(:,:,:) = psvs(:,:,isv_lima_ccn_acti:isv_lima_ccn_acti+limap%NMOD_CCN-1) * ptstep</div>
<div class="line"><a id="l00666" name="l00666"></a><span class="lineno">  666</span><span class="keywordflow">IF</span> ( limap%NMOD_CCN .GE. 1 ) zccnfs(:,:,:) = psvs(:,:,isv_lima_ccn_free:isv_lima_ccn_free+limap%NMOD_CCN-1)</div>
<div class="line"><a id="l00667" name="l00667"></a><span class="lineno">  667</span><span class="keywordflow">IF</span> ( limap%NMOD_CCN .GE. 1 ) zccnas(:,:,:) = psvs(:,:,isv_lima_ccn_acti:isv_lima_ccn_acti+limap%NMOD_CCN-1)</div>
<div class="line"><a id="l00668" name="l00668"></a><span class="lineno">  668</span><span class="comment">!</span></div>
<div class="line"><a id="l00669" name="l00669"></a><span class="lineno">  669</span><span class="keywordflow">IF</span> ( limap%NMOD_IFN .GE. 1 ) zifnft(:,:,:) = psvs(:,:,isv_lima_ifn_free:isv_lima_ifn_free+limap%NMOD_IFN-1) * ptstep</div>
<div class="line"><a id="l00670" name="l00670"></a><span class="lineno">  670</span><span class="keywordflow">IF</span> ( limap%NMOD_IFN .GE. 1 ) zifnnt(:,:,:) = psvs(:,:,isv_lima_ifn_nucl:isv_lima_ifn_nucl+limap%NMOD_IFN-1) * ptstep</div>
<div class="line"><a id="l00671" name="l00671"></a><span class="lineno">  671</span><span class="keywordflow">IF</span> ( limap%NMOD_IFN .GE. 1 ) zifnfs(:,:,:) = psvs(:,:,isv_lima_ifn_free:isv_lima_ifn_free+limap%NMOD_IFN-1)</div>
<div class="line"><a id="l00672" name="l00672"></a><span class="lineno">  672</span><span class="keywordflow">IF</span> ( limap%NMOD_IFN .GE. 1 ) zifnns(:,:,:) = psvs(:,:,isv_lima_ifn_nucl:isv_lima_ifn_nucl+limap%NMOD_IFN-1)</div>
<div class="line"><a id="l00673" name="l00673"></a><span class="lineno">  673</span><span class="comment">!</span></div>
<div class="line"><a id="l00674" name="l00674"></a><span class="lineno">  674</span><span class="keywordflow">IF</span> ( limap%NMOD_IMM .GE. 1 ) zimmnt(:,:,:) = psvs(:,:,isv_lima_imm_nucl:isv_lima_imm_nucl+limap%NMOD_IMM-1) * ptstep</div>
<div class="line"><a id="l00675" name="l00675"></a><span class="lineno">  675</span><span class="keywordflow">IF</span> ( limap%NMOD_IMM .GE. 1 ) zimmns(:,:,:) = psvs(:,:,isv_lima_imm_nucl:isv_lima_imm_nucl+limap%NMOD_IMM-1)</div>
<div class="line"><a id="l00676" name="l00676"></a><span class="lineno">  676</span><span class="comment">!</span></div>
<div class="line"><a id="l00677" name="l00677"></a><span class="lineno">  677</span><span class="keywordflow">IF</span> ( limap%LHHONI ) zhomft(:,:) = psvs(:,:,isv_lima_hom_haze) * ptstep</div>
<div class="line"><a id="l00678" name="l00678"></a><span class="lineno">  678</span><span class="keywordflow">IF</span> ( limap%LHHONI ) zhomfs(:,:) = psvs(:,:,isv_lima_hom_haze)</div>
<div class="line"><a id="l00679" name="l00679"></a><span class="lineno">  679</span><span class="comment">!</span></div>
<div class="line"><a id="l00680" name="l00680"></a><span class="lineno">  680</span>zinv_tstep  = 1./ptstep</div>
<div class="line"><a id="l00681" name="l00681"></a><span class="lineno">  681</span>zexn(:,:) = (ppabst(:,:)/cst%XP00)**(cst%XRD/cst%XCPD)</div>
<div class="line"><a id="l00682" name="l00682"></a><span class="lineno">  682</span>zt(:,:)   = ztht(:,:) * zexn(:,:)</div>
<div class="line"><a id="l00683" name="l00683"></a><span class="lineno">  683</span><span class="comment">!</span></div>
<div class="line"><a id="l00684" name="l00684"></a><span class="lineno">  684</span><span class="comment">! Electric charge density</span></div>
<div class="line"><a id="l00685" name="l00685"></a><span class="lineno">  685</span><span class="comment">!</span></div>
<div class="line"><a id="l00686" name="l00686"></a><span class="lineno">  686</span><span class="keywordflow">IF</span> (oelec) <span class="keywordflow">THEN</span></div>
<div class="line"><a id="l00687" name="l00687"></a><span class="lineno">  687</span>  <span class="keyword">ALLOCATE</span>(zqpit(d%NIJT,d%NKT))</div>
<div class="line"><a id="l00688" name="l00688"></a><span class="lineno">  688</span>  <span class="keyword">ALLOCATE</span>(zqct(d%NIJT,d%NKT))</div>
<div class="line"><a id="l00689" name="l00689"></a><span class="lineno">  689</span>  <span class="keyword">ALLOCATE</span>(zqrt(d%NIJT,d%NKT))</div>
<div class="line"><a id="l00690" name="l00690"></a><span class="lineno">  690</span>  <span class="keyword">ALLOCATE</span>(zqit(d%NIJT,d%NKT))</div>
<div class="line"><a id="l00691" name="l00691"></a><span class="lineno">  691</span>  <span class="keyword">ALLOCATE</span>(zqst(d%NIJT,d%NKT))</div>
<div class="line"><a id="l00692" name="l00692"></a><span class="lineno">  692</span>  <span class="keyword">ALLOCATE</span>(zqgt(d%NIJT,d%NKT))</div>
<div class="line"><a id="l00693" name="l00693"></a><span class="lineno">  693</span>  <span class="keyword">ALLOCATE</span>(zqnit(d%NIJT,d%NKT))</div>
<div class="line"><a id="l00694" name="l00694"></a><span class="lineno">  694</span>  <span class="keywordflow">IF</span> (krr == 7) <span class="keyword">ALLOCATE</span>(zqht(d%NIJT,d%NKT))</div>
<div class="line"><a id="l00695" name="l00695"></a><span class="lineno">  695</span>  <span class="comment">!</span></div>
<div class="line"><a id="l00696" name="l00696"></a><span class="lineno">  696</span>  <span class="keyword">ALLOCATE</span>(zqpis(d%NIJT,d%NKT))</div>
<div class="line"><a id="l00697" name="l00697"></a><span class="lineno">  697</span>  <span class="keyword">ALLOCATE</span>(zqcs(d%NIJT,d%NKT))</div>
<div class="line"><a id="l00698" name="l00698"></a><span class="lineno">  698</span>  <span class="keyword">ALLOCATE</span>(zqrs(d%NIJT,d%NKT))</div>
<div class="line"><a id="l00699" name="l00699"></a><span class="lineno">  699</span>  <span class="keyword">ALLOCATE</span>(zqis(d%NIJT,d%NKT))</div>
<div class="line"><a id="l00700" name="l00700"></a><span class="lineno">  700</span>  <span class="keyword">ALLOCATE</span>(zqss(d%NIJT,d%NKT))</div>
<div class="line"><a id="l00701" name="l00701"></a><span class="lineno">  701</span>  <span class="keyword">ALLOCATE</span>(zqgs(d%NIJT,d%NKT))</div>
<div class="line"><a id="l00702" name="l00702"></a><span class="lineno">  702</span>  <span class="keyword">ALLOCATE</span>(zqnis(d%NIJT,d%NKT))</div>
<div class="line"><a id="l00703" name="l00703"></a><span class="lineno">  703</span>  <span class="keywordflow">IF</span> (krr == 7) <span class="keyword">ALLOCATE</span>(zqhs(d%NIJT,d%NKT))</div>
<div class="line"><a id="l00704" name="l00704"></a><span class="lineno">  704</span>  <span class="comment">!</span></div>
<div class="line"><a id="l00705" name="l00705"></a><span class="lineno">  705</span>  <span class="keyword">ALLOCATE</span>(zrvt_elec(d%NIJT,d%NKT))</div>
<div class="line"><a id="l00706" name="l00706"></a><span class="lineno">  706</span>  <span class="keyword">ALLOCATE</span>(zrct_elec(d%NIJT,d%NKT))</div>
<div class="line"><a id="l00707" name="l00707"></a><span class="lineno">  707</span>  <span class="keyword">ALLOCATE</span>(zrrt_elec(d%NIJT,d%NKT))</div>
<div class="line"><a id="l00708" name="l00708"></a><span class="lineno">  708</span>  <span class="keyword">ALLOCATE</span>(zrit_elec(d%NIJT,d%NKT))</div>
<div class="line"><a id="l00709" name="l00709"></a><span class="lineno">  709</span>  <span class="keyword">ALLOCATE</span>(zrst_elec(d%NIJT,d%NKT))</div>
<div class="line"><a id="l00710" name="l00710"></a><span class="lineno">  710</span>  <span class="keyword">ALLOCATE</span>(zrgt_elec(d%NIJT,d%NKT))</div>
<div class="line"><a id="l00711" name="l00711"></a><span class="lineno">  711</span>  <span class="keywordflow">IF</span> (krr == 7) <span class="keyword">ALLOCATE</span>(zrht_elec(d%NIJT,d%NKT))</div>
<div class="line"><a id="l00712" name="l00712"></a><span class="lineno">  712</span>  <span class="keyword">ALLOCATE</span>(zcct_elec(d%NIJT,d%NKT))</div>
<div class="line"><a id="l00713" name="l00713"></a><span class="lineno">  713</span>  <span class="keyword">ALLOCATE</span>(zcrt_elec(d%NIJT,d%NKT))</div>
<div class="line"><a id="l00714" name="l00714"></a><span class="lineno">  714</span>  <span class="keyword">ALLOCATE</span>(zcit_elec(d%NIJT,d%NKT))</div>
<div class="line"><a id="l00715" name="l00715"></a><span class="lineno">  715</span>  <span class="keyword">ALLOCATE</span>(zcst_elec(d%NIJT,d%NKT))</div>
<div class="line"><a id="l00716" name="l00716"></a><span class="lineno">  716</span>  <span class="keyword">ALLOCATE</span>(zcgt_elec(d%NIJT,d%NKT))</div>
<div class="line"><a id="l00717" name="l00717"></a><span class="lineno">  717</span>  <span class="keywordflow">IF</span> (krr == 7) <span class="keyword">ALLOCATE</span>(zcht_elec(d%NIJT,d%NKT))</div>
<div class="line"><a id="l00718" name="l00718"></a><span class="lineno">  718</span><span class="comment">!</span></div>
<div class="line"><a id="l00719" name="l00719"></a><span class="lineno">  719</span><span class="comment">!++cb++ 21/04/23 source * ptstep</span></div>
<div class="line"><a id="l00720" name="l00720"></a><span class="lineno">  720</span>  zqpit(:,:) = psv_elec_s(:,:,1) * ptstep</div>
<div class="line"><a id="l00721" name="l00721"></a><span class="lineno">  721</span>  zqct(:,:)  = psv_elec_s(:,:,2) * ptstep</div>
<div class="line"><a id="l00722" name="l00722"></a><span class="lineno">  722</span>  zqrt(:,:)  = psv_elec_s(:,:,3) * ptstep</div>
<div class="line"><a id="l00723" name="l00723"></a><span class="lineno">  723</span>  zqit(:,:)  = psv_elec_s(:,:,4) * ptstep</div>
<div class="line"><a id="l00724" name="l00724"></a><span class="lineno">  724</span>  zqst(:,:)  = psv_elec_s(:,:,5) * ptstep</div>
<div class="line"><a id="l00725" name="l00725"></a><span class="lineno">  725</span>  zqgt(:,:)  = psv_elec_s(:,:,6) * ptstep</div>
<div class="line"><a id="l00726" name="l00726"></a><span class="lineno">  726</span>  <span class="keywordflow">IF</span> (krr == 6) <span class="keywordflow">THEN</span></div>
<div class="line"><a id="l00727" name="l00727"></a><span class="lineno">  727</span>    zqnit(:,:)  = psv_elec_s(:,:,7) * ptstep</div>
<div class="line"><a id="l00728" name="l00728"></a><span class="lineno">  728</span>  <span class="keywordflow">ELSE</span> <span class="keywordflow">IF</span> (krr == 7) <span class="keywordflow">THEN</span></div>
<div class="line"><a id="l00729" name="l00729"></a><span class="lineno">  729</span>    zqht(:,:)  = psv_elec_s(:,:,7) * ptstep</div>
<div class="line"><a id="l00730" name="l00730"></a><span class="lineno">  730</span>    zqnit(:,:) = psv_elec_s(:,:,8) * ptstep</div>
<div class="line"><a id="l00731" name="l00731"></a><span class="lineno">  731</span><span class="keywordflow">  END IF</span></div>
<div class="line"><a id="l00732" name="l00732"></a><span class="lineno">  732</span>  <span class="comment">!</span></div>
<div class="line"><a id="l00733" name="l00733"></a><span class="lineno">  733</span>  zqpis(:,:) = psv_elec_s(:,:,1)</div>
<div class="line"><a id="l00734" name="l00734"></a><span class="lineno">  734</span>  zqcs(:,:)  = psv_elec_s(:,:,2)</div>
<div class="line"><a id="l00735" name="l00735"></a><span class="lineno">  735</span>  zqrs(:,:)  = psv_elec_s(:,:,3)</div>
<div class="line"><a id="l00736" name="l00736"></a><span class="lineno">  736</span>  zqis(:,:)  = psv_elec_s(:,:,4)</div>
<div class="line"><a id="l00737" name="l00737"></a><span class="lineno">  737</span>  zqss(:,:)  = psv_elec_s(:,:,5)</div>
<div class="line"><a id="l00738" name="l00738"></a><span class="lineno">  738</span>  zqgs(:,:)  = psv_elec_s(:,:,6)</div>
<div class="line"><a id="l00739" name="l00739"></a><span class="lineno">  739</span>  <span class="keywordflow">IF</span> (krr == 6) <span class="keywordflow">THEN</span></div>
<div class="line"><a id="l00740" name="l00740"></a><span class="lineno">  740</span>    zqnis(:,:)  = psv_elec_s(:,:,7)</div>
<div class="line"><a id="l00741" name="l00741"></a><span class="lineno">  741</span>  <span class="keywordflow">ELSE</span> <span class="keywordflow">IF</span> (krr == 7) <span class="keywordflow">THEN</span></div>
<div class="line"><a id="l00742" name="l00742"></a><span class="lineno">  742</span>    zqhs(:,:)  = psv_elec_s(:,:,7)</div>
<div class="line"><a id="l00743" name="l00743"></a><span class="lineno">  743</span>    zqnis(:,:) = psv_elec_s(:,:,8) </div>
<div class="line"><a id="l00744" name="l00744"></a><span class="lineno">  744</span><span class="keywordflow">  END IF</span></div>
<div class="line"><a id="l00745" name="l00745"></a><span class="lineno">  745</span><span class="keywordflow">END IF</span></div>
<div class="line"><a id="l00746" name="l00746"></a><span class="lineno">  746</span><span class="comment">!</span></div>
<div class="line"><a id="l00747" name="l00747"></a><span class="lineno">  747</span>pinprc=0.</div>
<div class="line"><a id="l00748" name="l00748"></a><span class="lineno">  748</span>pindep=0.</div>
<div class="line"><a id="l00749" name="l00749"></a><span class="lineno">  749</span>pinprr=0.</div>
<div class="line"><a id="l00750" name="l00750"></a><span class="lineno">  750</span>pinpri=0.</div>
<div class="line"><a id="l00751" name="l00751"></a><span class="lineno">  751</span>pinprs=0.</div>
<div class="line"><a id="l00752" name="l00752"></a><span class="lineno">  752</span>pinprg=0.</div>
<div class="line"><a id="l00753" name="l00753"></a><span class="lineno">  753</span>pinprh=0.</div>
<div class="line"><a id="l00754" name="l00754"></a><span class="lineno">  754</span>pevap3d(:,:)=0.</div>
<div class="line"><a id="l00755" name="l00755"></a><span class="lineno">  755</span><span class="comment">!</span></div>
<div class="line"><a id="l00756" name="l00756"></a><span class="lineno">  756</span><span class="comment">!-------------------------------------------------------------------------------</span></div>
<div class="line"><a id="l00757" name="l00757"></a><span class="lineno">  757</span><span class="comment">!</span></div>
<div class="line"><a id="l00758" name="l00758"></a><span class="lineno">  758</span><span class="comment">!*       0.     Check mean diameter for cloud, rain  and ice</span></div>
<div class="line"><a id="l00759" name="l00759"></a><span class="lineno">  759</span><span class="comment">!               --------------------------------------------</span></div>
<div class="line"><a id="l00760" name="l00760"></a><span class="lineno">  760</span><span class="comment">! if ( BUCONF%LBU_ENABLE ) then</span></div>
<div class="line"><a id="l00761" name="l00761"></a><span class="lineno">  761</span><span class="comment">!   if ( BUCONF%lbudget_rc .and. lwarm .and. lrain ) call BUDGET_STORE_INIT_PHY(D, TBUDGETS(NBUDGET_RC), &#39;CORR&#39;, zrcs(:,:) * prhodj(:,:) )</span></div>
<div class="line"><a id="l00762" name="l00762"></a><span class="lineno">  762</span><span class="comment">!   if ( BUCONF%lbudget_rr .and. lwarm .and. lrain ) call BUDGET_STORE_INIT_PHY(D, TBUDGETS(NBUDGET_RR), &#39;CORR&#39;, zrrs(:,:) * prhodj(:,:) )</span></div>
<div class="line"><a id="l00763" name="l00763"></a><span class="lineno">  763</span><span class="comment">!   if ( BUCONF%lbudget_ri .and. lcold .and. lsnow ) call BUDGET_STORE_INIT_PHY(D, TBUDGETS(NBUDGET_RI), &#39;CORR&#39;, zris(:,:) * prhodj(:,:) )</span></div>
<div class="line"><a id="l00764" name="l00764"></a><span class="lineno">  764</span><span class="comment">!   if ( BUCONF%lbudget_rs .and. lcold .and. lsnow ) call BUDGET_STORE_INIT_PHY(D, TBUDGETS(NBUDGET_RS), &#39;CORR&#39;, zrss(:,:) * prhodj(:,:) )</span></div>
<div class="line"><a id="l00765" name="l00765"></a><span class="lineno">  765</span><span class="comment">!   if ( BUCONF%lbudget_sv ) then</span></div>
<div class="line"><a id="l00766" name="l00766"></a><span class="lineno">  766</span><span class="comment">!     if ( lwarm .and. lrain .and. nmom_c.ge.2) &amp;</span></div>
<div class="line"><a id="l00767" name="l00767"></a><span class="lineno">  767</span><span class="comment">!       call BUDGET_STORE_INIT_PHY(D, TBUDGETS(NBUDGET_SV1 - 1 + nsv_lima_nc), &#39;CORR&#39;, zccs(:,:) * prhodj(:,:) )</span></div>
<div class="line"><a id="l00768" name="l00768"></a><span class="lineno">  768</span><span class="comment">!     if ( lwarm .and. lrain .and. nmom_r.ge.2) &amp;</span></div>
<div class="line"><a id="l00769" name="l00769"></a><span class="lineno">  769</span><span class="comment">!       call BUDGET_STORE_INIT_PHY(D, TBUDGETS(NBUDGET_SV1 - 1 + nsv_lima_nr), &#39;CORR&#39;, zcrs(:,:) * prhodj(:,:) )</span></div>
<div class="line"><a id="l00770" name="l00770"></a><span class="lineno">  770</span><span class="comment">!     if ( lcold .and. lsnow .and. nmom_i.ge.2) &amp;</span></div>
<div class="line"><a id="l00771" name="l00771"></a><span class="lineno">  771</span><span class="comment">!       call BUDGET_STORE_INIT_PHY(D, TBUDGETS(NBUDGET_SV1 - 1 + nsv_lima_ni), &#39;CORR&#39;, zcis(:,:) * prhodj(:,:) )</span></div>
<div class="line"><a id="l00772" name="l00772"></a><span class="lineno">  772</span><span class="comment">!   end if</span></div>
<div class="line"><a id="l00773" name="l00773"></a><span class="lineno">  773</span><span class="comment">! end if</span></div>
<div class="line"><a id="l00774" name="l00774"></a><span class="lineno">  774</span><span class="comment">!!$IF (LIMAP%NMOM_R.GE.2) THEN</span></div>
<div class="line"><a id="l00775" name="l00775"></a><span class="lineno">  775</span><span class="comment">!!$   WHERE( ZRCT&gt;LIMAP%XRTMIN(2) .AND. ZCCT&gt;LIMAP%XCTMIN(2) .AND. ZRCT&gt;XAC*ZCCT*(100.E-6)**LIMAW%XBC )</span></div>
<div class="line"><a id="l00776" name="l00776"></a><span class="lineno">  776</span><span class="comment">!!$      ZRRT=ZRRT+ZRCT</span></div>
<div class="line"><a id="l00777" name="l00777"></a><span class="lineno">  777</span><span class="comment">!!$      ZRRS=ZRRS+ZRCS</span></div>
<div class="line"><a id="l00778" name="l00778"></a><span class="lineno">  778</span><span class="comment">!!$      ZCRT=ZCRT+ZCCT</span></div>
<div class="line"><a id="l00779" name="l00779"></a><span class="lineno">  779</span><span class="comment">!!$      ZCRS=ZCRS+ZCCS</span></div>
<div class="line"><a id="l00780" name="l00780"></a><span class="lineno">  780</span><span class="comment">!!$      ZRCT=0.</span></div>
<div class="line"><a id="l00781" name="l00781"></a><span class="lineno">  781</span><span class="comment">!!$      ZCCT=0.</span></div>
<div class="line"><a id="l00782" name="l00782"></a><span class="lineno">  782</span><span class="comment">!!$      ZRCS=0.</span></div>
<div class="line"><a id="l00783" name="l00783"></a><span class="lineno">  783</span><span class="comment">!!$      ZCCS=0.</span></div>
<div class="line"><a id="l00784" name="l00784"></a><span class="lineno">  784</span><span class="comment">!!$   END WHERE</span></div>
<div class="line"><a id="l00785" name="l00785"></a><span class="lineno">  785</span><span class="comment">!!$END IF</span></div>
<div class="line"><a id="l00786" name="l00786"></a><span class="lineno">  786</span><span class="comment">!!$!</span></div>
<div class="line"><a id="l00787" name="l00787"></a><span class="lineno">  787</span><span class="comment">!!$IF (LIMAP%NMOM_R.GE.2) THEN</span></div>
<div class="line"><a id="l00788" name="l00788"></a><span class="lineno">  788</span><span class="comment">!!$   WHERE( ZRRT&gt;LIMAP%XRTMIN(3) .AND. ZCRT&gt;LIMAP%XCTMIN(3) .AND. ZRRT&lt;LIMAW%XAR*ZCRT*(60.E-6)**LIMAW%XBR )</span></div>
<div class="line"><a id="l00789" name="l00789"></a><span class="lineno">  789</span><span class="comment">!!$      ZRCT=ZRCT+ZRRT</span></div>
<div class="line"><a id="l00790" name="l00790"></a><span class="lineno">  790</span><span class="comment">!!$      ZRCS=ZRCS+ZRRS</span></div>
<div class="line"><a id="l00791" name="l00791"></a><span class="lineno">  791</span><span class="comment">!!$      ZCCT=ZCCT+ZCRT</span></div>
<div class="line"><a id="l00792" name="l00792"></a><span class="lineno">  792</span><span class="comment">!!$      ZCCS=ZCCS+ZCRS</span></div>
<div class="line"><a id="l00793" name="l00793"></a><span class="lineno">  793</span><span class="comment">!!$      ZRRT=0.</span></div>
<div class="line"><a id="l00794" name="l00794"></a><span class="lineno">  794</span><span class="comment">!!$      ZCRT=0.</span></div>
<div class="line"><a id="l00795" name="l00795"></a><span class="lineno">  795</span><span class="comment">!!$      ZRRS=0.</span></div>
<div class="line"><a id="l00796" name="l00796"></a><span class="lineno">  796</span><span class="comment">!!$      ZCRS=0.</span></div>
<div class="line"><a id="l00797" name="l00797"></a><span class="lineno">  797</span><span class="comment">!!$   END WHERE</span></div>
<div class="line"><a id="l00798" name="l00798"></a><span class="lineno">  798</span><span class="comment">!!$END IF</span></div>
<div class="line"><a id="l00799" name="l00799"></a><span class="lineno">  799</span><span class="comment">!!$!</span></div>
<div class="line"><a id="l00800" name="l00800"></a><span class="lineno">  800</span><span class="comment">!!$IF (LIMAP%NMOM_S.GE.2) THEN</span></div>
<div class="line"><a id="l00801" name="l00801"></a><span class="lineno">  801</span><span class="comment">!!$   WHERE( ZRIT&gt;LIMAP%XRTMIN(4) .AND. ZCIT&gt;LIMAP%XCTMIN(4) .AND. ZRIT&gt;LIMAC%XAI*ZCIT*(250.E-6)**LIMAC%XBI )</span></div>
<div class="line"><a id="l00802" name="l00802"></a><span class="lineno">  802</span><span class="comment">!!$      ZRST=ZRST+ZRIT</span></div>
<div class="line"><a id="l00803" name="l00803"></a><span class="lineno">  803</span><span class="comment">!!$      ZRSS=ZRSS+ZRIS</span></div>
<div class="line"><a id="l00804" name="l00804"></a><span class="lineno">  804</span><span class="comment">!!$      ZRIT=0.</span></div>
<div class="line"><a id="l00805" name="l00805"></a><span class="lineno">  805</span><span class="comment">!!$      ZCIT=0.</span></div>
<div class="line"><a id="l00806" name="l00806"></a><span class="lineno">  806</span><span class="comment">!!$      ZRIS=0.</span></div>
<div class="line"><a id="l00807" name="l00807"></a><span class="lineno">  807</span><span class="comment">!!$      ZCIS=0.</span></div>
<div class="line"><a id="l00808" name="l00808"></a><span class="lineno">  808</span><span class="comment">!!$   END WHERE</span></div>
<div class="line"><a id="l00809" name="l00809"></a><span class="lineno">  809</span><span class="comment">!!$END IF</span></div>
<div class="line"><a id="l00810" name="l00810"></a><span class="lineno">  810</span><span class="comment">!</span></div>
<div class="line"><a id="l00811" name="l00811"></a><span class="lineno">  811</span><span class="comment">! if ( BUCONF%LBU_ENABLE ) then</span></div>
<div class="line"><a id="l00812" name="l00812"></a><span class="lineno">  812</span><span class="comment">!   if ( BUCONF%lbudget_rc .and. lwarm .and. lrain ) call BUDGET_STORE_END_PHY(D, TBUDGETS(NBUDGET_RC), &#39;CORR&#39;, zrcs(:,:) * prhodj(:,:) )</span></div>
<div class="line"><a id="l00813" name="l00813"></a><span class="lineno">  813</span><span class="comment">!   if ( BUCONF%lbudget_rr .and. lwarm .and. lrain ) call BUDGET_STORE_END_PHY(D, TBUDGETS(NBUDGET_RR), &#39;CORR&#39;, zrrs(:,:) * prhodj(:,:) )</span></div>
<div class="line"><a id="l00814" name="l00814"></a><span class="lineno">  814</span><span class="comment">!   if ( BUCONF%lbudget_ri .and. lcold .and. lsnow ) call BUDGET_STORE_END_PHY(D, TBUDGETS(NBUDGET_RI), &#39;CORR&#39;, zris(:,:) * prhodj(:,:) )</span></div>
<div class="line"><a id="l00815" name="l00815"></a><span class="lineno">  815</span><span class="comment">!   if ( BUCONF%lbudget_rs .and. lcold .and. lsnow ) call BUDGET_STORE_END_PHY(D, TBUDGETS(NBUDGET_RS), &#39;CORR&#39;, zrss(:,:) * prhodj(:,:) )</span></div>
<div class="line"><a id="l00816" name="l00816"></a><span class="lineno">  816</span><span class="comment">!   if ( BUCONF%lbudget_sv ) then</span></div>
<div class="line"><a id="l00817" name="l00817"></a><span class="lineno">  817</span><span class="comment">!     if ( lwarm .and. lrain .and. nmom_c.ge.2) &amp;</span></div>
<div class="line"><a id="l00818" name="l00818"></a><span class="lineno">  818</span><span class="comment">!       call BUDGET_STORE_END_PHY(D, TBUDGETS(NBUDGET_SV1 - 1 + nsv_lima_nc), &#39;CORR&#39;, zccs(:,:) * prhodj(:,:) )</span></div>
<div class="line"><a id="l00819" name="l00819"></a><span class="lineno">  819</span><span class="comment">!     if ( lwarm .and. lrain .and. nmom_r.ge.2) &amp;</span></div>
<div class="line"><a id="l00820" name="l00820"></a><span class="lineno">  820</span><span class="comment">!       call BUDGET_STORE_END_PHY(D, TBUDGETS(NBUDGET_SV1 - 1 + nsv_lima_nr), &#39;CORR&#39;, zcrs(:,:) * prhodj(:,:) )</span></div>
<div class="line"><a id="l00821" name="l00821"></a><span class="lineno">  821</span><span class="comment">!     if ( lcold .and. lsnow .and. nmom_i.ge.2) &amp;</span></div>
<div class="line"><a id="l00822" name="l00822"></a><span class="lineno">  822</span><span class="comment">!       call BUDGET_STORE_END_PHY(D, TBUDGETS(NBUDGET_SV1 - 1 + nsv_lima_ni), &#39;CORR&#39;, zcis(:,:) * prhodj(:,:) )</span></div>
<div class="line"><a id="l00823" name="l00823"></a><span class="lineno">  823</span><span class="comment">!   end if</span></div>
<div class="line"><a id="l00824" name="l00824"></a><span class="lineno">  824</span><span class="comment">! end if</span></div>
<div class="line"><a id="l00825" name="l00825"></a><span class="lineno">  825</span><span class="comment">!-------------------------------------------------------------------------------</span></div>
<div class="line"><a id="l00826" name="l00826"></a><span class="lineno">  826</span><span class="comment">!</span></div>
<div class="line"><a id="l00827" name="l00827"></a><span class="lineno">  827</span><span class="comment">!*       1.     Sedimentation</span></div>
<div class="line"><a id="l00828" name="l00828"></a><span class="lineno">  828</span><span class="comment">!               -------------</span></div>
<div class="line"><a id="l00829" name="l00829"></a><span class="lineno">  829</span><span class="comment">!</span></div>
<div class="line"><a id="l00830" name="l00830"></a><span class="lineno">  830</span><span class="comment">!</span></div>
<div class="line"><a id="l00831" name="l00831"></a><span class="lineno">  831</span><span class="keywordflow">IF</span> ( buconf%LBU_ENABLE ) <span class="keywordflow">THEN</span></div>
<div class="line"><a id="l00832" name="l00832"></a><span class="lineno">  832</span>  <span class="keywordflow">IF</span> ( buconf%LBUDGET_TH ) &amp;</div>
<div class="line"><a id="l00833" name="l00833"></a><span class="lineno">  833</span>       <span class="keyword">CALL </span>budget_store_init_phy(d, tbudgets(nbudget_th), <span class="stringliteral">&#39;SEDI&#39;</span>, zths(:,:) * prhodj(:,:) )</div>
<div class="line"><a id="l00834" name="l00834"></a><span class="lineno">  834</span>  <span class="keywordflow">IF</span> ( buconf%LBUDGET_RC .AND. limap%NMOM_C.GE.1 .AND. limap%LSEDC ) &amp;</div>
<div class="line"><a id="l00835" name="l00835"></a><span class="lineno">  835</span>       <span class="keyword">CALL </span>budget_store_init_phy(d, tbudgets(nbudget_rc), <span class="stringliteral">&#39;SEDI&#39;</span>, zrcs(:,:) * prhodj(:,:) )</div>
<div class="line"><a id="l00836" name="l00836"></a><span class="lineno">  836</span>  <span class="keywordflow">IF</span> ( buconf%LBUDGET_RR .AND. limap%NMOM_R.GE.1 ) &amp;</div>
<div class="line"><a id="l00837" name="l00837"></a><span class="lineno">  837</span>       <span class="keyword">CALL </span>budget_store_init_phy(d, tbudgets(nbudget_rr), <span class="stringliteral">&#39;SEDI&#39;</span>, zrrs(:,:) * prhodj(:,:) )</div>
<div class="line"><a id="l00838" name="l00838"></a><span class="lineno">  838</span>  <span class="keywordflow">IF</span> ( buconf%LBUDGET_RI .AND. limap%NMOM_I.GE.1 .AND. limap%LSEDI ) &amp;</div>
<div class="line"><a id="l00839" name="l00839"></a><span class="lineno">  839</span>       <span class="keyword">CALL </span>budget_store_init_phy(d, tbudgets(nbudget_ri), <span class="stringliteral">&#39;SEDI&#39;</span>, zris(:,:) * prhodj(:,:) )</div>
<div class="line"><a id="l00840" name="l00840"></a><span class="lineno">  840</span>  <span class="keywordflow">IF</span> ( buconf%LBUDGET_RS .AND. limap%NMOM_S.GE.1 ) &amp;</div>
<div class="line"><a id="l00841" name="l00841"></a><span class="lineno">  841</span>       <span class="keyword">CALL </span>budget_store_init_phy(d, tbudgets(nbudget_rs), <span class="stringliteral">&#39;SEDI&#39;</span>, zrss(:,:) * prhodj(:,:) )</div>
<div class="line"><a id="l00842" name="l00842"></a><span class="lineno">  842</span>  <span class="keywordflow">IF</span> ( buconf%LBUDGET_RG .AND. limap%NMOM_G.GE.1 ) &amp;</div>
<div class="line"><a id="l00843" name="l00843"></a><span class="lineno">  843</span>       <span class="keyword">CALL </span>budget_store_init_phy(d, tbudgets(nbudget_rg), <span class="stringliteral">&#39;SEDI&#39;</span>, zrgs(:,:) * prhodj(:,:) )</div>
<div class="line"><a id="l00844" name="l00844"></a><span class="lineno">  844</span>  <span class="keywordflow">IF</span> ( buconf%LBUDGET_RH .AND. limap%NMOM_H.GE.1 ) &amp;</div>
<div class="line"><a id="l00845" name="l00845"></a><span class="lineno">  845</span>       <span class="keyword">CALL </span>budget_store_init_phy(d, tbudgets(nbudget_rh), <span class="stringliteral">&#39;SEDI&#39;</span>, zrhs(:,:) * prhodj(:,:) )</div>
<div class="line"><a id="l00846" name="l00846"></a><span class="lineno">  846</span>  <span class="keywordflow">IF</span> ( buconf%LBUDGET_SV ) <span class="keywordflow">THEN</span></div>
<div class="line"><a id="l00847" name="l00847"></a><span class="lineno">  847</span>    <span class="keywordflow">IF</span> ( limap%LSEDC .AND. limap%NMOM_C.GE.2) &amp;</div>
<div class="line"><a id="l00848" name="l00848"></a><span class="lineno">  848</span>      <span class="keyword">CALL </span>budget_store_init_phy(d, tbudgets(nbudget_sv1 - 1 + tnsv%NSV_LIMA_NC), <span class="stringliteral">&#39;SEDI&#39;</span>, zccs(:,:) * prhodj(:,:) )</div>
<div class="line"><a id="l00849" name="l00849"></a><span class="lineno">  849</span>    <span class="keywordflow">IF</span> ( limap%NMOM_R.GE.2) &amp;</div>
<div class="line"><a id="l00850" name="l00850"></a><span class="lineno">  850</span>      <span class="keyword">CALL </span>budget_store_init_phy(d, tbudgets(nbudget_sv1 - 1 + tnsv%NSV_LIMA_NR), <span class="stringliteral">&#39;SEDI&#39;</span>, zcrs(:,:) * prhodj(:,:) )</div>
<div class="line"><a id="l00851" name="l00851"></a><span class="lineno">  851</span>    <span class="keywordflow">IF</span> ( limap%LSEDI .AND. limap%NMOM_I.GE.2) <span class="keywordflow">THEN</span></div>
<div class="line"><a id="l00852" name="l00852"></a><span class="lineno">  852</span>      <span class="keywordflow">IF</span> (.NOT. limap%LCRYSTAL_SHAPE) <span class="keywordflow">THEN</span></div>
<div class="line"><a id="l00853" name="l00853"></a><span class="lineno">  853</span>      <span class="keyword">CALL </span>budget_store_init_phy(d, tbudgets(nbudget_sv1 - 1 + tnsv%NSV_LIMA_NI), <span class="stringliteral">&#39;SEDI&#39;</span>, zcis(:,:) * prhodj(:,:) )</div>
<div class="line"><a id="l00854" name="l00854"></a><span class="lineno">  854</span>      <span class="keywordflow">ELSE</span></div>
<div class="line"><a id="l00855" name="l00855"></a><span class="lineno">  855</span>        <span class="keywordflow">DO</span> ish = 1, limap%NNB_CRYSTAL_SHAPE</div>
<div class="line"><a id="l00856" name="l00856"></a><span class="lineno">  856</span>          <span class="keyword">CALL </span>budget_store_init_phy(d, tbudgets(nbudget_sv1 - 1 + tnsv%NSV_LIMA_NI + ish - 1), <span class="stringliteral">&#39;SEDI&#39;</span>, &amp;</div>
<div class="line"><a id="l00857" name="l00857"></a><span class="lineno">  857</span>                                     zcis_shape( :, :, ish) * prhodj( :, :) )</div>
<div class="line"><a id="l00858" name="l00858"></a><span class="lineno">  858</span><span class="keywordflow">        END DO</span></div>
<div class="line"><a id="l00859" name="l00859"></a><span class="lineno">  859</span><span class="keywordflow">      END IF</span></div>
<div class="line"><a id="l00860" name="l00860"></a><span class="lineno">  860</span><span class="keywordflow">    END IF</span></div>
<div class="line"><a id="l00861" name="l00861"></a><span class="lineno">  861</span>    <span class="keywordflow">IF</span> ( limap%NMOM_S.GE.2) &amp;</div>
<div class="line"><a id="l00862" name="l00862"></a><span class="lineno">  862</span>      <span class="keyword">CALL </span>budget_store_init_phy(d, tbudgets(nbudget_sv1 - 1 + tnsv%NSV_LIMA_NS), <span class="stringliteral">&#39;SEDI&#39;</span>, zcss(:,:) * prhodj(:,:) )</div>
<div class="line"><a id="l00863" name="l00863"></a><span class="lineno">  863</span>    <span class="keywordflow">IF</span> ( limap%NMOM_G.GE.2) &amp;</div>
<div class="line"><a id="l00864" name="l00864"></a><span class="lineno">  864</span>      <span class="keyword">CALL </span>budget_store_init_phy(d, tbudgets(nbudget_sv1 - 1 + tnsv%NSV_LIMA_NG), <span class="stringliteral">&#39;SEDI&#39;</span>, zcgs(:,:) * prhodj(:,:) )</div>
<div class="line"><a id="l00865" name="l00865"></a><span class="lineno">  865</span>    <span class="keywordflow">IF</span> ( limap%NMOM_H.GE.2) &amp;</div>
<div class="line"><a id="l00866" name="l00866"></a><span class="lineno">  866</span>      <span class="keyword">CALL </span>budget_store_init_phy(d, tbudgets(nbudget_sv1 - 1 + tnsv%NSV_LIMA_NH), <span class="stringliteral">&#39;SEDI&#39;</span>, zchs(:,:) * prhodj(:,:) )</div>
<div class="line"><a id="l00867" name="l00867"></a><span class="lineno">  867</span>    <span class="comment">!</span></div>
<div class="line"><a id="l00868" name="l00868"></a><span class="lineno">  868</span>    <span class="keywordflow">IF</span> (oelec) <span class="keywordflow">THEN</span></div>
<div class="line"><a id="l00869" name="l00869"></a><span class="lineno">  869</span>      <span class="keywordflow">IF</span> ( limap%LSEDC ) &amp;</div>
<div class="line"><a id="l00870" name="l00870"></a><span class="lineno">  870</span>        <span class="keyword">CALL </span>budget_store_init_phy(d, tbudgets(nbudget_sv1 - 1 + tnsv%NSV_ELECBEG + 1), <span class="stringliteral">&#39;SEDI&#39;</span>, zqcs(:,:) * prhodj(:,:) )</div>
<div class="line"><a id="l00871" name="l00871"></a><span class="lineno">  871</span>      <span class="keyword">CALL </span>budget_store_init_phy(d, tbudgets(nbudget_sv1 - 1 + tnsv%NSV_ELECBEG + 2), <span class="stringliteral">&#39;SEDI&#39;</span>, zqrs(:,:) * prhodj(:,:) )</div>
<div class="line"><a id="l00872" name="l00872"></a><span class="lineno">  872</span>      <span class="keywordflow">IF</span> ( limap%LSEDI ) &amp;</div>
<div class="line"><a id="l00873" name="l00873"></a><span class="lineno">  873</span>        <span class="keyword">CALL </span>budget_store_init_phy(d, tbudgets(nbudget_sv1 - 1 + tnsv%NSV_ELECBEG + 3), <span class="stringliteral">&#39;SEDI&#39;</span>, zqis(:,:) * prhodj(:,:) )</div>
<div class="line"><a id="l00874" name="l00874"></a><span class="lineno">  874</span>      <span class="keyword">CALL </span>budget_store_init_phy(d, tbudgets(nbudget_sv1 - 1 + tnsv%NSV_ELECBEG + 4), <span class="stringliteral">&#39;SEDI&#39;</span>, zqss(:,:) * prhodj(:,:) )</div>
<div class="line"><a id="l00875" name="l00875"></a><span class="lineno">  875</span>      <span class="keyword">CALL </span>budget_store_init_phy(d, tbudgets(nbudget_sv1 - 1 + tnsv%NSV_ELECBEG + 5), <span class="stringliteral">&#39;SEDI&#39;</span>, zqgs(:,:) * prhodj(:,:) )</div>
<div class="line"><a id="l00876" name="l00876"></a><span class="lineno">  876</span>      <span class="keywordflow">IF</span> (limap%NMOM_H .GE. 1) &amp;</div>
<div class="line"><a id="l00877" name="l00877"></a><span class="lineno">  877</span>        <span class="keyword">CALL </span>budget_store_init_phy(d, tbudgets(nbudget_sv1 - 1 + tnsv%NSV_ELECBEG + 6), <span class="stringliteral">&#39;SEDI&#39;</span>, zqhs(:,:) * prhodj(:,:) )</div>
<div class="line"><a id="l00878" name="l00878"></a><span class="lineno">  878</span><span class="keywordflow">    END IF</span></div>
<div class="line"><a id="l00879" name="l00879"></a><span class="lineno">  879</span><span class="keywordflow">  END IF</span></div>
<div class="line"><a id="l00880" name="l00880"></a><span class="lineno">  880</span><span class="keywordflow">END IF</span></div>
<div class="line"><a id="l00881" name="l00881"></a><span class="lineno">  881</span><span class="comment">!</span></div>
<div class="line"><a id="l00882" name="l00882"></a><span class="lineno">  882</span>pfpr(:,:,:)=0.</div>
<div class="line"><a id="l00883" name="l00883"></a><span class="lineno">  883</span><span class="comment">!</span></div>
<div class="line"><a id="l00884" name="l00884"></a><span class="lineno">  884</span><span class="comment">! sedimentation of cloud droplets</span></div>
<div class="line"><a id="l00885" name="l00885"></a><span class="lineno">  885</span>zrt_sum = (zrvs + zrcs + zrrs + zris + zrss + zrgs + zrhs)*ptstep</div>
<div class="line"><a id="l00886" name="l00886"></a><span class="lineno">  886</span>zcpt    = cst%XCPD + (cst%XCPV * zrvs + cst%XCL * (zrcs + zrrs) + cst%XCI * (zris + zrss + zrgs + zrhs))*ptstep</div>
<div class="line"><a id="l00887" name="l00887"></a><span class="lineno">  887</span><span class="keywordflow">IF</span> (limap%NMOM_C.GE.1 .AND. limap%LSEDC) <span class="keywordflow">THEN</span></div>
<div class="line"><a id="l00888" name="l00888"></a><span class="lineno">  888</span>  <span class="keywordflow">IF</span> (oelec) <span class="keywordflow">THEN</span></div>
<div class="line"><a id="l00889" name="l00889"></a><span class="lineno">  889</span>    <span class="keyword">CALL </span>lima_sedimentation(limap, limaw, limac, limam, d, cst, &amp;</div>
<div class="line"><a id="l00890" name="l00890"></a><span class="lineno">  890</span>         <span class="stringliteral">&#39;L&#39;</span>, 2, 2, 0, 1, ptstep, oelec, elecp, elecd, &amp;</div>
<div class="line"><a id="l00891" name="l00891"></a><span class="lineno">  891</span>         pdzz, prhodref, pthvrefzikb, ppabst, zt, zrt_sum, zcpt, &amp;</div>
<div class="line"><a id="l00892" name="l00892"></a><span class="lineno">  892</span>                            zrcs, zccs, pinprc, pfpr(:,:,2), pefieldw, zqcs)</div>
<div class="line"><a id="l00893" name="l00893"></a><span class="lineno">  893</span>  <span class="keywordflow">ELSE</span></div>
<div class="line"><a id="l00894" name="l00894"></a><span class="lineno">  894</span>    <span class="keyword">CALL </span>lima_sedimentation(limap, limaw, limac, limam, d, cst, &amp;</div>
<div class="line"><a id="l00895" name="l00895"></a><span class="lineno">  895</span>         <span class="stringliteral">&#39;L&#39;</span>, 2, 2, 0, 1, ptstep, oelec, elecp, elecd, &amp;</div>
<div class="line"><a id="l00896" name="l00896"></a><span class="lineno">  896</span>         pdzz, prhodref, pthvrefzikb, ppabst, zt, zrt_sum, zcpt, &amp;</div>
<div class="line"><a id="l00897" name="l00897"></a><span class="lineno">  897</span>                            zrcs, zccs, pinprc, pfpr(:,:,2))</div>
<div class="line"><a id="l00898" name="l00898"></a><span class="lineno">  898</span><span class="keywordflow">  END IF</span></div>
<div class="line"><a id="l00899" name="l00899"></a><span class="lineno">  899</span><span class="keywordflow">END IF</span></div>
<div class="line"><a id="l00900" name="l00900"></a><span class="lineno">  900</span><span class="comment">!</span></div>
<div class="line"><a id="l00901" name="l00901"></a><span class="lineno">  901</span><span class="comment">! sedimentation of raindrops</span></div>
<div class="line"><a id="l00902" name="l00902"></a><span class="lineno">  902</span>zrt_sum = (zrvs + zrcs + zrrs + zris + zrss + zrgs + zrhs)*ptstep</div>
<div class="line"><a id="l00903" name="l00903"></a><span class="lineno">  903</span>zcpt    = cst%XCPD + (cst%XCPV * zrvs + cst%XCL * (zrcs + zrrs) + cst%XCI * (zris + zrss + zrgs + zrhs))*ptstep</div>
<div class="line"><a id="l00904" name="l00904"></a><span class="lineno">  904</span><span class="keywordflow">IF</span> (limap%NMOM_R.GE.1) <span class="keywordflow">THEN</span></div>
<div class="line"><a id="l00905" name="l00905"></a><span class="lineno">  905</span>  <span class="keywordflow">IF</span> (oelec) <span class="keywordflow">THEN</span></div>
<div class="line"><a id="l00906" name="l00906"></a><span class="lineno">  906</span>    <span class="keyword">CALL </span>lima_sedimentation(limap, limaw, limac, limam, d, cst, &amp;</div>
<div class="line"><a id="l00907" name="l00907"></a><span class="lineno">  907</span>         <span class="stringliteral">&#39;L&#39;</span>, limap%NMOM_R, 3, 0, 1, ptstep, oelec, elecp, elecd, &amp;</div>
<div class="line"><a id="l00908" name="l00908"></a><span class="lineno">  908</span>         pdzz, prhodref, pthvrefzikb,ppabst, zt, zrt_sum, zcpt, &amp;</div>
<div class="line"><a id="l00909" name="l00909"></a><span class="lineno">  909</span>                            zrrs, zcrs, pinprr, pfpr(:,:,3), pefieldw, zqrs)</div>
<div class="line"><a id="l00910" name="l00910"></a><span class="lineno">  910</span>  <span class="keywordflow">ELSE</span></div>
<div class="line"><a id="l00911" name="l00911"></a><span class="lineno">  911</span>    <span class="keyword">CALL </span>lima_sedimentation(limap, limaw, limac, limam, d, cst, &amp;</div>
<div class="line"><a id="l00912" name="l00912"></a><span class="lineno">  912</span>         <span class="stringliteral">&#39;L&#39;</span>, limap%NMOM_R, 3, 0, 1, ptstep, oelec, elecp, elecd, &amp;</div>
<div class="line"><a id="l00913" name="l00913"></a><span class="lineno">  913</span>         pdzz, prhodref,pthvrefzikb, ppabst, zt, zrt_sum, zcpt, &amp;</div>
<div class="line"><a id="l00914" name="l00914"></a><span class="lineno">  914</span>                            zrrs, zcrs, pinprr, pfpr(:,:,3))</div>
<div class="line"><a id="l00915" name="l00915"></a><span class="lineno">  915</span><span class="keywordflow">  END IF</span></div>
<div class="line"><a id="l00916" name="l00916"></a><span class="lineno">  916</span><span class="keywordflow">END IF</span></div>
<div class="line"><a id="l00917" name="l00917"></a><span class="lineno">  917</span><span class="comment">!</span></div>
<div class="line"><a id="l00918" name="l00918"></a><span class="lineno">  918</span><span class="comment">! sedimentation of ice crystals</span></div>
<div class="line"><a id="l00919" name="l00919"></a><span class="lineno">  919</span>zrt_sum = (zrvs + zrcs + zrrs + zris + zrss + zrgs + zrhs)*ptstep</div>
<div class="line"><a id="l00920" name="l00920"></a><span class="lineno">  920</span>zcpt    = cst%XCPD + (cst%XCPV * zrvs + cst%XCL * (zrcs + zrrs) + cst%XCI * (zris + zrss + zrgs + zrhs))*ptstep</div>
<div class="line"><a id="l00921" name="l00921"></a><span class="lineno">  921</span><span class="keywordflow">IF</span> (limap%NMOM_I.GE.1 .AND. limap%LSEDI) <span class="keywordflow">THEN</span></div>
<div class="line"><a id="l00922" name="l00922"></a><span class="lineno">  922</span>  <span class="keywordflow">IF</span> (oelec) <span class="keywordflow">THEN</span></div>
<div class="line"><a id="l00923" name="l00923"></a><span class="lineno">  923</span>    <span class="keyword">CALL </span>lima_sedimentation(limap, limaw, limac, limam, d, cst, &amp;</div>
<div class="line"><a id="l00924" name="l00924"></a><span class="lineno">  924</span>         <span class="stringliteral">&#39;I&#39;</span>, limap%NMOM_I, 4, 0, 1, ptstep, oelec, elecp, elecd, &amp;</div>
<div class="line"><a id="l00925" name="l00925"></a><span class="lineno">  925</span>         pdzz, prhodref,pthvrefzikb, ppabst, zt, zrt_sum, zcpt, &amp;</div>
<div class="line"><a id="l00926" name="l00926"></a><span class="lineno">  926</span>                            zris, zcis, zw2d, pfpr(:,:,4), pefieldw, zqis)</div>
<div class="line"><a id="l00927" name="l00927"></a><span class="lineno">  927</span>  <span class="keywordflow">ELSE</span></div>
<div class="line"><a id="l00928" name="l00928"></a><span class="lineno">  928</span>    <span class="keywordflow">IF</span> (.NOT. limap%LCRYSTAL_SHAPE) <span class="keywordflow">THEN</span></div>
<div class="line"><a id="l00929" name="l00929"></a><span class="lineno">  929</span>    <span class="keyword">CALL </span>lima_sedimentation(limap, limaw, limac, limam, d, cst, &amp;</div>
<div class="line"><a id="l00930" name="l00930"></a><span class="lineno">  930</span>         <span class="stringliteral">&#39;I&#39;</span>, limap%NMOM_I, 4, 0, 1, ptstep, oelec, elecp, elecd, &amp;</div>
<div class="line"><a id="l00931" name="l00931"></a><span class="lineno">  931</span>         pdzz, prhodref,pthvrefzikb, ppabst, zt, zrt_sum, zcpt, &amp;</div>
<div class="line"><a id="l00932" name="l00932"></a><span class="lineno">  932</span>                            zris, zcis, zw2d, pfpr(:,:,4))</div>
<div class="line"><a id="l00933" name="l00933"></a><span class="lineno">  933</span>    <span class="keywordflow">ELSE</span></div>
<div class="line"><a id="l00934" name="l00934"></a><span class="lineno">  934</span>      <span class="keyword">ALLOCATE</span>(zlbdai_shape(d%NIJT,d%NKT,limap%NNB_CRYSTAL_SHAPE))</div>
<div class="line"><a id="l00935" name="l00935"></a><span class="lineno">  935</span>      <span class="keyword">CALL </span>lima_shape_compute_lbda_3d(d, limap, limac, zris, zcis_shape, zris_shape, zlbdai_shape)</div>
<div class="line"><a id="l00936" name="l00936"></a><span class="lineno">  936</span>      <span class="keywordflow">DO</span> ish = 1, limap%NNB_CRYSTAL_SHAPE</div>
<div class="line"><a id="l00937" name="l00937"></a><span class="lineno">  937</span>        <span class="keyword">CALL </span>lima_sedimentation(limap, limaw, limac, limam, d, cst, &amp;</div>
<div class="line"><a id="l00938" name="l00938"></a><span class="lineno">  938</span>             <span class="stringliteral">&#39;I&#39;</span>, limap%NMOM_I, 4, ish, 1, ptstep, oelec, elecp, elecd, &amp;</div>
<div class="line"><a id="l00939" name="l00939"></a><span class="lineno">  939</span>             pdzz, prhodref,pthvrefzikb, ppabst, zt, zrt_sum, zcpt, &amp;</div>
<div class="line"><a id="l00940" name="l00940"></a><span class="lineno">  940</span>             zris_shape(:,:,ish), zcis_shape(:,:,ish), zw2d, pfpr(:,:,4), &amp;</div>
<div class="line"><a id="l00941" name="l00941"></a><span class="lineno">  941</span>             plbdai_shape=zlbdai_shape(:,:,ish))</div>
<div class="line"><a id="l00942" name="l00942"></a><span class="lineno">  942</span><span class="keywordflow">      END DO</span></div>
<div class="line"><a id="l00943" name="l00943"></a><span class="lineno">  943</span>      zcis = sum(zcis_shape,dim=3)</div>
<div class="line"><a id="l00944" name="l00944"></a><span class="lineno">  944</span>      zris = sum(zris_shape,dim=3)</div>
<div class="line"><a id="l00945" name="l00945"></a><span class="lineno">  945</span>      <span class="keyword">DEALLOCATE</span>(zlbdai_shape)</div>
<div class="line"><a id="l00946" name="l00946"></a><span class="lineno">  946</span><span class="keywordflow">    END IF</span></div>
<div class="line"><a id="l00947" name="l00947"></a><span class="lineno">  947</span><span class="keywordflow">  END IF</span></div>
<div class="line"><a id="l00948" name="l00948"></a><span class="lineno">  948</span><span class="keywordflow">END IF</span></div>
<div class="line"><a id="l00949" name="l00949"></a><span class="lineno">  949</span><span class="comment">!</span></div>
<div class="line"><a id="l00950" name="l00950"></a><span class="lineno">  950</span><span class="comment">! sedimentation of snow/aggregates</span></div>
<div class="line"><a id="l00951" name="l00951"></a><span class="lineno">  951</span>zrt_sum = (zrvs + zrcs + zrrs + zris + zrss + zrgs + zrhs)*ptstep</div>
<div class="line"><a id="l00952" name="l00952"></a><span class="lineno">  952</span>zcpt    = cst%XCPD + (cst%XCPV * zrvs + cst%XCL * (zrcs + zrrs) + cst%XCI * (zris + zrss + zrgs + zrhs))*ptstep</div>
<div class="line"><a id="l00953" name="l00953"></a><span class="lineno">  953</span><span class="keywordflow">IF</span> (limap%NMOM_S.GE.1) <span class="keywordflow">THEN</span></div>
<div class="line"><a id="l00954" name="l00954"></a><span class="lineno">  954</span>  <span class="keywordflow">IF</span> (oelec) <span class="keywordflow">THEN</span></div>
<div class="line"><a id="l00955" name="l00955"></a><span class="lineno">  955</span>    <span class="keyword">CALL </span>lima_sedimentation(limap, limaw, limac, limam, d, cst, &amp;</div>
<div class="line"><a id="l00956" name="l00956"></a><span class="lineno">  956</span>         <span class="stringliteral">&#39;I&#39;</span>, limap%NMOM_S, 5, 0, 1, ptstep, oelec, elecp, elecd, &amp;</div>
<div class="line"><a id="l00957" name="l00957"></a><span class="lineno">  957</span>         pdzz, prhodref, pthvrefzikb, ppabst, zt, zrt_sum, zcpt, &amp;</div>
<div class="line"><a id="l00958" name="l00958"></a><span class="lineno">  958</span>                            zrss, zcss, pinprs, pfpr(:,:,5), pefieldw, zqss)</div>
<div class="line"><a id="l00959" name="l00959"></a><span class="lineno">  959</span>  <span class="keywordflow">ELSE</span></div>
<div class="line"><a id="l00960" name="l00960"></a><span class="lineno">  960</span>    <span class="keyword">CALL </span>lima_sedimentation(limap, limaw, limac, limam, d, cst, &amp;</div>
<div class="line"><a id="l00961" name="l00961"></a><span class="lineno">  961</span>         <span class="stringliteral">&#39;I&#39;</span>, limap%NMOM_S, 5, 0, 1, ptstep, oelec, elecp, elecd, &amp;</div>
<div class="line"><a id="l00962" name="l00962"></a><span class="lineno">  962</span>         pdzz, prhodref, pthvrefzikb, ppabst,zt, zrt_sum, zcpt, &amp;</div>
<div class="line"><a id="l00963" name="l00963"></a><span class="lineno">  963</span>                            zrss, zcss, pinprs, pfpr(:,:,5))</div>
<div class="line"><a id="l00964" name="l00964"></a><span class="lineno">  964</span><span class="keywordflow">  END IF</span></div>
<div class="line"><a id="l00965" name="l00965"></a><span class="lineno">  965</span><span class="keywordflow">END IF</span></div>
<div class="line"><a id="l00966" name="l00966"></a><span class="lineno">  966</span><span class="comment">!</span></div>
<div class="line"><a id="l00967" name="l00967"></a><span class="lineno">  967</span><span class="comment">! sedimentation of graupel</span></div>
<div class="line"><a id="l00968" name="l00968"></a><span class="lineno">  968</span>zrt_sum = (zrvs + zrcs + zrrs + zris + zrss + zrgs + zrhs)*ptstep</div>
<div class="line"><a id="l00969" name="l00969"></a><span class="lineno">  969</span>zcpt    = cst%XCPD + (cst%XCPV * zrvs + cst%XCL * (zrcs + zrrs) + cst%XCI * (zris + zrss + zrgs + zrhs))*ptstep</div>
<div class="line"><a id="l00970" name="l00970"></a><span class="lineno">  970</span><span class="keywordflow">IF</span> (limap%NMOM_G.GE.1) <span class="keywordflow">THEN</span></div>
<div class="line"><a id="l00971" name="l00971"></a><span class="lineno">  971</span>  <span class="keywordflow">IF</span> (oelec) <span class="keywordflow">THEN</span></div>
<div class="line"><a id="l00972" name="l00972"></a><span class="lineno">  972</span>    <span class="keyword">CALL </span>lima_sedimentation(limap, limaw, limac, limam, d, cst, &amp;</div>
<div class="line"><a id="l00973" name="l00973"></a><span class="lineno">  973</span>         <span class="stringliteral">&#39;I&#39;</span>, limap%NMOM_G, 6, 0, 1, ptstep, oelec, elecp, elecd, &amp;</div>
<div class="line"><a id="l00974" name="l00974"></a><span class="lineno">  974</span>         pdzz, prhodref, pthvrefzikb, ppabst, zt, zrt_sum, zcpt, &amp;</div>
<div class="line"><a id="l00975" name="l00975"></a><span class="lineno">  975</span>                            zrgs, zcgs, pinprg, pfpr(:,:,6), pefieldw, zqgs)</div>
<div class="line"><a id="l00976" name="l00976"></a><span class="lineno">  976</span>  <span class="keywordflow">ELSE</span></div>
<div class="line"><a id="l00977" name="l00977"></a><span class="lineno">  977</span>    <span class="keyword">CALL </span>lima_sedimentation(limap, limaw, limac, limam, d, cst, &amp;</div>
<div class="line"><a id="l00978" name="l00978"></a><span class="lineno">  978</span>         <span class="stringliteral">&#39;I&#39;</span>, limap%NMOM_G, 6, 0, 1, ptstep, oelec, elecp, elecd, &amp;</div>
<div class="line"><a id="l00979" name="l00979"></a><span class="lineno">  979</span>         pdzz, prhodref, pthvrefzikb, ppabst, zt, zrt_sum, zcpt, &amp;</div>
<div class="line"><a id="l00980" name="l00980"></a><span class="lineno">  980</span>                            zrgs, zcgs, pinprg, pfpr(:,:,6))</div>
<div class="line"><a id="l00981" name="l00981"></a><span class="lineno">  981</span><span class="keywordflow">  END IF</span></div>
<div class="line"><a id="l00982" name="l00982"></a><span class="lineno">  982</span><span class="keywordflow">END IF</span></div>
<div class="line"><a id="l00983" name="l00983"></a><span class="lineno">  983</span><span class="comment">!</span></div>
<div class="line"><a id="l00984" name="l00984"></a><span class="lineno">  984</span><span class="comment">! sedimentation of hail</span></div>
<div class="line"><a id="l00985" name="l00985"></a><span class="lineno">  985</span>zrt_sum = (zrvs + zrcs + zrrs + zris + zrss + zrgs + zrhs)*ptstep</div>
<div class="line"><a id="l00986" name="l00986"></a><span class="lineno">  986</span>zcpt    = cst%XCPD + (cst%XCPV * zrvs + cst%XCL * (zrcs + zrrs) + cst%XCI * (zris + zrss + zrgs + zrhs))*ptstep</div>
<div class="line"><a id="l00987" name="l00987"></a><span class="lineno">  987</span><span class="keywordflow">IF</span> (limap%NMOM_H.GE.1) <span class="keywordflow">THEN</span></div>
<div class="line"><a id="l00988" name="l00988"></a><span class="lineno">  988</span>  <span class="keywordflow">IF</span> (oelec) <span class="keywordflow">THEN</span></div>
<div class="line"><a id="l00989" name="l00989"></a><span class="lineno">  989</span>    <span class="keyword">CALL </span>lima_sedimentation(limap, limaw, limac, limam, d, cst, &amp;</div>
<div class="line"><a id="l00990" name="l00990"></a><span class="lineno">  990</span>         <span class="stringliteral">&#39;I&#39;</span>, limap%NMOM_H, 7, 0, 1, ptstep, oelec, elecp, elecd, &amp;</div>
<div class="line"><a id="l00991" name="l00991"></a><span class="lineno">  991</span>         pdzz, prhodref, pthvrefzikb, ppabst, zt, zrt_sum, zcpt, &amp;</div>
<div class="line"><a id="l00992" name="l00992"></a><span class="lineno">  992</span>                            zrhs, zchs, pinprh, pfpr(:,:,7), pefieldw, zqhs)</div>
<div class="line"><a id="l00993" name="l00993"></a><span class="lineno">  993</span>  <span class="keywordflow">ELSE</span></div>
<div class="line"><a id="l00994" name="l00994"></a><span class="lineno">  994</span>    <span class="keyword">CALL </span>lima_sedimentation(limap, limaw, limac, limam, d, cst, &amp;</div>
<div class="line"><a id="l00995" name="l00995"></a><span class="lineno">  995</span>         <span class="stringliteral">&#39;I&#39;</span>, limap%NMOM_H, 7, 0, 1, ptstep, oelec, elecp, elecd, &amp;</div>
<div class="line"><a id="l00996" name="l00996"></a><span class="lineno">  996</span>         pdzz, prhodref, pthvrefzikb, ppabst, zt, zrt_sum, zcpt, &amp;</div>
<div class="line"><a id="l00997" name="l00997"></a><span class="lineno">  997</span>                            zrhs, zchs, pinprh, pfpr(:,:,7))</div>
<div class="line"><a id="l00998" name="l00998"></a><span class="lineno">  998</span><span class="keywordflow">  END IF</span></div>
<div class="line"><a id="l00999" name="l00999"></a><span class="lineno">  999</span><span class="keywordflow">END IF</span></div>
<div class="line"><a id="l01000" name="l01000"></a><span class="lineno"> 1000</span><span class="comment">!</span></div>
<div class="line"><a id="l01001" name="l01001"></a><span class="lineno"> 1001</span>zths(:,:) = zt(:,:) / zexn(:,:) * zinv_tstep</div>
<div class="line"><a id="l01002" name="l01002"></a><span class="lineno"> 1002</span><span class="comment">!</span></div>
<div class="line"><a id="l01003" name="l01003"></a><span class="lineno"> 1003</span><span class="comment">! Call budgets</span></div>
<div class="line"><a id="l01004" name="l01004"></a><span class="lineno"> 1004</span><span class="comment">!</span></div>
<div class="line"><a id="l01005" name="l01005"></a><span class="lineno"> 1005</span><span class="keywordflow">IF</span> ( buconf%LBU_ENABLE ) <span class="keywordflow">then</span></div>
<div class="line"><a id="l01006" name="l01006"></a><span class="lineno"> 1006</span>  <span class="keywordflow">IF</span> ( buconf%LBUDGET_TH ) &amp;</div>
<div class="line"><a id="l01007" name="l01007"></a><span class="lineno"> 1007</span>       <span class="keyword">CALL </span>budget_store_end_phy(d, tbudgets(nbudget_th), <span class="stringliteral">&#39;SEDI&#39;</span>, zths(:,:) * prhodj(:,:) )</div>
<div class="line"><a id="l01008" name="l01008"></a><span class="lineno"> 1008</span>  <span class="keywordflow">IF</span> ( buconf%LBUDGET_RC .AND. limap%NMOM_C.GE.1 .AND. limap%LSEDC ) &amp;</div>
<div class="line"><a id="l01009" name="l01009"></a><span class="lineno"> 1009</span>       <span class="keyword">CALL </span>budget_store_end_phy(d, tbudgets(nbudget_rc), <span class="stringliteral">&#39;SEDI&#39;</span>, zrcs(:,:) * prhodj(:,:) )</div>
<div class="line"><a id="l01010" name="l01010"></a><span class="lineno"> 1010</span>  <span class="keywordflow">IF</span> ( buconf%LBUDGET_RR .AND. limap%NMOM_R.GE.1 ) &amp;</div>
<div class="line"><a id="l01011" name="l01011"></a><span class="lineno"> 1011</span>       <span class="keyword">CALL </span>budget_store_end_phy(d, tbudgets(nbudget_rr), <span class="stringliteral">&#39;SEDI&#39;</span>, zrrs(:,:) * prhodj(:,:) )</div>
<div class="line"><a id="l01012" name="l01012"></a><span class="lineno"> 1012</span>  <span class="keywordflow">IF</span> ( buconf%LBUDGET_RI .AND. limap%NMOM_I.GE.1 .AND. limap%LSEDI ) &amp;</div>
<div class="line"><a id="l01013" name="l01013"></a><span class="lineno"> 1013</span>       <span class="keyword">CALL </span>budget_store_end_phy(d, tbudgets(nbudget_ri), <span class="stringliteral">&#39;SEDI&#39;</span>, zris(:,:) * prhodj(:,:) )</div>
<div class="line"><a id="l01014" name="l01014"></a><span class="lineno"> 1014</span>  <span class="keywordflow">IF</span> ( buconf%LBUDGET_RS .AND. limap%NMOM_S.GE.1 ) &amp;</div>
<div class="line"><a id="l01015" name="l01015"></a><span class="lineno"> 1015</span>       <span class="keyword">CALL </span>budget_store_end_phy(d, tbudgets(nbudget_rs), <span class="stringliteral">&#39;SEDI&#39;</span>, zrss(:,:) * prhodj(:,:) )</div>
<div class="line"><a id="l01016" name="l01016"></a><span class="lineno"> 1016</span>  <span class="keywordflow">IF</span> ( buconf%LBUDGET_RG .AND. limap%NMOM_G.GE.1 ) &amp;</div>
<div class="line"><a id="l01017" name="l01017"></a><span class="lineno"> 1017</span>       <span class="keyword">CALL </span>budget_store_end_phy(d, tbudgets(nbudget_rg), <span class="stringliteral">&#39;SEDI&#39;</span>, zrgs(:,:) * prhodj(:,:) )</div>
<div class="line"><a id="l01018" name="l01018"></a><span class="lineno"> 1018</span>  <span class="keywordflow">IF</span> ( buconf%LBUDGET_RH .AND. limap%NMOM_H.GE.1 ) &amp;</div>
<div class="line"><a id="l01019" name="l01019"></a><span class="lineno"> 1019</span>       <span class="keyword">CALL </span>budget_store_end_phy(d, tbudgets(nbudget_rh), <span class="stringliteral">&#39;SEDI&#39;</span>, zrhs(:,:) * prhodj(:,:) )</div>
<div class="line"><a id="l01020" name="l01020"></a><span class="lineno"> 1020</span>  <span class="keywordflow">IF</span> ( buconf%LBUDGET_SV ) <span class="keywordflow">then</span></div>
<div class="line"><a id="l01021" name="l01021"></a><span class="lineno"> 1021</span>    <span class="keywordflow">IF</span> ( limap%LSEDC .AND. limap%NMOM_C.GE.2 ) &amp;</div>
<div class="line"><a id="l01022" name="l01022"></a><span class="lineno"> 1022</span>      <span class="keyword">CALL </span>budget_store_end_phy(d, tbudgets(nbudget_sv1 - 1 + tnsv%NSV_LIMA_NC), <span class="stringliteral">&#39;SEDI&#39;</span>, zccs(:,:) * prhodj(:,:) )</div>
<div class="line"><a id="l01023" name="l01023"></a><span class="lineno"> 1023</span>    <span class="keywordflow">IF</span> ( limap%NMOM_R.GE.2 ) &amp;</div>
<div class="line"><a id="l01024" name="l01024"></a><span class="lineno"> 1024</span>      <span class="keyword">CALL </span>budget_store_end_phy(d, tbudgets(nbudget_sv1 - 1 + tnsv%NSV_LIMA_NR), <span class="stringliteral">&#39;SEDI&#39;</span>, zcrs(:,:) * prhodj(:,:) )</div>
<div class="line"><a id="l01025" name="l01025"></a><span class="lineno"> 1025</span>    <span class="keywordflow">IF</span> ( limap%LSEDI .AND. limap%NMOM_I.GE.2 ) <span class="keywordflow">THEN</span></div>
<div class="line"><a id="l01026" name="l01026"></a><span class="lineno"> 1026</span>      <span class="keywordflow">IF</span> (.NOT. limap%LCRYSTAL_SHAPE) <span class="keywordflow">THEN</span></div>
<div class="line"><a id="l01027" name="l01027"></a><span class="lineno"> 1027</span>      <span class="keyword">CALL </span>budget_store_end_phy(d, tbudgets(nbudget_sv1 - 1 + tnsv%NSV_LIMA_NI), <span class="stringliteral">&#39;SEDI&#39;</span>, zcis(:,:) * prhodj(:,:) )</div>
<div class="line"><a id="l01028" name="l01028"></a><span class="lineno"> 1028</span>      <span class="keywordflow">ELSE</span></div>
<div class="line"><a id="l01029" name="l01029"></a><span class="lineno"> 1029</span>        <span class="keywordflow">DO</span> ish = 1, limap%NNB_CRYSTAL_SHAPE</div>
<div class="line"><a id="l01030" name="l01030"></a><span class="lineno"> 1030</span>          <span class="keyword">CALL </span>budget_store_end_phy(d, tbudgets(nbudget_sv1 - 1 + tnsv%NSV_LIMA_NI + ish - 1), <span class="stringliteral">&#39;SEDI&#39;</span>, &amp;</div>
<div class="line"><a id="l01031" name="l01031"></a><span class="lineno"> 1031</span>                                    zcis_shape( :, :, ish) * prhodj( :, :) )</div>
<div class="line"><a id="l01032" name="l01032"></a><span class="lineno"> 1032</span><span class="keywordflow">        END DO</span></div>
<div class="line"><a id="l01033" name="l01033"></a><span class="lineno"> 1033</span><span class="keywordflow">      END IF</span></div>
<div class="line"><a id="l01034" name="l01034"></a><span class="lineno"> 1034</span><span class="keywordflow">    END IF</span></div>
<div class="line"><a id="l01035" name="l01035"></a><span class="lineno"> 1035</span>    <span class="keywordflow">IF</span> ( limap%NMOM_S.GE.2 ) &amp;</div>
<div class="line"><a id="l01036" name="l01036"></a><span class="lineno"> 1036</span>      <span class="keyword">CALL </span>budget_store_end_phy(d, tbudgets(nbudget_sv1 - 1 + tnsv%NSV_LIMA_NS), <span class="stringliteral">&#39;SEDI&#39;</span>, zcss(:,:) * prhodj(:,:) )</div>
<div class="line"><a id="l01037" name="l01037"></a><span class="lineno"> 1037</span>    <span class="keywordflow">IF</span> ( limap%NMOM_G.GE.2 ) &amp;</div>
<div class="line"><a id="l01038" name="l01038"></a><span class="lineno"> 1038</span>      <span class="keyword">CALL </span>budget_store_end_phy(d, tbudgets(nbudget_sv1 - 1 + tnsv%NSV_LIMA_NG), <span class="stringliteral">&#39;SEDI&#39;</span>, zcgs(:,:) * prhodj(:,:) )</div>
<div class="line"><a id="l01039" name="l01039"></a><span class="lineno"> 1039</span>    <span class="keywordflow">IF</span> ( limap%NMOM_H.GE.2 ) &amp;</div>
<div class="line"><a id="l01040" name="l01040"></a><span class="lineno"> 1040</span>      <span class="keyword">CALL </span>budget_store_end_phy(d, tbudgets(nbudget_sv1 - 1 + tnsv%NSV_LIMA_NH), <span class="stringliteral">&#39;SEDI&#39;</span>, zchs(:,:) * prhodj(:,:) )</div>
<div class="line"><a id="l01041" name="l01041"></a><span class="lineno"> 1041</span><span class="comment">!</span></div>
<div class="line"><a id="l01042" name="l01042"></a><span class="lineno"> 1042</span>    <span class="keywordflow">IF</span> (oelec) <span class="keywordflow">then</span></div>
<div class="line"><a id="l01043" name="l01043"></a><span class="lineno"> 1043</span>      <span class="keywordflow">IF</span> ( limap%LSEDC ) &amp;</div>
<div class="line"><a id="l01044" name="l01044"></a><span class="lineno"> 1044</span>        <span class="keyword">CALL </span>budget_store_end_phy(d, tbudgets(nbudget_sv1 - 1 + tnsv%NSV_ELECBEG + 1), <span class="stringliteral">&#39;SEDI&#39;</span>, zqcs(:,:) * prhodj(:,:) )</div>
<div class="line"><a id="l01045" name="l01045"></a><span class="lineno"> 1045</span>      <span class="keyword">CALL </span>budget_store_end_phy(d, tbudgets(nbudget_sv1 - 1 + tnsv%NSV_ELECBEG + 2), <span class="stringliteral">&#39;SEDI&#39;</span>, zqrs(:,:) * prhodj(:,:) )</div>
<div class="line"><a id="l01046" name="l01046"></a><span class="lineno"> 1046</span>      <span class="keywordflow">IF</span> ( limap%LSEDI ) &amp;</div>
<div class="line"><a id="l01047" name="l01047"></a><span class="lineno"> 1047</span>        <span class="keyword">CALL </span>budget_store_end_phy(d, tbudgets(nbudget_sv1 - 1 + tnsv%NSV_ELECBEG + 3), <span class="stringliteral">&#39;SEDI&#39;</span>, zqis(:,:) * prhodj(:,:) )</div>
<div class="line"><a id="l01048" name="l01048"></a><span class="lineno"> 1048</span>      <span class="keyword">CALL </span>budget_store_end_phy(d, tbudgets(nbudget_sv1 - 1 + tnsv%NSV_ELECBEG + 4), <span class="stringliteral">&#39;SEDI&#39;</span>, zqss(:,:) * prhodj(:,:) )</div>
<div class="line"><a id="l01049" name="l01049"></a><span class="lineno"> 1049</span>      <span class="keyword">CALL </span>budget_store_end_phy(d, tbudgets(nbudget_sv1 - 1 + tnsv%NSV_ELECBEG + 5), <span class="stringliteral">&#39;SEDI&#39;</span>, zqgs(:,:) * prhodj(:,:) )</div>
<div class="line"><a id="l01050" name="l01050"></a><span class="lineno"> 1050</span>      <span class="keywordflow">IF</span> (limap%NMOM_H .GE. 1) &amp;</div>
<div class="line"><a id="l01051" name="l01051"></a><span class="lineno"> 1051</span>        <span class="keyword">CALL </span>budget_store_end_phy(d, tbudgets(nbudget_sv1 - 1 + tnsv%NSV_ELECBEG + 6), <span class="stringliteral">&#39;SEDI&#39;</span>, zqhs(:,:) * prhodj(:,:) )</div>
<div class="line"><a id="l01052" name="l01052"></a><span class="lineno"> 1052</span><span class="keywordflow">    END IF</span></div>
<div class="line"><a id="l01053" name="l01053"></a><span class="lineno"> 1053</span><span class="keywordflow">  END IF</span></div>
<div class="line"><a id="l01054" name="l01054"></a><span class="lineno"> 1054</span><span class="keywordflow">END IF</span></div>
<div class="line"><a id="l01055" name="l01055"></a><span class="lineno"> 1055</span><span class="comment">!</span></div>
<div class="line"><a id="l01056" name="l01056"></a><span class="lineno"> 1056</span><span class="comment">! 1.bis Deposition at 1st level above ground</span></div>
<div class="line"><a id="l01057" name="l01057"></a><span class="lineno"> 1057</span><span class="comment">!</span></div>
<div class="line"><a id="l01058" name="l01058"></a><span class="lineno"> 1058</span><span class="keywordflow">IF</span> (limap%NMOM_C.GE.1 .AND. limap%LDEPOC) <span class="keywordflow">THEN</span></div>
<div class="line"><a id="l01059" name="l01059"></a><span class="lineno"> 1059</span>  <span class="keywordflow">IF</span> ( buconf%LBUDGET_RC ) <span class="keyword">CALL </span>budget_store_init_phy(d, tbudgets(nbudget_rc), <span class="stringliteral">&#39;DEPO&#39;</span>, zrcs(:,:) * prhodj(:,:) )</div>
<div class="line"><a id="l01060" name="l01060"></a><span class="lineno"> 1060</span>  <span class="keywordflow">IF</span> ( buconf%LBUDGET_SV .AND. limap%NMOM_C.GE.2) &amp;</div>
<div class="line"><a id="l01061" name="l01061"></a><span class="lineno"> 1061</span>       <span class="keyword">CALL </span>budget_store_init_phy(d, tbudgets(nbudget_sv1 - 1 + tnsv%NSV_LIMA_NC), <span class="stringliteral">&#39;DEPO&#39;</span>, zccs(:,:) * prhodj(:,:) )</div>
<div class="line"><a id="l01062" name="l01062"></a><span class="lineno"> 1062</span> </div>
<div class="line"><a id="l01063" name="l01063"></a><span class="lineno"> 1063</span>  gdep(:) = .false.</div>
<div class="line"><a id="l01064" name="l01064"></a><span class="lineno"> 1064</span>  gdep(:) = zrcs(:,d%NKB) &gt;0 .AND. zccs(:,d%NKB) &gt;0 .AND. zrct(:,d%NKB) &gt;0 .AND. zcct(:,d%NKB) &gt;0</div>
<div class="line"><a id="l01065" name="l01065"></a><span class="lineno"> 1065</span>  <span class="keywordflow">WHERE</span> (gdep)</div>
<div class="line"><a id="l01066" name="l01066"></a><span class="lineno"> 1066</span>     zrcs(:,d%NKB) = zrcs(:,d%NKB) - limap%XVDEPOC * zrct(:,d%NKB) / pdzz(:,d%NKB)</div>
<div class="line"><a id="l01067" name="l01067"></a><span class="lineno"> 1067</span>     zccs(:,d%NKB) = zccs(:,d%NKB) - limap%XVDEPOC * zcct(:,d%NKB) / pdzz(:,d%NKB)</div>
<div class="line"><a id="l01068" name="l01068"></a><span class="lineno"> 1068</span>     pinprc(:) = pinprc(:) + limap%XVDEPOC * zrct(:,d%NKB) * prhodref(:,d%NKB) /cst%XRHOLW</div>
<div class="line"><a id="l01069" name="l01069"></a><span class="lineno"> 1069</span>     pindep(:) = limap%XVDEPOC * zrct(:,d%NKB) *  prhodref(:,d%NKB) /cst%XRHOLW</div>
<div class="line"><a id="l01070" name="l01070"></a><span class="lineno"> 1070</span><span class="keywordflow">  END WHERE</span></div>
<div class="line"><a id="l01071" name="l01071"></a><span class="lineno"> 1071</span> </div>
<div class="line"><a id="l01072" name="l01072"></a><span class="lineno"> 1072</span>  <span class="keywordflow">IF</span> ( buconf%LBUDGET_RC ) <span class="keyword">CALL </span>budget_store_end_phy(d, tbudgets(nbudget_rc), <span class="stringliteral">&#39;DEPO&#39;</span>, zrcs(:,:) * prhodj(:,:) )</div>
<div class="line"><a id="l01073" name="l01073"></a><span class="lineno"> 1073</span>  <span class="keywordflow">IF</span> ( buconf%LBUDGET_SV .AND. limap%NMOM_C.GE.2) &amp;</div>
<div class="line"><a id="l01074" name="l01074"></a><span class="lineno"> 1074</span>       <span class="keyword">CALL </span>budget_store_end_phy(d, tbudgets(nbudget_sv1 - 1 + tnsv%NSV_LIMA_NC), <span class="stringliteral">&#39;DEPO&#39;</span>, zccs(:,:) * prhodj(:,:) )</div>
<div class="line"><a id="l01075" name="l01075"></a><span class="lineno"> 1075</span><span class="keywordflow">END IF</span></div>
<div class="line"><a id="l01076" name="l01076"></a><span class="lineno"> 1076</span><span class="comment">!</span></div>
<div class="line"><a id="l01077" name="l01077"></a><span class="lineno"> 1077</span><span class="comment">!</span></div>
<div class="line"><a id="l01078" name="l01078"></a><span class="lineno"> 1078</span><span class="comment">!!$Z_RR_CVRC(:,:) = 0.</span></div>
<div class="line"><a id="l01079" name="l01079"></a><span class="lineno"> 1079</span><span class="comment">!!$Z_CR_CVRC(:,:) = 0.</span></div>
<div class="line"><a id="l01080" name="l01080"></a><span class="lineno"> 1080</span><span class="comment">!!$IF (LIMAP%NMOM_R.GE.2) THEN</span></div>
<div class="line"><a id="l01081" name="l01081"></a><span class="lineno"> 1081</span><span class="comment">!!$   if( BUCONF%LBU_ENABLE ) then</span></div>
<div class="line"><a id="l01082" name="l01082"></a><span class="lineno"> 1082</span><span class="comment">!!$    if ( BUCONF%lbudget_rc ) call BUDGET_STORE_INIT_PHY(D, TBUDGETS(NBUDGET_RC),                    &#39;R2C1&#39;, zrcs(:,:) * prhodj(:,:) )</span></div>
<div class="line"><a id="l01083" name="l01083"></a><span class="lineno"> 1083</span><span class="comment">!!$    if ( BUCONF%lbudget_rr ) call BUDGET_STORE_INIT_PHY(D, TBUDGETS(NBUDGET_RR),                    &#39;R2C1&#39;, zrrs(:,:) * prhodj(:,:) )</span></div>
<div class="line"><a id="l01084" name="l01084"></a><span class="lineno"> 1084</span><span class="comment">!!$    if ( BUCONF%lbudget_sv .and. nmom_c.ge.2) &amp;</span></div>
<div class="line"><a id="l01085" name="l01085"></a><span class="lineno"> 1085</span><span class="comment">!!$         call BUDGET_STORE_INIT_PHY(D, TBUDGETS(NBUDGET_SV1 - 1 + nsv_lima_nc), &#39;R2C1&#39;, zccs(:,:) * prhodj(:,:) )</span></div>
<div class="line"><a id="l01086" name="l01086"></a><span class="lineno"> 1086</span><span class="comment">!!$    if ( BUCONF%lbudget_sv .and. nmom_r.ge.2) &amp;</span></div>
<div class="line"><a id="l01087" name="l01087"></a><span class="lineno"> 1087</span><span class="comment">!!$         call BUDGET_STORE_INIT_PHY(D, TBUDGETS(NBUDGET_SV1 - 1 + nsv_lima_nr), &#39;R2C1&#39;, zcrs(:,:) * prhodj(:,:) )</span></div>
<div class="line"><a id="l01088" name="l01088"></a><span class="lineno"> 1088</span><span class="comment">!!$   end if</span></div>
<div class="line"><a id="l01089" name="l01089"></a><span class="lineno"> 1089</span><span class="comment">!!$</span></div>
<div class="line"><a id="l01090" name="l01090"></a><span class="lineno"> 1090</span><span class="comment">!!$   CALL LIMA_DROPS_TO_DROPLETS_CONV(LIMAP, D, PRHODREF, ZRCS*PTSTEP, ZRRS*PTSTEP, ZCCS*PTSTEP, ZCRS*PTSTEP, &amp;</span></div>
<div class="line"><a id="l01091" name="l01091"></a><span class="lineno"> 1091</span><span class="comment">!!$                                    Z_RR_CVRC, Z_CR_CVRC)</span></div>
<div class="line"><a id="l01092" name="l01092"></a><span class="lineno"> 1092</span><span class="comment">!!$   !</span></div>
<div class="line"><a id="l01093" name="l01093"></a><span class="lineno"> 1093</span><span class="comment">!!$   ZRCS(:,:) = ZRCS(:,:) - Z_RR_CVRC(:,:)/PTSTEP</span></div>
<div class="line"><a id="l01094" name="l01094"></a><span class="lineno"> 1094</span><span class="comment">!!$   ZRRS(:,:) = ZRRS(:,:) + Z_RR_CVRC(:,:)/PTSTEP</span></div>
<div class="line"><a id="l01095" name="l01095"></a><span class="lineno"> 1095</span><span class="comment">!!$   ZCCS(:,:) = ZCCS(:,:) - Z_CR_CVRC(:,:)/PTSTEP</span></div>
<div class="line"><a id="l01096" name="l01096"></a><span class="lineno"> 1096</span><span class="comment">!!$   ZCRS(:,:) = ZCRS(:,:) + Z_CR_CVRC(:,:)/PTSTEP</span></div>
<div class="line"><a id="l01097" name="l01097"></a><span class="lineno"> 1097</span><span class="comment">!!$</span></div>
<div class="line"><a id="l01098" name="l01098"></a><span class="lineno"> 1098</span><span class="comment">!!$   if( BUCONF%LBU_ENABLE ) then</span></div>
<div class="line"><a id="l01099" name="l01099"></a><span class="lineno"> 1099</span><span class="comment">!!$    if ( BUCONF%lbudget_rc ) call BUDGET_STORE_END_PHY(D, TBUDGETS(NBUDGET_RC),                    &#39;R2C1&#39;, zrcs(:,:) * prhodj(:,:) )</span></div>
<div class="line"><a id="l01100" name="l01100"></a><span class="lineno"> 1100</span><span class="comment">!!$    if ( BUCONF%lbudget_rr ) call BUDGET_STORE_END_PHY(D, TBUDGETS(NBUDGET_RR),                    &#39;R2C1&#39;, zrrs(:,:) * prhodj(:,:) )</span></div>
<div class="line"><a id="l01101" name="l01101"></a><span class="lineno"> 1101</span><span class="comment">!!$    if ( BUCONF%lbudget_sv .and. nmom_c.ge.2) &amp;</span></div>
<div class="line"><a id="l01102" name="l01102"></a><span class="lineno"> 1102</span><span class="comment">!!$         call BUDGET_STORE_END_PHY(D, TBUDGETS(NBUDGET_SV1 - 1 + nsv_lima_nc), &#39;R2C1&#39;, zccs(:,:) * prhodj(:,:) )</span></div>
<div class="line"><a id="l01103" name="l01103"></a><span class="lineno"> 1103</span><span class="comment">!!$    if ( BUCONF%lbudget_sv .and. nmom_r.ge.2) &amp;</span></div>
<div class="line"><a id="l01104" name="l01104"></a><span class="lineno"> 1104</span><span class="comment">!!$         call BUDGET_STORE_END_PHY(D, TBUDGETS(NBUDGET_SV1 - 1 + nsv_lima_nr), &#39;R2C1&#39;, zcrs(:,:) * prhodj(:,:) )</span></div>
<div class="line"><a id="l01105" name="l01105"></a><span class="lineno"> 1105</span><span class="comment">!!$   end if</span></div>
<div class="line"><a id="l01106" name="l01106"></a><span class="lineno"> 1106</span><span class="comment">!!$END IF</span></div>
<div class="line"><a id="l01107" name="l01107"></a><span class="lineno"> 1107</span><span class="comment">!</span></div>
<div class="line"><a id="l01108" name="l01108"></a><span class="lineno"> 1108</span><span class="comment">! Update variables</span></div>
<div class="line"><a id="l01109" name="l01109"></a><span class="lineno"> 1109</span><span class="comment">!</span></div>
<div class="line"><a id="l01110" name="l01110"></a><span class="lineno"> 1110</span>ztht(:,:) = zths(:,:) * ptstep</div>
<div class="line"><a id="l01111" name="l01111"></a><span class="lineno"> 1111</span>zt(:,:)   = ztht(:,:) * zexn(:,:)</div>
<div class="line"><a id="l01112" name="l01112"></a><span class="lineno"> 1112</span><span class="comment">!</span></div>
<div class="line"><a id="l01113" name="l01113"></a><span class="lineno"> 1113</span><span class="keywordflow">IF</span> ( krr .GE. 2 ) zrct(:,:) = zrcs(:,:) * ptstep</div>
<div class="line"><a id="l01114" name="l01114"></a><span class="lineno"> 1114</span><span class="keywordflow">IF</span> ( krr .GE. 3 ) zrrt(:,:) = zrrs(:,:) * ptstep</div>
<div class="line"><a id="l01115" name="l01115"></a><span class="lineno"> 1115</span><span class="keywordflow">IF</span> ( krr .GE. 4 ) zrit(:,:) = zris(:,:) * ptstep</div>
<div class="line"><a id="l01116" name="l01116"></a><span class="lineno"> 1116</span><span class="keywordflow">IF</span> ( krr .GE. 5 ) zrst(:,:) = zrss(:,:) * ptstep</div>
<div class="line"><a id="l01117" name="l01117"></a><span class="lineno"> 1117</span><span class="keywordflow">IF</span> ( krr .GE. 6 ) zrgt(:,:) = zrgs(:,:) * ptstep</div>
<div class="line"><a id="l01118" name="l01118"></a><span class="lineno"> 1118</span><span class="keywordflow">IF</span> ( krr .GE. 7 ) zrht(:,:) = zrhs(:,:) * ptstep</div>
<div class="line"><a id="l01119" name="l01119"></a><span class="lineno"> 1119</span><span class="comment">!</span></div>
<div class="line"><a id="l01120" name="l01120"></a><span class="lineno"> 1120</span><span class="keywordflow">IF</span> ( limap%NMOM_C.GE.2 ) zcct(:,:) = zccs(:,:) * ptstep</div>
<div class="line"><a id="l01121" name="l01121"></a><span class="lineno"> 1121</span><span class="keywordflow">IF</span> ( limap%NMOM_R.GE.2 ) zcrt(:,:) = zcrs(:,:) * ptstep</div>
<div class="line"><a id="l01122" name="l01122"></a><span class="lineno"> 1122</span><span class="keywordflow">IF</span> ( limap%NMOM_I.GE.2 ) zcit(:,:) = zcis(:,:) * ptstep</div>
<div class="line"><a id="l01123" name="l01123"></a><span class="lineno"> 1123</span><span class="keywordflow">IF</span> ( limap%NMOM_S.GE.2 ) zcst(:,:) = zcss(:,:) * ptstep</div>
<div class="line"><a id="l01124" name="l01124"></a><span class="lineno"> 1124</span><span class="keywordflow">IF</span> ( limap%NMOM_G.GE.2 ) zcgt(:,:) = zcgs(:,:) * ptstep</div>
<div class="line"><a id="l01125" name="l01125"></a><span class="lineno"> 1125</span><span class="keywordflow">IF</span> ( limap%NMOM_H.GE.2 ) zcht(:,:) = zchs(:,:) * ptstep</div>
<div class="line"><a id="l01126" name="l01126"></a><span class="lineno"> 1126</span><span class="comment">!</span></div>
<div class="line"><a id="l01127" name="l01127"></a><span class="lineno"> 1127</span><span class="keywordflow">IF</span> (limap%LCRYSTAL_SHAPE) <span class="keywordflow">THEN</span></div>
<div class="line"><a id="l01128" name="l01128"></a><span class="lineno"> 1128</span>  zcit_shape(:,:,:) = zcis_shape(:,:,:) * ptstep</div>
<div class="line"><a id="l01129" name="l01129"></a><span class="lineno"> 1129</span>  zcit(:,:) = sum(zcit_shape,dim=3)</div>
<div class="line"><a id="l01130" name="l01130"></a><span class="lineno"> 1130</span><span class="keywordflow">END IF</span></div>
<div class="line"><a id="l01131" name="l01131"></a><span class="lineno"> 1131</span><span class="comment">!</span></div>
<div class="line"><a id="l01132" name="l01132"></a><span class="lineno"> 1132</span><span class="keywordflow">IF</span> (oelec) <span class="keywordflow">THEN</span></div>
<div class="line"><a id="l01133" name="l01133"></a><span class="lineno"> 1133</span>  zqct(:,:) = zqcs(:,:) * ptstep</div>
<div class="line"><a id="l01134" name="l01134"></a><span class="lineno"> 1134</span>  zqrt(:,:) = zqrs(:,:) * ptstep</div>
<div class="line"><a id="l01135" name="l01135"></a><span class="lineno"> 1135</span>  zqit(:,:) = zqis(:,:) * ptstep</div>
<div class="line"><a id="l01136" name="l01136"></a><span class="lineno"> 1136</span>  zqst(:,:) = zqss(:,:) * ptstep</div>
<div class="line"><a id="l01137" name="l01137"></a><span class="lineno"> 1137</span>  zqgt(:,:) = zqgs(:,:) * ptstep</div>
<div class="line"><a id="l01138" name="l01138"></a><span class="lineno"> 1138</span>  <span class="keywordflow">IF</span> (limap%NMOM_H .GE. 1) zqht(:,:) = zqhs(:,:) * ptstep</div>
<div class="line"><a id="l01139" name="l01139"></a><span class="lineno"> 1139</span><span class="keywordflow">END IF</span></div>
<div class="line"><a id="l01140" name="l01140"></a><span class="lineno"> 1140</span><span class="comment">! </span></div>
<div class="line"><a id="l01141" name="l01141"></a><span class="lineno"> 1141</span><span class="comment">!-------------------------------------------------------------------------------</span></div>
<div class="line"><a id="l01142" name="l01142"></a><span class="lineno"> 1142</span><span class="comment">!</span></div>
<div class="line"><a id="l01143" name="l01143"></a><span class="lineno"> 1143</span><span class="comment">!*       2.     Compute cloud, ice and precipitation fractions</span></div>
<div class="line"><a id="l01144" name="l01144"></a><span class="lineno"> 1144</span><span class="comment">!               ----------------------------------------------</span></div>
<div class="line"><a id="l01145" name="l01145"></a><span class="lineno"> 1145</span><span class="comment">!</span></div>
<div class="line"><a id="l01146" name="l01146"></a><span class="lineno"> 1146</span><span class="keyword">CALL </span>lima_compute_cloud_fractions (limap, d,                          &amp;</div>
<div class="line"><a id="l01147" name="l01147"></a><span class="lineno"> 1147</span>                                   zcct, zrct,                        &amp;</div>
<div class="line"><a id="l01148" name="l01148"></a><span class="lineno"> 1148</span>                                   zcrt, zrrt,                        &amp;</div>
<div class="line"><a id="l01149" name="l01149"></a><span class="lineno"> 1149</span>                                   zcit, zrit,                        &amp;</div>
<div class="line"><a id="l01150" name="l01150"></a><span class="lineno"> 1150</span>                                   zcst, zrst,                        &amp;</div>
<div class="line"><a id="l01151" name="l01151"></a><span class="lineno"> 1151</span>                                   zcgt, zrgt,                        &amp;</div>
<div class="line"><a id="l01152" name="l01152"></a><span class="lineno"> 1152</span>                                   zcht, zrht,                        &amp;</div>
<div class="line"><a id="l01153" name="l01153"></a><span class="lineno"> 1153</span>                                   pcldfr, picefr, pprcfr             )</div>
<div class="line"><a id="l01154" name="l01154"></a><span class="lineno"> 1154</span><span class="comment">!</span></div>
<div class="line"><a id="l01155" name="l01155"></a><span class="lineno"> 1155</span><span class="comment">!</span></div>
<div class="line"><a id="l01156" name="l01156"></a><span class="lineno"> 1156</span><span class="comment">!-------------------------------------------------------------------------------</span></div>
<div class="line"><a id="l01157" name="l01157"></a><span class="lineno"> 1157</span><span class="comment">!</span></div>
<div class="line"><a id="l01158" name="l01158"></a><span class="lineno"> 1158</span><span class="comment">!*       2.     Nucleation processes</span></div>
<div class="line"><a id="l01159" name="l01159"></a><span class="lineno"> 1159</span><span class="comment">!               --------------------</span></div>
<div class="line"><a id="l01160" name="l01160"></a><span class="lineno"> 1160</span><span class="comment">!</span></div>
<div class="line"><a id="l01161" name="l01161"></a><span class="lineno"> 1161</span><span class="keyword">CALL </span>lima_nucleation_procs (limap, limaw, limac, tnsv, d, cst, nebn, buconf, tbudgets, kbudgets,  &amp;</div>
<div class="line"><a id="l01162" name="l01162"></a><span class="lineno"> 1162</span>                            kcarb, ksoa, ksp, odust, osalt, oorilam,            &amp;</div>
<div class="line"><a id="l01163" name="l01163"></a><span class="lineno"> 1163</span>                            ptstep, prhodj,                                     &amp;</div>
<div class="line"><a id="l01164" name="l01164"></a><span class="lineno"> 1164</span>                            prhodref, zexn, ppabst, zt, pdthrad, pw_nu,         &amp;</div>
<div class="line"><a id="l01165" name="l01165"></a><span class="lineno"> 1165</span>                            ztht, zrvt, zrct, zrrt, zrit, zrst, zrgt, zrht,     &amp;</div>
<div class="line"><a id="l01166" name="l01166"></a><span class="lineno"> 1166</span>                            zcct, zcrt, zcit, zcit_shape, paero,psolorg, pmi, hactccn, &amp;</div>
<div class="line"><a id="l01167" name="l01167"></a><span class="lineno"> 1167</span>                            zccnft, zccnat, zifnft, zifnnt, zimmnt, zhomft,     &amp;</div>
<div class="line"><a id="l01168" name="l01168"></a><span class="lineno"> 1168</span>                            pcldfr, picefr, pprcfr,                             &amp;</div>
<div class="line"><a id="l01169" name="l01169"></a><span class="lineno"> 1169</span>                            ztot_rv_henu, ztot_rc_hinc, ztot_ri_hind, ztot_rv_honh)</div>
<div class="line"><a id="l01170" name="l01170"></a><span class="lineno"> 1170</span><span class="comment">! dans lima_nucleation_proc, pcit a ete mis a jour comme la somme des pcit_shape si lcrystal_shape=t </span></div>
<div class="line"><a id="l01171" name="l01171"></a><span class="lineno"> 1171</span><span class="comment">!</span></div>
<div class="line"><a id="l01172" name="l01172"></a><span class="lineno"> 1172</span><span class="comment">! Saving sources before microphysics time-splitting loop</span></div>
<div class="line"><a id="l01173" name="l01173"></a><span class="lineno"> 1173</span><span class="comment">!</span></div>
<div class="line"><a id="l01174" name="l01174"></a><span class="lineno"> 1174</span>zrvs(:,:) = zrvt(:,:) *zinv_tstep</div>
<div class="line"><a id="l01175" name="l01175"></a><span class="lineno"> 1175</span>zrcs(:,:) = zrct(:,:) *zinv_tstep</div>
<div class="line"><a id="l01176" name="l01176"></a><span class="lineno"> 1176</span>zrrs(:,:) = zrrt(:,:) *zinv_tstep</div>
<div class="line"><a id="l01177" name="l01177"></a><span class="lineno"> 1177</span>zris(:,:) = zrit(:,:) *zinv_tstep</div>
<div class="line"><a id="l01178" name="l01178"></a><span class="lineno"> 1178</span>zrss(:,:) = zrst(:,:) *zinv_tstep</div>
<div class="line"><a id="l01179" name="l01179"></a><span class="lineno"> 1179</span>zrgs(:,:) = zrgt(:,:) *zinv_tstep</div>
<div class="line"><a id="l01180" name="l01180"></a><span class="lineno"> 1180</span>zrhs(:,:) = zrht(:,:) *zinv_tstep</div>
<div class="line"><a id="l01181" name="l01181"></a><span class="lineno"> 1181</span><span class="comment">!</span></div>
<div class="line"><a id="l01182" name="l01182"></a><span class="lineno"> 1182</span><span class="keywordflow">IF</span> (limap%NMOM_C.GE.2) zccs(:,:) = zcct(:,:) *zinv_tstep</div>
<div class="line"><a id="l01183" name="l01183"></a><span class="lineno"> 1183</span><span class="keywordflow">IF</span> (limap%NMOM_R.GE.2) zcrs(:,:) = zcrt(:,:) *zinv_tstep</div>
<div class="line"><a id="l01184" name="l01184"></a><span class="lineno"> 1184</span><span class="keywordflow">IF</span> (limap%NMOM_I.GE.2) zcis(:,:) = zcit(:,:) *zinv_tstep</div>
<div class="line"><a id="l01185" name="l01185"></a><span class="lineno"> 1185</span><span class="keywordflow">IF</span> (limap%NMOM_S.GE.2) zcss(:,:) = zcst(:,:) *zinv_tstep</div>
<div class="line"><a id="l01186" name="l01186"></a><span class="lineno"> 1186</span><span class="keywordflow">IF</span> (limap%NMOM_G.GE.2) zcgs(:,:) = zcgt(:,:) *zinv_tstep</div>
<div class="line"><a id="l01187" name="l01187"></a><span class="lineno"> 1187</span><span class="keywordflow">IF</span> (limap%NMOM_H.GE.2) zchs(:,:) = zcht(:,:) *zinv_tstep</div>
<div class="line"><a id="l01188" name="l01188"></a><span class="lineno"> 1188</span><span class="comment">!</span></div>
<div class="line"><a id="l01189" name="l01189"></a><span class="lineno"> 1189</span><span class="keywordflow">IF</span> (limap%LCRYSTAL_SHAPE) <span class="keywordflow">THEN</span></div>
<div class="line"><a id="l01190" name="l01190"></a><span class="lineno"> 1190</span>  zcis_shape(:,:,:) = zcit_shape(:,:,:) * zinv_tstep</div>
<div class="line"><a id="l01191" name="l01191"></a><span class="lineno"> 1191</span>  zcis(:,:) = sum(zcis_shape,dim=3)</div>
<div class="line"><a id="l01192" name="l01192"></a><span class="lineno"> 1192</span><span class="keywordflow">END IF</span></div>
<div class="line"><a id="l01193" name="l01193"></a><span class="lineno"> 1193</span><span class="comment">!</span></div>
<div class="line"><a id="l01194" name="l01194"></a><span class="lineno"> 1194</span>zccnfs(:,:,:) = zccnft(:,:,:) *zinv_tstep</div>
<div class="line"><a id="l01195" name="l01195"></a><span class="lineno"> 1195</span>zccnas(:,:,:) = zccnat(:,:,:) *zinv_tstep</div>
<div class="line"><a id="l01196" name="l01196"></a><span class="lineno"> 1196</span>zifnfs(:,:,:) = zifnft(:,:,:) *zinv_tstep</div>
<div class="line"><a id="l01197" name="l01197"></a><span class="lineno"> 1197</span>zifnns(:,:,:) = zifnnt(:,:,:) *zinv_tstep</div>
<div class="line"><a id="l01198" name="l01198"></a><span class="lineno"> 1198</span>zimmns(:,:,:) = zimmnt(:,:,:) *zinv_tstep</div>
<div class="line"><a id="l01199" name="l01199"></a><span class="lineno"> 1199</span>zhomfs(:,:)   = zhomft(:,:)   *zinv_tstep</div>
<div class="line"><a id="l01200" name="l01200"></a><span class="lineno"> 1200</span><span class="comment">!</span></div>
<div class="line"><a id="l01201" name="l01201"></a><span class="lineno"> 1201</span>zths(:,:) = ztht(:,:) *zinv_tstep</div>
<div class="line"><a id="l01202" name="l01202"></a><span class="lineno"> 1202</span>zt(:,:)   = ztht(:,:) * zexn(:,:)</div>
<div class="line"><a id="l01203" name="l01203"></a><span class="lineno"> 1203</span><span class="comment">!</span></div>
<div class="line"><a id="l01204" name="l01204"></a><span class="lineno"> 1204</span><span class="keywordflow">IF</span> (oelec) <span class="keywordflow">THEN</span></div>
<div class="line"><a id="l01205" name="l01205"></a><span class="lineno"> 1205</span>  zrvt_elec(:,:) = zrvt(:,:)</div>
<div class="line"><a id="l01206" name="l01206"></a><span class="lineno"> 1206</span>  zrct_elec(:,:) = zrct(:,:)</div>
<div class="line"><a id="l01207" name="l01207"></a><span class="lineno"> 1207</span>  zrrt_elec(:,:) = zrrt(:,:)</div>
<div class="line"><a id="l01208" name="l01208"></a><span class="lineno"> 1208</span>  zrit_elec(:,:) = zrit(:,:)</div>
<div class="line"><a id="l01209" name="l01209"></a><span class="lineno"> 1209</span>  zrst_elec(:,:) = zrst(:,:)</div>
<div class="line"><a id="l01210" name="l01210"></a><span class="lineno"> 1210</span>  zrgt_elec(:,:) = zrgt(:,:)</div>
<div class="line"><a id="l01211" name="l01211"></a><span class="lineno"> 1211</span>  <span class="keywordflow">IF</span> (limap%NMOM_H .GE. 1) zrht_elec(:,:) = zrht(:,:)</div>
<div class="line"><a id="l01212" name="l01212"></a><span class="lineno"> 1212</span>  <span class="keywordflow">IF</span> (limap%NMOM_C .GE. 2) zcct_elec(:,:) = zcct(:,:)</div>
<div class="line"><a id="l01213" name="l01213"></a><span class="lineno"> 1213</span>  <span class="keywordflow">IF</span> (limap%NMOM_R .GE. 2) zcrt_elec(:,:) = zcrt(:,:)</div>
<div class="line"><a id="l01214" name="l01214"></a><span class="lineno"> 1214</span>  <span class="keywordflow">IF</span> (limap%NMOM_I .GE. 2) zcit_elec(:,:) = zcit(:,:)</div>
<div class="line"><a id="l01215" name="l01215"></a><span class="lineno"> 1215</span>  <span class="keywordflow">IF</span> (limap%NMOM_S .GE. 2) zcst_elec(:,:) = zcst(:,:)</div>
<div class="line"><a id="l01216" name="l01216"></a><span class="lineno"> 1216</span>  <span class="keywordflow">IF</span> (limap%NMOM_G .GE. 2) zcgt_elec(:,:) = zcgt(:,:)</div>
<div class="line"><a id="l01217" name="l01217"></a><span class="lineno"> 1217</span>  <span class="keywordflow">IF</span> (limap%NMOM_H .GE. 2) zcht_elec(:,:) = zcht(:,:)</div>
<div class="line"><a id="l01218" name="l01218"></a><span class="lineno"> 1218</span><span class="keywordflow">END IF</span></div>
<div class="line"><a id="l01219" name="l01219"></a><span class="lineno"> 1219</span><span class="comment">!</span></div>
<div class="line"><a id="l01220" name="l01220"></a><span class="lineno"> 1220</span><span class="comment">!-------------------------------------------------------------------------------</span></div>
<div class="line"><a id="l01221" name="l01221"></a><span class="lineno"> 1221</span><span class="comment">!</span></div>
<div class="line"><a id="l01222" name="l01222"></a><span class="lineno"> 1222</span><span class="comment">!*       2.     LOOP</span></div>
<div class="line"><a id="l01223" name="l01223"></a><span class="lineno"> 1223</span><span class="comment">!               ----</span></div>
<div class="line"><a id="l01224" name="l01224"></a><span class="lineno"> 1224</span><span class="comment">!</span></div>
<div class="line"><a id="l01225" name="l01225"></a><span class="lineno"> 1225</span><span class="comment">!</span></div>
<div class="line"><a id="l01226" name="l01226"></a><span class="lineno"> 1226</span><span class="comment">! Maximum number of iterations</span></div>
<div class="line"><a id="l01227" name="l01227"></a><span class="lineno"> 1227</span>inb_iter_max=limap%NMAXITER</div>
<div class="line"><a id="l01228" name="l01228"></a><span class="lineno"> 1228</span><span class="keywordflow">IF</span>(limap%XTSTEP_TS/=0.)<span class="keywordflow">THEN</span></div>
<div class="line"><a id="l01229" name="l01229"></a><span class="lineno"> 1229</span>  inb_iter_max=max(1, int(ptstep/limap%XTSTEP_TS)) <span class="comment">!At least the number of iterations needed for the time-splitting</span></div>
<div class="line"><a id="l01230" name="l01230"></a><span class="lineno"> 1230</span>  ztstep=ptstep/inb_iter_max</div>
<div class="line"><a id="l01231" name="l01231"></a><span class="lineno"> 1231</span>  inb_iter_max=max(limap%NMAXITER, inb_iter_max) <span class="comment">!Fot the case LIMAP%XMRSTEP/=0. at the same time</span></div>
<div class="line"><a id="l01232" name="l01232"></a><span class="lineno"> 1232</span><span class="keywordflow">ENDIF</span></div>
<div class="line"><a id="l01233" name="l01233"></a><span class="lineno"> 1233</span>iiter(:,:)=0</div>
<div class="line"><a id="l01234" name="l01234"></a><span class="lineno"> 1234</span>ztime(:,:)=0. <span class="comment">! Current integration time (all points may have a different integration time)</span></div>
<div class="line"><a id="l01235" name="l01235"></a><span class="lineno"> 1235</span><span class="comment">!</span></div>
<div class="line"><a id="l01236" name="l01236"></a><span class="lineno"> 1236</span><span class="comment">! Begin the huge time splitting loop</span></div>
<div class="line"><a id="l01237" name="l01237"></a><span class="lineno"> 1237</span><span class="comment">!</span></div>
<div class="line"><a id="l01238" name="l01238"></a><span class="lineno"> 1238</span>zrt_sum(:,:) = zrct(:,:) + zrrt(:,:) + zrit(:,:) + zrst(:,:) + zrgt(:,:) + zrht(:,:)</div>
<div class="line"><a id="l01239" name="l01239"></a><span class="lineno"> 1239</span><span class="keywordflow">WHERE</span> (zrt_sum(:,:)&lt;limap%XRTMIN(2)) ztime(:,:)=ptstep <span class="comment">! no need to treat hydrometeor-free point</span></div>
<div class="line"><a id="l01240" name="l01240"></a><span class="lineno"> 1240</span><span class="comment">!</span></div>
<div class="line"><a id="l01241" name="l01241"></a><span class="lineno"> 1241</span><span class="keywordflow">DO</span> <span class="keywordflow">WHILE</span>(any(ztime(d%NIJB:d%NIJE,d%NKTB:d%NKTE)&lt;ptstep))</div>
<div class="line"><a id="l01242" name="l01242"></a><span class="lineno"> 1242</span>   <span class="comment">!</span></div>
<div class="line"><a id="l01243" name="l01243"></a><span class="lineno"> 1243</span>   <span class="keywordflow">IF</span>(limap%XMRSTEP/=0.) <span class="keywordflow">THEN</span></div>
<div class="line"><a id="l01244" name="l01244"></a><span class="lineno"> 1244</span>      <span class="comment">! In this case we need to remember the mixing ratios used to compute the tendencies</span></div>
<div class="line"><a id="l01245" name="l01245"></a><span class="lineno"> 1245</span>      <span class="comment">! because when mixing ratio has evolved more than a threshold, we must re-compute tendecies</span></div>
<div class="line"><a id="l01246" name="l01246"></a><span class="lineno"> 1246</span>      z0rvt(:,:)=zrvt(:,:)</div>
<div class="line"><a id="l01247" name="l01247"></a><span class="lineno"> 1247</span>      z0rct(:,:)=zrct(:,:)</div>
<div class="line"><a id="l01248" name="l01248"></a><span class="lineno"> 1248</span>      z0rrt(:,:)=zrrt(:,:)</div>
<div class="line"><a id="l01249" name="l01249"></a><span class="lineno"> 1249</span>      z0rit(:,:)=zrit(:,:)</div>
<div class="line"><a id="l01250" name="l01250"></a><span class="lineno"> 1250</span>      z0rst(:,:)=zrst(:,:)</div>
<div class="line"><a id="l01251" name="l01251"></a><span class="lineno"> 1251</span>      z0rgt(:,:)=zrgt(:,:)</div>
<div class="line"><a id="l01252" name="l01252"></a><span class="lineno"> 1252</span>      z0rht(:,:)=zrht(:,:)</div>
<div class="line"><a id="l01253" name="l01253"></a><span class="lineno"> 1253</span><span class="keywordflow">   ENDIF</span></div>
<div class="line"><a id="l01254" name="l01254"></a><span class="lineno"> 1254</span>   <span class="comment">!</span></div>
<div class="line"><a id="l01255" name="l01255"></a><span class="lineno"> 1255</span>   <span class="keywordflow">IF</span>(limap%XTSTEP_TS/=0.) <span class="keywordflow">THEN</span></div>
<div class="line"><a id="l01256" name="l01256"></a><span class="lineno"> 1256</span>      <span class="comment">! In this case we need to remember the time when tendencies were computed</span></div>
<div class="line"><a id="l01257" name="l01257"></a><span class="lineno"> 1257</span>      <span class="comment">! because when time has evolved more than a limit, we must re-compute tendecies</span></div>
<div class="line"><a id="l01258" name="l01258"></a><span class="lineno"> 1258</span>      ztime_lastcall(:,:)=ztime(:,:)</div>
<div class="line"><a id="l01259" name="l01259"></a><span class="lineno"> 1259</span><span class="keywordflow">   ENDIF</span></div>
<div class="line"><a id="l01260" name="l01260"></a><span class="lineno"> 1260</span>   <span class="comment">!</span></div>
<div class="line"><a id="l01261" name="l01261"></a><span class="lineno"> 1261</span>   glcompute(:,:)=.false.</div>
<div class="line"><a id="l01262" name="l01262"></a><span class="lineno"> 1262</span>   glcompute(d%NIJB:d%NIJE,d%NKTB:d%NKTE) = ztime(d%NIJB:d%NIJE,d%NKTB:d%NKTE)&lt;ptstep <span class="comment">! Compuation only for points for which integration time has not reached the timestep</span></div>
<div class="line"><a id="l01263" name="l01263"></a><span class="lineno"> 1263</span>   <span class="keywordflow">WHERE</span>(glcompute(:,:))</div>
<div class="line"><a id="l01264" name="l01264"></a><span class="lineno"> 1264</span>      iiter(:,:)=iiter(:,:)+1</div>
<div class="line"><a id="l01265" name="l01265"></a><span class="lineno"> 1265</span><span class="keywordflow">   END WHERE</span></div>
<div class="line"><a id="l01266" name="l01266"></a><span class="lineno"> 1266</span>   <span class="comment">! </span></div>
<div class="line"><a id="l01267" name="l01267"></a><span class="lineno"> 1267</span>   <span class="keywordflow">DO</span> <span class="keywordflow">WHILE</span>(any(glcompute(:,:))) <span class="comment">! Loop to adjust tendencies when we cross the 0°C or when a species disappears</span></div>
<div class="line"><a id="l01268" name="l01268"></a><span class="lineno"> 1268</span> </div>
<div class="line"><a id="l01269" name="l01269"></a><span class="lineno"> 1269</span>      <span class="comment">!</span></div>
<div class="line"><a id="l01270" name="l01270"></a><span class="lineno"> 1270</span>      <span class="comment">! Packing variables to run computations only where necessary</span></div>
<div class="line"><a id="l01271" name="l01271"></a><span class="lineno"> 1271</span>      <span class="comment">!</span></div>
<div class="line"><a id="l01272" name="l01272"></a><span class="lineno"> 1272</span>      ipack = count(glcompute)</div>
<div class="line"><a id="l01273" name="l01273"></a><span class="lineno"> 1273</span>      <span class="keyword">ALLOCATE</span>(i1(ipack))</div>
<div class="line"><a id="l01274" name="l01274"></a><span class="lineno"> 1274</span>      <span class="keyword">ALLOCATE</span>(i3(ipack))</div>
<div class="line"><a id="l01275" name="l01275"></a><span class="lineno"> 1275</span>      ipack = countjv(glcompute,i1,i3)</div>
<div class="line"><a id="l01276" name="l01276"></a><span class="lineno"> 1276</span>      <span class="keyword">ALLOCATE</span>(zrhodref1d(ipack))</div>
<div class="line"><a id="l01277" name="l01277"></a><span class="lineno"> 1277</span>      <span class="keyword">ALLOCATE</span>(zexnref1d(ipack))</div>
<div class="line"><a id="l01278" name="l01278"></a><span class="lineno"> 1278</span>      <span class="keyword">ALLOCATE</span>(zexn1d(ipack))</div>
<div class="line"><a id="l01279" name="l01279"></a><span class="lineno"> 1279</span>      <span class="keyword">ALLOCATE</span>(zp1d(ipack))     </div>
<div class="line"><a id="l01280" name="l01280"></a><span class="lineno"> 1280</span>      <span class="keyword">ALLOCATE</span>(ztht1d(ipack))</div>
<div class="line"><a id="l01281" name="l01281"></a><span class="lineno"> 1281</span>      <span class="keyword">ALLOCATE</span>(zrvt1d(ipack))</div>
<div class="line"><a id="l01282" name="l01282"></a><span class="lineno"> 1282</span>      <span class="keyword">ALLOCATE</span>(zrct1d(ipack))</div>
<div class="line"><a id="l01283" name="l01283"></a><span class="lineno"> 1283</span>      <span class="keyword">ALLOCATE</span>(zrrt1d(ipack))</div>
<div class="line"><a id="l01284" name="l01284"></a><span class="lineno"> 1284</span>      <span class="keyword">ALLOCATE</span>(zrit1d(ipack))</div>
<div class="line"><a id="l01285" name="l01285"></a><span class="lineno"> 1285</span>      <span class="keyword">ALLOCATE</span>(zrst1d(ipack))</div>
<div class="line"><a id="l01286" name="l01286"></a><span class="lineno"> 1286</span>      <span class="keyword">ALLOCATE</span>(zrgt1d(ipack))</div>
<div class="line"><a id="l01287" name="l01287"></a><span class="lineno"> 1287</span>      <span class="keyword">ALLOCATE</span>(zrht1d(ipack))</div>
<div class="line"><a id="l01288" name="l01288"></a><span class="lineno"> 1288</span>      <span class="keyword">ALLOCATE</span>(zcct1d(ipack))</div>
<div class="line"><a id="l01289" name="l01289"></a><span class="lineno"> 1289</span>      <span class="keyword">ALLOCATE</span>(zcrt1d(ipack))</div>
<div class="line"><a id="l01290" name="l01290"></a><span class="lineno"> 1290</span>      <span class="keyword">ALLOCATE</span>(zcit1d(ipack))</div>
<div class="line"><a id="l01291" name="l01291"></a><span class="lineno"> 1291</span>      <span class="keyword">ALLOCATE</span>(zcst1d(ipack))</div>
<div class="line"><a id="l01292" name="l01292"></a><span class="lineno"> 1292</span>      <span class="keyword">ALLOCATE</span>(zcgt1d(ipack))</div>
<div class="line"><a id="l01293" name="l01293"></a><span class="lineno"> 1293</span>      <span class="keyword">ALLOCATE</span>(zcht1d(ipack))</div>
<div class="line"><a id="l01294" name="l01294"></a><span class="lineno"> 1294</span>      <span class="keyword">ALLOCATE</span>(zifnn1d(ipack,limap%NMOD_IFN))</div>
<div class="line"><a id="l01295" name="l01295"></a><span class="lineno"> 1295</span>      <span class="keyword">ALLOCATE</span>(zevap1d(ipack))</div>
<div class="line"><a id="l01296" name="l01296"></a><span class="lineno"> 1296</span>      <span class="keyword">ALLOCATE</span>(ztime1d(ipack))</div>
<div class="line"><a id="l01297" name="l01297"></a><span class="lineno"> 1297</span>      <span class="keyword">ALLOCATE</span>(glcompute1d(ipack))</div>
<div class="line"><a id="l01298" name="l01298"></a><span class="lineno"> 1298</span>      <span class="keyword">ALLOCATE</span>(iiter1d(ipack))</div>
<div class="line"><a id="l01299" name="l01299"></a><span class="lineno"> 1299</span>      <span class="keyword">ALLOCATE</span>(ztime_lastcall1d(ipack))</div>
<div class="line"><a id="l01300" name="l01300"></a><span class="lineno"> 1300</span>      <span class="keyword">ALLOCATE</span>(z0rvt1d(ipack))</div>
<div class="line"><a id="l01301" name="l01301"></a><span class="lineno"> 1301</span>      <span class="keyword">ALLOCATE</span>(z0rct1d(ipack))</div>
<div class="line"><a id="l01302" name="l01302"></a><span class="lineno"> 1302</span>      <span class="keyword">ALLOCATE</span>(z0rrt1d(ipack))</div>
<div class="line"><a id="l01303" name="l01303"></a><span class="lineno"> 1303</span>      <span class="keyword">ALLOCATE</span>(z0rit1d(ipack))</div>
<div class="line"><a id="l01304" name="l01304"></a><span class="lineno"> 1304</span>      <span class="keyword">ALLOCATE</span>(z0rst1d(ipack))</div>
<div class="line"><a id="l01305" name="l01305"></a><span class="lineno"> 1305</span>      <span class="keyword">ALLOCATE</span>(z0rgt1d(ipack))</div>
<div class="line"><a id="l01306" name="l01306"></a><span class="lineno"> 1306</span>      <span class="keyword">ALLOCATE</span>(z0rht1d(ipack))</div>
<div class="line"><a id="l01307" name="l01307"></a><span class="lineno"> 1307</span>      <span class="keyword">ALLOCATE</span>(zcf1d(ipack))</div>
<div class="line"><a id="l01308" name="l01308"></a><span class="lineno"> 1308</span>      <span class="keyword">ALLOCATE</span>(zif1d(ipack))</div>
<div class="line"><a id="l01309" name="l01309"></a><span class="lineno"> 1309</span>      <span class="keyword">ALLOCATE</span>(zpf1d(ipack))</div>
<div class="line"><a id="l01310" name="l01310"></a><span class="lineno"> 1310</span>      <span class="keyword">ALLOCATE</span>(zlatham_iaggs(ipack))</div>
<div class="line"><a id="l01311" name="l01311"></a><span class="lineno"> 1311</span>      <span class="keywordflow">IF</span> (limap%LCRYSTAL_SHAPE) <span class="keywordflow">THEN</span></div>
<div class="line"><a id="l01312" name="l01312"></a><span class="lineno"> 1312</span>        <span class="keyword">ALLOCATE</span>(zcit1d_shape(ipack,limap%NNB_CRYSTAL_SHAPE))</div>
<div class="line"><a id="l01313" name="l01313"></a><span class="lineno"> 1313</span>      <span class="keywordflow">ELSE</span></div>
<div class="line"><a id="l01314" name="l01314"></a><span class="lineno"> 1314</span>        <span class="keyword">ALLOCATE</span>(zcit1d_shape(0,0))</div>
<div class="line"><a id="l01315" name="l01315"></a><span class="lineno"> 1315</span><span class="keywordflow">      END IF</span></div>
<div class="line"><a id="l01316" name="l01316"></a><span class="lineno"> 1316</span>      <span class="keywordflow">DO</span> ii=1,ipack</div>
<div class="line"><a id="l01317" name="l01317"></a><span class="lineno"> 1317</span>         zrhodref1d(ii)       = prhodref(i1(ii),i3(ii))</div>
<div class="line"><a id="l01318" name="l01318"></a><span class="lineno"> 1318</span>         zexnref1d(ii)        = pexnref(i1(ii),i3(ii))</div>
<div class="line"><a id="l01319" name="l01319"></a><span class="lineno"> 1319</span>         zexn1d(ii)           = zexn(i1(ii),i3(ii))</div>
<div class="line"><a id="l01320" name="l01320"></a><span class="lineno"> 1320</span>         zp1d(ii)             = ppabst(i1(ii),i3(ii))</div>
<div class="line"><a id="l01321" name="l01321"></a><span class="lineno"> 1321</span>         ztht1d(ii)           = ztht(i1(ii),i3(ii))</div>
<div class="line"><a id="l01322" name="l01322"></a><span class="lineno"> 1322</span>         zrvt1d(ii)           = zrvt(i1(ii),i3(ii))</div>
<div class="line"><a id="l01323" name="l01323"></a><span class="lineno"> 1323</span>         zrct1d(ii)           = zrct(i1(ii),i3(ii))</div>
<div class="line"><a id="l01324" name="l01324"></a><span class="lineno"> 1324</span>         zrrt1d(ii)           = zrrt(i1(ii),i3(ii))</div>
<div class="line"><a id="l01325" name="l01325"></a><span class="lineno"> 1325</span>         zrit1d(ii)           = zrit(i1(ii),i3(ii))</div>
<div class="line"><a id="l01326" name="l01326"></a><span class="lineno"> 1326</span>         zrst1d(ii)           = zrst(i1(ii),i3(ii))</div>
<div class="line"><a id="l01327" name="l01327"></a><span class="lineno"> 1327</span>         zrgt1d(ii)           = zrgt(i1(ii),i3(ii))</div>
<div class="line"><a id="l01328" name="l01328"></a><span class="lineno"> 1328</span>         zrht1d(ii)           = zrht(i1(ii),i3(ii))</div>
<div class="line"><a id="l01329" name="l01329"></a><span class="lineno"> 1329</span>         zcct1d(ii)           = zcct(i1(ii),i3(ii))</div>
<div class="line"><a id="l01330" name="l01330"></a><span class="lineno"> 1330</span>         zcrt1d(ii)           = zcrt(i1(ii),i3(ii))</div>
<div class="line"><a id="l01331" name="l01331"></a><span class="lineno"> 1331</span>         zcit1d(ii)           = zcit(i1(ii),i3(ii))</div>
<div class="line"><a id="l01332" name="l01332"></a><span class="lineno"> 1332</span>         zcst1d(ii)           = zcst(i1(ii),i3(ii))</div>
<div class="line"><a id="l01333" name="l01333"></a><span class="lineno"> 1333</span>         zcgt1d(ii)           = zcgt(i1(ii),i3(ii))</div>
<div class="line"><a id="l01334" name="l01334"></a><span class="lineno"> 1334</span>         zcht1d(ii)           = zcht(i1(ii),i3(ii))</div>
<div class="line"><a id="l01335" name="l01335"></a><span class="lineno"> 1335</span>         zifnn1d(ii,:)        = zifnnt(i1(ii),i3(ii),:)</div>
<div class="line"><a id="l01336" name="l01336"></a><span class="lineno"> 1336</span>         zevap1d(ii)          = pevap3d(i1(ii),i3(ii))</div>
<div class="line"><a id="l01337" name="l01337"></a><span class="lineno"> 1337</span>         ztime1d(ii)          = ztime(i1(ii),i3(ii))         </div>
<div class="line"><a id="l01338" name="l01338"></a><span class="lineno"> 1338</span>         glcompute1d(ii)      = glcompute(i1(ii),i3(ii))         </div>
<div class="line"><a id="l01339" name="l01339"></a><span class="lineno"> 1339</span>         iiter1d(ii)          = iiter(i1(ii),i3(ii))         </div>
<div class="line"><a id="l01340" name="l01340"></a><span class="lineno"> 1340</span>         ztime_lastcall1d(ii) = ztime_lastcall(i1(ii),i3(ii))         </div>
<div class="line"><a id="l01341" name="l01341"></a><span class="lineno"> 1341</span>         z0rvt1d(ii)          = z0rvt(i1(ii),i3(ii))</div>
<div class="line"><a id="l01342" name="l01342"></a><span class="lineno"> 1342</span>         z0rct1d(ii)          = z0rct(i1(ii),i3(ii))</div>
<div class="line"><a id="l01343" name="l01343"></a><span class="lineno"> 1343</span>         z0rrt1d(ii)          = z0rrt(i1(ii),i3(ii))</div>
<div class="line"><a id="l01344" name="l01344"></a><span class="lineno"> 1344</span>         z0rit1d(ii)          = z0rit(i1(ii),i3(ii))</div>
<div class="line"><a id="l01345" name="l01345"></a><span class="lineno"> 1345</span>         z0rst1d(ii)          = z0rst(i1(ii),i3(ii))</div>
<div class="line"><a id="l01346" name="l01346"></a><span class="lineno"> 1346</span>         z0rgt1d(ii)          = z0rgt(i1(ii),i3(ii))</div>
<div class="line"><a id="l01347" name="l01347"></a><span class="lineno"> 1347</span>         z0rht1d(ii)          = z0rht(i1(ii),i3(ii))</div>
<div class="line"><a id="l01348" name="l01348"></a><span class="lineno"> 1348</span>         zcf1d(ii)            = pcldfr(i1(ii),i3(ii))</div>
<div class="line"><a id="l01349" name="l01349"></a><span class="lineno"> 1349</span>         zif1d(ii)            = picefr(i1(ii),i3(ii))</div>
<div class="line"><a id="l01350" name="l01350"></a><span class="lineno"> 1350</span>         zpf1d(ii)            = pprcfr(i1(ii),i3(ii))</div>
<div class="line"><a id="l01351" name="l01351"></a><span class="lineno"> 1351</span>         <span class="keywordflow">IF</span> (oelec) <span class="keywordflow">THEN</span></div>
<div class="line"><a id="l01352" name="l01352"></a><span class="lineno"> 1352</span>           zlatham_iaggs(ii) = platham_iaggs(i1(ii),i3(ii))</div>
<div class="line"><a id="l01353" name="l01353"></a><span class="lineno"> 1353</span>         <span class="keywordflow">ELSE</span></div>
<div class="line"><a id="l01354" name="l01354"></a><span class="lineno"> 1354</span>           zlatham_iaggs(ii) = 1.0 </div>
<div class="line"><a id="l01355" name="l01355"></a><span class="lineno"> 1355</span><span class="keywordflow">         END IF</span></div>
<div class="line"><a id="l01356" name="l01356"></a><span class="lineno"> 1356</span>         <span class="keywordflow">IF</span> (limap%LCRYSTAL_SHAPE) <span class="keywordflow">THEN</span></div>
<div class="line"><a id="l01357" name="l01357"></a><span class="lineno"> 1357</span>           <span class="keywordflow">DO</span> ish = 1, limap%NNB_CRYSTAL_SHAPE</div>
<div class="line"><a id="l01358" name="l01358"></a><span class="lineno"> 1358</span>             zcit1d_shape(ii,ish) = zcit_shape(i1(ii),i3(ii),ish)</div>
<div class="line"><a id="l01359" name="l01359"></a><span class="lineno"> 1359</span><span class="keywordflow">           END DO</span></div>
<div class="line"><a id="l01360" name="l01360"></a><span class="lineno"> 1360</span><span class="keywordflow">         END IF</span></div>
<div class="line"><a id="l01361" name="l01361"></a><span class="lineno"> 1361</span><span class="keywordflow">      END DO</span></div>
<div class="line"><a id="l01362" name="l01362"></a><span class="lineno"> 1362</span>      <span class="comment">!</span></div>
<div class="line"><a id="l01363" name="l01363"></a><span class="lineno"> 1363</span>      <span class="keywordflow">WHERE</span>(zcf1d(:)&lt;1.e-10 .AND. zrct1d(:)&gt;limap%XRTMIN(2) .AND. zcct1d(:)&gt;limap%XCTMIN(2)) zcf1d(:)=1.</div>
<div class="line"><a id="l01364" name="l01364"></a><span class="lineno"> 1364</span>      <span class="keywordflow">WHERE</span>(zif1d(:)&lt;1.e-10 .AND. zrit1d(:)&gt;limap%XRTMIN(4) .AND. zcit1d(:)&gt;limap%XCTMIN(4)) zif1d(:)=1.</div>
<div class="line"><a id="l01365" name="l01365"></a><span class="lineno"> 1365</span>      <span class="keywordflow">WHERE</span>(zpf1d(:)&lt;1.e-10 .AND. zrrt1d(:)&gt;limap%XRTMIN(3) .AND. zcrt1d(:)&gt;limap%XCTMIN(3)) zpf1d(:)=1.</div>
<div class="line"><a id="l01366" name="l01366"></a><span class="lineno"> 1366</span>      <span class="keywordflow">WHERE</span>(zpf1d(:)&lt;1.e-10 .AND. zrst1d(:)&gt;limap%XRTMIN(5) .AND. zcst1d(:)&gt;limap%XCTMIN(5)) zpf1d(:)=1.</div>
<div class="line"><a id="l01367" name="l01367"></a><span class="lineno"> 1367</span>      <span class="keywordflow">WHERE</span>(zpf1d(:)&lt;1.e-10 .AND. zrgt1d(:)&gt;limap%XRTMIN(6) .AND. zcgt1d(:)&gt;limap%XCTMIN(6)) zpf1d(:)=1.</div>
<div class="line"><a id="l01368" name="l01368"></a><span class="lineno"> 1368</span>      <span class="keywordflow">WHERE</span>(zpf1d(:)&lt;1.e-10 .AND. zrht1d(:)&gt;limap%XRTMIN(7) .AND. zcht1d(:)&gt;limap%XCTMIN(7)) zpf1d(:)=1.</div>
<div class="line"><a id="l01369" name="l01369"></a><span class="lineno"> 1369</span>      <span class="comment">!</span></div>
<div class="line"><a id="l01370" name="l01370"></a><span class="lineno"> 1370</span>      <span class="comment">! Allocating 1D variables</span></div>
<div class="line"><a id="l01371" name="l01371"></a><span class="lineno"> 1371</span>      <span class="comment">!</span></div>
<div class="line"><a id="l01372" name="l01372"></a><span class="lineno"> 1372</span>      <span class="keyword">ALLOCATE</span>(zmaxtime(ipack))           ;  zmaxtime(:) = 0.</div>
<div class="line"><a id="l01373" name="l01373"></a><span class="lineno"> 1373</span>      <span class="keyword">ALLOCATE</span>(ztime_threshold(ipack))    ;  ztime_threshold(:) = 0.</div>
<div class="line"><a id="l01374" name="l01374"></a><span class="lineno"> 1374</span>      <span class="comment">!</span></div>
<div class="line"><a id="l01375" name="l01375"></a><span class="lineno"> 1375</span>      <span class="keyword">ALLOCATE</span>(za_th(ipack))              ;  za_th(:) = 0.</div>
<div class="line"><a id="l01376" name="l01376"></a><span class="lineno"> 1376</span>      <span class="keyword">ALLOCATE</span>(za_rv(ipack))              ;  za_rv(:) = 0.</div>
<div class="line"><a id="l01377" name="l01377"></a><span class="lineno"> 1377</span>      <span class="keyword">ALLOCATE</span>(za_rc(ipack))              ;  za_rc(:) = 0.</div>
<div class="line"><a id="l01378" name="l01378"></a><span class="lineno"> 1378</span>      <span class="keyword">ALLOCATE</span>(za_rr(ipack))              ;  za_rr(:) = 0.</div>
<div class="line"><a id="l01379" name="l01379"></a><span class="lineno"> 1379</span>      <span class="keyword">ALLOCATE</span>(za_ri(ipack))              ;  za_ri(:) = 0.</div>
<div class="line"><a id="l01380" name="l01380"></a><span class="lineno"> 1380</span>      <span class="keyword">ALLOCATE</span>(za_rs(ipack))              ;  za_rs(:) = 0.</div>
<div class="line"><a id="l01381" name="l01381"></a><span class="lineno"> 1381</span>      <span class="keyword">ALLOCATE</span>(za_rg(ipack))              ;  za_rg(:) = 0.</div>
<div class="line"><a id="l01382" name="l01382"></a><span class="lineno"> 1382</span>      <span class="keyword">ALLOCATE</span>(za_rh(ipack))              ;  za_rh(:) = 0.</div>
<div class="line"><a id="l01383" name="l01383"></a><span class="lineno"> 1383</span>      <span class="keyword">ALLOCATE</span>(za_cc(ipack))              ;  za_cc(:) = 0.</div>
<div class="line"><a id="l01384" name="l01384"></a><span class="lineno"> 1384</span>      <span class="keyword">ALLOCATE</span>(za_cr(ipack))              ;  za_cr(:) = 0.</div>
<div class="line"><a id="l01385" name="l01385"></a><span class="lineno"> 1385</span>      <span class="keyword">ALLOCATE</span>(za_ci(ipack))              ;  za_ci(:) = 0.</div>
<div class="line"><a id="l01386" name="l01386"></a><span class="lineno"> 1386</span>      <span class="keyword">ALLOCATE</span>(za_cs(ipack))              ;  za_cs(:) = 0.</div>
<div class="line"><a id="l01387" name="l01387"></a><span class="lineno"> 1387</span>      <span class="keyword">ALLOCATE</span>(za_cg(ipack))              ;  za_cg(:) = 0.</div>
<div class="line"><a id="l01388" name="l01388"></a><span class="lineno"> 1388</span>      <span class="keyword">ALLOCATE</span>(za_ch(ipack))              ;  za_ch(:) = 0.</div>
<div class="line"><a id="l01389" name="l01389"></a><span class="lineno"> 1389</span>      <span class="comment">!</span></div>
<div class="line"><a id="l01390" name="l01390"></a><span class="lineno"> 1390</span>      <span class="keyword">ALLOCATE</span>(zb_th(ipack))              ;  zb_th(:) = 0.</div>
<div class="line"><a id="l01391" name="l01391"></a><span class="lineno"> 1391</span>      <span class="keyword">ALLOCATE</span>(zb_rv(ipack))              ;  zb_rv(:) = 0.</div>
<div class="line"><a id="l01392" name="l01392"></a><span class="lineno"> 1392</span>      <span class="keyword">ALLOCATE</span>(zb_rc(ipack))              ;  zb_rc(:) = 0.</div>
<div class="line"><a id="l01393" name="l01393"></a><span class="lineno"> 1393</span>      <span class="keyword">ALLOCATE</span>(zb_rr(ipack))              ;  zb_rr(:) = 0.</div>
<div class="line"><a id="l01394" name="l01394"></a><span class="lineno"> 1394</span>      <span class="keyword">ALLOCATE</span>(zb_ri(ipack))              ;  zb_ri(:) = 0.</div>
<div class="line"><a id="l01395" name="l01395"></a><span class="lineno"> 1395</span>      <span class="keyword">ALLOCATE</span>(zb_rs(ipack))              ;  zb_rs(:) = 0.</div>
<div class="line"><a id="l01396" name="l01396"></a><span class="lineno"> 1396</span>      <span class="keyword">ALLOCATE</span>(zb_rg(ipack))              ;  zb_rg(:) = 0.</div>
<div class="line"><a id="l01397" name="l01397"></a><span class="lineno"> 1397</span>      <span class="keyword">ALLOCATE</span>(zb_rh(ipack))              ;  zb_rh(:) = 0.</div>
<div class="line"><a id="l01398" name="l01398"></a><span class="lineno"> 1398</span>      <span class="keyword">ALLOCATE</span>(zb_cc(ipack))              ;  zb_cc(:) = 0.</div>
<div class="line"><a id="l01399" name="l01399"></a><span class="lineno"> 1399</span>      <span class="keyword">ALLOCATE</span>(zb_cr(ipack))              ;  zb_cr(:) = 0.</div>
<div class="line"><a id="l01400" name="l01400"></a><span class="lineno"> 1400</span>      <span class="keyword">ALLOCATE</span>(zb_ci(ipack))              ;  zb_ci(:) = 0.</div>
<div class="line"><a id="l01401" name="l01401"></a><span class="lineno"> 1401</span>      <span class="keyword">ALLOCATE</span>(zb_cs(ipack))              ;  zb_cs(:) = 0.</div>
<div class="line"><a id="l01402" name="l01402"></a><span class="lineno"> 1402</span>      <span class="keyword">ALLOCATE</span>(zb_cg(ipack))              ;  zb_cg(:) = 0.</div>
<div class="line"><a id="l01403" name="l01403"></a><span class="lineno"> 1403</span>      <span class="keyword">ALLOCATE</span>(zb_ch(ipack))              ;  zb_ch(:) = 0.</div>
<div class="line"><a id="l01404" name="l01404"></a><span class="lineno"> 1404</span>      <span class="keyword">ALLOCATE</span>(zb_ifnn(ipack,limap%NMOD_IFN))   ;  zb_ifnn(:,:) = 0.</div>
<div class="line"><a id="l01405" name="l01405"></a><span class="lineno"> 1405</span>      <span class="comment">!</span></div>
<div class="line"><a id="l01406" name="l01406"></a><span class="lineno"> 1406</span>      <span class="keyword">ALLOCATE</span>(z_cr_brku(ipack))          ; z_cr_brku(:) = 0.</div>
<div class="line"><a id="l01407" name="l01407"></a><span class="lineno"> 1407</span>      <span class="keyword">ALLOCATE</span>(z_th_honr(ipack))          ; z_th_honr(:) = 0.</div>
<div class="line"><a id="l01408" name="l01408"></a><span class="lineno"> 1408</span>      <span class="keyword">ALLOCATE</span>(z_rr_honr(ipack))          ; z_rr_honr(:) = 0.</div>
<div class="line"><a id="l01409" name="l01409"></a><span class="lineno"> 1409</span>      <span class="keyword">ALLOCATE</span>(z_cr_honr(ipack))          ; z_cr_honr(:) = 0.</div>
<div class="line"><a id="l01410" name="l01410"></a><span class="lineno"> 1410</span>      <span class="keyword">ALLOCATE</span>(z_th_imlt(ipack))          ; z_th_imlt(:) = 0.</div>
<div class="line"><a id="l01411" name="l01411"></a><span class="lineno"> 1411</span>      <span class="keyword">ALLOCATE</span>(z_rc_imlt(ipack))          ; z_rc_imlt(:) = 0.</div>
<div class="line"><a id="l01412" name="l01412"></a><span class="lineno"> 1412</span>      <span class="keyword">ALLOCATE</span>(z_cc_imlt(ipack))          ; z_cc_imlt(:) = 0.</div>
<div class="line"><a id="l01413" name="l01413"></a><span class="lineno"> 1413</span>      <span class="keyword">ALLOCATE</span>(z_th_honc(ipack))          ; z_th_honc(:) = 0.</div>
<div class="line"><a id="l01414" name="l01414"></a><span class="lineno"> 1414</span>      <span class="keyword">ALLOCATE</span>(z_rc_honc(ipack))          ; z_rc_honc(:) = 0.</div>
<div class="line"><a id="l01415" name="l01415"></a><span class="lineno"> 1415</span>      <span class="keyword">ALLOCATE</span>(z_cc_honc(ipack))          ; z_cc_honc(:) = 0.</div>
<div class="line"><a id="l01416" name="l01416"></a><span class="lineno"> 1416</span>      <span class="keyword">ALLOCATE</span>(z_cc_self(ipack))          ; z_cc_self(:) = 0.</div>
<div class="line"><a id="l01417" name="l01417"></a><span class="lineno"> 1417</span>      <span class="keyword">ALLOCATE</span>(z_rc_auto(ipack))          ; z_rc_auto(:) = 0.</div>
<div class="line"><a id="l01418" name="l01418"></a><span class="lineno"> 1418</span>      <span class="keyword">ALLOCATE</span>(z_cc_auto(ipack))          ; z_cc_auto(:) = 0.</div>
<div class="line"><a id="l01419" name="l01419"></a><span class="lineno"> 1419</span>      <span class="keyword">ALLOCATE</span>(z_cr_auto(ipack))          ; z_cr_auto(:) = 0.</div>
<div class="line"><a id="l01420" name="l01420"></a><span class="lineno"> 1420</span>      <span class="keyword">ALLOCATE</span>(z_rc_accr(ipack))          ; z_rc_accr(:) = 0.</div>
<div class="line"><a id="l01421" name="l01421"></a><span class="lineno"> 1421</span>      <span class="keyword">ALLOCATE</span>(z_cc_accr(ipack))          ; z_cc_accr(:) = 0.</div>
<div class="line"><a id="l01422" name="l01422"></a><span class="lineno"> 1422</span>      <span class="keyword">ALLOCATE</span>(z_cr_scbu(ipack))          ; z_cr_scbu(:) = 0.</div>
<div class="line"><a id="l01423" name="l01423"></a><span class="lineno"> 1423</span>      <span class="keyword">ALLOCATE</span>(z_th_evap(ipack))          ; z_th_evap(:) = 0.</div>
<div class="line"><a id="l01424" name="l01424"></a><span class="lineno"> 1424</span>      <span class="keyword">ALLOCATE</span>(z_rr_evap(ipack))          ; z_rr_evap(:) = 0.</div>
<div class="line"><a id="l01425" name="l01425"></a><span class="lineno"> 1425</span>      <span class="keyword">ALLOCATE</span>(z_cr_evap(ipack))          ; z_cr_evap(:) = 0.</div>
<div class="line"><a id="l01426" name="l01426"></a><span class="lineno"> 1426</span>      <span class="keyword">ALLOCATE</span>(z_ri_cnvi(ipack))          ; z_ri_cnvi(:) = 0.</div>
<div class="line"><a id="l01427" name="l01427"></a><span class="lineno"> 1427</span>      <span class="keyword">ALLOCATE</span>(z_ci_cnvi(ipack))          ; z_ci_cnvi(:) = 0.</div>
<div class="line"><a id="l01428" name="l01428"></a><span class="lineno"> 1428</span>      <span class="keyword">ALLOCATE</span>(z_th_deps(ipack))          ; z_th_deps(:) = 0.</div>
<div class="line"><a id="l01429" name="l01429"></a><span class="lineno"> 1429</span>      <span class="keyword">ALLOCATE</span>(z_rs_deps(ipack))          ; z_rs_deps(:) = 0.</div>
<div class="line"><a id="l01430" name="l01430"></a><span class="lineno"> 1430</span>      <span class="keyword">ALLOCATE</span>(z_th_depi(ipack))          ; z_th_depi(:) = 0.</div>
<div class="line"><a id="l01431" name="l01431"></a><span class="lineno"> 1431</span>      <span class="keyword">ALLOCATE</span>(z_ri_depi(ipack))          ; z_ri_depi(:) = 0.</div>
<div class="line"><a id="l01432" name="l01432"></a><span class="lineno"> 1432</span>      <span class="keyword">ALLOCATE</span>(z_ri_cnvs(ipack))          ; z_ri_cnvs(:) = 0.</div>
<div class="line"><a id="l01433" name="l01433"></a><span class="lineno"> 1433</span>      <span class="keyword">ALLOCATE</span>(z_ci_cnvs(ipack))          ; z_ci_cnvs(:) = 0.</div>
<div class="line"><a id="l01434" name="l01434"></a><span class="lineno"> 1434</span>      <span class="keyword">ALLOCATE</span>(z_cs_ssc(ipack))           ; z_cs_ssc(:) = 0.</div>
<div class="line"><a id="l01435" name="l01435"></a><span class="lineno"> 1435</span>      <span class="keyword">ALLOCATE</span>(z_ci_isc(ipack))           ; z_ci_isc(:) = 0.</div>
<div class="line"><a id="l01436" name="l01436"></a><span class="lineno"> 1436</span>      <span class="keyword">ALLOCATE</span>(z_ri_aggs(ipack))          ; z_ri_aggs(:) = 0.</div>
<div class="line"><a id="l01437" name="l01437"></a><span class="lineno"> 1437</span>      <span class="keyword">ALLOCATE</span>(z_ci_aggs(ipack))          ; z_ci_aggs(:) = 0.</div>
<div class="line"><a id="l01438" name="l01438"></a><span class="lineno"> 1438</span>      <span class="keyword">ALLOCATE</span>(z_th_depg(ipack))          ; z_th_depg(:) = 0.</div>
<div class="line"><a id="l01439" name="l01439"></a><span class="lineno"> 1439</span>      <span class="keyword">ALLOCATE</span>(z_rg_depg(ipack))          ; z_rg_depg(:) = 0.</div>
<div class="line"><a id="l01440" name="l01440"></a><span class="lineno"> 1440</span>      <span class="keyword">ALLOCATE</span>(z_th_berfi(ipack))         ; z_th_berfi(:) = 0.</div>
<div class="line"><a id="l01441" name="l01441"></a><span class="lineno"> 1441</span>      <span class="keyword">ALLOCATE</span>(z_rc_berfi(ipack))         ; z_rc_berfi(:) = 0.</div>
<div class="line"><a id="l01442" name="l01442"></a><span class="lineno"> 1442</span>      <span class="keyword">ALLOCATE</span>(z_th_rim(ipack))           ; z_th_rim(:) = 0.</div>
<div class="line"><a id="l01443" name="l01443"></a><span class="lineno"> 1443</span>      <span class="keyword">ALLOCATE</span>(z_cc_rim(ipack))           ; z_cc_rim(:) = 0.</div>
<div class="line"><a id="l01444" name="l01444"></a><span class="lineno"> 1444</span>      <span class="keyword">ALLOCATE</span>(z_cs_rim(ipack))           ; z_cs_rim(:) = 0.</div>
<div class="line"><a id="l01445" name="l01445"></a><span class="lineno"> 1445</span>      <span class="keyword">ALLOCATE</span>(z_rc_rimss(ipack))         ; z_rc_rimss = 0.</div>
<div class="line"><a id="l01446" name="l01446"></a><span class="lineno"> 1446</span>      <span class="keyword">ALLOCATE</span>(z_rc_rimsg(ipack))         ; z_rc_rimsg = 0.</div>
<div class="line"><a id="l01447" name="l01447"></a><span class="lineno"> 1447</span>      <span class="keyword">ALLOCATE</span>(z_rs_rimcg(ipack))         ; z_rs_rimcg = 0.</div>
<div class="line"><a id="l01448" name="l01448"></a><span class="lineno"> 1448</span>      <span class="keyword">ALLOCATE</span>(z_ri_hms(ipack))           ; z_ri_hms(:) = 0.</div>
<div class="line"><a id="l01449" name="l01449"></a><span class="lineno"> 1449</span>      <span class="keyword">ALLOCATE</span>(z_ci_hms(ipack))           ; z_ci_hms(:) = 0.</div>
<div class="line"><a id="l01450" name="l01450"></a><span class="lineno"> 1450</span>      <span class="keyword">ALLOCATE</span>(z_rs_hms(ipack))           ; z_rs_hms(:) = 0.</div>
<div class="line"><a id="l01451" name="l01451"></a><span class="lineno"> 1451</span>      <span class="keyword">ALLOCATE</span>(z_th_acc(ipack))           ; z_th_acc(:) = 0.</div>
<div class="line"><a id="l01452" name="l01452"></a><span class="lineno"> 1452</span>      <span class="keyword">ALLOCATE</span>(z_cr_acc(ipack))           ; z_cr_acc(:) = 0.</div>
<div class="line"><a id="l01453" name="l01453"></a><span class="lineno"> 1453</span>      <span class="keyword">ALLOCATE</span>(z_cs_acc(ipack))           ; z_cs_acc(:) = 0.</div>
<div class="line"><a id="l01454" name="l01454"></a><span class="lineno"> 1454</span>      <span class="keyword">ALLOCATE</span>(z_rr_accss(ipack))         ; z_rr_accss = 0.</div>
<div class="line"><a id="l01455" name="l01455"></a><span class="lineno"> 1455</span>      <span class="keyword">ALLOCATE</span>(z_rr_accsg(ipack))         ; z_rr_accsg = 0.</div>
<div class="line"><a id="l01456" name="l01456"></a><span class="lineno"> 1456</span>      <span class="keyword">ALLOCATE</span>(z_rs_accrg(ipack))         ; z_rs_accrg = 0.</div>
<div class="line"><a id="l01457" name="l01457"></a><span class="lineno"> 1457</span>      <span class="keyword">ALLOCATE</span>(z_rs_cmel(ipack))          ; z_rs_cmel(:) = 0.</div>
<div class="line"><a id="l01458" name="l01458"></a><span class="lineno"> 1458</span>      <span class="keyword">ALLOCATE</span>(z_cs_cmel(ipack))          ; z_cs_cmel(:) = 0.</div>
<div class="line"><a id="l01459" name="l01459"></a><span class="lineno"> 1459</span>      <span class="keyword">ALLOCATE</span>(z_th_cfrz(ipack))          ; z_th_cfrz(:) = 0.</div>
<div class="line"><a id="l01460" name="l01460"></a><span class="lineno"> 1460</span>      <span class="keyword">ALLOCATE</span>(z_rr_cfrz(ipack))          ; z_rr_cfrz(:) = 0.</div>
<div class="line"><a id="l01461" name="l01461"></a><span class="lineno"> 1461</span>      <span class="keyword">ALLOCATE</span>(z_cr_cfrz(ipack))          ; z_cr_cfrz(:) = 0.</div>
<div class="line"><a id="l01462" name="l01462"></a><span class="lineno"> 1462</span>      <span class="keyword">ALLOCATE</span>(z_ri_cfrz(ipack))          ; z_ri_cfrz(:) = 0.</div>
<div class="line"><a id="l01463" name="l01463"></a><span class="lineno"> 1463</span>      <span class="keyword">ALLOCATE</span>(z_ci_cfrz(ipack))          ; z_ci_cfrz(:) = 0.</div>
<div class="line"><a id="l01464" name="l01464"></a><span class="lineno"> 1464</span>      <span class="keyword">ALLOCATE</span>(z_ri_cibu(ipack))          ; z_ri_cibu(:) = 0.</div>
<div class="line"><a id="l01465" name="l01465"></a><span class="lineno"> 1465</span>      <span class="keyword">ALLOCATE</span>(z_ci_cibu(ipack))          ; z_ci_cibu(:) = 0.</div>
<div class="line"><a id="l01466" name="l01466"></a><span class="lineno"> 1466</span>      <span class="keyword">ALLOCATE</span>(z_ri_rdsf(ipack))          ; z_ri_rdsf(:) = 0.</div>
<div class="line"><a id="l01467" name="l01467"></a><span class="lineno"> 1467</span>      <span class="keyword">ALLOCATE</span>(z_ci_rdsf(ipack))          ; z_ci_rdsf(:) = 0.</div>
<div class="line"><a id="l01468" name="l01468"></a><span class="lineno"> 1468</span>      <span class="keyword">ALLOCATE</span>(z_th_wetg(ipack))          ; z_th_wetg(:) = 0.</div>
<div class="line"><a id="l01469" name="l01469"></a><span class="lineno"> 1469</span>      <span class="keyword">ALLOCATE</span>(z_rc_wetg(ipack))          ; z_rc_wetg(:) = 0.</div>
<div class="line"><a id="l01470" name="l01470"></a><span class="lineno"> 1470</span>      <span class="keyword">ALLOCATE</span>(z_cc_wetg(ipack))          ; z_cc_wetg(:) = 0.</div>
<div class="line"><a id="l01471" name="l01471"></a><span class="lineno"> 1471</span>      <span class="keyword">ALLOCATE</span>(z_rr_wetg(ipack))          ; z_rr_wetg(:) = 0.</div>
<div class="line"><a id="l01472" name="l01472"></a><span class="lineno"> 1472</span>      <span class="keyword">ALLOCATE</span>(z_cr_wetg(ipack))          ; z_cr_wetg(:) = 0.</div>
<div class="line"><a id="l01473" name="l01473"></a><span class="lineno"> 1473</span>      <span class="keyword">ALLOCATE</span>(z_ri_wetg(ipack))          ; z_ri_wetg(:) = 0.</div>
<div class="line"><a id="l01474" name="l01474"></a><span class="lineno"> 1474</span>      <span class="keyword">ALLOCATE</span>(z_ci_wetg(ipack))          ; z_ci_wetg(:) = 0.</div>
<div class="line"><a id="l01475" name="l01475"></a><span class="lineno"> 1475</span>      <span class="keyword">ALLOCATE</span>(z_rs_wetg(ipack))          ; z_rs_wetg(:) = 0.</div>
<div class="line"><a id="l01476" name="l01476"></a><span class="lineno"> 1476</span>      <span class="keyword">ALLOCATE</span>(z_cs_wetg(ipack))          ; z_cs_wetg(:) = 0.</div>
<div class="line"><a id="l01477" name="l01477"></a><span class="lineno"> 1477</span>      <span class="keyword">ALLOCATE</span>(z_rg_wetg(ipack))          ; z_rg_wetg(:) = 0.</div>
<div class="line"><a id="l01478" name="l01478"></a><span class="lineno"> 1478</span>      <span class="keyword">ALLOCATE</span>(z_cg_wetg(ipack))          ; z_cg_wetg(:) = 0.</div>
<div class="line"><a id="l01479" name="l01479"></a><span class="lineno"> 1479</span>      <span class="keyword">ALLOCATE</span>(z_rh_wetg(ipack))          ; z_rh_wetg(:) = 0.</div>
<div class="line"><a id="l01480" name="l01480"></a><span class="lineno"> 1480</span>      <span class="keyword">ALLOCATE</span>(z_th_dryg(ipack))          ; z_th_dryg(:) = 0.</div>
<div class="line"><a id="l01481" name="l01481"></a><span class="lineno"> 1481</span>      <span class="keyword">ALLOCATE</span>(z_rc_dryg(ipack))          ; z_rc_dryg(:) = 0.</div>
<div class="line"><a id="l01482" name="l01482"></a><span class="lineno"> 1482</span>      <span class="keyword">ALLOCATE</span>(z_cc_dryg(ipack))          ; z_cc_dryg(:) = 0.</div>
<div class="line"><a id="l01483" name="l01483"></a><span class="lineno"> 1483</span>      <span class="keyword">ALLOCATE</span>(z_rr_dryg(ipack))          ; z_rr_dryg(:) = 0.</div>
<div class="line"><a id="l01484" name="l01484"></a><span class="lineno"> 1484</span>      <span class="keyword">ALLOCATE</span>(z_cr_dryg(ipack))          ; z_cr_dryg(:) = 0.</div>
<div class="line"><a id="l01485" name="l01485"></a><span class="lineno"> 1485</span>      <span class="keyword">ALLOCATE</span>(z_ri_dryg(ipack))          ; z_ri_dryg(:) = 0.</div>
<div class="line"><a id="l01486" name="l01486"></a><span class="lineno"> 1486</span>      <span class="keyword">ALLOCATE</span>(z_ci_dryg(ipack))          ; z_ci_dryg(:) = 0.</div>
<div class="line"><a id="l01487" name="l01487"></a><span class="lineno"> 1487</span>      <span class="keyword">ALLOCATE</span>(z_rs_dryg(ipack))          ; z_rs_dryg(:) = 0.</div>
<div class="line"><a id="l01488" name="l01488"></a><span class="lineno"> 1488</span>      <span class="keyword">ALLOCATE</span>(z_cs_dryg(ipack))          ; z_cs_dryg(:) = 0.</div>
<div class="line"><a id="l01489" name="l01489"></a><span class="lineno"> 1489</span>      <span class="keyword">ALLOCATE</span>(z_rg_dryg(ipack))          ; z_rg_dryg(:) = 0.</div>
<div class="line"><a id="l01490" name="l01490"></a><span class="lineno"> 1490</span>      <span class="keyword">ALLOCATE</span>(z_ri_hmg(ipack))           ; z_ri_hmg(:) = 0.</div>
<div class="line"><a id="l01491" name="l01491"></a><span class="lineno"> 1491</span>      <span class="keyword">ALLOCATE</span>(z_ci_hmg(ipack))           ; z_ci_hmg(:) = 0.</div>
<div class="line"><a id="l01492" name="l01492"></a><span class="lineno"> 1492</span>      <span class="keyword">ALLOCATE</span>(z_rg_hmg(ipack))           ; z_rg_hmg(:) = 0.</div>
<div class="line"><a id="l01493" name="l01493"></a><span class="lineno"> 1493</span>      <span class="keyword">ALLOCATE</span>(z_th_gmlt(ipack))          ; z_th_gmlt(:) = 0.</div>
<div class="line"><a id="l01494" name="l01494"></a><span class="lineno"> 1494</span>      <span class="keyword">ALLOCATE</span>(z_rr_gmlt(ipack))          ; z_rr_gmlt(:) = 0.</div>
<div class="line"><a id="l01495" name="l01495"></a><span class="lineno"> 1495</span>      <span class="keyword">ALLOCATE</span>(z_cr_gmlt(ipack))          ; z_cr_gmlt(:) = 0.</div>
<div class="line"><a id="l01496" name="l01496"></a><span class="lineno"> 1496</span>      <span class="keyword">ALLOCATE</span>(z_cg_gmlt(ipack))          ; z_cg_gmlt(:) = 0.</div>
<div class="line"><a id="l01497" name="l01497"></a><span class="lineno"> 1497</span>      <span class="keyword">ALLOCATE</span>(z_th_deph(ipack))          ; z_th_deph(:) = 0.</div>
<div class="line"><a id="l01498" name="l01498"></a><span class="lineno"> 1498</span>      <span class="keyword">ALLOCATE</span>(z_rh_deph(ipack))          ; z_rh_deph(:) = 0.</div>
<div class="line"><a id="l01499" name="l01499"></a><span class="lineno"> 1499</span>      <span class="keyword">ALLOCATE</span>(z_th_weth(ipack))          ; z_th_weth(:) = 0.</div>
<div class="line"><a id="l01500" name="l01500"></a><span class="lineno"> 1500</span>      <span class="keyword">ALLOCATE</span>(z_rc_weth(ipack))          ; z_rc_weth(:) = 0.</div>
<div class="line"><a id="l01501" name="l01501"></a><span class="lineno"> 1501</span>      <span class="keyword">ALLOCATE</span>(z_cc_weth(ipack))          ; z_cc_weth(:) = 0.</div>
<div class="line"><a id="l01502" name="l01502"></a><span class="lineno"> 1502</span>      <span class="keyword">ALLOCATE</span>(z_rr_weth(ipack))          ; z_rr_weth(:) = 0.</div>
<div class="line"><a id="l01503" name="l01503"></a><span class="lineno"> 1503</span>      <span class="keyword">ALLOCATE</span>(z_cr_weth(ipack))          ; z_cr_weth(:) = 0.</div>
<div class="line"><a id="l01504" name="l01504"></a><span class="lineno"> 1504</span>      <span class="keyword">ALLOCATE</span>(z_ri_weth(ipack))          ; z_ri_weth(:) = 0.</div>
<div class="line"><a id="l01505" name="l01505"></a><span class="lineno"> 1505</span>      <span class="keyword">ALLOCATE</span>(z_ci_weth(ipack))          ; z_ci_weth(:) = 0.</div>
<div class="line"><a id="l01506" name="l01506"></a><span class="lineno"> 1506</span>      <span class="keyword">ALLOCATE</span>(z_rs_weth(ipack))          ; z_rs_weth(:) = 0.</div>
<div class="line"><a id="l01507" name="l01507"></a><span class="lineno"> 1507</span>      <span class="keyword">ALLOCATE</span>(z_cs_weth(ipack))          ; z_cs_weth(:) = 0.</div>
<div class="line"><a id="l01508" name="l01508"></a><span class="lineno"> 1508</span>      <span class="keyword">ALLOCATE</span>(z_rg_weth(ipack))          ; z_rg_weth(:) = 0.</div>
<div class="line"><a id="l01509" name="l01509"></a><span class="lineno"> 1509</span>      <span class="keyword">ALLOCATE</span>(z_cg_weth(ipack))          ; z_cg_weth(:) = 0.</div>
<div class="line"><a id="l01510" name="l01510"></a><span class="lineno"> 1510</span>      <span class="keyword">ALLOCATE</span>(z_rh_weth(ipack))          ; z_rh_weth(:) = 0.</div>
<div class="line"><a id="l01511" name="l01511"></a><span class="lineno"> 1511</span>      <span class="keyword">ALLOCATE</span>(z_rg_cohg(ipack))          ; z_rg_cohg(:) = 0.</div>
<div class="line"><a id="l01512" name="l01512"></a><span class="lineno"> 1512</span>      <span class="keyword">ALLOCATE</span>(z_cg_cohg(ipack))          ; z_cg_cohg(:) = 0.</div>
<div class="line"><a id="l01513" name="l01513"></a><span class="lineno"> 1513</span>      <span class="keyword">ALLOCATE</span>(z_th_hmlt(ipack))          ; z_th_hmlt(:) = 0.</div>
<div class="line"><a id="l01514" name="l01514"></a><span class="lineno"> 1514</span>      <span class="keyword">ALLOCATE</span>(z_rr_hmlt(ipack))          ; z_rr_hmlt(:) = 0.</div>
<div class="line"><a id="l01515" name="l01515"></a><span class="lineno"> 1515</span>      <span class="keyword">ALLOCATE</span>(z_cr_hmlt(ipack))          ; z_cr_hmlt(:) = 0.</div>
<div class="line"><a id="l01516" name="l01516"></a><span class="lineno"> 1516</span>      <span class="keyword">ALLOCATE</span>(z_ch_hmlt(ipack))          ; z_ch_hmlt(:) = 0.</div>
<div class="line"><a id="l01517" name="l01517"></a><span class="lineno"> 1517</span> </div>
<div class="line"><a id="l01518" name="l01518"></a><span class="lineno"> 1518</span>      <span class="keyword">ALLOCATE</span>(z_rv_corr2(ipack))         ; z_rv_corr2(:) = 0.</div>
<div class="line"><a id="l01519" name="l01519"></a><span class="lineno"> 1519</span>      <span class="keyword">ALLOCATE</span>(z_rc_corr2(ipack))         ; z_rc_corr2(:) = 0.</div>
<div class="line"><a id="l01520" name="l01520"></a><span class="lineno"> 1520</span>      <span class="keyword">ALLOCATE</span>(z_rr_corr2(ipack))         ; z_rr_corr2(:) = 0.</div>
<div class="line"><a id="l01521" name="l01521"></a><span class="lineno"> 1521</span>      <span class="keyword">ALLOCATE</span>(z_ri_corr2(ipack))         ; z_ri_corr2(:) = 0.</div>
<div class="line"><a id="l01522" name="l01522"></a><span class="lineno"> 1522</span>      <span class="keyword">ALLOCATE</span>(z_cc_corr2(ipack))         ; z_cc_corr2(:) = 0.</div>
<div class="line"><a id="l01523" name="l01523"></a><span class="lineno"> 1523</span>      <span class="keyword">ALLOCATE</span>(z_cr_corr2(ipack))         ; z_cr_corr2(:) = 0.</div>
<div class="line"><a id="l01524" name="l01524"></a><span class="lineno"> 1524</span>      <span class="keyword">ALLOCATE</span>(z_ci_corr2(ipack))         ; z_ci_corr2(:) = 0.</div>
<div class="line"><a id="l01525" name="l01525"></a><span class="lineno"> 1525</span><span class="comment">!</span></div>
<div class="line"><a id="l01526" name="l01526"></a><span class="lineno"> 1526</span>      <span class="keywordflow">IF</span> (limap%LCRYSTAL_SHAPE) <span class="keywordflow">THEN</span></div>
<div class="line"><a id="l01527" name="l01527"></a><span class="lineno"> 1527</span>        <span class="keyword">ALLOCATE</span>(za_ci_shape(ipack,limap%NNB_CRYSTAL_SHAPE)) ; za_ci_shape(:,:) = 0.</div>
<div class="line"><a id="l01528" name="l01528"></a><span class="lineno"> 1528</span>        <span class="keyword">ALLOCATE</span>(zb_ci_shape(ipack,limap%NNB_CRYSTAL_SHAPE)) ; zb_ci_shape(:,:) = 0.</div>
<div class="line"><a id="l01529" name="l01529"></a><span class="lineno"> 1529</span>        <span class="keyword">ALLOCATE</span>(z_shci_imlt(ipack,limap%NNB_CRYSTAL_SHAPE)) ; z_shci_imlt(:,:) = 0.</div>
<div class="line"><a id="l01530" name="l01530"></a><span class="lineno"> 1530</span>        <span class="keyword">ALLOCATE</span>(z_shci_honc(ipack,limap%NNB_CRYSTAL_SHAPE)) ; z_shci_honc(:,:) = 0.</div>
<div class="line"><a id="l01531" name="l01531"></a><span class="lineno"> 1531</span>        <span class="keyword">ALLOCATE</span>(z_shci_cnvi(ipack,limap%NNB_CRYSTAL_SHAPE)) ; z_shci_cnvi(:,:) = 0.</div>
<div class="line"><a id="l01532" name="l01532"></a><span class="lineno"> 1532</span>        <span class="keyword">ALLOCATE</span>(z_shci_hach(ipack,limap%NNB_CRYSTAL_SHAPE)) ; z_shci_hach(:,:) = 0.</div>
<div class="line"><a id="l01533" name="l01533"></a><span class="lineno"> 1533</span>        <span class="keyword">ALLOCATE</span>(z_shci_cnvs(ipack,limap%NNB_CRYSTAL_SHAPE)) ; z_shci_cnvs(:,:) = 0.</div>
<div class="line"><a id="l01534" name="l01534"></a><span class="lineno"> 1534</span>        <span class="keyword">ALLOCATE</span>(z_shci_aggs(ipack,limap%NNB_CRYSTAL_SHAPE)) ; z_shci_aggs(:,:) = 0.</div>
<div class="line"><a id="l01535" name="l01535"></a><span class="lineno"> 1535</span>        <span class="keyword">ALLOCATE</span>(z_shci_hms(ipack,limap%NNB_CRYSTAL_SHAPE))  ; z_shci_hms(:,:)  = 0.</div>
<div class="line"><a id="l01536" name="l01536"></a><span class="lineno"> 1536</span>        <span class="keyword">ALLOCATE</span>(z_shci_cfrz(ipack,limap%NNB_CRYSTAL_SHAPE)) ; z_shci_cfrz(:,:) = 0.</div>
<div class="line"><a id="l01537" name="l01537"></a><span class="lineno"> 1537</span>        <span class="keyword">ALLOCATE</span>(z_shci_cibu(ipack,limap%NNB_CRYSTAL_SHAPE)) ; z_shci_cibu(:,:) = 0.</div>
<div class="line"><a id="l01538" name="l01538"></a><span class="lineno"> 1538</span>        <span class="keyword">ALLOCATE</span>(z_shci_rdsf(ipack,limap%NNB_CRYSTAL_SHAPE)) ; z_shci_rdsf(:,:) = 0.</div>
<div class="line"><a id="l01539" name="l01539"></a><span class="lineno"> 1539</span>        <span class="keyword">ALLOCATE</span>(z_shci_wetg(ipack,limap%NNB_CRYSTAL_SHAPE)) ; z_shci_wetg(:,:) = 0.</div>
<div class="line"><a id="l01540" name="l01540"></a><span class="lineno"> 1540</span>        <span class="keyword">ALLOCATE</span>(z_shci_dryg(ipack,limap%NNB_CRYSTAL_SHAPE)) ; z_shci_dryg(:,:) = 0.</div>
<div class="line"><a id="l01541" name="l01541"></a><span class="lineno"> 1541</span>        <span class="keyword">ALLOCATE</span>(z_shci_hmg(ipack,limap%NNB_CRYSTAL_SHAPE))  ; z_shci_hmg(:,:)  = 0.</div>
<div class="line"><a id="l01542" name="l01542"></a><span class="lineno"> 1542</span>        <span class="keyword">ALLOCATE</span>(z_shci_corr2(ipack,limap%NNB_CRYSTAL_SHAPE)); z_shci_corr2(:,:) = 0.</div>
<div class="line"><a id="l01543" name="l01543"></a><span class="lineno"> 1543</span>        <span class="keyword">ALLOCATE</span>(z_shci_isc(ipack,limap%NNB_CRYSTAL_SHAPE))  ; z_shci_isc(:,:)  = 0.</div>
<div class="line"><a id="l01544" name="l01544"></a><span class="lineno"> 1544</span>        <span class="keyword">ALLOCATE</span>(z_shci_iscs(ipack,limap%NNB_CRYSTAL_SHAPE)) ; z_shci_iscs(:,:) = 0.</div>
<div class="line"><a id="l01545" name="l01545"></a><span class="lineno"> 1545</span>        <span class="keyword">ALLOCATE</span>(z_shri_iscs(ipack))                   ; z_shri_iscs(:) = 0.</div>
<div class="line"><a id="l01546" name="l01546"></a><span class="lineno"> 1546</span>      <span class="keywordflow">ELSE</span></div>
<div class="line"><a id="l01547" name="l01547"></a><span class="lineno"> 1547</span>        <span class="keyword">ALLOCATE</span>(za_ci_shape(0,0))</div>
<div class="line"><a id="l01548" name="l01548"></a><span class="lineno"> 1548</span>        <span class="keyword">ALLOCATE</span>(zb_ci_shape(0,0))</div>
<div class="line"><a id="l01549" name="l01549"></a><span class="lineno"> 1549</span>        <span class="keyword">ALLOCATE</span>(z_shci_imlt(0,0))</div>
<div class="line"><a id="l01550" name="l01550"></a><span class="lineno"> 1550</span>        <span class="keyword">ALLOCATE</span>(z_shci_honc(0,0))</div>
<div class="line"><a id="l01551" name="l01551"></a><span class="lineno"> 1551</span>        <span class="keyword">ALLOCATE</span>(z_shci_cnvi(0,0))</div>
<div class="line"><a id="l01552" name="l01552"></a><span class="lineno"> 1552</span>        <span class="keyword">ALLOCATE</span>(z_shci_hach(0,0))</div>
<div class="line"><a id="l01553" name="l01553"></a><span class="lineno"> 1553</span>        <span class="keyword">ALLOCATE</span>(z_shci_cnvs(0,0))</div>
<div class="line"><a id="l01554" name="l01554"></a><span class="lineno"> 1554</span>        <span class="keyword">ALLOCATE</span>(z_shci_aggs(0,0))</div>
<div class="line"><a id="l01555" name="l01555"></a><span class="lineno"> 1555</span>        <span class="keyword">ALLOCATE</span>(z_shci_hms(0,0))</div>
<div class="line"><a id="l01556" name="l01556"></a><span class="lineno"> 1556</span>        <span class="keyword">ALLOCATE</span>(z_shci_cfrz(0,0))</div>
<div class="line"><a id="l01557" name="l01557"></a><span class="lineno"> 1557</span>        <span class="keyword">ALLOCATE</span>(z_shci_cibu(0,0))</div>
<div class="line"><a id="l01558" name="l01558"></a><span class="lineno"> 1558</span>        <span class="keyword">ALLOCATE</span>(z_shci_rdsf(0,0))</div>
<div class="line"><a id="l01559" name="l01559"></a><span class="lineno"> 1559</span>        <span class="keyword">ALLOCATE</span>(z_shci_wetg(0,0))</div>
<div class="line"><a id="l01560" name="l01560"></a><span class="lineno"> 1560</span>        <span class="keyword">ALLOCATE</span>(z_shci_dryg(0,0))</div>
<div class="line"><a id="l01561" name="l01561"></a><span class="lineno"> 1561</span>        <span class="keyword">ALLOCATE</span>(z_shci_hmg(0,0))</div>
<div class="line"><a id="l01562" name="l01562"></a><span class="lineno"> 1562</span>        <span class="keyword">ALLOCATE</span>(z_shci_corr2(0,0))</div>
<div class="line"><a id="l01563" name="l01563"></a><span class="lineno"> 1563</span>        <span class="keyword">ALLOCATE</span>(z_shci_isc(0,0))</div>
<div class="line"><a id="l01564" name="l01564"></a><span class="lineno"> 1564</span>        <span class="keyword">ALLOCATE</span>(z_shci_iscs(0,0))</div>
<div class="line"><a id="l01565" name="l01565"></a><span class="lineno"> 1565</span>        <span class="keyword">ALLOCATE</span>(z_shri_iscs(0))</div>
<div class="line"><a id="l01566" name="l01566"></a><span class="lineno"> 1566</span><span class="keywordflow">      END IF</span></div>
<div class="line"><a id="l01567" name="l01567"></a><span class="lineno"> 1567</span>      <span class="comment">!</span></div>
<div class="line"><a id="l01568" name="l01568"></a><span class="lineno"> 1568</span>      <span class="comment">!***       4.1 Tendencies computation</span></div>
<div class="line"><a id="l01569" name="l01569"></a><span class="lineno"> 1569</span>      <span class="comment">!</span></div>
<div class="line"><a id="l01570" name="l01570"></a><span class="lineno"> 1570</span>      <span class="keyword">CALL </span>lima_inst_procs (cst, limap, limaw, ipack, ptstep, glcompute1d,      &amp;</div>
<div class="line"><a id="l01571" name="l01571"></a><span class="lineno"> 1571</span>                            zexnref1d, zp1d,                                    &amp;</div>
<div class="line"><a id="l01572" name="l01572"></a><span class="lineno"> 1572</span>                            ztht1d, zrvt1d, zrct1d, zrrt1d, zrit1d, zrst1d, zrgt1d, &amp;</div>
<div class="line"><a id="l01573" name="l01573"></a><span class="lineno"> 1573</span>                            zcct1d, zcrt1d, zcit1d, zcit1d_shape,               &amp;</div>
<div class="line"><a id="l01574" name="l01574"></a><span class="lineno"> 1574</span>                            zifnn1d,                                            &amp;</div>
<div class="line"><a id="l01575" name="l01575"></a><span class="lineno"> 1575</span>                            z_cr_brku,                                          &amp; <span class="comment">! spontaneous break up of drops (BRKU) : Nr</span></div>
<div class="line"><a id="l01576" name="l01576"></a><span class="lineno"> 1576</span>                            z_th_honr, z_rr_honr, z_cr_honr,                    &amp; <span class="comment">! rain drops homogeneous freezing (HONR) : rr, Nr, rg=-rr, th</span></div>
<div class="line"><a id="l01577" name="l01577"></a><span class="lineno"> 1577</span>                            z_th_imlt, z_rc_imlt, z_cc_imlt,                    &amp; <span class="comment">! ice melting (IMLT) : rc, Nc, ri=-rc, Ni=-Nc, th, IFNF, IFNA</span></div>
<div class="line"><a id="l01578" name="l01578"></a><span class="lineno"> 1578</span>                            z_shci_imlt,                                        &amp;</div>
<div class="line"><a id="l01579" name="l01579"></a><span class="lineno"> 1579</span>                            zb_th, zb_rv, zb_rc, zb_rr, zb_ri, zb_rg,           &amp;</div>
<div class="line"><a id="l01580" name="l01580"></a><span class="lineno"> 1580</span>                            zb_cc, zb_cr, zb_ci, zb_ci_shape, zb_cg,            &amp;</div>
<div class="line"><a id="l01581" name="l01581"></a><span class="lineno"> 1581</span>                            zb_ifnn,                                            &amp;</div>
<div class="line"><a id="l01582" name="l01582"></a><span class="lineno"> 1582</span>                            zcf1d, zif1d, zpf1d                                 )</div>
<div class="line"><a id="l01583" name="l01583"></a><span class="lineno"> 1583</span>      </div>
<div class="line"><a id="l01584" name="l01584"></a><span class="lineno"> 1584</span>      <span class="keyword">CALL </span>lima_tendencies (cst, limap, limaw, limac, limam, ipack, ptstep, glcompute1d, &amp;</div>
<div class="line"><a id="l01585" name="l01585"></a><span class="lineno"> 1585</span>                            zexnref1d, zrhodref1d, zp1d, ztht1d,                    &amp;</div>
<div class="line"><a id="l01586" name="l01586"></a><span class="lineno"> 1586</span>                            zrvt1d, zrct1d, zrrt1d, zrit1d, zrst1d, zrgt1d, zrht1d, &amp;</div>
<div class="line"><a id="l01587" name="l01587"></a><span class="lineno"> 1587</span>                            zcct1d, zcrt1d, zcit1d, zcit1d_shape, zcst1d, zcgt1d, zcht1d, &amp;</div>
<div class="line"><a id="l01588" name="l01588"></a><span class="lineno"> 1588</span>                            z_th_honc, z_rc_honc, z_cc_honc, z_shci_honc,           &amp; </div>
<div class="line"><a id="l01589" name="l01589"></a><span class="lineno"> 1589</span>                            z_cc_self,                                              &amp; </div>
<div class="line"><a id="l01590" name="l01590"></a><span class="lineno"> 1590</span>                            z_rc_auto, z_cc_auto, z_cr_auto,                        &amp; </div>
<div class="line"><a id="l01591" name="l01591"></a><span class="lineno"> 1591</span>                            z_rc_accr, z_cc_accr,                                   &amp; </div>
<div class="line"><a id="l01592" name="l01592"></a><span class="lineno"> 1592</span>                            z_cr_scbu,                                              &amp; </div>
<div class="line"><a id="l01593" name="l01593"></a><span class="lineno"> 1593</span>                            z_th_evap, z_rr_evap, z_cr_evap,                        &amp; </div>
<div class="line"><a id="l01594" name="l01594"></a><span class="lineno"> 1594</span>                            z_ri_cnvi, z_ci_cnvi, z_shci_cnvi,                      &amp; </div>
<div class="line"><a id="l01595" name="l01595"></a><span class="lineno"> 1595</span>                            z_th_deps, z_rs_deps,                                   &amp; </div>
<div class="line"><a id="l01596" name="l01596"></a><span class="lineno"> 1596</span>                            z_th_depi, z_ri_depi, z_shci_hach,                      &amp; </div>
<div class="line"><a id="l01597" name="l01597"></a><span class="lineno"> 1597</span>                            z_ri_cnvs, z_ci_cnvs, z_shci_cnvs,                      &amp;</div>
<div class="line"><a id="l01598" name="l01598"></a><span class="lineno"> 1598</span>                            z_cs_ssc,  z_ci_isc, z_shci_isc, z_shri_iscs, z_shci_iscs, &amp;</div>
<div class="line"><a id="l01599" name="l01599"></a><span class="lineno"> 1599</span>                            z_ri_aggs, z_ci_aggs, z_shci_aggs,                      &amp;</div>
<div class="line"><a id="l01600" name="l01600"></a><span class="lineno"> 1600</span>                            z_th_depg, z_rg_depg,                                   &amp; </div>
<div class="line"><a id="l01601" name="l01601"></a><span class="lineno"> 1601</span>                            z_th_berfi, z_rc_berfi,                                 &amp; </div>
<div class="line"><a id="l01602" name="l01602"></a><span class="lineno"> 1602</span>                            z_th_rim, z_cc_rim, z_cs_rim, z_rc_rimss, z_rc_rimsg, z_rs_rimcg, &amp;</div>
<div class="line"><a id="l01603" name="l01603"></a><span class="lineno"> 1603</span>                            z_ri_hms, z_ci_hms, z_rs_hms, z_shci_hms,                         &amp;</div>
<div class="line"><a id="l01604" name="l01604"></a><span class="lineno"> 1604</span>                            z_th_acc, z_cr_acc, z_cs_acc, z_rr_accss, z_rr_accsg, z_rs_accrg, &amp;</div>
<div class="line"><a id="l01605" name="l01605"></a><span class="lineno"> 1605</span>                            z_rs_cmel, z_cs_cmel,                                   &amp; </div>
<div class="line"><a id="l01606" name="l01606"></a><span class="lineno"> 1606</span>                            z_th_cfrz, z_rr_cfrz, z_cr_cfrz, z_ri_cfrz, z_ci_cfrz, z_shci_cfrz,&amp; </div>
<div class="line"><a id="l01607" name="l01607"></a><span class="lineno"> 1607</span>                            z_ri_cibu, z_ci_cibu, z_shci_cibu,                      &amp; </div>
<div class="line"><a id="l01608" name="l01608"></a><span class="lineno"> 1608</span>                            z_ri_rdsf, z_ci_rdsf, z_shci_rdsf,                      &amp; </div>
<div class="line"><a id="l01609" name="l01609"></a><span class="lineno"> 1609</span>                            z_th_wetg, z_rc_wetg, z_cc_wetg, z_rr_wetg, z_cr_wetg,  &amp; </div>
<div class="line"><a id="l01610" name="l01610"></a><span class="lineno"> 1610</span>                            z_ri_wetg, z_ci_wetg, z_rs_wetg, z_cs_wetg, z_rg_wetg, z_cg_wetg,  &amp;</div>
<div class="line"><a id="l01611" name="l01611"></a><span class="lineno"> 1611</span>                            z_rh_wetg, z_shci_wetg,                                 &amp; </div>
<div class="line"><a id="l01612" name="l01612"></a><span class="lineno"> 1612</span>                            z_th_dryg, z_rc_dryg, z_cc_dryg, z_rr_dryg, z_cr_dryg,  &amp; </div>
<div class="line"><a id="l01613" name="l01613"></a><span class="lineno"> 1613</span>                            z_ri_dryg, z_ci_dryg, z_rs_dryg, z_cs_dryg, z_rg_dryg, z_shci_dryg,&amp; </div>
<div class="line"><a id="l01614" name="l01614"></a><span class="lineno"> 1614</span>                            z_ri_hmg, z_ci_hmg, z_rg_hmg, z_shci_hmg,               &amp; </div>
<div class="line"><a id="l01615" name="l01615"></a><span class="lineno"> 1615</span>                            z_th_gmlt, z_rr_gmlt, z_cr_gmlt, z_cg_gmlt,             &amp;</div>
<div class="line"><a id="l01616" name="l01616"></a><span class="lineno"> 1616</span>                            z_th_deph, z_rh_deph,                                   &amp;</div>
<div class="line"><a id="l01617" name="l01617"></a><span class="lineno"> 1617</span>                            z_th_weth, z_rc_weth, z_cc_weth, z_rr_weth, z_cr_weth,  &amp;</div>
<div class="line"><a id="l01618" name="l01618"></a><span class="lineno"> 1618</span>                            z_ri_weth, z_ci_weth, z_rs_weth, z_cs_weth, z_rg_weth,  &amp;</div>
<div class="line"><a id="l01619" name="l01619"></a><span class="lineno"> 1619</span>                            z_cg_weth, z_rh_weth, &amp;</div>
<div class="line"><a id="l01620" name="l01620"></a><span class="lineno"> 1620</span>                            z_rg_cohg, z_cg_cohg,                                   &amp;</div>
<div class="line"><a id="l01621" name="l01621"></a><span class="lineno"> 1621</span>                            z_th_hmlt, z_rr_hmlt, z_cr_hmlt, z_ch_hmlt,             &amp;</div>
<div class="line"><a id="l01622" name="l01622"></a><span class="lineno"> 1622</span>                            za_th, za_rv, za_rc, za_cc, za_rr, za_cr,               &amp;</div>
<div class="line"><a id="l01623" name="l01623"></a><span class="lineno"> 1623</span>                            za_ri, za_ci, za_ci_shape, za_rs, za_cs, za_rg, za_cg,  &amp;</div>
<div class="line"><a id="l01624" name="l01624"></a><span class="lineno"> 1624</span>                            za_rh, za_ch,                                           &amp;</div>
<div class="line"><a id="l01625" name="l01625"></a><span class="lineno"> 1625</span>                            zevap1d,                                                &amp;</div>
<div class="line"><a id="l01626" name="l01626"></a><span class="lineno"> 1626</span>                            zcf1d, zif1d, zpf1d,                                    &amp;</div>
<div class="line"><a id="l01627" name="l01627"></a><span class="lineno"> 1627</span>                            zlatham_iaggs                                           )</div>
<div class="line"><a id="l01628" name="l01628"></a><span class="lineno"> 1628</span> </div>
<div class="line"><a id="l01629" name="l01629"></a><span class="lineno"> 1629</span>      <span class="comment">!</span></div>
<div class="line"><a id="l01630" name="l01630"></a><span class="lineno"> 1630</span>      <span class="comment">!***       4.2 Integration time</span></div>
<div class="line"><a id="l01631" name="l01631"></a><span class="lineno"> 1631</span>      <span class="comment">!</span></div>
<div class="line"><a id="l01632" name="l01632"></a><span class="lineno"> 1632</span>      <span class="comment">! If we can, we will use these tendecies until the end of the timestep</span></div>
<div class="line"><a id="l01633" name="l01633"></a><span class="lineno"> 1633</span>      zmaxtime(:)=ptstep-ztime1d(:) <span class="comment">! Remaining time until the end of the timestep</span></div>
<div class="line"><a id="l01634" name="l01634"></a><span class="lineno"> 1634</span> </div>
<div class="line"><a id="l01635" name="l01635"></a><span class="lineno"> 1635</span>      <span class="comment">! We need to adjust tendencies when temperature reaches 0</span></div>
<div class="line"><a id="l01636" name="l01636"></a><span class="lineno"> 1636</span>      <span class="keywordflow">IF</span>(limap%LFEEDBACKT) <span class="keywordflow">THEN</span></div>
<div class="line"><a id="l01637" name="l01637"></a><span class="lineno"> 1637</span>         <span class="comment">!Is ZB_TH enough to change temperature sign?</span></div>
<div class="line"><a id="l01638" name="l01638"></a><span class="lineno"> 1638</span>         <span class="keywordflow">WHERE</span>( ((ztht1d(:) - cst%XTT/zexn1d(:)) * (ztht1d(:) + zb_th(:) - cst%XTT/zexn1d(:))) &lt; 0. )</div>
<div class="line"><a id="l01639" name="l01639"></a><span class="lineno"> 1639</span>            zmaxtime(:)=0.</div>
<div class="line"><a id="l01640" name="l01640"></a><span class="lineno"> 1640</span><span class="keywordflow">         ENDWHERE</span></div>
<div class="line"><a id="l01641" name="l01641"></a><span class="lineno"> 1641</span>         <span class="comment">!Can ZA_TH make temperature change of sign?</span></div>
<div class="line"><a id="l01642" name="l01642"></a><span class="lineno"> 1642</span>         ztime_threshold(:)=-1.</div>
<div class="line"><a id="l01643" name="l01643"></a><span class="lineno"> 1643</span>         <span class="keywordflow">WHERE</span>(abs(za_th(:))&gt;1.e-20)</div>
<div class="line"><a id="l01644" name="l01644"></a><span class="lineno"> 1644</span>            ztime_threshold(:)=(cst%XTT/zexn1d(:) - zb_th(:) - ztht1d(:))/za_th(:)</div>
<div class="line"><a id="l01645" name="l01645"></a><span class="lineno"> 1645</span><span class="keywordflow">         ENDWHERE</span></div>
<div class="line"><a id="l01646" name="l01646"></a><span class="lineno"> 1646</span>         <span class="keywordflow">WHERE</span>(ztime_threshold(:)&gt;0.)</div>
<div class="line"><a id="l01647" name="l01647"></a><span class="lineno"> 1647</span>            zmaxtime(:)=min(zmaxtime(:), ztime_threshold(:))</div>
<div class="line"><a id="l01648" name="l01648"></a><span class="lineno"> 1648</span><span class="keywordflow">         ENDWHERE</span></div>
<div class="line"><a id="l01649" name="l01649"></a><span class="lineno"> 1649</span><span class="keywordflow">      ENDIF</span></div>
<div class="line"><a id="l01650" name="l01650"></a><span class="lineno"> 1650</span> </div>
<div class="line"><a id="l01651" name="l01651"></a><span class="lineno"> 1651</span>      <span class="comment">! We need to adjust tendencies when a species disappears</span></div>
<div class="line"><a id="l01652" name="l01652"></a><span class="lineno"> 1652</span>      <span class="comment">! When a species is missing, only the external tendencies can be negative (and we must keep track of it)</span></div>
<div class="line"><a id="l01653" name="l01653"></a><span class="lineno"> 1653</span>      <span class="keywordflow">WHERE</span>(za_rv(:)&lt;-1.e-20 .AND. zrvt1d(:)&gt;limap%XRTMIN(1))</div>
<div class="line"><a id="l01654" name="l01654"></a><span class="lineno"> 1654</span>         zmaxtime(:)=min(zmaxtime(:), -(zb_rv(:)+zrvt1d(:))/za_rv(:))</div>
<div class="line"><a id="l01655" name="l01655"></a><span class="lineno"> 1655</span><span class="keywordflow">      END WHERE</span></div>
<div class="line"><a id="l01656" name="l01656"></a><span class="lineno"> 1656</span>      <span class="keywordflow">WHERE</span>(za_rc(:)&lt;-1.e-20 .AND. zrct1d(:)&gt;limap%XRTMIN(2))</div>
<div class="line"><a id="l01657" name="l01657"></a><span class="lineno"> 1657</span>         zmaxtime(:)=min(zmaxtime(:), -(zb_rc(:)+zrct1d(:))/za_rc(:))</div>
<div class="line"><a id="l01658" name="l01658"></a><span class="lineno"> 1658</span><span class="keywordflow">      END WHERE</span></div>
<div class="line"><a id="l01659" name="l01659"></a><span class="lineno"> 1659</span>      <span class="keywordflow">IF</span> (limap%NMOM_C.GE.2) <span class="keywordflow">THEN</span></div>
<div class="line"><a id="l01660" name="l01660"></a><span class="lineno"> 1660</span>         <span class="keywordflow">WHERE</span>(za_cc(:)&lt;-1.e-20 .AND. zcct1d(:)&gt;limap%XCTMIN(2))</div>
<div class="line"><a id="l01661" name="l01661"></a><span class="lineno"> 1661</span>            zmaxtime(:)=min(zmaxtime(:), -(zb_cc(:)+zcct1d(:))/za_cc(:))</div>
<div class="line"><a id="l01662" name="l01662"></a><span class="lineno"> 1662</span><span class="keywordflow">         END WHERE</span></div>
<div class="line"><a id="l01663" name="l01663"></a><span class="lineno"> 1663</span><span class="keywordflow">      ENDIF</span></div>
<div class="line"><a id="l01664" name="l01664"></a><span class="lineno"> 1664</span>      <span class="keywordflow">WHERE</span>(za_rr(:)&lt;-1.e-20 .AND. zrrt1d(:)&gt;limap%XRTMIN(3))</div>
<div class="line"><a id="l01665" name="l01665"></a><span class="lineno"> 1665</span>         zmaxtime(:)=min(zmaxtime(:), -(zb_rr(:)+zrrt1d(:))/za_rr(:))</div>
<div class="line"><a id="l01666" name="l01666"></a><span class="lineno"> 1666</span><span class="keywordflow">      END WHERE</span></div>
<div class="line"><a id="l01667" name="l01667"></a><span class="lineno"> 1667</span>      <span class="keywordflow">IF</span> (limap%NMOM_R.GE.2) <span class="keywordflow">THEN</span></div>
<div class="line"><a id="l01668" name="l01668"></a><span class="lineno"> 1668</span>         <span class="keywordflow">WHERE</span>(za_cr(:)&lt;-1.e-20 .AND. zcrt1d(:)&gt;limap%XCTMIN(3))</div>
<div class="line"><a id="l01669" name="l01669"></a><span class="lineno"> 1669</span>            zmaxtime(:)=min(zmaxtime(:), -(zb_cr(:)+zcrt1d(:))/za_cr(:))</div>
<div class="line"><a id="l01670" name="l01670"></a><span class="lineno"> 1670</span><span class="keywordflow">         END WHERE</span></div>
<div class="line"><a id="l01671" name="l01671"></a><span class="lineno"> 1671</span><span class="keywordflow">      ENDIF</span></div>
<div class="line"><a id="l01672" name="l01672"></a><span class="lineno"> 1672</span>      <span class="keywordflow">WHERE</span>(za_ri(:)&lt;-1.e-20 .AND. zrit1d(:)&gt;limap%XRTMIN(4))</div>
<div class="line"><a id="l01673" name="l01673"></a><span class="lineno"> 1673</span>         zmaxtime(:)=min(zmaxtime(:), -(zb_ri(:)+zrit1d(:))/za_ri(:))</div>
<div class="line"><a id="l01674" name="l01674"></a><span class="lineno"> 1674</span><span class="keywordflow">      END WHERE</span></div>
<div class="line"><a id="l01675" name="l01675"></a><span class="lineno"> 1675</span>      <span class="keywordflow">IF</span> (limap%NMOM_I.GE.2) <span class="keywordflow">THEN</span></div>
<div class="line"><a id="l01676" name="l01676"></a><span class="lineno"> 1676</span>         <span class="keywordflow">WHERE</span>(za_ci(:)&lt;-1.e-20 .AND. zcit1d(:)&gt;limap%XCTMIN(4))</div>
<div class="line"><a id="l01677" name="l01677"></a><span class="lineno"> 1677</span>            zmaxtime(:)=min(zmaxtime(:), -(zb_ci(:)+zcit1d(:))/za_ci(:))</div>
<div class="line"><a id="l01678" name="l01678"></a><span class="lineno"> 1678</span><span class="keywordflow">         END WHERE</span></div>
<div class="line"><a id="l01679" name="l01679"></a><span class="lineno"> 1679</span><span class="keywordflow">      ENDIF</span></div>
<div class="line"><a id="l01680" name="l01680"></a><span class="lineno"> 1680</span>      <span class="keywordflow">WHERE</span>(za_rs(:)&lt;-1.e-20 .AND. zrst1d(:)&gt;limap%XRTMIN(5))</div>
<div class="line"><a id="l01681" name="l01681"></a><span class="lineno"> 1681</span>         zmaxtime(:)=min(zmaxtime(:), -(zb_rs(:)+zrst1d(:))/za_rs(:))</div>
<div class="line"><a id="l01682" name="l01682"></a><span class="lineno"> 1682</span><span class="keywordflow">      END WHERE</span></div>
<div class="line"><a id="l01683" name="l01683"></a><span class="lineno"> 1683</span>      <span class="keywordflow">IF</span> (limap%NMOM_S.GE.2) <span class="keywordflow">THEN</span></div>
<div class="line"><a id="l01684" name="l01684"></a><span class="lineno"> 1684</span>         <span class="keywordflow">WHERE</span>(za_cs(:)&lt;-1.e-20 .AND. zcst1d(:)&gt;limap%XCTMIN(5))</div>
<div class="line"><a id="l01685" name="l01685"></a><span class="lineno"> 1685</span>            zmaxtime(:)=min(zmaxtime(:), -(zb_cs(:)+zcst1d(:))/za_cs(:))</div>
<div class="line"><a id="l01686" name="l01686"></a><span class="lineno"> 1686</span><span class="keywordflow">         END WHERE</span></div>
<div class="line"><a id="l01687" name="l01687"></a><span class="lineno"> 1687</span><span class="keywordflow">      ENDIF</span></div>
<div class="line"><a id="l01688" name="l01688"></a><span class="lineno"> 1688</span>      <span class="keywordflow">WHERE</span>(za_rg(:)&lt;-1.e-20 .AND. zrgt1d(:)&gt;limap%XRTMIN(6))</div>
<div class="line"><a id="l01689" name="l01689"></a><span class="lineno"> 1689</span>         zmaxtime(:)=min(zmaxtime(:), -(zb_rg(:)+zrgt1d(:))/za_rg(:))</div>
<div class="line"><a id="l01690" name="l01690"></a><span class="lineno"> 1690</span><span class="keywordflow">      END WHERE</span></div>
<div class="line"><a id="l01691" name="l01691"></a><span class="lineno"> 1691</span>      <span class="keywordflow">IF</span> (limap%NMOM_G.GE.2) <span class="keywordflow">THEN</span></div>
<div class="line"><a id="l01692" name="l01692"></a><span class="lineno"> 1692</span>         <span class="keywordflow">WHERE</span>(za_cg(:)&lt;-1.e-20 .AND. zcgt1d(:)&gt;limap%XCTMIN(6))</div>
<div class="line"><a id="l01693" name="l01693"></a><span class="lineno"> 1693</span>            zmaxtime(:)=min(zmaxtime(:), -(zb_cg(:)+zcgt1d(:))/za_cg(:))</div>
<div class="line"><a id="l01694" name="l01694"></a><span class="lineno"> 1694</span><span class="keywordflow">         END WHERE</span></div>
<div class="line"><a id="l01695" name="l01695"></a><span class="lineno"> 1695</span><span class="keywordflow">      ENDIF</span></div>
<div class="line"><a id="l01696" name="l01696"></a><span class="lineno"> 1696</span>      <span class="keywordflow">WHERE</span>(za_rh(:)&lt;-1.e-20 .AND. zrht1d(:)&gt;limap%XRTMIN(7))</div>
<div class="line"><a id="l01697" name="l01697"></a><span class="lineno"> 1697</span>         zmaxtime(:)=min(zmaxtime(:), -(zb_rh(:)+zrht1d(:))/za_rh(:))</div>
<div class="line"><a id="l01698" name="l01698"></a><span class="lineno"> 1698</span><span class="keywordflow">      END WHERE</span></div>
<div class="line"><a id="l01699" name="l01699"></a><span class="lineno"> 1699</span>      <span class="keywordflow">IF</span> (limap%NMOM_H.GE.2) <span class="keywordflow">THEN</span></div>
<div class="line"><a id="l01700" name="l01700"></a><span class="lineno"> 1700</span>         <span class="keywordflow">WHERE</span>(za_ch(:)&lt;-1.e-20 .AND. zcht1d(:)&gt;limap%XCTMIN(7))</div>
<div class="line"><a id="l01701" name="l01701"></a><span class="lineno"> 1701</span>            zmaxtime(:)=min(zmaxtime(:), -(zb_ch(:)+zcht1d(:))/za_ch(:))</div>
<div class="line"><a id="l01702" name="l01702"></a><span class="lineno"> 1702</span><span class="keywordflow">         END WHERE</span></div>
<div class="line"><a id="l01703" name="l01703"></a><span class="lineno"> 1703</span><span class="keywordflow">      ENDIF</span></div>
<div class="line"><a id="l01704" name="l01704"></a><span class="lineno"> 1704</span> </div>
<div class="line"><a id="l01705" name="l01705"></a><span class="lineno"> 1705</span>      <span class="comment">! We stop when the end of the timestep is reached</span></div>
<div class="line"><a id="l01706" name="l01706"></a><span class="lineno"> 1706</span>      <span class="keywordflow">WHERE</span>(ptstep-ztime1d(:)-zmaxtime(:)&lt;=0.)</div>
<div class="line"><a id="l01707" name="l01707"></a><span class="lineno"> 1707</span>         glcompute1d(:)=.false.</div>
<div class="line"><a id="l01708" name="l01708"></a><span class="lineno"> 1708</span><span class="keywordflow">      ENDWHERE</span></div>
<div class="line"><a id="l01709" name="l01709"></a><span class="lineno"> 1709</span> </div>
<div class="line"><a id="l01710" name="l01710"></a><span class="lineno"> 1710</span>      <span class="comment">! We must recompute tendencies when the end of the sub-timestep is reached</span></div>
<div class="line"><a id="l01711" name="l01711"></a><span class="lineno"> 1711</span>      <span class="keywordflow">IF</span>(limap%XTSTEP_TS/=0.) <span class="keywordflow">THEN</span></div>
<div class="line"><a id="l01712" name="l01712"></a><span class="lineno"> 1712</span>         <span class="keywordflow">WHERE</span>(iiter1d(:)&lt;inb_iter_max .AND. ztime1d(:)+zmaxtime(:)&gt;ztime_lastcall1d(:)+ztstep)</div>
<div class="line"><a id="l01713" name="l01713"></a><span class="lineno"> 1713</span>            zmaxtime(:)=ztime_lastcall1d(:)-ztime1d(:)+ztstep</div>
<div class="line"><a id="l01714" name="l01714"></a><span class="lineno"> 1714</span>            glcompute1d(:)=.false.</div>
<div class="line"><a id="l01715" name="l01715"></a><span class="lineno"> 1715</span><span class="keywordflow">         ENDWHERE</span></div>
<div class="line"><a id="l01716" name="l01716"></a><span class="lineno"> 1716</span><span class="keywordflow">      ENDIF</span></div>
<div class="line"><a id="l01717" name="l01717"></a><span class="lineno"> 1717</span> </div>
<div class="line"><a id="l01718" name="l01718"></a><span class="lineno"> 1718</span>      <span class="comment">! We must recompute tendencies when the maximum allowed change is reached</span></div>
<div class="line"><a id="l01719" name="l01719"></a><span class="lineno"> 1719</span>      <span class="comment">! When a species is missing, only the external tendencies can be active and we do not want to recompute</span></div>
<div class="line"><a id="l01720" name="l01720"></a><span class="lineno"> 1720</span>      <span class="comment">! the microphysical tendencies when external tendencies are negative (results won&#39;t change because species was already missing)</span></div>
<div class="line"><a id="l01721" name="l01721"></a><span class="lineno"> 1721</span>      <span class="keywordflow">IF</span>(limap%XMRSTEP/=0.) <span class="keywordflow">THEN</span></div>
<div class="line"><a id="l01722" name="l01722"></a><span class="lineno"> 1722</span>         ztime_threshold(:)=-1.</div>
<div class="line"><a id="l01723" name="l01723"></a><span class="lineno"> 1723</span>         <span class="keywordflow">WHERE</span>(iiter1d(:)&lt;inb_iter_max .AND. abs(za_rv(:))&gt;1.e-20)</div>
<div class="line"><a id="l01724" name="l01724"></a><span class="lineno"> 1724</span>            ztime_threshold(:)=(sign(1., za_rv(:))*limap%XMRSTEP+z0rvt1d(:)-zrvt1d(:)-zb_rv(:))/za_rv(:)</div>
<div class="line"><a id="l01725" name="l01725"></a><span class="lineno"> 1725</span><span class="keywordflow">         ENDWHERE</span></div>
<div class="line"><a id="l01726" name="l01726"></a><span class="lineno"> 1726</span>         <span class="keywordflow">WHERE</span>(ztime_threshold(:)&gt;=0. .AND. ztime_threshold(:)&lt;zmaxtime(:) .AND. &amp;</div>
<div class="line"><a id="l01727" name="l01727"></a><span class="lineno"> 1727</span>              &amp;(zrvt1d(:)&gt;limap%XRTMIN(1) .OR. za_rv(:)&gt;0.))</div>
<div class="line"><a id="l01728" name="l01728"></a><span class="lineno"> 1728</span>            zmaxtime(:)=min(zmaxtime(:), ztime_threshold(:))</div>
<div class="line"><a id="l01729" name="l01729"></a><span class="lineno"> 1729</span>            glcompute1d(:)=.false.</div>
<div class="line"><a id="l01730" name="l01730"></a><span class="lineno"> 1730</span><span class="keywordflow">         ENDWHERE</span></div>
<div class="line"><a id="l01731" name="l01731"></a><span class="lineno"> 1731</span> </div>
<div class="line"><a id="l01732" name="l01732"></a><span class="lineno"> 1732</span>         ztime_threshold(:)=-1.</div>
<div class="line"><a id="l01733" name="l01733"></a><span class="lineno"> 1733</span>         <span class="keywordflow">WHERE</span>(iiter1d(:)&lt;inb_iter_max .AND. abs(za_rc(:))&gt;1.e-20)</div>
<div class="line"><a id="l01734" name="l01734"></a><span class="lineno"> 1734</span>            ztime_threshold(:)=(sign(1., za_rc(:))*limap%XMRSTEP+z0rct1d(:)-zrct1d(:)-zb_rc(:))/za_rc(:)</div>
<div class="line"><a id="l01735" name="l01735"></a><span class="lineno"> 1735</span><span class="keywordflow">         ENDWHERE</span></div>
<div class="line"><a id="l01736" name="l01736"></a><span class="lineno"> 1736</span>         <span class="keywordflow">WHERE</span>(ztime_threshold(:)&gt;=0. .AND. ztime_threshold(:)&lt;zmaxtime(:) .AND. &amp;</div>
<div class="line"><a id="l01737" name="l01737"></a><span class="lineno"> 1737</span>              &amp;(zrct1d(:)&gt;limap%XRTMIN(2) .OR. za_rc(:)&gt;0.))</div>
<div class="line"><a id="l01738" name="l01738"></a><span class="lineno"> 1738</span>            zmaxtime(:)=min(zmaxtime(:), ztime_threshold(:))</div>
<div class="line"><a id="l01739" name="l01739"></a><span class="lineno"> 1739</span>            glcompute1d(:)=.false.</div>
<div class="line"><a id="l01740" name="l01740"></a><span class="lineno"> 1740</span><span class="keywordflow">         ENDWHERE</span></div>
<div class="line"><a id="l01741" name="l01741"></a><span class="lineno"> 1741</span> </div>
<div class="line"><a id="l01742" name="l01742"></a><span class="lineno"> 1742</span>         ztime_threshold(:)=-1.</div>
<div class="line"><a id="l01743" name="l01743"></a><span class="lineno"> 1743</span>         <span class="keywordflow">WHERE</span>(iiter1d(:)&lt;inb_iter_max .AND. abs(za_rr(:))&gt;1.e-20)</div>
<div class="line"><a id="l01744" name="l01744"></a><span class="lineno"> 1744</span>            ztime_threshold(:)=(sign(1., za_rr(:))*limap%XMRSTEP+z0rrt1d(:)-zrrt1d(:)-zb_rr(:))/za_rr(:)</div>
<div class="line"><a id="l01745" name="l01745"></a><span class="lineno"> 1745</span><span class="keywordflow">         ENDWHERE</span></div>
<div class="line"><a id="l01746" name="l01746"></a><span class="lineno"> 1746</span>         <span class="keywordflow">WHERE</span>(ztime_threshold(:)&gt;=0. .AND. ztime_threshold(:)&lt;zmaxtime(:) .AND. &amp;</div>
<div class="line"><a id="l01747" name="l01747"></a><span class="lineno"> 1747</span>              &amp;(zrrt1d(:)&gt;limap%XRTMIN(3) .OR. za_rr(:)&gt;0.))</div>
<div class="line"><a id="l01748" name="l01748"></a><span class="lineno"> 1748</span>            zmaxtime(:)=min(zmaxtime(:), ztime_threshold(:))</div>
<div class="line"><a id="l01749" name="l01749"></a><span class="lineno"> 1749</span>            glcompute1d(:)=.false.</div>
<div class="line"><a id="l01750" name="l01750"></a><span class="lineno"> 1750</span><span class="keywordflow">         ENDWHERE</span></div>
<div class="line"><a id="l01751" name="l01751"></a><span class="lineno"> 1751</span> </div>
<div class="line"><a id="l01752" name="l01752"></a><span class="lineno"> 1752</span>         ztime_threshold(:)=-1.</div>
<div class="line"><a id="l01753" name="l01753"></a><span class="lineno"> 1753</span>         <span class="keywordflow">WHERE</span>(iiter1d(:)&lt;inb_iter_max .AND. abs(za_ri(:))&gt;1.e-20)</div>
<div class="line"><a id="l01754" name="l01754"></a><span class="lineno"> 1754</span>            ztime_threshold(:)=(sign(1., za_ri(:))*limap%XMRSTEP+z0rit1d(:)-zrit1d(:)-zb_ri(:))/za_ri(:)</div>
<div class="line"><a id="l01755" name="l01755"></a><span class="lineno"> 1755</span><span class="keywordflow">         ENDWHERE</span></div>
<div class="line"><a id="l01756" name="l01756"></a><span class="lineno"> 1756</span>         <span class="keywordflow">WHERE</span>(ztime_threshold(:)&gt;=0. .AND. ztime_threshold(:)&lt;zmaxtime(:) .AND. &amp;</div>
<div class="line"><a id="l01757" name="l01757"></a><span class="lineno"> 1757</span>              &amp;(zrit1d(:)&gt;limap%XRTMIN(4) .OR. za_ri(:)&gt;0.))</div>
<div class="line"><a id="l01758" name="l01758"></a><span class="lineno"> 1758</span>            zmaxtime(:)=min(zmaxtime(:), ztime_threshold(:))</div>
<div class="line"><a id="l01759" name="l01759"></a><span class="lineno"> 1759</span>            glcompute1d(:)=.false.</div>
<div class="line"><a id="l01760" name="l01760"></a><span class="lineno"> 1760</span><span class="keywordflow">         ENDWHERE</span></div>
<div class="line"><a id="l01761" name="l01761"></a><span class="lineno"> 1761</span> </div>
<div class="line"><a id="l01762" name="l01762"></a><span class="lineno"> 1762</span>         ztime_threshold(:)=-1.</div>
<div class="line"><a id="l01763" name="l01763"></a><span class="lineno"> 1763</span>         <span class="keywordflow">WHERE</span>(iiter1d(:)&lt;inb_iter_max .AND. abs(za_rs(:))&gt;1.e-20)</div>
<div class="line"><a id="l01764" name="l01764"></a><span class="lineno"> 1764</span>            ztime_threshold(:)=(sign(1., za_rs(:))*limap%XMRSTEP+z0rst1d(:)-zrst1d(:)-zb_rs(:))/za_rs(:)</div>
<div class="line"><a id="l01765" name="l01765"></a><span class="lineno"> 1765</span><span class="keywordflow">         ENDWHERE</span></div>
<div class="line"><a id="l01766" name="l01766"></a><span class="lineno"> 1766</span>         <span class="keywordflow">WHERE</span>(ztime_threshold(:)&gt;=0. .AND. ztime_threshold(:)&lt;zmaxtime(:) .AND. &amp;</div>
<div class="line"><a id="l01767" name="l01767"></a><span class="lineno"> 1767</span>              &amp;(zrst1d(:)&gt;limap%XRTMIN(5) .OR. za_rs(:)&gt;0.))</div>
<div class="line"><a id="l01768" name="l01768"></a><span class="lineno"> 1768</span>            zmaxtime(:)=min(zmaxtime(:), ztime_threshold(:))</div>
<div class="line"><a id="l01769" name="l01769"></a><span class="lineno"> 1769</span>            glcompute1d(:)=.false.</div>
<div class="line"><a id="l01770" name="l01770"></a><span class="lineno"> 1770</span><span class="keywordflow">         ENDWHERE</span></div>
<div class="line"><a id="l01771" name="l01771"></a><span class="lineno"> 1771</span> </div>
<div class="line"><a id="l01772" name="l01772"></a><span class="lineno"> 1772</span>         ztime_threshold(:)=-1.</div>
<div class="line"><a id="l01773" name="l01773"></a><span class="lineno"> 1773</span>         <span class="keywordflow">WHERE</span>(iiter1d(:)&lt;inb_iter_max .AND. abs(za_rg(:))&gt;1.e-20)</div>
<div class="line"><a id="l01774" name="l01774"></a><span class="lineno"> 1774</span>            ztime_threshold(:)=(sign(1., za_rg(:))*limap%XMRSTEP+z0rgt1d(:)-zrgt1d(:)-zb_rg(:))/za_rg(:)</div>
<div class="line"><a id="l01775" name="l01775"></a><span class="lineno"> 1775</span><span class="keywordflow">         ENDWHERE</span></div>
<div class="line"><a id="l01776" name="l01776"></a><span class="lineno"> 1776</span>         <span class="keywordflow">WHERE</span>(ztime_threshold(:)&gt;=0. .AND. ztime_threshold(:)&lt;zmaxtime(:) .AND. &amp;</div>
<div class="line"><a id="l01777" name="l01777"></a><span class="lineno"> 1777</span>              &amp;(zrgt1d(:)&gt;limap%XRTMIN(6) .OR. za_rg(:)&gt;0.))</div>
<div class="line"><a id="l01778" name="l01778"></a><span class="lineno"> 1778</span>            zmaxtime(:)=min(zmaxtime(:), ztime_threshold(:))</div>
<div class="line"><a id="l01779" name="l01779"></a><span class="lineno"> 1779</span>            glcompute1d(:)=.false.</div>
<div class="line"><a id="l01780" name="l01780"></a><span class="lineno"> 1780</span><span class="keywordflow">         ENDWHERE</span></div>
<div class="line"><a id="l01781" name="l01781"></a><span class="lineno"> 1781</span> </div>
<div class="line"><a id="l01782" name="l01782"></a><span class="lineno"> 1782</span>         ztime_threshold(:)=-1.</div>
<div class="line"><a id="l01783" name="l01783"></a><span class="lineno"> 1783</span>         <span class="keywordflow">WHERE</span>(iiter1d(:)&lt;inb_iter_max .AND. abs(za_rh(:))&gt;1.e-20)</div>
<div class="line"><a id="l01784" name="l01784"></a><span class="lineno"> 1784</span>            ztime_threshold(:)=(sign(1., za_rh(:))*limap%XMRSTEP+z0rht1d(:)-zrht1d(:)-zb_rh(:))/za_rh(:)</div>
<div class="line"><a id="l01785" name="l01785"></a><span class="lineno"> 1785</span><span class="keywordflow">         ENDWHERE</span></div>
<div class="line"><a id="l01786" name="l01786"></a><span class="lineno"> 1786</span>         <span class="keywordflow">WHERE</span>(ztime_threshold(:)&gt;=0. .AND. ztime_threshold(:)&lt;zmaxtime(:) .AND. &amp;</div>
<div class="line"><a id="l01787" name="l01787"></a><span class="lineno"> 1787</span>              &amp;(zrht1d(:)&gt;limap%XRTMIN(7) .OR. za_rh(:)&gt;0.))</div>
<div class="line"><a id="l01788" name="l01788"></a><span class="lineno"> 1788</span>            zmaxtime(:)=min(zmaxtime(:), ztime_threshold(:))</div>
<div class="line"><a id="l01789" name="l01789"></a><span class="lineno"> 1789</span>            glcompute1d(:)=.false.</div>
<div class="line"><a id="l01790" name="l01790"></a><span class="lineno"> 1790</span><span class="keywordflow">         ENDWHERE</span></div>
<div class="line"><a id="l01791" name="l01791"></a><span class="lineno"> 1791</span> </div>
<div class="line"><a id="l01792" name="l01792"></a><span class="lineno"> 1792</span>         <span class="keywordflow">WHERE</span>(iiter1d(:)&lt;inb_iter_max .AND. max(abs(zb_rv(:)),  &amp;</div>
<div class="line"><a id="l01793" name="l01793"></a><span class="lineno"> 1793</span>              abs(zb_rc(:)), abs(zb_rr(:)), abs(zb_ri(:)), &amp;</div>
<div class="line"><a id="l01794" name="l01794"></a><span class="lineno"> 1794</span>              abs(zb_rs(:)), abs(zb_rg(:)), abs(zb_rh(:)))&gt;limap%XMRSTEP)</div>
<div class="line"><a id="l01795" name="l01795"></a><span class="lineno"> 1795</span>            zmaxtime(:)=0.</div>
<div class="line"><a id="l01796" name="l01796"></a><span class="lineno"> 1796</span>            glcompute1d(:)=.false.</div>
<div class="line"><a id="l01797" name="l01797"></a><span class="lineno"> 1797</span><span class="keywordflow">         ENDWHERE</span></div>
<div class="line"><a id="l01798" name="l01798"></a><span class="lineno"> 1798</span><span class="keywordflow">      ENDIF</span></div>
<div class="line"><a id="l01799" name="l01799"></a><span class="lineno"> 1799</span>      <span class="comment">!</span></div>
<div class="line"><a id="l01800" name="l01800"></a><span class="lineno"> 1800</span>      <span class="comment">!***       4.3 New values of variables for next iteration</span></div>
<div class="line"><a id="l01801" name="l01801"></a><span class="lineno"> 1801</span>      <span class="comment">!</span></div>
<div class="line"><a id="l01802" name="l01802"></a><span class="lineno"> 1802</span>      ztht1d = ztht1d + za_th(:) * zmaxtime(:) + zb_th(:)</div>
<div class="line"><a id="l01803" name="l01803"></a><span class="lineno"> 1803</span>      zrvt1d = zrvt1d + za_rv(:) * zmaxtime(:) + zb_rv(:)</div>
<div class="line"><a id="l01804" name="l01804"></a><span class="lineno"> 1804</span>      zrct1d = zrct1d + za_rc(:) * zmaxtime(:) + zb_rc(:)</div>
<div class="line"><a id="l01805" name="l01805"></a><span class="lineno"> 1805</span>      <span class="keywordflow">IF</span> (limap%NMOM_C.GE.2) zcct1d = zcct1d + za_cc(:) * zmaxtime(:) + zb_cc(:)</div>
<div class="line"><a id="l01806" name="l01806"></a><span class="lineno"> 1806</span>      zrrt1d = zrrt1d + za_rr(:) * zmaxtime(:) + zb_rr(:)</div>
<div class="line"><a id="l01807" name="l01807"></a><span class="lineno"> 1807</span>      <span class="keywordflow">IF</span> (limap%NMOM_R.GE.2) zcrt1d = zcrt1d + za_cr(:) * zmaxtime(:) + zb_cr(:)</div>
<div class="line"><a id="l01808" name="l01808"></a><span class="lineno"> 1808</span>      zrit1d = zrit1d + za_ri(:) * zmaxtime(:) + zb_ri(:)</div>
<div class="line"><a id="l01809" name="l01809"></a><span class="lineno"> 1809</span>      <span class="keywordflow">IF</span> (limap%NMOM_I.GE.2) zcit1d = zcit1d + za_ci(:) * zmaxtime(:) + zb_ci(:)</div>
<div class="line"><a id="l01810" name="l01810"></a><span class="lineno"> 1810</span>      zrst1d = zrst1d + za_rs(:) * zmaxtime(:) + zb_rs(:)</div>
<div class="line"><a id="l01811" name="l01811"></a><span class="lineno"> 1811</span>      <span class="keywordflow">IF</span> (limap%NMOM_S.GE.2) zcst1d = zcst1d + za_cs(:) * zmaxtime(:) + zb_cs(:)</div>
<div class="line"><a id="l01812" name="l01812"></a><span class="lineno"> 1812</span>      zrgt1d = zrgt1d + za_rg(:) * zmaxtime(:) + zb_rg(:)</div>
<div class="line"><a id="l01813" name="l01813"></a><span class="lineno"> 1813</span>      <span class="keywordflow">IF</span> (limap%NMOM_G.GE.2) zcgt1d = zcgt1d + za_cg(:) * zmaxtime(:) + zb_cg(:)</div>
<div class="line"><a id="l01814" name="l01814"></a><span class="lineno"> 1814</span>      zrht1d = zrht1d + za_rh(:) * zmaxtime(:) + zb_rh(:)</div>
<div class="line"><a id="l01815" name="l01815"></a><span class="lineno"> 1815</span>      <span class="keywordflow">IF</span> (limap%NMOM_H.GE.2) zcht1d = zcht1d + za_ch(:) * zmaxtime(:) + zb_ch(:)</div>
<div class="line"><a id="l01816" name="l01816"></a><span class="lineno"> 1816</span>      <span class="keywordflow">IF</span> (limap%LCRYSTAL_SHAPE) <span class="keywordflow">THEN</span></div>
<div class="line"><a id="l01817" name="l01817"></a><span class="lineno"> 1817</span>        <span class="keywordflow">DO</span> ish = 1, limap%NNB_CRYSTAL_SHAPE</div>
<div class="line"><a id="l01818" name="l01818"></a><span class="lineno"> 1818</span>          zcit1d_shape(:,ish) = zcit1d_shape(:,ish) + &amp;</div>
<div class="line"><a id="l01819" name="l01819"></a><span class="lineno"> 1819</span>                                za_ci_shape(:,ish) * zmaxtime(:) + zb_ci_shape(:,ish)</div>
<div class="line"><a id="l01820" name="l01820"></a><span class="lineno"> 1820</span><span class="keywordflow">        END DO</span></div>
<div class="line"><a id="l01821" name="l01821"></a><span class="lineno"> 1821</span>        zcit1d(:) = sum(zcit1d_shape,dim=2)</div>
<div class="line"><a id="l01822" name="l01822"></a><span class="lineno"> 1822</span><span class="keywordflow">      END IF</span></div>
<div class="line"><a id="l01823" name="l01823"></a><span class="lineno"> 1823</span>      <span class="comment">!</span></div>
<div class="line"><a id="l01824" name="l01824"></a><span class="lineno"> 1824</span>      <span class="keywordflow">DO</span> ii=1,limap%NMOD_IFN</div>
<div class="line"><a id="l01825" name="l01825"></a><span class="lineno"> 1825</span>         zifnn1d(:,ii) = zifnn1d(:,ii) + zb_ifnn(:,ii)</div>
<div class="line"><a id="l01826" name="l01826"></a><span class="lineno"> 1826</span><span class="keywordflow">      END DO</span></div>
<div class="line"><a id="l01827" name="l01827"></a><span class="lineno"> 1827</span>      <span class="comment">!</span></div>
<div class="line"><a id="l01828" name="l01828"></a><span class="lineno"> 1828</span>      <span class="comment">!***       4.5 </span></div>
<div class="line"><a id="l01829" name="l01829"></a><span class="lineno"> 1829</span>      <span class="comment">!</span></div>
<div class="line"><a id="l01830" name="l01830"></a><span class="lineno"> 1830</span>      <span class="keywordflow">WHERE</span> (zrct1d .LE. limap%XRTMIN(2))</div>
<div class="line"><a id="l01831" name="l01831"></a><span class="lineno"> 1831</span>         z_rv_corr2(:) = zrct1d(:)</div>
<div class="line"><a id="l01832" name="l01832"></a><span class="lineno"> 1832</span>         z_rc_corr2(:) = -zrct1d(:)</div>
<div class="line"><a id="l01833" name="l01833"></a><span class="lineno"> 1833</span>         z_cc_corr2(:) = -zcct1d(:)</div>
<div class="line"><a id="l01834" name="l01834"></a><span class="lineno"> 1834</span> </div>
<div class="line"><a id="l01835" name="l01835"></a><span class="lineno"> 1835</span>         zrvt1d = zrvt1d + zrct1d</div>
<div class="line"><a id="l01836" name="l01836"></a><span class="lineno"> 1836</span>         zrct1d = 0.</div>
<div class="line"><a id="l01837" name="l01837"></a><span class="lineno"> 1837</span>         zcct1d = 0.</div>
<div class="line"><a id="l01838" name="l01838"></a><span class="lineno"> 1838</span><span class="keywordflow">      END WHERE</span></div>
<div class="line"><a id="l01839" name="l01839"></a><span class="lineno"> 1839</span>      <span class="keywordflow">WHERE</span> (zrrt1d .LE. limap%XRTMIN(3))</div>
<div class="line"><a id="l01840" name="l01840"></a><span class="lineno"> 1840</span>         z_rv_corr2(:) = z_rv_corr2(:) + zrrt1d(:)</div>
<div class="line"><a id="l01841" name="l01841"></a><span class="lineno"> 1841</span>         z_rr_corr2(:) = -zrrt1d(:)</div>
<div class="line"><a id="l01842" name="l01842"></a><span class="lineno"> 1842</span>         z_cr_corr2(:) = -zcrt1d(:)</div>
<div class="line"><a id="l01843" name="l01843"></a><span class="lineno"> 1843</span> </div>
<div class="line"><a id="l01844" name="l01844"></a><span class="lineno"> 1844</span>         zrvt1d = zrvt1d + zrrt1d</div>
<div class="line"><a id="l01845" name="l01845"></a><span class="lineno"> 1845</span>         zrrt1d = 0.</div>
<div class="line"><a id="l01846" name="l01846"></a><span class="lineno"> 1846</span>         zcrt1d = 0.</div>
<div class="line"><a id="l01847" name="l01847"></a><span class="lineno"> 1847</span><span class="keywordflow">      END WHERE</span></div>
<div class="line"><a id="l01848" name="l01848"></a><span class="lineno"> 1848</span><span class="comment">! on traite les formes avant pour eviter que zrit1d ne soit modifie (where)</span></div>
<div class="line"><a id="l01849" name="l01849"></a><span class="lineno"> 1849</span>      <span class="keywordflow">IF</span> (limap%LCRYSTAL_SHAPE) <span class="keywordflow">THEN</span></div>
<div class="line"><a id="l01850" name="l01850"></a><span class="lineno"> 1850</span>        <span class="keywordflow">DO</span> ish = 1, limap%NNB_CRYSTAL_SHAPE</div>
<div class="line"><a id="l01851" name="l01851"></a><span class="lineno"> 1851</span>          <span class="keywordflow">WHERE</span> (zrit1d .LE. limap%XRTMIN(4))</div>
<div class="line"><a id="l01852" name="l01852"></a><span class="lineno"> 1852</span>            z_shci_corr2(:,ish) = -zcit1d_shape(:,ish)</div>
<div class="line"><a id="l01853" name="l01853"></a><span class="lineno"> 1853</span>            zcit1d_shape(:,ish) = 0.</div>
<div class="line"><a id="l01854" name="l01854"></a><span class="lineno"> 1854</span><span class="keywordflow">          END WHERE</span></div>
<div class="line"><a id="l01855" name="l01855"></a><span class="lineno"> 1855</span><span class="keywordflow">        END DO</span></div>
<div class="line"><a id="l01856" name="l01856"></a><span class="lineno"> 1856</span>        zcit1d(:) = sum(zcit1d_shape,dim=2) <span class="comment">!++cb-- 08/03/24</span></div>
<div class="line"><a id="l01857" name="l01857"></a><span class="lineno"> 1857</span><span class="keywordflow">      END IF</span></div>
<div class="line"><a id="l01858" name="l01858"></a><span class="lineno"> 1858</span>      <span class="keywordflow">WHERE</span> (zrit1d .LE. limap%XRTMIN(4))</div>
<div class="line"><a id="l01859" name="l01859"></a><span class="lineno"> 1859</span>         z_rv_corr2(:) = z_rv_corr2(:) + zrit1d(:)</div>
<div class="line"><a id="l01860" name="l01860"></a><span class="lineno"> 1860</span>         z_ri_corr2(:) = -zrit1d(:)</div>
<div class="line"><a id="l01861" name="l01861"></a><span class="lineno"> 1861</span>         z_ci_corr2(:) = -zcit1d(:)</div>
<div class="line"><a id="l01862" name="l01862"></a><span class="lineno"> 1862</span> </div>
<div class="line"><a id="l01863" name="l01863"></a><span class="lineno"> 1863</span>         zrvt1d = zrvt1d + zrit1d</div>
<div class="line"><a id="l01864" name="l01864"></a><span class="lineno"> 1864</span>         zrit1d = 0.</div>
<div class="line"><a id="l01865" name="l01865"></a><span class="lineno"> 1865</span>         zcit1d = 0.</div>
<div class="line"><a id="l01866" name="l01866"></a><span class="lineno"> 1866</span><span class="keywordflow">      END WHERE</span>      </div>
<div class="line"><a id="l01867" name="l01867"></a><span class="lineno"> 1867</span>      <span class="comment">!</span></div>
<div class="line"><a id="l01868" name="l01868"></a><span class="lineno"> 1868</span>      <span class="comment">!***       4.5 Next loop</span></div>
<div class="line"><a id="l01869" name="l01869"></a><span class="lineno"> 1869</span>      <span class="comment">!</span></div>
<div class="line"><a id="l01870" name="l01870"></a><span class="lineno"> 1870</span>      ztime1d(:)=ztime1d(:)+zmaxtime(:)</div>
<div class="line"><a id="l01871" name="l01871"></a><span class="lineno"> 1871</span>      <span class="comment">!</span></div>
<div class="line"><a id="l01872" name="l01872"></a><span class="lineno"> 1872</span>      <span class="comment">!***       4.4 Unpacking</span></div>
<div class="line"><a id="l01873" name="l01873"></a><span class="lineno"> 1873</span>      <span class="comment">!</span></div>
<div class="line"><a id="l01874" name="l01874"></a><span class="lineno"> 1874</span>      <span class="keywordflow">DO</span> ii=1,ipack</div>
<div class="line"><a id="l01875" name="l01875"></a><span class="lineno"> 1875</span>         ztht(i1(ii),i3(ii))      = ztht1d(ii)</div>
<div class="line"><a id="l01876" name="l01876"></a><span class="lineno"> 1876</span>         zrvt(i1(ii),i3(ii))      = zrvt1d(ii)</div>
<div class="line"><a id="l01877" name="l01877"></a><span class="lineno"> 1877</span>         zrct(i1(ii),i3(ii))      = zrct1d(ii)</div>
<div class="line"><a id="l01878" name="l01878"></a><span class="lineno"> 1878</span>         zrrt(i1(ii),i3(ii))      = zrrt1d(ii)</div>
<div class="line"><a id="l01879" name="l01879"></a><span class="lineno"> 1879</span>         zrit(i1(ii),i3(ii))      = zrit1d(ii)</div>
<div class="line"><a id="l01880" name="l01880"></a><span class="lineno"> 1880</span>         zrst(i1(ii),i3(ii))      = zrst1d(ii)</div>
<div class="line"><a id="l01881" name="l01881"></a><span class="lineno"> 1881</span>         zrgt(i1(ii),i3(ii))      = zrgt1d(ii)</div>
<div class="line"><a id="l01882" name="l01882"></a><span class="lineno"> 1882</span>         zrht(i1(ii),i3(ii))      = zrht1d(ii)</div>
<div class="line"><a id="l01883" name="l01883"></a><span class="lineno"> 1883</span>         <span class="keywordflow">IF</span> (limap%NMOM_C.GE.2) zcct(i1(ii),i3(ii))      = zcct1d(ii)</div>
<div class="line"><a id="l01884" name="l01884"></a><span class="lineno"> 1884</span>         <span class="keywordflow">IF</span> (limap%NMOM_R.GE.2) zcrt(i1(ii),i3(ii))      = zcrt1d(ii)</div>
<div class="line"><a id="l01885" name="l01885"></a><span class="lineno"> 1885</span>         <span class="keywordflow">IF</span> (limap%NMOM_I.GE.2) zcit(i1(ii),i3(ii))      = zcit1d(ii)</div>
<div class="line"><a id="l01886" name="l01886"></a><span class="lineno"> 1886</span>         <span class="keywordflow">IF</span> (limap%NMOM_S.GE.2) zcst(i1(ii),i3(ii))      = zcst1d(ii)</div>
<div class="line"><a id="l01887" name="l01887"></a><span class="lineno"> 1887</span>         <span class="keywordflow">IF</span> (limap%NMOM_G.GE.2) zcgt(i1(ii),i3(ii))      = zcgt1d(ii)</div>
<div class="line"><a id="l01888" name="l01888"></a><span class="lineno"> 1888</span>         <span class="keywordflow">IF</span> (limap%NMOM_H.GE.2) zcht(i1(ii),i3(ii))      = zcht1d(ii)</div>
<div class="line"><a id="l01889" name="l01889"></a><span class="lineno"> 1889</span>         <span class="keywordflow">IF</span> (limap%LCRYSTAL_SHAPE) <span class="keywordflow">THEN</span></div>
<div class="line"><a id="l01890" name="l01890"></a><span class="lineno"> 1890</span>           <span class="keywordflow">DO</span> ish = 1, limap%NNB_CRYSTAL_SHAPE</div>
<div class="line"><a id="l01891" name="l01891"></a><span class="lineno"> 1891</span>             zcit_shape(i1(ii),i3(ii),ish) = zcit1d_shape(ii,ish)</div>
<div class="line"><a id="l01892" name="l01892"></a><span class="lineno"> 1892</span><span class="keywordflow">           END DO</span></div>
<div class="line"><a id="l01893" name="l01893"></a><span class="lineno"> 1893</span><span class="keywordflow">         END IF</span></div>
<div class="line"><a id="l01894" name="l01894"></a><span class="lineno"> 1894</span>         zifnnt(i1(ii),i3(ii),:)  = zifnn1d(ii,:)</div>
<div class="line"><a id="l01895" name="l01895"></a><span class="lineno"> 1895</span>         pevap3d(i1(ii),i3(ii))   = zevap1d(ii)</div>
<div class="line"><a id="l01896" name="l01896"></a><span class="lineno"> 1896</span>         ztime(i1(ii),i3(ii))     = ztime1d(ii)</div>
<div class="line"><a id="l01897" name="l01897"></a><span class="lineno"> 1897</span>         glcompute(i1(ii),i3(ii)) = glcompute1d(ii)</div>
<div class="line"><a id="l01898" name="l01898"></a><span class="lineno"> 1898</span>         iiter(i1(ii),i3(ii))     = iiter1d(ii)</div>
<div class="line"><a id="l01899" name="l01899"></a><span class="lineno"> 1899</span><span class="keywordflow">      END DO</span></div>
<div class="line"><a id="l01900" name="l01900"></a><span class="lineno"> 1900</span>      <span class="comment">!</span></div>
<div class="line"><a id="l01901" name="l01901"></a><span class="lineno"> 1901</span><span class="comment">!!$      IF (LIMAP%NMOM_C.GE.2 .AND. LIMAP%NMOM_R.GE.2) THEN</span></div>
<div class="line"><a id="l01902" name="l01902"></a><span class="lineno"> 1902</span><span class="comment">!!$         CALL LIMA_DROPS_TO_DROPLETS_CONV(LIMAP, D, PRHODREF, ZRCT, ZRRT, ZCCT, ZCRT, &amp;</span></div>
<div class="line"><a id="l01903" name="l01903"></a><span class="lineno"> 1903</span><span class="comment">!!$              Z_RR_CVRC, Z_CR_CVRC    )</span></div>
<div class="line"><a id="l01904" name="l01904"></a><span class="lineno"> 1904</span><span class="comment">!!$         ZRCT(:,:) = ZRCT(:,:) - Z_RR_CVRC(:,:)</span></div>
<div class="line"><a id="l01905" name="l01905"></a><span class="lineno"> 1905</span><span class="comment">!!$         ZRRT(:,:) = ZRRT(:,:) + Z_RR_CVRC(:,:)</span></div>
<div class="line"><a id="l01906" name="l01906"></a><span class="lineno"> 1906</span><span class="comment">!!$         ZCCT(:,:) = ZCCT(:,:) - Z_CR_CVRC(:,:)</span></div>
<div class="line"><a id="l01907" name="l01907"></a><span class="lineno"> 1907</span><span class="comment">!!$         ZCRT(:,:) = ZCRT(:,:) + Z_CR_CVRC(:,:)</span></div>
<div class="line"><a id="l01908" name="l01908"></a><span class="lineno"> 1908</span><span class="comment">!!$      END IF</span></div>
<div class="line"><a id="l01909" name="l01909"></a><span class="lineno"> 1909</span>      <span class="comment">!</span></div>
<div class="line"><a id="l01910" name="l01910"></a><span class="lineno"> 1910</span>      <span class="comment">!***       4.4 Unpacking for budgets</span></div>
<div class="line"><a id="l01911" name="l01911"></a><span class="lineno"> 1911</span>      <span class="comment">!</span></div>
<div class="line"><a id="l01912" name="l01912"></a><span class="lineno"> 1912</span>      <span class="keywordflow">IF</span>(buconf%LBU_ENABLE .OR. oelec) <span class="keywordflow">THEN</span></div>
<div class="line"><a id="l01913" name="l01913"></a><span class="lineno"> 1913</span>        ztot_rr_cvrc(:,:) = ztot_rr_cvrc(:,:) + z_rr_cvrc(:,:)</div>
<div class="line"><a id="l01914" name="l01914"></a><span class="lineno"> 1914</span>        ztot_cr_cvrc(:,:) = ztot_cr_cvrc(:,:) + z_cr_cvrc(:,:)</div>
<div class="line"><a id="l01915" name="l01915"></a><span class="lineno"> 1915</span> </div>
<div class="line"><a id="l01916" name="l01916"></a><span class="lineno"> 1916</span>         <span class="keywordflow">DO</span> ii=1,ipack</div>
<div class="line"><a id="l01917" name="l01917"></a><span class="lineno"> 1917</span>            <span class="comment">! Instantaneous processes</span></div>
<div class="line"><a id="l01918" name="l01918"></a><span class="lineno"> 1918</span>            ztot_cr_brku(i1(ii),i3(ii)) =   ztot_cr_brku(i1(ii),i3(ii))   + z_cr_brku(ii)</div>
<div class="line"><a id="l01919" name="l01919"></a><span class="lineno"> 1919</span>            ztot_th_honr(i1(ii),i3(ii)) =   ztot_th_honr(i1(ii),i3(ii))   + z_th_honr(ii)</div>
<div class="line"><a id="l01920" name="l01920"></a><span class="lineno"> 1920</span>            ztot_rr_honr(i1(ii),i3(ii)) =   ztot_rr_honr(i1(ii),i3(ii))   + z_rr_honr(ii)</div>
<div class="line"><a id="l01921" name="l01921"></a><span class="lineno"> 1921</span>            ztot_cr_honr(i1(ii),i3(ii)) =   ztot_cr_honr(i1(ii),i3(ii))   + z_cr_honr(ii)</div>
<div class="line"><a id="l01922" name="l01922"></a><span class="lineno"> 1922</span>            ztot_th_imlt(i1(ii),i3(ii)) =   ztot_th_imlt(i1(ii),i3(ii))   + z_th_imlt(ii)</div>
<div class="line"><a id="l01923" name="l01923"></a><span class="lineno"> 1923</span>            ztot_rc_imlt(i1(ii),i3(ii)) =   ztot_rc_imlt(i1(ii),i3(ii))   + z_rc_imlt(ii)</div>
<div class="line"><a id="l01924" name="l01924"></a><span class="lineno"> 1924</span>            ztot_cc_imlt(i1(ii),i3(ii)) =   ztot_cc_imlt(i1(ii),i3(ii))   + z_cc_imlt(ii)</div>
<div class="line"><a id="l01925" name="l01925"></a><span class="lineno"> 1925</span>            <span class="keywordflow">DO</span> in = 1, limap%NMOD_IFN</div>
<div class="line"><a id="l01926" name="l01926"></a><span class="lineno"> 1926</span>              ztot_ifnn_imlt(i1(ii),i3(ii),in) = ztot_ifnn_imlt(i1(ii),i3(ii),in) + zb_ifnn(ii,in)</div>
<div class="line"><a id="l01927" name="l01927"></a><span class="lineno"> 1927</span><span class="keywordflow">            END DO</span></div>
<div class="line"><a id="l01928" name="l01928"></a><span class="lineno"> 1928</span> </div>
<div class="line"><a id="l01929" name="l01929"></a><span class="lineno"> 1929</span>            <span class="comment">! Tendencies</span></div>
<div class="line"><a id="l01930" name="l01930"></a><span class="lineno"> 1930</span>            ztot_th_honc(i1(ii),i3(ii)) =   ztot_th_honc(i1(ii),i3(ii))   + z_th_honc(ii)  * zmaxtime(ii)</div>
<div class="line"><a id="l01931" name="l01931"></a><span class="lineno"> 1931</span>            ztot_rc_honc(i1(ii),i3(ii)) =   ztot_rc_honc(i1(ii),i3(ii))   + z_rc_honc(ii)  * zmaxtime(ii)</div>
<div class="line"><a id="l01932" name="l01932"></a><span class="lineno"> 1932</span>            ztot_cc_honc(i1(ii),i3(ii)) =   ztot_cc_honc(i1(ii),i3(ii))   + z_cc_honc(ii)  * zmaxtime(ii)</div>
<div class="line"><a id="l01933" name="l01933"></a><span class="lineno"> 1933</span>            ztot_cc_self(i1(ii),i3(ii)) =   ztot_cc_self(i1(ii),i3(ii))   + z_cc_self(ii)  * zmaxtime(ii)</div>
<div class="line"><a id="l01934" name="l01934"></a><span class="lineno"> 1934</span>            ztot_rc_auto(i1(ii),i3(ii)) =   ztot_rc_auto(i1(ii),i3(ii))   + z_rc_auto(ii)  * zmaxtime(ii)</div>
<div class="line"><a id="l01935" name="l01935"></a><span class="lineno"> 1935</span>            ztot_cc_auto(i1(ii),i3(ii)) =   ztot_cc_auto(i1(ii),i3(ii))   + z_cc_auto(ii)  * zmaxtime(ii)</div>
<div class="line"><a id="l01936" name="l01936"></a><span class="lineno"> 1936</span>            ztot_cr_auto(i1(ii),i3(ii)) =   ztot_cr_auto(i1(ii),i3(ii))   + z_cr_auto(ii)  * zmaxtime(ii)</div>
<div class="line"><a id="l01937" name="l01937"></a><span class="lineno"> 1937</span>            ztot_rc_accr(i1(ii),i3(ii)) =   ztot_rc_accr(i1(ii),i3(ii))   + z_rc_accr(ii)  * zmaxtime(ii)</div>
<div class="line"><a id="l01938" name="l01938"></a><span class="lineno"> 1938</span>            ztot_cc_accr(i1(ii),i3(ii)) =   ztot_cc_accr(i1(ii),i3(ii))   + z_cc_accr(ii)  * zmaxtime(ii)</div>
<div class="line"><a id="l01939" name="l01939"></a><span class="lineno"> 1939</span>            ztot_cr_scbu(i1(ii),i3(ii)) =   ztot_cr_scbu(i1(ii),i3(ii))   + z_cr_scbu(ii)  * zmaxtime(ii)</div>
<div class="line"><a id="l01940" name="l01940"></a><span class="lineno"> 1940</span>            ztot_th_evap(i1(ii),i3(ii)) =   ztot_th_evap(i1(ii),i3(ii))   + z_th_evap(ii)  * zmaxtime(ii)</div>
<div class="line"><a id="l01941" name="l01941"></a><span class="lineno"> 1941</span><span class="comment">!!$            ZTOT_RC_EVAP(I1(II),I3(II)) =   ZTOT_RC_EVAP(I1(II),I3(II))   + Z_RC_EVAP(II)  * ZMAXTIME(II)</span></div>
<div class="line"><a id="l01942" name="l01942"></a><span class="lineno"> 1942</span><span class="comment">!!$            ZTOT_CC_EVAP(I1(II),I3(II)) =   ZTOT_CC_EVAP(I1(II),I3(II))   + Z_CC_EVAP(II)  * ZMAXTIME(II)</span></div>
<div class="line"><a id="l01943" name="l01943"></a><span class="lineno"> 1943</span>            ztot_rr_evap(i1(ii),i3(ii)) =   ztot_rr_evap(i1(ii),i3(ii))   + z_rr_evap(ii)  * zmaxtime(ii)</div>
<div class="line"><a id="l01944" name="l01944"></a><span class="lineno"> 1944</span>            ztot_cr_evap(i1(ii),i3(ii)) =   ztot_cr_evap(i1(ii),i3(ii))   + z_cr_evap(ii)  * zmaxtime(ii)</div>
<div class="line"><a id="l01945" name="l01945"></a><span class="lineno"> 1945</span>            ztot_ri_cnvi(i1(ii),i3(ii)) =   ztot_ri_cnvi(i1(ii),i3(ii))   + z_ri_cnvi(ii)  * zmaxtime(ii)</div>
<div class="line"><a id="l01946" name="l01946"></a><span class="lineno"> 1946</span>            ztot_ci_cnvi(i1(ii),i3(ii)) =   ztot_ci_cnvi(i1(ii),i3(ii))   + z_ci_cnvi(ii)  * zmaxtime(ii)</div>
<div class="line"><a id="l01947" name="l01947"></a><span class="lineno"> 1947</span>            ztot_th_deps(i1(ii),i3(ii)) =   ztot_th_deps(i1(ii),i3(ii))   + z_th_deps(ii)  * zmaxtime(ii)</div>
<div class="line"><a id="l01948" name="l01948"></a><span class="lineno"> 1948</span>            ztot_rs_deps(i1(ii),i3(ii)) =   ztot_rs_deps(i1(ii),i3(ii))   + z_rs_deps(ii)  * zmaxtime(ii)</div>
<div class="line"><a id="l01949" name="l01949"></a><span class="lineno"> 1949</span>            ztot_th_depi(i1(ii),i3(ii)) =   ztot_th_depi(i1(ii),i3(ii))   + z_th_depi(ii)  * zmaxtime(ii)</div>
<div class="line"><a id="l01950" name="l01950"></a><span class="lineno"> 1950</span>            ztot_ri_depi(i1(ii),i3(ii)) =   ztot_ri_depi(i1(ii),i3(ii))   + z_ri_depi(ii)  * zmaxtime(ii)</div>
<div class="line"><a id="l01951" name="l01951"></a><span class="lineno"> 1951</span>            ztot_ri_cnvs(i1(ii),i3(ii)) =   ztot_ri_cnvs(i1(ii),i3(ii))   + z_ri_cnvs(ii)  * zmaxtime(ii)</div>
<div class="line"><a id="l01952" name="l01952"></a><span class="lineno"> 1952</span>            ztot_ci_cnvs(i1(ii),i3(ii)) =   ztot_ci_cnvs(i1(ii),i3(ii))   + z_ci_cnvs(ii)  * zmaxtime(ii)</div>
<div class="line"><a id="l01953" name="l01953"></a><span class="lineno"> 1953</span>            ztot_cs_ssc(i1(ii),i3(ii))  =   ztot_cs_ssc(i1(ii),i3(ii))    + z_cs_ssc(ii)   * zmaxtime(ii)</div>
<div class="line"><a id="l01954" name="l01954"></a><span class="lineno"> 1954</span>            ztot_ci_isc(i1(ii),i3(ii))  =   ztot_ci_isc(i1(ii),i3(ii))    + z_ci_isc(ii)   * zmaxtime(ii)</div>
<div class="line"><a id="l01955" name="l01955"></a><span class="lineno"> 1955</span>            ztot_ri_aggs(i1(ii),i3(ii)) =   ztot_ri_aggs(i1(ii),i3(ii))   + z_ri_aggs(ii)  * zmaxtime(ii)</div>
<div class="line"><a id="l01956" name="l01956"></a><span class="lineno"> 1956</span>            ztot_ci_aggs(i1(ii),i3(ii)) =   ztot_ci_aggs(i1(ii),i3(ii))   + z_ci_aggs(ii)  * zmaxtime(ii)</div>
<div class="line"><a id="l01957" name="l01957"></a><span class="lineno"> 1957</span>            ztot_th_depg(i1(ii),i3(ii)) =   ztot_th_depg(i1(ii),i3(ii))   + z_th_depg(ii)  * zmaxtime(ii)</div>
<div class="line"><a id="l01958" name="l01958"></a><span class="lineno"> 1958</span>            ztot_rg_depg(i1(ii),i3(ii)) =   ztot_rg_depg(i1(ii),i3(ii))   + z_rg_depg(ii)  * zmaxtime(ii)</div>
<div class="line"><a id="l01959" name="l01959"></a><span class="lineno"> 1959</span>            ztot_th_berfi(i1(ii),i3(ii))=   ztot_th_berfi(i1(ii),i3(ii))  + z_th_berfi(ii) * zmaxtime(ii)</div>
<div class="line"><a id="l01960" name="l01960"></a><span class="lineno"> 1960</span>            ztot_rc_berfi(i1(ii),i3(ii))=   ztot_rc_berfi(i1(ii),i3(ii))  + z_rc_berfi(ii) * zmaxtime(ii)</div>
<div class="line"><a id="l01961" name="l01961"></a><span class="lineno"> 1961</span>            ztot_th_rim(i1(ii),i3(ii))  =   ztot_th_rim(i1(ii),i3(ii))    + z_th_rim(ii)   * zmaxtime(ii)</div>
<div class="line"><a id="l01962" name="l01962"></a><span class="lineno"> 1962</span>            ztot_cc_rim(i1(ii),i3(ii))  =   ztot_cc_rim(i1(ii),i3(ii))    + z_cc_rim(ii)   * zmaxtime(ii)</div>
<div class="line"><a id="l01963" name="l01963"></a><span class="lineno"> 1963</span>            ztot_cs_rim(i1(ii),i3(ii))  =   ztot_cs_rim(i1(ii),i3(ii))    + z_cs_rim(ii)   * zmaxtime(ii)</div>
<div class="line"><a id="l01964" name="l01964"></a><span class="lineno"> 1964</span>            ztot_rc_rimss(i1(ii),i3(ii))=   ztot_rc_rimss(i1(ii),i3(ii))  + z_rc_rimss(ii) * zmaxtime(ii)</div>
<div class="line"><a id="l01965" name="l01965"></a><span class="lineno"> 1965</span>            ztot_rc_rimsg(i1(ii),i3(ii))=   ztot_rc_rimsg(i1(ii),i3(ii))  + z_rc_rimsg(ii) * zmaxtime(ii)</div>
<div class="line"><a id="l01966" name="l01966"></a><span class="lineno"> 1966</span>            ztot_rs_rimcg(i1(ii),i3(ii))=   ztot_rs_rimcg(i1(ii),i3(ii))  + z_rs_rimcg(ii) * zmaxtime(ii)</div>
<div class="line"><a id="l01967" name="l01967"></a><span class="lineno"> 1967</span>            ztot_ri_hms(i1(ii),i3(ii))  =   ztot_ri_hms(i1(ii),i3(ii))    + z_ri_hms(ii)   * zmaxtime(ii)</div>
<div class="line"><a id="l01968" name="l01968"></a><span class="lineno"> 1968</span>            ztot_ci_hms(i1(ii),i3(ii))  =   ztot_ci_hms(i1(ii),i3(ii))    + z_ci_hms(ii)   * zmaxtime(ii)</div>
<div class="line"><a id="l01969" name="l01969"></a><span class="lineno"> 1969</span>            ztot_rs_hms(i1(ii),i3(ii))  =   ztot_rs_hms(i1(ii),i3(ii))    + z_rs_hms(ii)   * zmaxtime(ii)</div>
<div class="line"><a id="l01970" name="l01970"></a><span class="lineno"> 1970</span>            ztot_th_acc(i1(ii),i3(ii))  =   ztot_th_acc(i1(ii),i3(ii))    + z_th_acc(ii)   * zmaxtime(ii)</div>
<div class="line"><a id="l01971" name="l01971"></a><span class="lineno"> 1971</span>            ztot_cr_acc(i1(ii),i3(ii))  =   ztot_cr_acc(i1(ii),i3(ii))    + z_cr_acc(ii)   * zmaxtime(ii)</div>
<div class="line"><a id="l01972" name="l01972"></a><span class="lineno"> 1972</span>            ztot_cs_acc(i1(ii),i3(ii))  =   ztot_cs_acc(i1(ii),i3(ii))    + z_cs_acc(ii)   * zmaxtime(ii)</div>
<div class="line"><a id="l01973" name="l01973"></a><span class="lineno"> 1973</span>            ztot_rr_accss(i1(ii),i3(ii))=   ztot_rr_accss(i1(ii),i3(ii))  + z_rr_accss(ii) * zmaxtime(ii)</div>
<div class="line"><a id="l01974" name="l01974"></a><span class="lineno"> 1974</span>            ztot_rr_accsg(i1(ii),i3(ii))=   ztot_rr_accsg(i1(ii),i3(ii))  + z_rr_accsg(ii) * zmaxtime(ii)</div>
<div class="line"><a id="l01975" name="l01975"></a><span class="lineno"> 1975</span>            ztot_rs_accrg(i1(ii),i3(ii))=   ztot_rs_accrg(i1(ii),i3(ii))  + z_rs_accrg(ii) * zmaxtime(ii)</div>
<div class="line"><a id="l01976" name="l01976"></a><span class="lineno"> 1976</span>            ztot_cs_cmel(i1(ii),i3(ii)) =   ztot_cs_cmel(i1(ii),i3(ii))   + z_cs_cmel(ii)  * zmaxtime(ii)</div>
<div class="line"><a id="l01977" name="l01977"></a><span class="lineno"> 1977</span>            ztot_rs_cmel(i1(ii),i3(ii)) =   ztot_rs_cmel(i1(ii),i3(ii))   + z_rs_cmel(ii)  * zmaxtime(ii)</div>
<div class="line"><a id="l01978" name="l01978"></a><span class="lineno"> 1978</span>            ztot_th_cfrz(i1(ii),i3(ii)) =   ztot_th_cfrz(i1(ii),i3(ii))   + z_th_cfrz(ii)  * zmaxtime(ii)</div>
<div class="line"><a id="l01979" name="l01979"></a><span class="lineno"> 1979</span>            ztot_rr_cfrz(i1(ii),i3(ii)) =   ztot_rr_cfrz(i1(ii),i3(ii))   + z_rr_cfrz(ii)  * zmaxtime(ii)</div>
<div class="line"><a id="l01980" name="l01980"></a><span class="lineno"> 1980</span>            ztot_cr_cfrz(i1(ii),i3(ii)) =   ztot_cr_cfrz(i1(ii),i3(ii))   + z_cr_cfrz(ii)  * zmaxtime(ii)</div>
<div class="line"><a id="l01981" name="l01981"></a><span class="lineno"> 1981</span>            ztot_ri_cfrz(i1(ii),i3(ii)) =   ztot_ri_cfrz(i1(ii),i3(ii))   + z_ri_cfrz(ii)  * zmaxtime(ii)</div>
<div class="line"><a id="l01982" name="l01982"></a><span class="lineno"> 1982</span>            ztot_ci_cfrz(i1(ii),i3(ii)) =   ztot_ci_cfrz(i1(ii),i3(ii))   + z_ci_cfrz(ii)  * zmaxtime(ii)</div>
<div class="line"><a id="l01983" name="l01983"></a><span class="lineno"> 1983</span>            ztot_ri_cibu(i1(ii),i3(ii)) =   ztot_ri_cibu(i1(ii),i3(ii))   + z_ri_cibu(ii)  * zmaxtime(ii)</div>
<div class="line"><a id="l01984" name="l01984"></a><span class="lineno"> 1984</span>            ztot_ci_cibu(i1(ii),i3(ii)) =   ztot_ci_cibu(i1(ii),i3(ii))   + z_ci_cibu(ii)  * zmaxtime(ii)</div>
<div class="line"><a id="l01985" name="l01985"></a><span class="lineno"> 1985</span>            ztot_ri_rdsf(i1(ii),i3(ii)) =   ztot_ri_rdsf(i1(ii),i3(ii))   + z_ri_rdsf(ii)  * zmaxtime(ii)</div>
<div class="line"><a id="l01986" name="l01986"></a><span class="lineno"> 1986</span>            ztot_ci_rdsf(i1(ii),i3(ii)) =   ztot_ci_rdsf(i1(ii),i3(ii))   + z_ci_rdsf(ii)  * zmaxtime(ii)</div>
<div class="line"><a id="l01987" name="l01987"></a><span class="lineno"> 1987</span>            ztot_th_wetg(i1(ii),i3(ii)) =   ztot_th_wetg(i1(ii),i3(ii))   + z_th_wetg(ii)  * zmaxtime(ii)</div>
<div class="line"><a id="l01988" name="l01988"></a><span class="lineno"> 1988</span>            ztot_rc_wetg(i1(ii),i3(ii)) =   ztot_rc_wetg(i1(ii),i3(ii))   + z_rc_wetg(ii)  * zmaxtime(ii)</div>
<div class="line"><a id="l01989" name="l01989"></a><span class="lineno"> 1989</span>            ztot_cc_wetg(i1(ii),i3(ii)) =   ztot_cc_wetg(i1(ii),i3(ii))   + z_cc_wetg(ii)  * zmaxtime(ii)</div>
<div class="line"><a id="l01990" name="l01990"></a><span class="lineno"> 1990</span>            ztot_rr_wetg(i1(ii),i3(ii)) =   ztot_rr_wetg(i1(ii),i3(ii))   + z_rr_wetg(ii)  * zmaxtime(ii)</div>
<div class="line"><a id="l01991" name="l01991"></a><span class="lineno"> 1991</span>            ztot_cr_wetg(i1(ii),i3(ii)) =   ztot_cr_wetg(i1(ii),i3(ii))   + z_cr_wetg(ii)  * zmaxtime(ii)</div>
<div class="line"><a id="l01992" name="l01992"></a><span class="lineno"> 1992</span>            ztot_ri_wetg(i1(ii),i3(ii)) =   ztot_ri_wetg(i1(ii),i3(ii))   + z_ri_wetg(ii)  * zmaxtime(ii)</div>
<div class="line"><a id="l01993" name="l01993"></a><span class="lineno"> 1993</span>            ztot_ci_wetg(i1(ii),i3(ii)) =   ztot_ci_wetg(i1(ii),i3(ii))   + z_ci_wetg(ii)  * zmaxtime(ii)</div>
<div class="line"><a id="l01994" name="l01994"></a><span class="lineno"> 1994</span>            ztot_rs_wetg(i1(ii),i3(ii)) =   ztot_rs_wetg(i1(ii),i3(ii))   + z_rs_wetg(ii)  * zmaxtime(ii)</div>
<div class="line"><a id="l01995" name="l01995"></a><span class="lineno"> 1995</span>            ztot_cs_wetg(i1(ii),i3(ii)) =   ztot_cs_wetg(i1(ii),i3(ii))   + z_cs_wetg(ii)  * zmaxtime(ii)</div>
<div class="line"><a id="l01996" name="l01996"></a><span class="lineno"> 1996</span>            ztot_rg_wetg(i1(ii),i3(ii)) =   ztot_rg_wetg(i1(ii),i3(ii))   + z_rg_wetg(ii)  * zmaxtime(ii)</div>
<div class="line"><a id="l01997" name="l01997"></a><span class="lineno"> 1997</span>            ztot_cg_wetg(i1(ii),i3(ii)) =   ztot_cg_wetg(i1(ii),i3(ii))   + z_cg_wetg(ii)  * zmaxtime(ii)</div>
<div class="line"><a id="l01998" name="l01998"></a><span class="lineno"> 1998</span>            ztot_rh_wetg(i1(ii),i3(ii)) =   ztot_rh_wetg(i1(ii),i3(ii))   + z_rh_wetg(ii)  * zmaxtime(ii)</div>
<div class="line"><a id="l01999" name="l01999"></a><span class="lineno"> 1999</span>            ztot_th_dryg(i1(ii),i3(ii)) =   ztot_th_dryg(i1(ii),i3(ii))   + z_th_dryg(ii)  * zmaxtime(ii)</div>
<div class="line"><a id="l02000" name="l02000"></a><span class="lineno"> 2000</span>            ztot_rc_dryg(i1(ii),i3(ii)) =   ztot_rc_dryg(i1(ii),i3(ii))   + z_rc_dryg(ii)  * zmaxtime(ii)</div>
<div class="line"><a id="l02001" name="l02001"></a><span class="lineno"> 2001</span>            ztot_cc_dryg(i1(ii),i3(ii)) =   ztot_cc_dryg(i1(ii),i3(ii))   + z_cc_dryg(ii)  * zmaxtime(ii)</div>
<div class="line"><a id="l02002" name="l02002"></a><span class="lineno"> 2002</span>            ztot_rr_dryg(i1(ii),i3(ii)) =   ztot_rr_dryg(i1(ii),i3(ii))   + z_rr_dryg(ii)  * zmaxtime(ii)</div>
<div class="line"><a id="l02003" name="l02003"></a><span class="lineno"> 2003</span>            ztot_cr_dryg(i1(ii),i3(ii)) =   ztot_cr_dryg(i1(ii),i3(ii))   + z_cr_dryg(ii)  * zmaxtime(ii)</div>
<div class="line"><a id="l02004" name="l02004"></a><span class="lineno"> 2004</span>            ztot_ri_dryg(i1(ii),i3(ii)) =   ztot_ri_dryg(i1(ii),i3(ii))   + z_ri_dryg(ii)  * zmaxtime(ii)</div>
<div class="line"><a id="l02005" name="l02005"></a><span class="lineno"> 2005</span>            ztot_ci_dryg(i1(ii),i3(ii)) =   ztot_ci_dryg(i1(ii),i3(ii))   + z_ci_dryg(ii)  * zmaxtime(ii)</div>
<div class="line"><a id="l02006" name="l02006"></a><span class="lineno"> 2006</span>            ztot_rs_dryg(i1(ii),i3(ii)) =   ztot_rs_dryg(i1(ii),i3(ii))   + z_rs_dryg(ii)  * zmaxtime(ii)</div>
<div class="line"><a id="l02007" name="l02007"></a><span class="lineno"> 2007</span>            ztot_cs_dryg(i1(ii),i3(ii)) =   ztot_cs_dryg(i1(ii),i3(ii))   + z_cs_dryg(ii)  * zmaxtime(ii)</div>
<div class="line"><a id="l02008" name="l02008"></a><span class="lineno"> 2008</span>            ztot_rg_dryg(i1(ii),i3(ii)) =   ztot_rg_dryg(i1(ii),i3(ii))   + z_rg_dryg(ii)  * zmaxtime(ii)</div>
<div class="line"><a id="l02009" name="l02009"></a><span class="lineno"> 2009</span>            ztot_ri_hmg(i1(ii),i3(ii))  =   ztot_ri_hmg(i1(ii),i3(ii))    + z_ri_hmg(ii)   * zmaxtime(ii)</div>
<div class="line"><a id="l02010" name="l02010"></a><span class="lineno"> 2010</span>            ztot_ci_hmg(i1(ii),i3(ii))  =   ztot_ci_hmg(i1(ii),i3(ii))    + z_ci_hmg(ii)   * zmaxtime(ii)</div>
<div class="line"><a id="l02011" name="l02011"></a><span class="lineno"> 2011</span>            ztot_rg_hmg(i1(ii),i3(ii))  =   ztot_rg_hmg(i1(ii),i3(ii))    + z_rg_hmg(ii)   * zmaxtime(ii)</div>
<div class="line"><a id="l02012" name="l02012"></a><span class="lineno"> 2012</span>            ztot_th_gmlt(i1(ii),i3(ii)) =   ztot_th_gmlt(i1(ii),i3(ii))   + z_th_gmlt(ii)  * zmaxtime(ii)</div>
<div class="line"><a id="l02013" name="l02013"></a><span class="lineno"> 2013</span>            ztot_rr_gmlt(i1(ii),i3(ii)) =   ztot_rr_gmlt(i1(ii),i3(ii))   + z_rr_gmlt(ii)  * zmaxtime(ii)</div>
<div class="line"><a id="l02014" name="l02014"></a><span class="lineno"> 2014</span>            ztot_cr_gmlt(i1(ii),i3(ii)) =   ztot_cr_gmlt(i1(ii),i3(ii))   + z_cr_gmlt(ii)  * zmaxtime(ii)</div>
<div class="line"><a id="l02015" name="l02015"></a><span class="lineno"> 2015</span>            ztot_cg_gmlt(i1(ii),i3(ii)) =   ztot_cg_gmlt(i1(ii),i3(ii))   + z_cg_gmlt(ii)  * zmaxtime(ii)</div>
<div class="line"><a id="l02016" name="l02016"></a><span class="lineno"> 2016</span>            ztot_th_deph(i1(ii),i3(ii)) =   ztot_th_deph(i1(ii),i3(ii))   + z_th_deph(ii)  * zmaxtime(ii)</div>
<div class="line"><a id="l02017" name="l02017"></a><span class="lineno"> 2017</span>            ztot_rh_deph(i1(ii),i3(ii)) =   ztot_rh_deph(i1(ii),i3(ii))   + z_rh_deph(ii)  * zmaxtime(ii)</div>
<div class="line"><a id="l02018" name="l02018"></a><span class="lineno"> 2018</span>            ztot_th_weth(i1(ii),i3(ii)) =   ztot_th_weth(i1(ii),i3(ii))   + z_th_weth(ii)  * zmaxtime(ii)</div>
<div class="line"><a id="l02019" name="l02019"></a><span class="lineno"> 2019</span>            ztot_rc_weth(i1(ii),i3(ii)) =   ztot_rc_weth(i1(ii),i3(ii))   + z_rc_weth(ii)  * zmaxtime(ii)</div>
<div class="line"><a id="l02020" name="l02020"></a><span class="lineno"> 2020</span>            ztot_cc_weth(i1(ii),i3(ii)) =   ztot_cc_weth(i1(ii),i3(ii))   + z_cc_weth(ii)  * zmaxtime(ii)</div>
<div class="line"><a id="l02021" name="l02021"></a><span class="lineno"> 2021</span>            ztot_rr_weth(i1(ii),i3(ii)) =   ztot_rr_weth(i1(ii),i3(ii))   + z_rr_weth(ii)  * zmaxtime(ii)</div>
<div class="line"><a id="l02022" name="l02022"></a><span class="lineno"> 2022</span>            ztot_cr_weth(i1(ii),i3(ii)) =   ztot_cr_weth(i1(ii),i3(ii))   + z_cr_weth(ii)  * zmaxtime(ii)</div>
<div class="line"><a id="l02023" name="l02023"></a><span class="lineno"> 2023</span>            ztot_ri_weth(i1(ii),i3(ii)) =   ztot_ri_weth(i1(ii),i3(ii))   + z_ri_weth(ii)  * zmaxtime(ii)</div>
<div class="line"><a id="l02024" name="l02024"></a><span class="lineno"> 2024</span>            ztot_ci_weth(i1(ii),i3(ii)) =   ztot_ci_weth(i1(ii),i3(ii))   + z_ci_weth(ii)  * zmaxtime(ii)</div>
<div class="line"><a id="l02025" name="l02025"></a><span class="lineno"> 2025</span>            ztot_rs_weth(i1(ii),i3(ii)) =   ztot_rs_weth(i1(ii),i3(ii))   + z_rs_weth(ii)  * zmaxtime(ii)</div>
<div class="line"><a id="l02026" name="l02026"></a><span class="lineno"> 2026</span>            ztot_cs_weth(i1(ii),i3(ii)) =   ztot_cs_weth(i1(ii),i3(ii))   + z_cs_weth(ii)  * zmaxtime(ii)</div>
<div class="line"><a id="l02027" name="l02027"></a><span class="lineno"> 2027</span>            ztot_rg_weth(i1(ii),i3(ii)) =   ztot_rg_weth(i1(ii),i3(ii))   + z_rg_weth(ii)  * zmaxtime(ii)</div>
<div class="line"><a id="l02028" name="l02028"></a><span class="lineno"> 2028</span>            ztot_cg_weth(i1(ii),i3(ii)) =   ztot_cg_weth(i1(ii),i3(ii))   + z_cg_weth(ii)  * zmaxtime(ii)</div>
<div class="line"><a id="l02029" name="l02029"></a><span class="lineno"> 2029</span>            ztot_rh_weth(i1(ii),i3(ii)) =   ztot_rh_weth(i1(ii),i3(ii))   + z_rh_weth(ii)  * zmaxtime(ii)</div>
<div class="line"><a id="l02030" name="l02030"></a><span class="lineno"> 2030</span>            ztot_rg_cohg(i1(ii),i3(ii)) =   ztot_rg_cohg(i1(ii),i3(ii))   + z_rg_cohg(ii)  * zmaxtime(ii)</div>
<div class="line"><a id="l02031" name="l02031"></a><span class="lineno"> 2031</span>            ztot_cg_cohg(i1(ii),i3(ii)) =   ztot_cg_cohg(i1(ii),i3(ii))   + z_cg_cohg(ii)  * zmaxtime(ii)</div>
<div class="line"><a id="l02032" name="l02032"></a><span class="lineno"> 2032</span>            ztot_th_hmlt(i1(ii),i3(ii)) =   ztot_rr_hmlt(i1(ii),i3(ii))   + z_rr_hmlt(ii)  * zmaxtime(ii)</div>
<div class="line"><a id="l02033" name="l02033"></a><span class="lineno"> 2033</span>            ztot_rr_hmlt(i1(ii),i3(ii)) =   ztot_rr_hmlt(i1(ii),i3(ii))   + z_rr_hmlt(ii)  * zmaxtime(ii)</div>
<div class="line"><a id="l02034" name="l02034"></a><span class="lineno"> 2034</span>            ztot_cr_hmlt(i1(ii),i3(ii)) =   ztot_cr_hmlt(i1(ii),i3(ii))   + z_cr_hmlt(ii)  * zmaxtime(ii)</div>
<div class="line"><a id="l02035" name="l02035"></a><span class="lineno"> 2035</span>            ztot_ch_hmlt(i1(ii),i3(ii)) =   ztot_ch_hmlt(i1(ii),i3(ii))   + z_ch_hmlt(ii)  * zmaxtime(ii)</div>
<div class="line"><a id="l02036" name="l02036"></a><span class="lineno"> 2036</span> </div>
<div class="line"><a id="l02037" name="l02037"></a><span class="lineno"> 2037</span>            <span class="comment">! Correction term</span></div>
<div class="line"><a id="l02038" name="l02038"></a><span class="lineno"> 2038</span>            ztot_rv_corr2(i1(ii),i3(ii)) =   ztot_rv_corr2(i1(ii),i3(ii)) + z_rv_corr2(ii)</div>
<div class="line"><a id="l02039" name="l02039"></a><span class="lineno"> 2039</span>            ztot_rc_corr2(i1(ii),i3(ii)) =   ztot_rc_corr2(i1(ii),i3(ii)) + z_rc_corr2(ii)</div>
<div class="line"><a id="l02040" name="l02040"></a><span class="lineno"> 2040</span>            ztot_rr_corr2(i1(ii),i3(ii)) =   ztot_rr_corr2(i1(ii),i3(ii)) + z_rr_corr2(ii)</div>
<div class="line"><a id="l02041" name="l02041"></a><span class="lineno"> 2041</span>            ztot_ri_corr2(i1(ii),i3(ii)) =   ztot_ri_corr2(i1(ii),i3(ii)) + z_ri_corr2(ii)</div>
<div class="line"><a id="l02042" name="l02042"></a><span class="lineno"> 2042</span>            ztot_cc_corr2(i1(ii),i3(ii)) =   ztot_cc_corr2(i1(ii),i3(ii)) + z_cc_corr2(ii)</div>
<div class="line"><a id="l02043" name="l02043"></a><span class="lineno"> 2043</span>            ztot_cr_corr2(i1(ii),i3(ii)) =   ztot_cr_corr2(i1(ii),i3(ii)) + z_cr_corr2(ii)</div>
<div class="line"><a id="l02044" name="l02044"></a><span class="lineno"> 2044</span>            ztot_ci_corr2(i1(ii),i3(ii)) =   ztot_ci_corr2(i1(ii),i3(ii)) + z_ci_corr2(ii)</div>
<div class="line"><a id="l02045" name="l02045"></a><span class="lineno"> 2045</span> </div>
<div class="line"><a id="l02046" name="l02046"></a><span class="lineno"> 2046</span>            <span class="comment">! Terms for ice crystal shapes</span></div>
<div class="line"><a id="l02047" name="l02047"></a><span class="lineno"> 2047</span>            <span class="keywordflow">IF</span> (limap%LCRYSTAL_SHAPE) <span class="keywordflow">THEN</span></div>
<div class="line"><a id="l02048" name="l02048"></a><span class="lineno"> 2048</span>              <span class="keywordflow">DO</span> ish = 1, limap%NNB_CRYSTAL_SHAPE</div>
<div class="line"><a id="l02049" name="l02049"></a><span class="lineno"> 2049</span>                <span class="comment">! instantaneous process</span></div>
<div class="line"><a id="l02050" name="l02050"></a><span class="lineno"> 2050</span>                ztot_shci_imlt(i1(ii),i3(ii),ish) = ztot_shci_imlt(i1(ii),i3(ii),ish) + z_shci_imlt(ii,ish)</div>
<div class="line"><a id="l02051" name="l02051"></a><span class="lineno"> 2051</span>                <span class="comment">! tendencies</span></div>
<div class="line"><a id="l02052" name="l02052"></a><span class="lineno"> 2052</span>                ztot_shci_honc(i1(ii),i3(ii),ish) = ztot_shci_honc(i1(ii),i3(ii),ish) + &amp;</div>
<div class="line"><a id="l02053" name="l02053"></a><span class="lineno"> 2053</span>                                                           z_shci_honc(ii,ish) * zmaxtime(ii)</div>
<div class="line"><a id="l02054" name="l02054"></a><span class="lineno"> 2054</span>                ztot_shci_cnvi(i1(ii),i3(ii),ish) = ztot_shci_cnvi(i1(ii),i3(ii),ish) + &amp;</div>
<div class="line"><a id="l02055" name="l02055"></a><span class="lineno"> 2055</span>                                                           z_shci_cnvi(ii,ish) * zmaxtime(ii)</div>
<div class="line"><a id="l02056" name="l02056"></a><span class="lineno"> 2056</span>                ztot_shci_hach(i1(ii),i3(ii),ish) = ztot_shci_hach(i1(ii),i3(ii),ish) + &amp;</div>
<div class="line"><a id="l02057" name="l02057"></a><span class="lineno"> 2057</span>                                                           z_shci_hach(ii,ish) * zmaxtime(ii)</div>
<div class="line"><a id="l02058" name="l02058"></a><span class="lineno"> 2058</span>                ztot_shci_cnvs(i1(ii),i3(ii),ish) = ztot_shci_cnvs(i1(ii),i3(ii),ish) + &amp;</div>
<div class="line"><a id="l02059" name="l02059"></a><span class="lineno"> 2059</span>                                                           z_shci_cnvs(ii,ish) * zmaxtime(ii)</div>
<div class="line"><a id="l02060" name="l02060"></a><span class="lineno"> 2060</span>                ztot_shci_aggs(i1(ii),i3(ii),ish) = ztot_shci_aggs(i1(ii),i3(ii),ish) + &amp;</div>
<div class="line"><a id="l02061" name="l02061"></a><span class="lineno"> 2061</span>                                                           z_shci_aggs(ii,ish) * zmaxtime(ii)</div>
<div class="line"><a id="l02062" name="l02062"></a><span class="lineno"> 2062</span>                ztot_shci_hms(i1(ii),i3(ii),ish)  = ztot_shci_hms(i1(ii),i3(ii),ish)  + &amp;</div>
<div class="line"><a id="l02063" name="l02063"></a><span class="lineno"> 2063</span>                                                           z_shci_hms(ii,ish)  * zmaxtime(ii)</div>
<div class="line"><a id="l02064" name="l02064"></a><span class="lineno"> 2064</span>                ztot_shci_cfrz(i1(ii),i3(ii),ish) = ztot_shci_cfrz(i1(ii),i3(ii),ish) + &amp;</div>
<div class="line"><a id="l02065" name="l02065"></a><span class="lineno"> 2065</span>                                                           z_shci_cfrz(ii,ish) * zmaxtime(ii)</div>
<div class="line"><a id="l02066" name="l02066"></a><span class="lineno"> 2066</span>                ztot_shci_cibu(i1(ii),i3(ii),ish) = ztot_shci_cibu(i1(ii),i3(ii),ish) + &amp;</div>
<div class="line"><a id="l02067" name="l02067"></a><span class="lineno"> 2067</span>                                                           z_shci_cibu(ii,ish) * zmaxtime(ii)</div>
<div class="line"><a id="l02068" name="l02068"></a><span class="lineno"> 2068</span>                ztot_shci_rdsf(i1(ii),i3(ii),ish) = ztot_shci_rdsf(i1(ii),i3(ii),ish) + &amp;</div>
<div class="line"><a id="l02069" name="l02069"></a><span class="lineno"> 2069</span>                                                           z_shci_rdsf(ii,ish) * zmaxtime(ii)</div>
<div class="line"><a id="l02070" name="l02070"></a><span class="lineno"> 2070</span>                ztot_shci_wetg(i1(ii),i3(ii),ish) = ztot_shci_wetg(i1(ii),i3(ii),ish) + &amp;</div>
<div class="line"><a id="l02071" name="l02071"></a><span class="lineno"> 2071</span>                                                           z_shci_wetg(ii,ish) * zmaxtime(ii)</div>
<div class="line"><a id="l02072" name="l02072"></a><span class="lineno"> 2072</span>                ztot_shci_dryg(i1(ii),i3(ii),ish) = ztot_shci_dryg(i1(ii),i3(ii),ish) + &amp;</div>
<div class="line"><a id="l02073" name="l02073"></a><span class="lineno"> 2073</span>                                                           z_shci_dryg(ii,ish) * zmaxtime(ii)</div>
<div class="line"><a id="l02074" name="l02074"></a><span class="lineno"> 2074</span>                ztot_shci_hmg(i1(ii),i3(ii),ish)  = ztot_shci_hmg(i1(ii),i3(ii),ish)  + &amp;</div>
<div class="line"><a id="l02075" name="l02075"></a><span class="lineno"> 2075</span>                                                           z_shci_hmg(ii,ish)  * zmaxtime(ii)</div>
<div class="line"><a id="l02076" name="l02076"></a><span class="lineno"> 2076</span>                ztot_shci_isc(i1(ii),i3(ii),ish)  = ztot_shci_isc(i1(ii),i3(ii),ish)  + &amp;</div>
<div class="line"><a id="l02077" name="l02077"></a><span class="lineno"> 2077</span>                                                           z_shci_isc(ii,ish) * zmaxtime(ii)</div>
<div class="line"><a id="l02078" name="l02078"></a><span class="lineno"> 2078</span>                ztot_shci_iscs(i1(ii),i3(ii),ish) = ztot_shci_iscs(i1(ii),i3(ii),ish) + &amp;    </div>
<div class="line"><a id="l02079" name="l02079"></a><span class="lineno"> 2079</span>                                                           z_shci_iscs(ii,ish) * zmaxtime(ii)</div>
<div class="line"><a id="l02080" name="l02080"></a><span class="lineno"> 2080</span>                <span class="comment">! Correction term</span></div>
<div class="line"><a id="l02081" name="l02081"></a><span class="lineno"> 2081</span>                ztot_shci_corr2(i1(ii),i3(ii),ish)  = ztot_shci_corr2(i1(ii),i3(ii),ish) + &amp;</div>
<div class="line"><a id="l02082" name="l02082"></a><span class="lineno"> 2082</span>                                                             z_shci_corr2(ii,ish)</div>
<div class="line"><a id="l02083" name="l02083"></a><span class="lineno"> 2083</span><span class="keywordflow">              END DO</span></div>
<div class="line"><a id="l02084" name="l02084"></a><span class="lineno"> 2084</span>              ztot_shri_iscs(i1(ii),i2(ii)) = ztot_shri_iscs(i1(ii),i2(ii)) + &amp;    </div>
<div class="line"><a id="l02085" name="l02085"></a><span class="lineno"> 2085</span>                                                        z_shri_iscs(ii) * zmaxtime(ii) </div>
<div class="line"><a id="l02086" name="l02086"></a><span class="lineno"> 2086</span><span class="keywordflow">            END IF</span></div>
<div class="line"><a id="l02087" name="l02087"></a><span class="lineno"> 2087</span> </div>
<div class="line"><a id="l02088" name="l02088"></a><span class="lineno"> 2088</span><span class="keywordflow">         END DO</span></div>
<div class="line"><a id="l02089" name="l02089"></a><span class="lineno"> 2089</span><span class="keywordflow">      ENDIF</span></div>
<div class="line"><a id="l02090" name="l02090"></a><span class="lineno"> 2090</span>      <span class="comment">!</span></div>
<div class="line"><a id="l02091" name="l02091"></a><span class="lineno"> 2091</span>      <span class="comment">! Deallocating variables</span></div>
<div class="line"><a id="l02092" name="l02092"></a><span class="lineno"> 2092</span>      <span class="comment">!</span></div>
<div class="line"><a id="l02093" name="l02093"></a><span class="lineno"> 2093</span>      <span class="keyword">DEALLOCATE</span>(i1)</div>
<div class="line"><a id="l02094" name="l02094"></a><span class="lineno"> 2094</span>      <span class="keyword">DEALLOCATE</span>(i3)</div>
<div class="line"><a id="l02095" name="l02095"></a><span class="lineno"> 2095</span>      <span class="keyword">DEALLOCATE</span>(zrhodref1d)</div>
<div class="line"><a id="l02096" name="l02096"></a><span class="lineno"> 2096</span>      <span class="keyword">DEALLOCATE</span>(zexnref1d)</div>
<div class="line"><a id="l02097" name="l02097"></a><span class="lineno"> 2097</span>      <span class="keyword">DEALLOCATE</span>(zexn1d)</div>
<div class="line"><a id="l02098" name="l02098"></a><span class="lineno"> 2098</span>      <span class="keyword">DEALLOCATE</span>(zp1d)     </div>
<div class="line"><a id="l02099" name="l02099"></a><span class="lineno"> 2099</span>      <span class="keyword">DEALLOCATE</span>(ztht1d)</div>
<div class="line"><a id="l02100" name="l02100"></a><span class="lineno"> 2100</span>      <span class="keyword">DEALLOCATE</span>(zrvt1d)</div>
<div class="line"><a id="l02101" name="l02101"></a><span class="lineno"> 2101</span>      <span class="keyword">DEALLOCATE</span>(zrct1d)</div>
<div class="line"><a id="l02102" name="l02102"></a><span class="lineno"> 2102</span>      <span class="keyword">DEALLOCATE</span>(zrrt1d)</div>
<div class="line"><a id="l02103" name="l02103"></a><span class="lineno"> 2103</span>      <span class="keyword">DEALLOCATE</span>(zrit1d)</div>
<div class="line"><a id="l02104" name="l02104"></a><span class="lineno"> 2104</span>      <span class="keyword">DEALLOCATE</span>(zrst1d)</div>
<div class="line"><a id="l02105" name="l02105"></a><span class="lineno"> 2105</span>      <span class="keyword">DEALLOCATE</span>(zrgt1d)</div>
<div class="line"><a id="l02106" name="l02106"></a><span class="lineno"> 2106</span>      <span class="keyword">DEALLOCATE</span>(zrht1d)</div>
<div class="line"><a id="l02107" name="l02107"></a><span class="lineno"> 2107</span>      <span class="keyword">DEALLOCATE</span>(zcct1d)</div>
<div class="line"><a id="l02108" name="l02108"></a><span class="lineno"> 2108</span>      <span class="keyword">DEALLOCATE</span>(zcrt1d)</div>
<div class="line"><a id="l02109" name="l02109"></a><span class="lineno"> 2109</span>      <span class="keyword">DEALLOCATE</span>(zcit1d)</div>
<div class="line"><a id="l02110" name="l02110"></a><span class="lineno"> 2110</span>      <span class="keyword">DEALLOCATE</span>(zcst1d)</div>
<div class="line"><a id="l02111" name="l02111"></a><span class="lineno"> 2111</span>      <span class="keyword">DEALLOCATE</span>(zcgt1d)</div>
<div class="line"><a id="l02112" name="l02112"></a><span class="lineno"> 2112</span>      <span class="keyword">DEALLOCATE</span>(zcht1d)</div>
<div class="line"><a id="l02113" name="l02113"></a><span class="lineno"> 2113</span>      <span class="keyword">DEALLOCATE</span>(zifnn1d)</div>
<div class="line"><a id="l02114" name="l02114"></a><span class="lineno"> 2114</span>      <span class="keyword">DEALLOCATE</span>(zevap1d)</div>
<div class="line"><a id="l02115" name="l02115"></a><span class="lineno"> 2115</span>      <span class="keyword">DEALLOCATE</span>(ztime1d)</div>
<div class="line"><a id="l02116" name="l02116"></a><span class="lineno"> 2116</span>      <span class="keyword">DEALLOCATE</span>(glcompute1d)</div>
<div class="line"><a id="l02117" name="l02117"></a><span class="lineno"> 2117</span>      <span class="keyword">DEALLOCATE</span>(iiter1d)</div>
<div class="line"><a id="l02118" name="l02118"></a><span class="lineno"> 2118</span>      <span class="keyword">DEALLOCATE</span>(ztime_lastcall1d)</div>
<div class="line"><a id="l02119" name="l02119"></a><span class="lineno"> 2119</span>      <span class="keyword">DEALLOCATE</span>(z0rvt1d)</div>
<div class="line"><a id="l02120" name="l02120"></a><span class="lineno"> 2120</span>      <span class="keyword">DEALLOCATE</span>(z0rct1d)</div>
<div class="line"><a id="l02121" name="l02121"></a><span class="lineno"> 2121</span>      <span class="keyword">DEALLOCATE</span>(z0rrt1d)</div>
<div class="line"><a id="l02122" name="l02122"></a><span class="lineno"> 2122</span>      <span class="keyword">DEALLOCATE</span>(z0rit1d)</div>
<div class="line"><a id="l02123" name="l02123"></a><span class="lineno"> 2123</span>      <span class="keyword">DEALLOCATE</span>(z0rst1d)</div>
<div class="line"><a id="l02124" name="l02124"></a><span class="lineno"> 2124</span>      <span class="keyword">DEALLOCATE</span>(z0rgt1d)</div>
<div class="line"><a id="l02125" name="l02125"></a><span class="lineno"> 2125</span>      <span class="keyword">DEALLOCATE</span>(z0rht1d)</div>
<div class="line"><a id="l02126" name="l02126"></a><span class="lineno"> 2126</span>      <span class="keyword">DEALLOCATE</span>(zcf1d)</div>
<div class="line"><a id="l02127" name="l02127"></a><span class="lineno"> 2127</span>      <span class="keyword">DEALLOCATE</span>(zif1d)</div>
<div class="line"><a id="l02128" name="l02128"></a><span class="lineno"> 2128</span>      <span class="keyword">DEALLOCATE</span>(zpf1d)</div>
<div class="line"><a id="l02129" name="l02129"></a><span class="lineno"> 2129</span>      <span class="keyword">DEALLOCATE</span>(zlatham_iaggs)</div>
<div class="line"><a id="l02130" name="l02130"></a><span class="lineno"> 2130</span>      <span class="comment">!</span></div>
<div class="line"><a id="l02131" name="l02131"></a><span class="lineno"> 2131</span>      <span class="keyword">DEALLOCATE</span>(zmaxtime)</div>
<div class="line"><a id="l02132" name="l02132"></a><span class="lineno"> 2132</span>      <span class="keyword">DEALLOCATE</span>(ztime_threshold)</div>
<div class="line"><a id="l02133" name="l02133"></a><span class="lineno"> 2133</span>      <span class="comment">!</span></div>
<div class="line"><a id="l02134" name="l02134"></a><span class="lineno"> 2134</span>      <span class="keyword">DEALLOCATE</span>(za_th)</div>
<div class="line"><a id="l02135" name="l02135"></a><span class="lineno"> 2135</span>      <span class="keyword">DEALLOCATE</span>(za_rv)</div>
<div class="line"><a id="l02136" name="l02136"></a><span class="lineno"> 2136</span>      <span class="keyword">DEALLOCATE</span>(za_rc)</div>
<div class="line"><a id="l02137" name="l02137"></a><span class="lineno"> 2137</span>      <span class="keyword">DEALLOCATE</span>(za_rr)</div>
<div class="line"><a id="l02138" name="l02138"></a><span class="lineno"> 2138</span>      <span class="keyword">DEALLOCATE</span>(za_ri)</div>
<div class="line"><a id="l02139" name="l02139"></a><span class="lineno"> 2139</span>      <span class="keyword">DEALLOCATE</span>(za_rs)</div>
<div class="line"><a id="l02140" name="l02140"></a><span class="lineno"> 2140</span>      <span class="keyword">DEALLOCATE</span>(za_rg)</div>
<div class="line"><a id="l02141" name="l02141"></a><span class="lineno"> 2141</span>      <span class="keyword">DEALLOCATE</span>(za_rh)</div>
<div class="line"><a id="l02142" name="l02142"></a><span class="lineno"> 2142</span>      <span class="keyword">DEALLOCATE</span>(za_cc)</div>
<div class="line"><a id="l02143" name="l02143"></a><span class="lineno"> 2143</span>      <span class="keyword">DEALLOCATE</span>(za_cr)</div>
<div class="line"><a id="l02144" name="l02144"></a><span class="lineno"> 2144</span>      <span class="keyword">DEALLOCATE</span>(za_ci)</div>
<div class="line"><a id="l02145" name="l02145"></a><span class="lineno"> 2145</span>      <span class="keyword">DEALLOCATE</span>(za_cs)</div>
<div class="line"><a id="l02146" name="l02146"></a><span class="lineno"> 2146</span>      <span class="keyword">DEALLOCATE</span>(za_cg)</div>
<div class="line"><a id="l02147" name="l02147"></a><span class="lineno"> 2147</span>      <span class="keyword">DEALLOCATE</span>(za_ch)</div>
<div class="line"><a id="l02148" name="l02148"></a><span class="lineno"> 2148</span>      <span class="comment">!</span></div>
<div class="line"><a id="l02149" name="l02149"></a><span class="lineno"> 2149</span>      <span class="keyword">DEALLOCATE</span>(zb_th)</div>
<div class="line"><a id="l02150" name="l02150"></a><span class="lineno"> 2150</span>      <span class="keyword">DEALLOCATE</span>(zb_rv)   </div>
<div class="line"><a id="l02151" name="l02151"></a><span class="lineno"> 2151</span>      <span class="keyword">DEALLOCATE</span>(zb_rc)   </div>
<div class="line"><a id="l02152" name="l02152"></a><span class="lineno"> 2152</span>      <span class="keyword">DEALLOCATE</span>(zb_rr)   </div>
<div class="line"><a id="l02153" name="l02153"></a><span class="lineno"> 2153</span>      <span class="keyword">DEALLOCATE</span>(zb_ri)   </div>
<div class="line"><a id="l02154" name="l02154"></a><span class="lineno"> 2154</span>      <span class="keyword">DEALLOCATE</span>(zb_rs)   </div>
<div class="line"><a id="l02155" name="l02155"></a><span class="lineno"> 2155</span>      <span class="keyword">DEALLOCATE</span>(zb_rg)   </div>
<div class="line"><a id="l02156" name="l02156"></a><span class="lineno"> 2156</span>      <span class="keyword">DEALLOCATE</span>(zb_rh)   </div>
<div class="line"><a id="l02157" name="l02157"></a><span class="lineno"> 2157</span>      <span class="keyword">DEALLOCATE</span>(zb_cc)   </div>
<div class="line"><a id="l02158" name="l02158"></a><span class="lineno"> 2158</span>      <span class="keyword">DEALLOCATE</span>(zb_cr)  </div>
<div class="line"><a id="l02159" name="l02159"></a><span class="lineno"> 2159</span>      <span class="keyword">DEALLOCATE</span>(zb_ci)  </div>
<div class="line"><a id="l02160" name="l02160"></a><span class="lineno"> 2160</span>      <span class="keyword">DEALLOCATE</span>(zb_cs)  </div>
<div class="line"><a id="l02161" name="l02161"></a><span class="lineno"> 2161</span>      <span class="keyword">DEALLOCATE</span>(zb_cg)  </div>
<div class="line"><a id="l02162" name="l02162"></a><span class="lineno"> 2162</span>      <span class="keyword">DEALLOCATE</span>(zb_ch)  </div>
<div class="line"><a id="l02163" name="l02163"></a><span class="lineno"> 2163</span>      <span class="keyword">DEALLOCATE</span>(zb_ifnn)</div>
<div class="line"><a id="l02164" name="l02164"></a><span class="lineno"> 2164</span>      <span class="comment">!</span></div>
<div class="line"><a id="l02165" name="l02165"></a><span class="lineno"> 2165</span>      <span class="keyword">DEALLOCATE</span>(z_cr_brku)</div>
<div class="line"><a id="l02166" name="l02166"></a><span class="lineno"> 2166</span>      <span class="keyword">DEALLOCATE</span>(z_th_honr)</div>
<div class="line"><a id="l02167" name="l02167"></a><span class="lineno"> 2167</span>      <span class="keyword">DEALLOCATE</span>(z_rr_honr)</div>
<div class="line"><a id="l02168" name="l02168"></a><span class="lineno"> 2168</span>      <span class="keyword">DEALLOCATE</span>(z_cr_honr)</div>
<div class="line"><a id="l02169" name="l02169"></a><span class="lineno"> 2169</span>      <span class="keyword">DEALLOCATE</span>(z_th_imlt)</div>
<div class="line"><a id="l02170" name="l02170"></a><span class="lineno"> 2170</span>      <span class="keyword">DEALLOCATE</span>(z_rc_imlt)</div>
<div class="line"><a id="l02171" name="l02171"></a><span class="lineno"> 2171</span>      <span class="keyword">DEALLOCATE</span>(z_cc_imlt)</div>
<div class="line"><a id="l02172" name="l02172"></a><span class="lineno"> 2172</span>      <span class="keyword">DEALLOCATE</span>(z_th_honc)</div>
<div class="line"><a id="l02173" name="l02173"></a><span class="lineno"> 2173</span>      <span class="keyword">DEALLOCATE</span>(z_rc_honc)</div>
<div class="line"><a id="l02174" name="l02174"></a><span class="lineno"> 2174</span>      <span class="keyword">DEALLOCATE</span>(z_cc_honc)</div>
<div class="line"><a id="l02175" name="l02175"></a><span class="lineno"> 2175</span>      <span class="keyword">DEALLOCATE</span>(z_cc_self) </div>
<div class="line"><a id="l02176" name="l02176"></a><span class="lineno"> 2176</span>      <span class="keyword">DEALLOCATE</span>(z_rc_auto) </div>
<div class="line"><a id="l02177" name="l02177"></a><span class="lineno"> 2177</span>      <span class="keyword">DEALLOCATE</span>(z_cc_auto)</div>
<div class="line"><a id="l02178" name="l02178"></a><span class="lineno"> 2178</span>      <span class="keyword">DEALLOCATE</span>(z_cr_auto) </div>
<div class="line"><a id="l02179" name="l02179"></a><span class="lineno"> 2179</span>      <span class="keyword">DEALLOCATE</span>(z_rc_accr) </div>
<div class="line"><a id="l02180" name="l02180"></a><span class="lineno"> 2180</span>      <span class="keyword">DEALLOCATE</span>(z_cc_accr) </div>
<div class="line"><a id="l02181" name="l02181"></a><span class="lineno"> 2181</span>      <span class="keyword">DEALLOCATE</span>(z_cr_scbu)</div>
<div class="line"><a id="l02182" name="l02182"></a><span class="lineno"> 2182</span>      <span class="keyword">DEALLOCATE</span>(z_th_evap) </div>
<div class="line"><a id="l02183" name="l02183"></a><span class="lineno"> 2183</span>      <span class="keyword">DEALLOCATE</span>(z_rr_evap) </div>
<div class="line"><a id="l02184" name="l02184"></a><span class="lineno"> 2184</span>      <span class="keyword">DEALLOCATE</span>(z_cr_evap) </div>
<div class="line"><a id="l02185" name="l02185"></a><span class="lineno"> 2185</span>      <span class="keyword">DEALLOCATE</span>(z_ri_cnvi)</div>
<div class="line"><a id="l02186" name="l02186"></a><span class="lineno"> 2186</span>      <span class="keyword">DEALLOCATE</span>(z_ci_cnvi)</div>
<div class="line"><a id="l02187" name="l02187"></a><span class="lineno"> 2187</span>      <span class="keyword">DEALLOCATE</span>(z_th_deps)</div>
<div class="line"><a id="l02188" name="l02188"></a><span class="lineno"> 2188</span>      <span class="keyword">DEALLOCATE</span>(z_rs_deps)</div>
<div class="line"><a id="l02189" name="l02189"></a><span class="lineno"> 2189</span>      <span class="keyword">DEALLOCATE</span>(z_th_depi)</div>
<div class="line"><a id="l02190" name="l02190"></a><span class="lineno"> 2190</span>      <span class="keyword">DEALLOCATE</span>(z_ri_depi)</div>
<div class="line"><a id="l02191" name="l02191"></a><span class="lineno"> 2191</span>      <span class="keyword">DEALLOCATE</span>(z_ri_cnvs)</div>
<div class="line"><a id="l02192" name="l02192"></a><span class="lineno"> 2192</span>      <span class="keyword">DEALLOCATE</span>(z_ci_cnvs)</div>
<div class="line"><a id="l02193" name="l02193"></a><span class="lineno"> 2193</span>      <span class="keyword">DEALLOCATE</span>(z_cs_ssc) </div>
<div class="line"><a id="l02194" name="l02194"></a><span class="lineno"> 2194</span>      <span class="keyword">DEALLOCATE</span>(z_ci_isc)</div>
<div class="line"><a id="l02195" name="l02195"></a><span class="lineno"> 2195</span>      <span class="keyword">DEALLOCATE</span>(z_ri_aggs) </div>
<div class="line"><a id="l02196" name="l02196"></a><span class="lineno"> 2196</span>      <span class="keyword">DEALLOCATE</span>(z_ci_aggs) </div>
<div class="line"><a id="l02197" name="l02197"></a><span class="lineno"> 2197</span>      <span class="keyword">DEALLOCATE</span>(z_th_depg) </div>
<div class="line"><a id="l02198" name="l02198"></a><span class="lineno"> 2198</span>      <span class="keyword">DEALLOCATE</span>(z_rg_depg) </div>
<div class="line"><a id="l02199" name="l02199"></a><span class="lineno"> 2199</span>      <span class="keyword">DEALLOCATE</span>(z_th_berfi)</div>
<div class="line"><a id="l02200" name="l02200"></a><span class="lineno"> 2200</span>      <span class="keyword">DEALLOCATE</span>(z_rc_berfi)</div>
<div class="line"><a id="l02201" name="l02201"></a><span class="lineno"> 2201</span>      <span class="keyword">DEALLOCATE</span>(z_th_rim) </div>
<div class="line"><a id="l02202" name="l02202"></a><span class="lineno"> 2202</span>      <span class="keyword">DEALLOCATE</span>(z_cc_rim)  </div>
<div class="line"><a id="l02203" name="l02203"></a><span class="lineno"> 2203</span>      <span class="keyword">DEALLOCATE</span>(z_cs_rim) </div>
<div class="line"><a id="l02204" name="l02204"></a><span class="lineno"> 2204</span>      <span class="keyword">DEALLOCATE</span>(z_rc_rimss)</div>
<div class="line"><a id="l02205" name="l02205"></a><span class="lineno"> 2205</span>      <span class="keyword">DEALLOCATE</span>(z_rc_rimsg)</div>
<div class="line"><a id="l02206" name="l02206"></a><span class="lineno"> 2206</span>      <span class="keyword">DEALLOCATE</span>(z_rs_rimcg)    </div>
<div class="line"><a id="l02207" name="l02207"></a><span class="lineno"> 2207</span>      <span class="keyword">DEALLOCATE</span>(z_ri_hms) </div>
<div class="line"><a id="l02208" name="l02208"></a><span class="lineno"> 2208</span>      <span class="keyword">DEALLOCATE</span>(z_ci_hms) </div>
<div class="line"><a id="l02209" name="l02209"></a><span class="lineno"> 2209</span>      <span class="keyword">DEALLOCATE</span>(z_rs_hms)</div>
<div class="line"><a id="l02210" name="l02210"></a><span class="lineno"> 2210</span>      <span class="keyword">DEALLOCATE</span>(z_th_acc) </div>
<div class="line"><a id="l02211" name="l02211"></a><span class="lineno"> 2211</span>      <span class="keyword">DEALLOCATE</span>(z_cr_acc) </div>
<div class="line"><a id="l02212" name="l02212"></a><span class="lineno"> 2212</span>      <span class="keyword">DEALLOCATE</span>(z_cs_acc) </div>
<div class="line"><a id="l02213" name="l02213"></a><span class="lineno"> 2213</span>      <span class="keyword">DEALLOCATE</span>(z_rr_accss)</div>
<div class="line"><a id="l02214" name="l02214"></a><span class="lineno"> 2214</span>      <span class="keyword">DEALLOCATE</span>(z_rr_accsg)</div>
<div class="line"><a id="l02215" name="l02215"></a><span class="lineno"> 2215</span>      <span class="keyword">DEALLOCATE</span>(z_rs_accrg)</div>
<div class="line"><a id="l02216" name="l02216"></a><span class="lineno"> 2216</span>      <span class="keyword">DEALLOCATE</span>(z_cs_cmel) </div>
<div class="line"><a id="l02217" name="l02217"></a><span class="lineno"> 2217</span>      <span class="keyword">DEALLOCATE</span>(z_rs_cmel) </div>
<div class="line"><a id="l02218" name="l02218"></a><span class="lineno"> 2218</span>      <span class="keyword">DEALLOCATE</span>(z_th_cfrz)</div>
<div class="line"><a id="l02219" name="l02219"></a><span class="lineno"> 2219</span>      <span class="keyword">DEALLOCATE</span>(z_rr_cfrz)</div>
<div class="line"><a id="l02220" name="l02220"></a><span class="lineno"> 2220</span>      <span class="keyword">DEALLOCATE</span>(z_cr_cfrz)</div>
<div class="line"><a id="l02221" name="l02221"></a><span class="lineno"> 2221</span>      <span class="keyword">DEALLOCATE</span>(z_ri_cfrz)</div>
<div class="line"><a id="l02222" name="l02222"></a><span class="lineno"> 2222</span>      <span class="keyword">DEALLOCATE</span>(z_ci_cfrz)</div>
<div class="line"><a id="l02223" name="l02223"></a><span class="lineno"> 2223</span>      <span class="keyword">DEALLOCATE</span>(z_ri_cibu) </div>
<div class="line"><a id="l02224" name="l02224"></a><span class="lineno"> 2224</span>      <span class="keyword">DEALLOCATE</span>(z_ci_cibu) </div>
<div class="line"><a id="l02225" name="l02225"></a><span class="lineno"> 2225</span>      <span class="keyword">DEALLOCATE</span>(z_ri_rdsf) </div>
<div class="line"><a id="l02226" name="l02226"></a><span class="lineno"> 2226</span>      <span class="keyword">DEALLOCATE</span>(z_ci_rdsf) </div>
<div class="line"><a id="l02227" name="l02227"></a><span class="lineno"> 2227</span>      <span class="keyword">DEALLOCATE</span>(z_th_wetg)</div>
<div class="line"><a id="l02228" name="l02228"></a><span class="lineno"> 2228</span>      <span class="keyword">DEALLOCATE</span>(z_rc_wetg)</div>
<div class="line"><a id="l02229" name="l02229"></a><span class="lineno"> 2229</span>      <span class="keyword">DEALLOCATE</span>(z_cc_wetg)</div>
<div class="line"><a id="l02230" name="l02230"></a><span class="lineno"> 2230</span>      <span class="keyword">DEALLOCATE</span>(z_rr_wetg) </div>
<div class="line"><a id="l02231" name="l02231"></a><span class="lineno"> 2231</span>      <span class="keyword">DEALLOCATE</span>(z_cr_wetg) </div>
<div class="line"><a id="l02232" name="l02232"></a><span class="lineno"> 2232</span>      <span class="keyword">DEALLOCATE</span>(z_ri_wetg)</div>
<div class="line"><a id="l02233" name="l02233"></a><span class="lineno"> 2233</span>      <span class="keyword">DEALLOCATE</span>(z_ci_wetg)</div>
<div class="line"><a id="l02234" name="l02234"></a><span class="lineno"> 2234</span>      <span class="keyword">DEALLOCATE</span>(z_rs_wetg)</div>
<div class="line"><a id="l02235" name="l02235"></a><span class="lineno"> 2235</span>      <span class="keyword">DEALLOCATE</span>(z_cs_wetg)</div>
<div class="line"><a id="l02236" name="l02236"></a><span class="lineno"> 2236</span>      <span class="keyword">DEALLOCATE</span>(z_rg_wetg)</div>
<div class="line"><a id="l02237" name="l02237"></a><span class="lineno"> 2237</span>      <span class="keyword">DEALLOCATE</span>(z_cg_wetg)</div>
<div class="line"><a id="l02238" name="l02238"></a><span class="lineno"> 2238</span>      <span class="keyword">DEALLOCATE</span>(z_rh_wetg) </div>
<div class="line"><a id="l02239" name="l02239"></a><span class="lineno"> 2239</span>      <span class="keyword">DEALLOCATE</span>(z_th_dryg) </div>
<div class="line"><a id="l02240" name="l02240"></a><span class="lineno"> 2240</span>      <span class="keyword">DEALLOCATE</span>(z_rc_dryg) </div>
<div class="line"><a id="l02241" name="l02241"></a><span class="lineno"> 2241</span>      <span class="keyword">DEALLOCATE</span>(z_cc_dryg)</div>
<div class="line"><a id="l02242" name="l02242"></a><span class="lineno"> 2242</span>      <span class="keyword">DEALLOCATE</span>(z_rr_dryg)</div>
<div class="line"><a id="l02243" name="l02243"></a><span class="lineno"> 2243</span>      <span class="keyword">DEALLOCATE</span>(z_cr_dryg)</div>
<div class="line"><a id="l02244" name="l02244"></a><span class="lineno"> 2244</span>      <span class="keyword">DEALLOCATE</span>(z_ri_dryg)</div>
<div class="line"><a id="l02245" name="l02245"></a><span class="lineno"> 2245</span>      <span class="keyword">DEALLOCATE</span>(z_ci_dryg)</div>
<div class="line"><a id="l02246" name="l02246"></a><span class="lineno"> 2246</span>      <span class="keyword">DEALLOCATE</span>(z_rs_dryg) </div>
<div class="line"><a id="l02247" name="l02247"></a><span class="lineno"> 2247</span>      <span class="keyword">DEALLOCATE</span>(z_cs_dryg) </div>
<div class="line"><a id="l02248" name="l02248"></a><span class="lineno"> 2248</span>      <span class="keyword">DEALLOCATE</span>(z_rg_dryg)</div>
<div class="line"><a id="l02249" name="l02249"></a><span class="lineno"> 2249</span>      <span class="keyword">DEALLOCATE</span>(z_ri_hmg) </div>
<div class="line"><a id="l02250" name="l02250"></a><span class="lineno"> 2250</span>      <span class="keyword">DEALLOCATE</span>(z_ci_hmg) </div>
<div class="line"><a id="l02251" name="l02251"></a><span class="lineno"> 2251</span>      <span class="keyword">DEALLOCATE</span>(z_rg_hmg) </div>
<div class="line"><a id="l02252" name="l02252"></a><span class="lineno"> 2252</span>      <span class="keyword">DEALLOCATE</span>(z_th_gmlt)</div>
<div class="line"><a id="l02253" name="l02253"></a><span class="lineno"> 2253</span>      <span class="keyword">DEALLOCATE</span>(z_rr_gmlt)</div>
<div class="line"><a id="l02254" name="l02254"></a><span class="lineno"> 2254</span>      <span class="keyword">DEALLOCATE</span>(z_cr_gmlt)</div>
<div class="line"><a id="l02255" name="l02255"></a><span class="lineno"> 2255</span>      <span class="keyword">DEALLOCATE</span>(z_cg_gmlt)</div>
<div class="line"><a id="l02256" name="l02256"></a><span class="lineno"> 2256</span>      <span class="keyword">DEALLOCATE</span>(z_th_deph) </div>
<div class="line"><a id="l02257" name="l02257"></a><span class="lineno"> 2257</span>      <span class="keyword">DEALLOCATE</span>(z_rh_deph) </div>
<div class="line"><a id="l02258" name="l02258"></a><span class="lineno"> 2258</span>      <span class="keyword">DEALLOCATE</span>(z_th_weth)</div>
<div class="line"><a id="l02259" name="l02259"></a><span class="lineno"> 2259</span>      <span class="keyword">DEALLOCATE</span>(z_rc_weth)</div>
<div class="line"><a id="l02260" name="l02260"></a><span class="lineno"> 2260</span>      <span class="keyword">DEALLOCATE</span>(z_cc_weth)</div>
<div class="line"><a id="l02261" name="l02261"></a><span class="lineno"> 2261</span>      <span class="keyword">DEALLOCATE</span>(z_rr_weth) </div>
<div class="line"><a id="l02262" name="l02262"></a><span class="lineno"> 2262</span>      <span class="keyword">DEALLOCATE</span>(z_cr_weth) </div>
<div class="line"><a id="l02263" name="l02263"></a><span class="lineno"> 2263</span>      <span class="keyword">DEALLOCATE</span>(z_ri_weth)</div>
<div class="line"><a id="l02264" name="l02264"></a><span class="lineno"> 2264</span>      <span class="keyword">DEALLOCATE</span>(z_ci_weth)</div>
<div class="line"><a id="l02265" name="l02265"></a><span class="lineno"> 2265</span>      <span class="keyword">DEALLOCATE</span>(z_rs_weth)</div>
<div class="line"><a id="l02266" name="l02266"></a><span class="lineno"> 2266</span>      <span class="keyword">DEALLOCATE</span>(z_cs_weth)</div>
<div class="line"><a id="l02267" name="l02267"></a><span class="lineno"> 2267</span>      <span class="keyword">DEALLOCATE</span>(z_rg_weth)</div>
<div class="line"><a id="l02268" name="l02268"></a><span class="lineno"> 2268</span>      <span class="keyword">DEALLOCATE</span>(z_cg_weth)</div>
<div class="line"><a id="l02269" name="l02269"></a><span class="lineno"> 2269</span>      <span class="keyword">DEALLOCATE</span>(z_rh_weth) </div>
<div class="line"><a id="l02270" name="l02270"></a><span class="lineno"> 2270</span>      <span class="keyword">DEALLOCATE</span>(z_rg_cohg)</div>
<div class="line"><a id="l02271" name="l02271"></a><span class="lineno"> 2271</span>      <span class="keyword">DEALLOCATE</span>(z_cg_cohg)</div>
<div class="line"><a id="l02272" name="l02272"></a><span class="lineno"> 2272</span>      <span class="keyword">DEALLOCATE</span>(z_th_hmlt) </div>
<div class="line"><a id="l02273" name="l02273"></a><span class="lineno"> 2273</span>      <span class="keyword">DEALLOCATE</span>(z_rr_hmlt) </div>
<div class="line"><a id="l02274" name="l02274"></a><span class="lineno"> 2274</span>      <span class="keyword">DEALLOCATE</span>(z_cr_hmlt) </div>
<div class="line"><a id="l02275" name="l02275"></a><span class="lineno"> 2275</span>      <span class="keyword">DEALLOCATE</span>(z_ch_hmlt) </div>
<div class="line"><a id="l02276" name="l02276"></a><span class="lineno"> 2276</span>      <span class="comment">!</span></div>
<div class="line"><a id="l02277" name="l02277"></a><span class="lineno"> 2277</span>      <span class="keyword">DEALLOCATE</span>(z_rv_corr2)</div>
<div class="line"><a id="l02278" name="l02278"></a><span class="lineno"> 2278</span>      <span class="keyword">DEALLOCATE</span>(z_rc_corr2)</div>
<div class="line"><a id="l02279" name="l02279"></a><span class="lineno"> 2279</span>      <span class="keyword">DEALLOCATE</span>(z_rr_corr2)</div>
<div class="line"><a id="l02280" name="l02280"></a><span class="lineno"> 2280</span>      <span class="keyword">DEALLOCATE</span>(z_ri_corr2)</div>
<div class="line"><a id="l02281" name="l02281"></a><span class="lineno"> 2281</span>      <span class="keyword">DEALLOCATE</span>(z_cc_corr2)</div>
<div class="line"><a id="l02282" name="l02282"></a><span class="lineno"> 2282</span>      <span class="keyword">DEALLOCATE</span>(z_cr_corr2)</div>
<div class="line"><a id="l02283" name="l02283"></a><span class="lineno"> 2283</span>      <span class="keyword">DEALLOCATE</span>(z_ci_corr2)</div>
<div class="line"><a id="l02284" name="l02284"></a><span class="lineno"> 2284</span>      <span class="comment">!</span></div>
<div class="line"><a id="l02285" name="l02285"></a><span class="lineno"> 2285</span>      <span class="keyword">DEALLOCATE</span>(zcit1d_shape)</div>
<div class="line"><a id="l02286" name="l02286"></a><span class="lineno"> 2286</span>      <span class="keyword">DEALLOCATE</span>(za_ci_shape)</div>
<div class="line"><a id="l02287" name="l02287"></a><span class="lineno"> 2287</span>      <span class="keyword">DEALLOCATE</span>(zb_ci_shape)</div>
<div class="line"><a id="l02288" name="l02288"></a><span class="lineno"> 2288</span>      <span class="keyword">DEALLOCATE</span>(z_shci_imlt)</div>
<div class="line"><a id="l02289" name="l02289"></a><span class="lineno"> 2289</span>      <span class="keyword">DEALLOCATE</span>(z_shci_isc)</div>
<div class="line"><a id="l02290" name="l02290"></a><span class="lineno"> 2290</span>      <span class="keyword">DEALLOCATE</span>(z_shci_iscs)</div>
<div class="line"><a id="l02291" name="l02291"></a><span class="lineno"> 2291</span>      <span class="keyword">DEALLOCATE</span>(z_shri_iscs)</div>
<div class="line"><a id="l02292" name="l02292"></a><span class="lineno"> 2292</span>      <span class="keyword">DEALLOCATE</span>(z_shci_honc)</div>
<div class="line"><a id="l02293" name="l02293"></a><span class="lineno"> 2293</span>      <span class="keyword">DEALLOCATE</span>(z_shci_cnvi)</div>
<div class="line"><a id="l02294" name="l02294"></a><span class="lineno"> 2294</span>      <span class="keyword">DEALLOCATE</span>(z_shci_hach)</div>
<div class="line"><a id="l02295" name="l02295"></a><span class="lineno"> 2295</span>      <span class="keyword">DEALLOCATE</span>(z_shci_cnvs)</div>
<div class="line"><a id="l02296" name="l02296"></a><span class="lineno"> 2296</span>      <span class="keyword">DEALLOCATE</span>(z_shci_aggs)</div>
<div class="line"><a id="l02297" name="l02297"></a><span class="lineno"> 2297</span>      <span class="keyword">DEALLOCATE</span>(z_shci_hms)</div>
<div class="line"><a id="l02298" name="l02298"></a><span class="lineno"> 2298</span>      <span class="keyword">DEALLOCATE</span>(z_shci_cfrz)</div>
<div class="line"><a id="l02299" name="l02299"></a><span class="lineno"> 2299</span>      <span class="keyword">DEALLOCATE</span>(z_shci_cibu)</div>
<div class="line"><a id="l02300" name="l02300"></a><span class="lineno"> 2300</span>      <span class="keyword">DEALLOCATE</span>(z_shci_rdsf)</div>
<div class="line"><a id="l02301" name="l02301"></a><span class="lineno"> 2301</span>      <span class="keyword">DEALLOCATE</span>(z_shci_wetg)</div>
<div class="line"><a id="l02302" name="l02302"></a><span class="lineno"> 2302</span>      <span class="keyword">DEALLOCATE</span>(z_shci_dryg)</div>
<div class="line"><a id="l02303" name="l02303"></a><span class="lineno"> 2303</span>      <span class="keyword">DEALLOCATE</span>(z_shci_hmg)      </div>
<div class="line"><a id="l02304" name="l02304"></a><span class="lineno"> 2304</span>      <span class="keyword">DEALLOCATE</span>(z_shci_corr2)</div>
<div class="line"><a id="l02305" name="l02305"></a><span class="lineno"> 2305</span>      <span class="comment">!</span></div>
<div class="line"><a id="l02306" name="l02306"></a><span class="lineno"> 2306</span><span class="keywordflow">   ENDDO</span></div>
<div class="line"><a id="l02307" name="l02307"></a><span class="lineno"> 2307</span><span class="keywordflow">ENDDO</span></div>
<div class="line"><a id="l02308" name="l02308"></a><span class="lineno"> 2308</span><span class="comment">!</span></div>
<div class="line"><a id="l02309" name="l02309"></a><span class="lineno"> 2309</span><span class="comment">!-------------------------------------------------------------------------------</span></div>
<div class="line"><a id="l02310" name="l02310"></a><span class="lineno"> 2310</span><span class="comment">!</span></div>
<div class="line"><a id="l02311" name="l02311"></a><span class="lineno"> 2311</span><span class="comment">!*       7.     CLOUD ELECTRIFICATION</span></div>
<div class="line"><a id="l02312" name="l02312"></a><span class="lineno"> 2312</span><span class="comment">!               ---------------------</span></div>
<div class="line"><a id="l02313" name="l02313"></a><span class="lineno"> 2313</span><span class="comment">!</span></div>
<div class="line"><a id="l02314" name="l02314"></a><span class="lineno"> 2314</span><span class="comment">!*       7.1    Packing variables</span></div>
<div class="line"><a id="l02315" name="l02315"></a><span class="lineno"> 2315</span><span class="comment">!               -----------------</span></div>
<div class="line"><a id="l02316" name="l02316"></a><span class="lineno"> 2316</span><span class="comment">!</span></div>
<div class="line"><a id="l02317" name="l02317"></a><span class="lineno"> 2317</span><span class="keywordflow">IF</span> (oelec) <span class="keywordflow">THEN</span></div>
<div class="line"><a id="l02318" name="l02318"></a><span class="lineno"> 2318</span>  <span class="keyword">ALLOCATE</span>(gmask_elec(d%NIJT,d%NKT))</div>
<div class="line"><a id="l02319" name="l02319"></a><span class="lineno"> 2319</span>  gmask_elec(:,:) = .false.</div>
<div class="line"><a id="l02320" name="l02320"></a><span class="lineno"> 2320</span>  gmask_elec(:,:) = ztot_ri_hind(:,:)  .NE. 0. .OR. ztot_rr_honr(:,:)  .NE. 0. .OR. &amp;</div>
<div class="line"><a id="l02321" name="l02321"></a><span class="lineno"> 2321</span>                      ztot_rc_imlt(:,:)  .NE. 0. .OR. ztot_rc_honc(:,:)  .NE. 0. .OR. &amp;</div>
<div class="line"><a id="l02322" name="l02322"></a><span class="lineno"> 2322</span>                      ztot_rs_deps(:,:)  .NE. 0. .OR. ztot_ri_aggs(:,:)  .NE. 0. .OR. &amp;</div>
<div class="line"><a id="l02323" name="l02323"></a><span class="lineno"> 2323</span>                      ztot_ri_cnvs(:,:)  .NE. 0. .OR. ztot_rg_depg(:,:)  .NE. 0. .OR. &amp;</div>
<div class="line"><a id="l02324" name="l02324"></a><span class="lineno"> 2324</span>                      ztot_rc_auto(:,:)  .NE. 0. .OR. ztot_rc_accr(:,:)  .NE. 0. .OR. &amp;</div>
<div class="line"><a id="l02325" name="l02325"></a><span class="lineno"> 2325</span>                      ztot_rr_evap(:,:)  .NE. 0. .OR. ztot_rc_rimss(:,:) .NE. 0. .OR. &amp;</div>
<div class="line"><a id="l02326" name="l02326"></a><span class="lineno"> 2326</span>                      ztot_rc_rimsg(:,:) .NE. 0. .OR. ztot_rs_rimcg(:,:) .NE. 0. .OR. &amp;</div>
<div class="line"><a id="l02327" name="l02327"></a><span class="lineno"> 2327</span>                      ztot_rr_accss(:,:) .NE. 0. .OR. ztot_rr_accsg(:,:) .NE. 0. .OR. &amp;</div>
<div class="line"><a id="l02328" name="l02328"></a><span class="lineno"> 2328</span>                      ztot_rs_accrg(:,:) .NE. 0. .OR. ztot_rs_cmel(:,:)  .NE. 0. .OR. &amp;</div>
<div class="line"><a id="l02329" name="l02329"></a><span class="lineno"> 2329</span>                      ztot_rr_cfrz(:,:)  .NE. 0. .OR. ztot_ri_cfrz(:,:)  .NE. 0. .OR. &amp;</div>
<div class="line"><a id="l02330" name="l02330"></a><span class="lineno"> 2330</span>                      ztot_ri_cibu(:,:)  .NE. 0. .OR. ztot_ri_rdsf(:,:)  .NE. 0. .OR. &amp;</div>
<div class="line"><a id="l02331" name="l02331"></a><span class="lineno"> 2331</span>                      ztot_rc_wetg(:,:)  .NE. 0. .OR. ztot_ri_wetg(:,:)  .NE. 0. .OR. &amp;</div>
<div class="line"><a id="l02332" name="l02332"></a><span class="lineno"> 2332</span>                      ztot_rr_wetg(:,:)  .NE. 0. .OR. ztot_rs_wetg(:,:)  .NE. 0. .OR. &amp;</div>
<div class="line"><a id="l02333" name="l02333"></a><span class="lineno"> 2333</span>                      ztot_rc_dryg(:,:)  .NE. 0. .OR. ztot_ri_dryg(:,:)  .NE. 0. .OR. &amp;</div>
<div class="line"><a id="l02334" name="l02334"></a><span class="lineno"> 2334</span>                      ztot_rr_dryg(:,:)  .NE. 0. .OR. ztot_rs_dryg(:,:)  .NE. 0. .OR. &amp;</div>
<div class="line"><a id="l02335" name="l02335"></a><span class="lineno"> 2335</span>                      ztot_rh_wetg(:,:)  .NE. 0. .OR. ztot_rr_gmlt(:,:)  .NE. 0. .OR. &amp;</div>
<div class="line"><a id="l02336" name="l02336"></a><span class="lineno"> 2336</span>                      ztot_rc_berfi(:,:) .NE. 0. .OR. ztot_rv_henu(:,:)  .NE. 0. .OR. &amp;</div>
<div class="line"><a id="l02337" name="l02337"></a><span class="lineno"> 2337</span>                      ztot_rc_hinc(:,:)  .NE. 0. .OR. ztot_rv_honh(:,:)  .NE. 0. .OR. &amp;</div>
<div class="line"><a id="l02338" name="l02338"></a><span class="lineno"> 2338</span>                      ztot_rr_cvrc(:,:)  .NE. 0. .OR. ztot_ri_cnvi(:,:)  .NE. 0. .OR. &amp;</div>
<div class="line"><a id="l02339" name="l02339"></a><span class="lineno"> 2339</span>                      ztot_ri_depi(:,:)  .NE. 0. .OR. ztot_ri_hms(:,:)   .NE. 0. .OR. &amp;</div>
<div class="line"><a id="l02340" name="l02340"></a><span class="lineno"> 2340</span>                      ztot_ri_hmg(:,:)   .NE. 0. .OR. ztot_rc_corr2(:,:) .NE. 0. .OR. &amp;</div>
<div class="line"><a id="l02341" name="l02341"></a><span class="lineno"> 2341</span>                      ztot_rr_corr2(:,:) .NE. 0. .OR. ztot_ri_corr2(:,:) .NE. 0.</div>
<div class="line"><a id="l02342" name="l02342"></a><span class="lineno"> 2342</span>  <span class="keywordflow">IF</span> (limap%NMOM_H .GE. 1) &amp;</div>
<div class="line"><a id="l02343" name="l02343"></a><span class="lineno"> 2343</span>    gmask_elec(:,:) = gmask_elec(:,:)           .OR.                                  &amp;</div>
<div class="line"><a id="l02344" name="l02344"></a><span class="lineno"> 2344</span>                        ztot_rc_weth(:,:) .NE. 0. .OR. ztot_ri_weth(:,:) .NE. 0. .OR. &amp;</div>
<div class="line"><a id="l02345" name="l02345"></a><span class="lineno"> 2345</span>                        ztot_rs_weth(:,:) .NE. 0. .OR. ztot_rg_weth(:,:) .NE. 0. .OR. &amp;</div>
<div class="line"><a id="l02346" name="l02346"></a><span class="lineno"> 2346</span>                        ztot_rr_weth(:,:) .NE. 0. .OR.                                  &amp;</div>
<div class="line"><a id="l02347" name="l02347"></a><span class="lineno"> 2347</span>                        <span class="comment">!ZTOT_RC_DRYH(:,:) .NE. 0. .OR. ZTOT_RI_DRYH(:,:) .NE. 0. .OR. &amp;</span></div>
<div class="line"><a id="l02348" name="l02348"></a><span class="lineno"> 2348</span>                        <span class="comment">!ZTOT_RS_DRYH(:,:) .NE. 0. .OR. ZTOT_RR_DRYH(:,:) .NE. 0. .OR. &amp;</span></div>
<div class="line"><a id="l02349" name="l02349"></a><span class="lineno"> 2349</span>                        <span class="comment">!ZTOT_RG_DRYH(:,:) .NE. 0. .OR.                                  &amp;</span></div>
<div class="line"><a id="l02350" name="l02350"></a><span class="lineno"> 2350</span>                        ztot_rg_cohg(:,:) .NE. 0. .OR. ztot_rr_hmlt(:,:) .NE. 0.</div>
<div class="line"><a id="l02351" name="l02351"></a><span class="lineno"> 2351</span>  <span class="comment">!</span></div>
<div class="line"><a id="l02352" name="l02352"></a><span class="lineno"> 2352</span>  ielec = count(gmask_elec)</div>
<div class="line"><a id="l02353" name="l02353"></a><span class="lineno"> 2353</span>  <span class="comment">!</span></div>
<div class="line"><a id="l02354" name="l02354"></a><span class="lineno"> 2354</span><span class="comment">!</span></div>
<div class="line"><a id="l02355" name="l02355"></a><span class="lineno"> 2355</span><span class="comment">!*       7.2    Cloud electrification:</span></div>
<div class="line"><a id="l02356" name="l02356"></a><span class="lineno"> 2356</span><span class="comment">!               ---------------------</span></div>
<div class="line"><a id="l02357" name="l02357"></a><span class="lineno"> 2357</span><span class="comment">!</span></div>
<div class="line"><a id="l02358" name="l02358"></a><span class="lineno"> 2358</span><span class="comment">! Attention, les signes des tendances ne sont pas traites de la meme facon dans ice3 et lima</span></div>
<div class="line"><a id="l02359" name="l02359"></a><span class="lineno"> 2359</span><span class="comment">! On se cale sur la facon de faire dans ice3 =&gt; on fait en sorte que les tendances soient positives</span></div>
<div class="line"><a id="l02360" name="l02360"></a><span class="lineno"> 2360</span>  <span class="keywordflow">IF</span> (limap%NMOM_H .GE. 1) <span class="keywordflow">THEN</span></div>
<div class="line"><a id="l02361" name="l02361"></a><span class="lineno"> 2361</span>    <span class="keyword">CALL </span>elec_tendencies(d, cst, iced, icep, elecd, elecp,                                              &amp;</div>
<div class="line"><a id="l02362" name="l02362"></a><span class="lineno"> 2362</span>                         krr, ielec, ptstep, gmask_elec,                                                &amp;</div>
<div class="line"><a id="l02363" name="l02363"></a><span class="lineno"> 2363</span>                         buconf, tbudgets, kbudgets,                                                    &amp;</div>
<div class="line"><a id="l02364" name="l02364"></a><span class="lineno"> 2364</span>                         <span class="stringliteral">&#39;LIMA&#39;</span>, pthvrefzikb,                                                           &amp;</div>
<div class="line"><a id="l02365" name="l02365"></a><span class="lineno"> 2365</span>                         prhodref,  prhodj, zt, zcit_elec,                                              &amp;</div>
<div class="line"><a id="l02366" name="l02366"></a><span class="lineno"> 2366</span>                         zrvt_elec, zrct_elec, zrrt_elec, zrit_elec, zrst_elec, zrgt_elec,              &amp;</div>
<div class="line"><a id="l02367" name="l02367"></a><span class="lineno"> 2367</span>                         zqpit, zqct, zqrt, zqit, zqst, zqgt, zqnit,                                    &amp;</div>
<div class="line"><a id="l02368" name="l02368"></a><span class="lineno"> 2368</span>                         zqpis, zqcs, zqrs, zqis, zqss, zqgs, zqnis,                                    &amp;</div>
<div class="line"><a id="l02369" name="l02369"></a><span class="lineno"> 2369</span>                         ztot_ri_hind*zinv_tstep,  -ztot_rr_honr*zinv_tstep,   ztot_rc_imlt*zinv_tstep, &amp;</div>
<div class="line"><a id="l02370" name="l02370"></a><span class="lineno"> 2370</span>                        -ztot_rc_honc*zinv_tstep,   ztot_rs_deps*zinv_tstep,  -ztot_ri_aggs*zinv_tstep, &amp;</div>
<div class="line"><a id="l02371" name="l02371"></a><span class="lineno"> 2371</span>                        -ztot_ri_cnvs*zinv_tstep,   ztot_rg_depg*zinv_tstep,  -ztot_rc_auto*zinv_tstep, &amp;</div>
<div class="line"><a id="l02372" name="l02372"></a><span class="lineno"> 2372</span>                        -ztot_rc_accr*zinv_tstep,  -ztot_rr_evap*zinv_tstep,                            &amp;</div>
<div class="line"><a id="l02373" name="l02373"></a><span class="lineno"> 2373</span>                         ztot_rc_rimss*zinv_tstep,  ztot_rc_rimsg*zinv_tstep,  ztot_rs_rimcg*zinv_tstep,&amp;</div>
<div class="line"><a id="l02374" name="l02374"></a><span class="lineno"> 2374</span>                         ztot_rr_accss*zinv_tstep,  ztot_rr_accsg*zinv_tstep,  ztot_rs_accrg*zinv_tstep,&amp;</div>
<div class="line"><a id="l02375" name="l02375"></a><span class="lineno"> 2375</span>                        -ztot_rs_cmel*zinv_tstep,  -ztot_ri_cfrz*zinv_tstep,  -ztot_rr_cfrz*zinv_tstep, &amp;</div>
<div class="line"><a id="l02376" name="l02376"></a><span class="lineno"> 2376</span>                        -ztot_rc_wetg*zinv_tstep,  -ztot_ri_wetg*zinv_tstep,  -ztot_rr_wetg*zinv_tstep, &amp;</div>
<div class="line"><a id="l02377" name="l02377"></a><span class="lineno"> 2377</span>                        -ztot_rs_wetg*zinv_tstep,                                                       &amp;</div>
<div class="line"><a id="l02378" name="l02378"></a><span class="lineno"> 2378</span>                        -ztot_rc_dryg*zinv_tstep,  -ztot_ri_dryg*zinv_tstep,  -ztot_rr_dryg*zinv_tstep, &amp;</div>
<div class="line"><a id="l02379" name="l02379"></a><span class="lineno"> 2379</span>                        -ztot_rs_dryg*zinv_tstep,                                                       &amp;</div>
<div class="line"><a id="l02380" name="l02380"></a><span class="lineno"> 2380</span>                         ztot_rr_gmlt*zinv_tstep,  -ztot_rc_berfi*zinv_tstep,                           &amp;</div>
<div class="line"><a id="l02381" name="l02381"></a><span class="lineno"> 2381</span><span class="comment">! variables et processus optionnels propres a la grele : pas encore teste</span></div>
<div class="line"><a id="l02382" name="l02382"></a><span class="lineno"> 2382</span>                         prwetgh=ztot_rh_wetg*zinv_tstep,                                               &amp;</div>
<div class="line"><a id="l02383" name="l02383"></a><span class="lineno"> 2383</span>                         prcweth=ztot_rc_weth, priweth=ztot_ri_weth, prsweth=ztot_rs_weth,              &amp;</div>
<div class="line"><a id="l02384" name="l02384"></a><span class="lineno"> 2384</span>                         prgweth=ztot_rg_weth, prrweth=ztot_rr_weth,                                    &amp;</div>
<div class="line"><a id="l02385" name="l02385"></a><span class="lineno"> 2385</span><span class="comment">!                         PRCDRYH=ZTOT_RC_DRYH, PRIDRYH=ZTOT_RI_DRYH, PRSDRYH=ZTOT_RS_DRYH,              &amp;</span></div>
<div class="line"><a id="l02386" name="l02386"></a><span class="lineno"> 2386</span><span class="comment">!                         PRRDRYH=ZTOT_RR_DRYH, PRGDRYH=ZTOT_RG_DRYH,                                    &amp;</span></div>
<div class="line"><a id="l02387" name="l02387"></a><span class="lineno"> 2387</span>                         prdryhg=ztot_rg_cohg, prhmltr=ztot_rr_hmlt,                                    &amp;</div>
<div class="line"><a id="l02388" name="l02388"></a><span class="lineno"> 2388</span>                         prht=zrht, prhs=zrhs, pqht=zqht, pqhs=zqhs, pcht=zcht,                         &amp;</div>
<div class="line"><a id="l02389" name="l02389"></a><span class="lineno"> 2389</span><span class="comment">! variables et processus optionnels propres a lima</span></div>
<div class="line"><a id="l02390" name="l02390"></a><span class="lineno"> 2390</span>                         pcct=zcct_elec, pcrt=zcrt_elec, pcst=zcst_elec, pcgt=zcgt_elec,                &amp;</div>
<div class="line"><a id="l02391" name="l02391"></a><span class="lineno"> 2391</span>                         prvhenc=ztot_rv_henu*zinv_tstep,    prchinc=-ztot_rc_hinc*zinv_tstep,          &amp;</div>
<div class="line"><a id="l02392" name="l02392"></a><span class="lineno"> 2392</span>                         prvhonh=-ztot_rv_honh*zinv_tstep,   prrcvrc=-ztot_rr_cvrc*zinv_tstep,          &amp;</div>
<div class="line"><a id="l02393" name="l02393"></a><span class="lineno"> 2393</span>                         pricnvi=ztot_ri_cnvi*zinv_tstep,    prvdepi=ztot_ri_depi*zinv_tstep,           &amp;</div>
<div class="line"><a id="l02394" name="l02394"></a><span class="lineno"> 2394</span>                         prshmsi=ztot_ri_hms*zinv_tstep,     prghmgi=ztot_ri_hmg*zinv_tstep,            &amp;</div>
<div class="line"><a id="l02395" name="l02395"></a><span class="lineno"> 2395</span>                         pricibu=ztot_ri_cibu*zinv_tstep,    prirdsf=ztot_ri_rdsf*zinv_tstep,           &amp;</div>
<div class="line"><a id="l02396" name="l02396"></a><span class="lineno"> 2396</span>                         prccorr2=-ztot_rc_corr2*zinv_tstep, prrcorr2=-ztot_rr_corr2*zinv_tstep,        &amp;</div>
<div class="line"><a id="l02397" name="l02397"></a><span class="lineno"> 2397</span>                         pricorr2=-ztot_ri_corr2*zinv_tstep)</div>
<div class="line"><a id="l02398" name="l02398"></a><span class="lineno"> 2398</span>  <span class="keywordflow">ELSE</span></div>
<div class="line"><a id="l02399" name="l02399"></a><span class="lineno"> 2399</span>    <span class="keyword">CALL </span>elec_tendencies(d, cst, iced, icep, elecd, elecp,                                              &amp;</div>
<div class="line"><a id="l02400" name="l02400"></a><span class="lineno"> 2400</span>                         krr, ielec, ptstep, gmask_elec,                                                &amp;</div>
<div class="line"><a id="l02401" name="l02401"></a><span class="lineno"> 2401</span>                         buconf, tbudgets, kbudgets,                                                    &amp;</div>
<div class="line"><a id="l02402" name="l02402"></a><span class="lineno"> 2402</span>                         <span class="stringliteral">&#39;LIMA&#39;</span>, pthvrefzikb,                                                           &amp;</div>
<div class="line"><a id="l02403" name="l02403"></a><span class="lineno"> 2403</span>                         prhodref, prhodj, zt, zcit_elec,                                               &amp;</div>
<div class="line"><a id="l02404" name="l02404"></a><span class="lineno"> 2404</span>                         zrvt_elec, zrct_elec, zrrt_elec, zrit_elec, zrst_elec, zrgt_elec,              &amp;</div>
<div class="line"><a id="l02405" name="l02405"></a><span class="lineno"> 2405</span>                         zqpit, zqct, zqrt, zqit, zqst, zqgt, zqnit,                                    &amp;</div>
<div class="line"><a id="l02406" name="l02406"></a><span class="lineno"> 2406</span>                         zqpis, zqcs, zqrs, zqis, zqss, zqgs, zqnis,                                    &amp;</div>
<div class="line"><a id="l02407" name="l02407"></a><span class="lineno"> 2407</span>                         ztot_ri_hind*zinv_tstep,  -ztot_rr_honr*zinv_tstep,   ztot_rc_imlt*zinv_tstep, &amp;</div>
<div class="line"><a id="l02408" name="l02408"></a><span class="lineno"> 2408</span>                        -ztot_rc_honc*zinv_tstep,   ztot_rs_deps*zinv_tstep,  -ztot_ri_aggs*zinv_tstep, &amp;</div>
<div class="line"><a id="l02409" name="l02409"></a><span class="lineno"> 2409</span>                        -ztot_ri_cnvs*zinv_tstep,   ztot_rg_depg*zinv_tstep,  -ztot_rc_auto*zinv_tstep, &amp;</div>
<div class="line"><a id="l02410" name="l02410"></a><span class="lineno"> 2410</span>                        -ztot_rc_accr*zinv_tstep,  -ztot_rr_evap*zinv_tstep,                            &amp;</div>
<div class="line"><a id="l02411" name="l02411"></a><span class="lineno"> 2411</span>                         ztot_rc_rimss*zinv_tstep,  ztot_rc_rimsg*zinv_tstep,  ztot_rs_rimcg*zinv_tstep,&amp;</div>
<div class="line"><a id="l02412" name="l02412"></a><span class="lineno"> 2412</span>                         ztot_rr_accss*zinv_tstep,  ztot_rr_accsg*zinv_tstep,  ztot_rs_accrg*zinv_tstep,&amp;</div>
<div class="line"><a id="l02413" name="l02413"></a><span class="lineno"> 2413</span>                        -ztot_rs_cmel*zinv_tstep,  -ztot_ri_cfrz*zinv_tstep,  -ztot_rr_cfrz*zinv_tstep, &amp;</div>
<div class="line"><a id="l02414" name="l02414"></a><span class="lineno"> 2414</span>                        -ztot_rc_wetg*zinv_tstep,  -ztot_ri_wetg*zinv_tstep,  -ztot_rr_wetg*zinv_tstep, &amp;</div>
<div class="line"><a id="l02415" name="l02415"></a><span class="lineno"> 2415</span>                        -ztot_rs_wetg*zinv_tstep,                                                       &amp;</div>
<div class="line"><a id="l02416" name="l02416"></a><span class="lineno"> 2416</span>                        -ztot_rc_dryg*zinv_tstep,  -ztot_ri_dryg*zinv_tstep,  -ztot_rr_dryg*zinv_tstep, &amp;</div>
<div class="line"><a id="l02417" name="l02417"></a><span class="lineno"> 2417</span>                        -ztot_rs_dryg*zinv_tstep,                                                       &amp;</div>
<div class="line"><a id="l02418" name="l02418"></a><span class="lineno"> 2418</span>                         ztot_rr_gmlt*zinv_tstep,  -ztot_rc_berfi*zinv_tstep,                           &amp;</div>
<div class="line"><a id="l02419" name="l02419"></a><span class="lineno"> 2419</span><span class="comment">! variables et processus optionnels propres a lima</span></div>
<div class="line"><a id="l02420" name="l02420"></a><span class="lineno"> 2420</span>                         pcct=zcct, pcrt=zcrt, pcst=zcst, pcgt=zcgt,                                    &amp;</div>
<div class="line"><a id="l02421" name="l02421"></a><span class="lineno"> 2421</span>                         prvhenc=ztot_rv_henu*zinv_tstep,    prchinc=-ztot_rc_hinc*zinv_tstep,          &amp;</div>
<div class="line"><a id="l02422" name="l02422"></a><span class="lineno"> 2422</span>                         prvhonh=-ztot_rv_honh*zinv_tstep,   prrcvrc=-ztot_rr_cvrc*zinv_tstep,          &amp;</div>
<div class="line"><a id="l02423" name="l02423"></a><span class="lineno"> 2423</span>                         pricnvi=ztot_ri_cnvi*zinv_tstep,    prvdepi=ztot_ri_depi*zinv_tstep,           &amp;</div>
<div class="line"><a id="l02424" name="l02424"></a><span class="lineno"> 2424</span>                         prshmsi=ztot_ri_hms*zinv_tstep,     prghmgi=ztot_ri_hmg*zinv_tstep,            &amp;</div>
<div class="line"><a id="l02425" name="l02425"></a><span class="lineno"> 2425</span>                         pricibu=ztot_ri_cibu*zinv_tstep,    prirdsf=ztot_ri_rdsf*zinv_tstep,           &amp;</div>
<div class="line"><a id="l02426" name="l02426"></a><span class="lineno"> 2426</span>                         prccorr2=-ztot_rc_corr2*zinv_tstep, prrcorr2=-ztot_rr_corr2*zinv_tstep,        &amp;</div>
<div class="line"><a id="l02427" name="l02427"></a><span class="lineno"> 2427</span>                         pricorr2=-ztot_ri_corr2*zinv_tstep)            </div>
<div class="line"><a id="l02428" name="l02428"></a><span class="lineno"> 2428</span><span class="keywordflow">  END IF</span></div>
<div class="line"><a id="l02429" name="l02429"></a><span class="lineno"> 2429</span>  <span class="comment">!</span></div>
<div class="line"><a id="l02430" name="l02430"></a><span class="lineno"> 2430</span>  <span class="comment">! update the source variables</span></div>
<div class="line"><a id="l02431" name="l02431"></a><span class="lineno"> 2431</span>  psv_elec_s(:,:,1) = zqpis(:,:)</div>
<div class="line"><a id="l02432" name="l02432"></a><span class="lineno"> 2432</span>  psv_elec_s(:,:,2) = zqcs(:,:)</div>
<div class="line"><a id="l02433" name="l02433"></a><span class="lineno"> 2433</span>  psv_elec_s(:,:,3) = zqrs(:,:)</div>
<div class="line"><a id="l02434" name="l02434"></a><span class="lineno"> 2434</span>  psv_elec_s(:,:,4) = zqis(:,:)</div>
<div class="line"><a id="l02435" name="l02435"></a><span class="lineno"> 2435</span>  psv_elec_s(:,:,5) = zqss(:,:)</div>
<div class="line"><a id="l02436" name="l02436"></a><span class="lineno"> 2436</span>  psv_elec_s(:,:,6) = zqgs(:,:)</div>
<div class="line"><a id="l02437" name="l02437"></a><span class="lineno"> 2437</span>  <span class="keywordflow">IF</span> (krr == 6) <span class="keywordflow">THEN</span></div>
<div class="line"><a id="l02438" name="l02438"></a><span class="lineno"> 2438</span>    psv_elec_s(:,:,7) = zqnis(:,:)</div>
<div class="line"><a id="l02439" name="l02439"></a><span class="lineno"> 2439</span>  <span class="keywordflow">ELSE</span> <span class="keywordflow">IF</span> (krr == 7) <span class="keywordflow">THEN</span></div>
<div class="line"><a id="l02440" name="l02440"></a><span class="lineno"> 2440</span>    psv_elec_s(:,:,7) = zqhs(:,:)</div>
<div class="line"><a id="l02441" name="l02441"></a><span class="lineno"> 2441</span>    psv_elec_s(:,:,8) = zqnis(:,:)</div>
<div class="line"><a id="l02442" name="l02442"></a><span class="lineno"> 2442</span><span class="keywordflow">  END IF</span></div>
<div class="line"><a id="l02443" name="l02443"></a><span class="lineno"> 2443</span>  <span class="comment">!</span></div>
<div class="line"><a id="l02444" name="l02444"></a><span class="lineno"> 2444</span>  <span class="keyword">DEALLOCATE</span>(gmask_elec)</div>
<div class="line"><a id="l02445" name="l02445"></a><span class="lineno"> 2445</span>  <span class="comment">!</span></div>
<div class="line"><a id="l02446" name="l02446"></a><span class="lineno"> 2446</span>  <span class="keyword">DEALLOCATE</span>(zqpit)</div>
<div class="line"><a id="l02447" name="l02447"></a><span class="lineno"> 2447</span>  <span class="keyword">DEALLOCATE</span>(zqnit)</div>
<div class="line"><a id="l02448" name="l02448"></a><span class="lineno"> 2448</span>  <span class="keyword">DEALLOCATE</span>(zqct)</div>
<div class="line"><a id="l02449" name="l02449"></a><span class="lineno"> 2449</span>  <span class="keyword">DEALLOCATE</span>(zqrt)</div>
<div class="line"><a id="l02450" name="l02450"></a><span class="lineno"> 2450</span>  <span class="keyword">DEALLOCATE</span>(zqit)</div>
<div class="line"><a id="l02451" name="l02451"></a><span class="lineno"> 2451</span>  <span class="keyword">DEALLOCATE</span>(zqst)</div>
<div class="line"><a id="l02452" name="l02452"></a><span class="lineno"> 2452</span>  <span class="keyword">DEALLOCATE</span>(zqgt)</div>
<div class="line"><a id="l02453" name="l02453"></a><span class="lineno"> 2453</span>  <span class="keywordflow">IF</span> (<span class="keyword">ALLOCATED</span>(zqht)) <span class="keyword">DEALLOCATE</span>(zqht)</div>
<div class="line"><a id="l02454" name="l02454"></a><span class="lineno"> 2454</span>  <span class="keyword">DEALLOCATE</span>(zqpis)</div>
<div class="line"><a id="l02455" name="l02455"></a><span class="lineno"> 2455</span>  <span class="keyword">DEALLOCATE</span>(zqnis)</div>
<div class="line"><a id="l02456" name="l02456"></a><span class="lineno"> 2456</span>  <span class="keyword">DEALLOCATE</span>(zqcs)</div>
<div class="line"><a id="l02457" name="l02457"></a><span class="lineno"> 2457</span>  <span class="keyword">DEALLOCATE</span>(zqrs)</div>
<div class="line"><a id="l02458" name="l02458"></a><span class="lineno"> 2458</span>  <span class="keyword">DEALLOCATE</span>(zqis)</div>
<div class="line"><a id="l02459" name="l02459"></a><span class="lineno"> 2459</span>  <span class="keyword">DEALLOCATE</span>(zqss)</div>
<div class="line"><a id="l02460" name="l02460"></a><span class="lineno"> 2460</span>  <span class="keyword">DEALLOCATE</span>(zqgs)</div>
<div class="line"><a id="l02461" name="l02461"></a><span class="lineno"> 2461</span>  <span class="keywordflow">IF</span> (<span class="keyword">ALLOCATED</span>(zqhs)) <span class="keyword">DEALLOCATE</span>(zqhs)</div>
<div class="line"><a id="l02462" name="l02462"></a><span class="lineno"> 2462</span>  <span class="comment">!</span></div>
<div class="line"><a id="l02463" name="l02463"></a><span class="lineno"> 2463</span>  <span class="keyword">DEALLOCATE</span>(zrvt_elec)</div>
<div class="line"><a id="l02464" name="l02464"></a><span class="lineno"> 2464</span>  <span class="keyword">DEALLOCATE</span>(zrct_elec)</div>
<div class="line"><a id="l02465" name="l02465"></a><span class="lineno"> 2465</span>  <span class="keyword">DEALLOCATE</span>(zrrt_elec)</div>
<div class="line"><a id="l02466" name="l02466"></a><span class="lineno"> 2466</span>  <span class="keyword">DEALLOCATE</span>(zrit_elec)</div>
<div class="line"><a id="l02467" name="l02467"></a><span class="lineno"> 2467</span>  <span class="keyword">DEALLOCATE</span>(zrst_elec)</div>
<div class="line"><a id="l02468" name="l02468"></a><span class="lineno"> 2468</span>  <span class="keyword">DEALLOCATE</span>(zrgt_elec)</div>
<div class="line"><a id="l02469" name="l02469"></a><span class="lineno"> 2469</span>  <span class="keywordflow">IF</span> (<span class="keyword">ALLOCATED</span>(zrht_elec)) <span class="keyword">DEALLOCATE</span>(zrht_elec)</div>
<div class="line"><a id="l02470" name="l02470"></a><span class="lineno"> 2470</span>  <span class="keywordflow">IF</span> (<span class="keyword">ALLOCATED</span>(zcct_elec)) <span class="keyword">DEALLOCATE</span>(zcct_elec)</div>
<div class="line"><a id="l02471" name="l02471"></a><span class="lineno"> 2471</span>  <span class="keywordflow">IF</span> (<span class="keyword">ALLOCATED</span>(zcrt_elec)) <span class="keyword">DEALLOCATE</span>(zcrt_elec)</div>
<div class="line"><a id="l02472" name="l02472"></a><span class="lineno"> 2472</span>  <span class="keywordflow">IF</span> (<span class="keyword">ALLOCATED</span>(zcit_elec)) <span class="keyword">DEALLOCATE</span>(zcit_elec)</div>
<div class="line"><a id="l02473" name="l02473"></a><span class="lineno"> 2473</span>  <span class="keywordflow">IF</span> (<span class="keyword">ALLOCATED</span>(zcst_elec)) <span class="keyword">DEALLOCATE</span>(zcst_elec)</div>
<div class="line"><a id="l02474" name="l02474"></a><span class="lineno"> 2474</span>  <span class="keywordflow">IF</span> (<span class="keyword">ALLOCATED</span>(zcgt_elec)) <span class="keyword">DEALLOCATE</span>(zcgt_elec)</div>
<div class="line"><a id="l02475" name="l02475"></a><span class="lineno"> 2475</span>  <span class="keywordflow">IF</span> (<span class="keyword">ALLOCATED</span>(zcht_elec)) <span class="keyword">DEALLOCATE</span>(zcht_elec)</div>
<div class="line"><a id="l02476" name="l02476"></a><span class="lineno"> 2476</span>  <span class="comment">!</span></div>
<div class="line"><a id="l02477" name="l02477"></a><span class="lineno"> 2477</span><span class="keywordflow">END IF</span></div>
<div class="line"><a id="l02478" name="l02478"></a><span class="lineno"> 2478</span><span class="comment">!</span></div>
<div class="line"><a id="l02479" name="l02479"></a><span class="lineno"> 2479</span><span class="keyword">DEALLOCATE</span>(ztot_ri_hind)</div>
<div class="line"><a id="l02480" name="l02480"></a><span class="lineno"> 2480</span><span class="keyword">DEALLOCATE</span>(ztot_rc_hinc)</div>
<div class="line"><a id="l02481" name="l02481"></a><span class="lineno"> 2481</span><span class="keyword">DEALLOCATE</span>(ztot_rv_henu)</div>
<div class="line"><a id="l02482" name="l02482"></a><span class="lineno"> 2482</span><span class="keyword">DEALLOCATE</span>(ztot_rv_honh)</div>
<div class="line"><a id="l02483" name="l02483"></a><span class="lineno"> 2483</span><span class="comment">!</span></div>
<div class="line"><a id="l02484" name="l02484"></a><span class="lineno"> 2484</span><span class="comment">!</span></div>
<div class="line"><a id="l02485" name="l02485"></a><span class="lineno"> 2485</span><span class="comment">!*       7.3    Unpacking variables</span></div>
<div class="line"><a id="l02486" name="l02486"></a><span class="lineno"> 2486</span><span class="comment">!               -------------------</span></div>
<div class="line"><a id="l02487" name="l02487"></a><span class="lineno"> 2487</span><span class="comment">!</span></div>
<div class="line"><a id="l02488" name="l02488"></a><span class="lineno"> 2488</span><span class="comment">! not necessary! the only variables needed in the following (PQxS) are already 3D</span></div>
<div class="line"><a id="l02489" name="l02489"></a><span class="lineno"> 2489</span><span class="comment">!</span></div>
<div class="line"><a id="l02490" name="l02490"></a><span class="lineno"> 2490</span><span class="comment">!</span></div>
<div class="line"><a id="l02491" name="l02491"></a><span class="lineno"> 2491</span><span class="comment">!-------------------------------------------------------------------------------</span></div>
<div class="line"><a id="l02492" name="l02492"></a><span class="lineno"> 2492</span><span class="comment">!</span></div>
<div class="line"><a id="l02493" name="l02493"></a><span class="lineno"> 2493</span><span class="comment">!*       7.     TOTAL TENDENCIES</span></div>
<div class="line"><a id="l02494" name="l02494"></a><span class="lineno"> 2494</span><span class="comment">!               ----------------</span></div>
<div class="line"><a id="l02495" name="l02495"></a><span class="lineno"> 2495</span><span class="comment">!</span></div>
<div class="line"><a id="l02496" name="l02496"></a><span class="lineno"> 2496</span><span class="comment">! Source at the end of microphysics = new state / PTSTEP</span></div>
<div class="line"><a id="l02497" name="l02497"></a><span class="lineno"> 2497</span><span class="comment">!</span></div>
<div class="line"><a id="l02498" name="l02498"></a><span class="lineno"> 2498</span>pths(:,:) = ztht(:,:) * zinv_tstep</div>
<div class="line"><a id="l02499" name="l02499"></a><span class="lineno"> 2499</span><span class="comment">!</span></div>
<div class="line"><a id="l02500" name="l02500"></a><span class="lineno"> 2500</span>prs(:,:,1) = zrvt(:,:) *zinv_tstep</div>
<div class="line"><a id="l02501" name="l02501"></a><span class="lineno"> 2501</span><span class="keywordflow">IF</span> ( krr .GE. 2 ) prs(:,:,2) = zrct(:,:) *zinv_tstep</div>
<div class="line"><a id="l02502" name="l02502"></a><span class="lineno"> 2502</span><span class="keywordflow">IF</span> ( krr .GE. 3 ) prs(:,:,3) = zrrt(:,:) *zinv_tstep</div>
<div class="line"><a id="l02503" name="l02503"></a><span class="lineno"> 2503</span><span class="keywordflow">IF</span> ( krr .GE. 4 ) prs(:,:,4) = zrit(:,:) *zinv_tstep</div>
<div class="line"><a id="l02504" name="l02504"></a><span class="lineno"> 2504</span><span class="keywordflow">IF</span> ( krr .GE. 5 ) prs(:,:,5) = zrst(:,:) *zinv_tstep</div>
<div class="line"><a id="l02505" name="l02505"></a><span class="lineno"> 2505</span><span class="keywordflow">IF</span> ( krr .GE. 6 ) prs(:,:,6) = zrgt(:,:) *zinv_tstep</div>
<div class="line"><a id="l02506" name="l02506"></a><span class="lineno"> 2506</span><span class="keywordflow">IF</span> ( krr .GE. 7 ) prs(:,:,7) = zrht(:,:) *zinv_tstep</div>
<div class="line"><a id="l02507" name="l02507"></a><span class="lineno"> 2507</span><span class="comment">!</span></div>
<div class="line"><a id="l02508" name="l02508"></a><span class="lineno"> 2508</span><span class="keywordflow">IF</span> ( limap%NMOM_C.GE.2 ) psvs(:,:,isv_lima_nc) = zcct(:,:) *zinv_tstep</div>
<div class="line"><a id="l02509" name="l02509"></a><span class="lineno"> 2509</span><span class="keywordflow">IF</span> ( limap%NMOM_R.GE.2 ) psvs(:,:,isv_lima_nr) = zcrt(:,:) *zinv_tstep</div>
<div class="line"><a id="l02510" name="l02510"></a><span class="lineno"> 2510</span><span class="keywordflow">IF</span> ( limap%NMOM_I.GE.2 ) <span class="keywordflow">THEN</span></div>
<div class="line"><a id="l02511" name="l02511"></a><span class="lineno"> 2511</span>  <span class="keywordflow">IF</span> (.NOT. limap%LCRYSTAL_SHAPE) <span class="keywordflow">THEN</span></div>
<div class="line"><a id="l02512" name="l02512"></a><span class="lineno"> 2512</span>    psvs(:,:,isv_lima_ni) = zcit(:,:) *zinv_tstep</div>
<div class="line"><a id="l02513" name="l02513"></a><span class="lineno"> 2513</span>  <span class="keywordflow">ELSE</span></div>
<div class="line"><a id="l02514" name="l02514"></a><span class="lineno"> 2514</span>    <span class="keywordflow">DO</span> ish = 1, limap%NNB_CRYSTAL_SHAPE</div>
<div class="line"><a id="l02515" name="l02515"></a><span class="lineno"> 2515</span>      psvs(:,:,isv_lima_ni+ish-1) = zcit_shape(:,:,ish) *zinv_tstep</div>
<div class="line"><a id="l02516" name="l02516"></a><span class="lineno"> 2516</span><span class="keywordflow">    END DO</span></div>
<div class="line"><a id="l02517" name="l02517"></a><span class="lineno"> 2517</span><span class="keywordflow">  END IF</span></div>
<div class="line"><a id="l02518" name="l02518"></a><span class="lineno"> 2518</span><span class="keywordflow">END IF</span></div>
<div class="line"><a id="l02519" name="l02519"></a><span class="lineno"> 2519</span><span class="keywordflow">IF</span> ( limap%NMOM_S.GE.2 ) psvs(:,:,isv_lima_ns) = zcst(:,:) *zinv_tstep</div>
<div class="line"><a id="l02520" name="l02520"></a><span class="lineno"> 2520</span><span class="keywordflow">IF</span> ( limap%NMOM_G.GE.2 ) psvs(:,:,isv_lima_ng) = zcgt(:,:) *zinv_tstep</div>
<div class="line"><a id="l02521" name="l02521"></a><span class="lineno"> 2521</span><span class="keywordflow">IF</span> ( limap%NMOM_H.GE.2 ) psvs(:,:,isv_lima_nh) = zcht(:,:) *zinv_tstep</div>
<div class="line"><a id="l02522" name="l02522"></a><span class="lineno"> 2522</span><span class="comment">!</span></div>
<div class="line"><a id="l02523" name="l02523"></a><span class="lineno"> 2523</span><span class="keywordflow">IF</span> ( limap%NMOD_CCN .GE. 1 )   psvs(:,:,isv_lima_ccn_free:isv_lima_ccn_free+limap%NMOD_CCN-1) = zccnft(:,:,:) *zinv_tstep</div>
<div class="line"><a id="l02524" name="l02524"></a><span class="lineno"> 2524</span><span class="keywordflow">IF</span> ( limap%NMOD_CCN .GE. 1 )   psvs(:,:,isv_lima_ccn_acti:isv_lima_ccn_acti+limap%NMOD_CCN-1) = zccnat(:,:,:) *zinv_tstep</div>
<div class="line"><a id="l02525" name="l02525"></a><span class="lineno"> 2525</span><span class="keywordflow">IF</span> ( limap%NMOD_IFN .GE. 1 )   psvs(:,:,isv_lima_ifn_free:isv_lima_ifn_free+limap%NMOD_IFN-1) = zifnft(:,:,:) *zinv_tstep</div>
<div class="line"><a id="l02526" name="l02526"></a><span class="lineno"> 2526</span><span class="keywordflow">IF</span> ( limap%NMOD_IFN .GE. 1 )   psvs(:,:,isv_lima_ifn_nucl:isv_lima_ifn_nucl+limap%NMOD_IFN-1) = zifnnt(:,:,:) *zinv_tstep</div>
<div class="line"><a id="l02527" name="l02527"></a><span class="lineno"> 2527</span><span class="keywordflow">IF</span> ( limap%NMOD_IMM .GE. 1 )   psvs(:,:,isv_lima_imm_nucl:isv_lima_imm_nucl+limap%NMOD_IMM-1) = zimmnt(:,:,:) *zinv_tstep</div>
<div class="line"><a id="l02528" name="l02528"></a><span class="lineno"> 2528</span><span class="keywordflow">IF</span> ( limap%LHHONI) psvs(:,:,isv_lima_hom_haze) = zhomft(:,:) *zinv_tstep</div>
<div class="line"><a id="l02529" name="l02529"></a><span class="lineno"> 2529</span><span class="comment">!</span></div>
<div class="line"><a id="l02530" name="l02530"></a><span class="lineno"> 2530</span><span class="comment">!</span></div>
<div class="line"><a id="l02531" name="l02531"></a><span class="lineno"> 2531</span><span class="comment">!</span></div>
<div class="line"><a id="l02532" name="l02532"></a><span class="lineno"> 2532</span><span class="comment">! Call budgets</span></div>
<div class="line"><a id="l02533" name="l02533"></a><span class="lineno"> 2533</span><span class="comment">!</span></div>
<div class="line"><a id="l02534" name="l02534"></a><span class="lineno"> 2534</span><span class="keywordflow">IF</span> ( buconf%LBU_ENABLE ) <span class="keywordflow">then</span></div>
<div class="line"><a id="l02535" name="l02535"></a><span class="lineno"> 2535</span>  <span class="keyword">ALLOCATE</span>(zrhodjontstep(d%NIJT,d%NKT))</div>
<div class="line"><a id="l02536" name="l02536"></a><span class="lineno"> 2536</span>  zrhodjontstep(:,:) = zinv_tstep * prhodj(:,:)</div>
<div class="line"><a id="l02537" name="l02537"></a><span class="lineno"> 2537</span> </div>
<div class="line"><a id="l02538" name="l02538"></a><span class="lineno"> 2538</span>  <span class="keywordflow">IF</span> ( buconf%LBUDGET_TH ) <span class="keywordflow">then</span></div>
<div class="line"><a id="l02539" name="l02539"></a><span class="lineno"> 2539</span>    <span class="keyword">CALL </span>budget_store_add_phy(d, tbudgets(nbudget_th), <span class="stringliteral">&#39;REVA&#39;</span>,  ztot_th_evap(:,:) * zrhodjontstep(:,:) )</div>
<div class="line"><a id="l02540" name="l02540"></a><span class="lineno"> 2540</span>    <span class="keyword">CALL </span>budget_store_add_phy(d, tbudgets(nbudget_th), <span class="stringliteral">&#39;HONC&#39;</span>,  ztot_th_honc(:,:) * zrhodjontstep(:,:) )</div>
<div class="line"><a id="l02541" name="l02541"></a><span class="lineno"> 2541</span>    <span class="keyword">CALL </span>budget_store_add_phy(d, tbudgets(nbudget_th), <span class="stringliteral">&#39;HONR&#39;</span>,  ztot_th_honr(:,:) * zrhodjontstep(:,:) )</div>
<div class="line"><a id="l02542" name="l02542"></a><span class="lineno"> 2542</span>    <span class="keyword">CALL </span>budget_store_add_phy(d, tbudgets(nbudget_th), <span class="stringliteral">&#39;DEPS&#39;</span>,  ztot_th_deps(:,:) * zrhodjontstep(:,:) )</div>
<div class="line"><a id="l02543" name="l02543"></a><span class="lineno"> 2543</span>    <span class="keyword">CALL </span>budget_store_add_phy(d, tbudgets(nbudget_th), <span class="stringliteral">&#39;DEPI&#39;</span>,  ztot_th_depi(:,:) * zrhodjontstep(:,:) )</div>
<div class="line"><a id="l02544" name="l02544"></a><span class="lineno"> 2544</span>    <span class="keyword">CALL </span>budget_store_add_phy(d, tbudgets(nbudget_th), <span class="stringliteral">&#39;DEPG&#39;</span>,  ztot_th_depg(:,:) * zrhodjontstep(:,:) )</div>
<div class="line"><a id="l02545" name="l02545"></a><span class="lineno"> 2545</span>    <span class="keyword">CALL </span>budget_store_add_phy(d, tbudgets(nbudget_th), <span class="stringliteral">&#39;IMLT&#39;</span>,  ztot_th_imlt(:,:) * zrhodjontstep(:,:) )</div>
<div class="line"><a id="l02546" name="l02546"></a><span class="lineno"> 2546</span>    <span class="keyword">CALL </span>budget_store_add_phy(d, tbudgets(nbudget_th), <span class="stringliteral">&#39;BERFI&#39;</span>, ztot_th_berfi(:,:) * zrhodjontstep(:,:) )</div>
<div class="line"><a id="l02547" name="l02547"></a><span class="lineno"> 2547</span>    <span class="keyword">CALL </span>budget_store_add_phy(d, tbudgets(nbudget_th), <span class="stringliteral">&#39;RIM&#39;</span>,   ztot_th_rim(:,:) * zrhodjontstep(:,:) )</div>
<div class="line"><a id="l02548" name="l02548"></a><span class="lineno"> 2548</span>    <span class="keyword">CALL </span>budget_store_add_phy(d, tbudgets(nbudget_th), <span class="stringliteral">&#39;ACC&#39;</span>,   ztot_th_acc(:,:) * zrhodjontstep(:,:) )</div>
<div class="line"><a id="l02549" name="l02549"></a><span class="lineno"> 2549</span>    <span class="keyword">CALL </span>budget_store_add_phy(d, tbudgets(nbudget_th), <span class="stringliteral">&#39;CFRZ&#39;</span>,  ztot_th_cfrz(:,:) * zrhodjontstep(:,:) )</div>
<div class="line"><a id="l02550" name="l02550"></a><span class="lineno"> 2550</span>    <span class="keyword">CALL </span>budget_store_add_phy(d, tbudgets(nbudget_th), <span class="stringliteral">&#39;WETG&#39;</span>,  ztot_th_wetg(:,:) * zrhodjontstep(:,:) )</div>
<div class="line"><a id="l02551" name="l02551"></a><span class="lineno"> 2551</span>    <span class="keyword">CALL </span>budget_store_add_phy(d, tbudgets(nbudget_th), <span class="stringliteral">&#39;DRYG&#39;</span>,  ztot_th_dryg(:,:) * zrhodjontstep(:,:) )</div>
<div class="line"><a id="l02552" name="l02552"></a><span class="lineno"> 2552</span>    <span class="keyword">CALL </span>budget_store_add_phy(d, tbudgets(nbudget_th), <span class="stringliteral">&#39;GMLT&#39;</span>,  ztot_th_gmlt(:,:) * zrhodjontstep(:,:) )</div>
<div class="line"><a id="l02553" name="l02553"></a><span class="lineno"> 2553</span>    <span class="keyword">CALL </span>budget_store_add_phy(d, tbudgets(nbudget_th), <span class="stringliteral">&#39;DEPH&#39;</span>,  ztot_th_deph(:,:) * zrhodjontstep(:,:) )</div>
<div class="line"><a id="l02554" name="l02554"></a><span class="lineno"> 2554</span>    <span class="keyword">CALL </span>budget_store_add_phy(d, tbudgets(nbudget_th), <span class="stringliteral">&#39;WETH&#39;</span>,  ztot_th_weth(:,:) * zrhodjontstep(:,:) )</div>
<div class="line"><a id="l02555" name="l02555"></a><span class="lineno"> 2555</span>    <span class="keyword">CALL </span>budget_store_add_phy(d, tbudgets(nbudget_th), <span class="stringliteral">&#39;HMLT&#39;</span>,  ztot_th_hmlt(:,:) * zrhodjontstep(:,:) )</div>
<div class="line"><a id="l02556" name="l02556"></a><span class="lineno"> 2556</span><span class="keywordflow">  END IF</span></div>
<div class="line"><a id="l02557" name="l02557"></a><span class="lineno"> 2557</span> </div>
<div class="line"><a id="l02558" name="l02558"></a><span class="lineno"> 2558</span>  <span class="keywordflow">IF</span> ( buconf%LBUDGET_RV ) <span class="keywordflow">then</span></div>
<div class="line"><a id="l02559" name="l02559"></a><span class="lineno"> 2559</span>    <span class="keyword">CALL </span>budget_store_add_phy(d, tbudgets(nbudget_rv), <span class="stringliteral">&#39;REVA&#39;</span>, -ztot_rr_evap(:,:) * zrhodjontstep(:,:) )</div>
<div class="line"><a id="l02560" name="l02560"></a><span class="lineno"> 2560</span>    <span class="keyword">CALL </span>budget_store_add_phy(d, tbudgets(nbudget_rv), <span class="stringliteral">&#39;DEPS&#39;</span>, -ztot_rs_deps(:,:) * zrhodjontstep(:,:) )</div>
<div class="line"><a id="l02561" name="l02561"></a><span class="lineno"> 2561</span>    <span class="keyword">CALL </span>budget_store_add_phy(d, tbudgets(nbudget_rv), <span class="stringliteral">&#39;DEPI&#39;</span>, -ztot_ri_depi(:,:) * zrhodjontstep(:,:) )</div>
<div class="line"><a id="l02562" name="l02562"></a><span class="lineno"> 2562</span>    <span class="keyword">CALL </span>budget_store_add_phy(d, tbudgets(nbudget_rv), <span class="stringliteral">&#39;DEPG&#39;</span>, -ztot_rg_depg(:,:) * zrhodjontstep(:,:) )</div>
<div class="line"><a id="l02563" name="l02563"></a><span class="lineno"> 2563</span>    <span class="keyword">CALL </span>budget_store_add_phy(d, tbudgets(nbudget_rv), <span class="stringliteral">&#39;CORR2&#39;</span>, ztot_rv_corr2(:,:) * zrhodjontstep(:,:) )</div>
<div class="line"><a id="l02564" name="l02564"></a><span class="lineno"> 2564</span>    <span class="keyword">CALL </span>budget_store_add_phy(d, tbudgets(nbudget_rv), <span class="stringliteral">&#39;DEPH&#39;</span>, -ztot_rh_deph(:,:) * zrhodjontstep(:,:) )</div>
<div class="line"><a id="l02565" name="l02565"></a><span class="lineno"> 2565</span><span class="keywordflow">  END IF</span></div>
<div class="line"><a id="l02566" name="l02566"></a><span class="lineno"> 2566</span> </div>
<div class="line"><a id="l02567" name="l02567"></a><span class="lineno"> 2567</span>  <span class="keywordflow">IF</span> ( buconf%LBUDGET_RC ) <span class="keywordflow">then</span></div>
<div class="line"><a id="l02568" name="l02568"></a><span class="lineno"> 2568</span>    <span class="keyword">CALL </span>budget_store_add_phy(d, tbudgets(nbudget_rc), <span class="stringliteral">&#39;AUTO&#39;</span>,  ztot_rc_auto(:,:) * zrhodjontstep(:,:) )</div>
<div class="line"><a id="l02569" name="l02569"></a><span class="lineno"> 2569</span>    <span class="keyword">CALL </span>budget_store_add_phy(d, tbudgets(nbudget_rc), <span class="stringliteral">&#39;ACCR&#39;</span>,  ztot_rc_accr(:,:) * zrhodjontstep(:,:) )</div>
<div class="line"><a id="l02570" name="l02570"></a><span class="lineno"> 2570</span>    <span class="keyword">CALL </span>budget_store_add_phy(d, tbudgets(nbudget_rc), <span class="stringliteral">&#39;HONC&#39;</span>,  ztot_rc_honc(:,:) * zrhodjontstep(:,:) )</div>
<div class="line"><a id="l02571" name="l02571"></a><span class="lineno"> 2571</span>    <span class="keyword">CALL </span>budget_store_add_phy(d, tbudgets(nbudget_rc), <span class="stringliteral">&#39;IMLT&#39;</span>,  ztot_rc_imlt(:,:) * zrhodjontstep(:,:) )</div>
<div class="line"><a id="l02572" name="l02572"></a><span class="lineno"> 2572</span>    <span class="keyword">CALL </span>budget_store_add_phy(d, tbudgets(nbudget_rc), <span class="stringliteral">&#39;BERFI&#39;</span>, ztot_rc_berfi(:,:) * zrhodjontstep(:,:) )</div>
<div class="line"><a id="l02573" name="l02573"></a><span class="lineno"> 2573</span>    <span class="keyword">CALL </span>budget_store_add_phy(d, tbudgets(nbudget_rc), <span class="stringliteral">&#39;RIM&#39;</span>,  (-ztot_rr_accss(:,:) - ztot_rr_accsg(:,:)) &amp;</div>
<div class="line"><a id="l02574" name="l02574"></a><span class="lineno"> 2574</span>                                                          * zrhodjontstep(:,:) )</div>
<div class="line"><a id="l02575" name="l02575"></a><span class="lineno"> 2575</span>    <span class="keyword">CALL </span>budget_store_add_phy(d, tbudgets(nbudget_rc), <span class="stringliteral">&#39;WETG&#39;</span>,  ztot_rc_wetg(:,:) * zrhodjontstep(:,:) )</div>
<div class="line"><a id="l02576" name="l02576"></a><span class="lineno"> 2576</span>    <span class="keyword">CALL </span>budget_store_add_phy(d, tbudgets(nbudget_rc), <span class="stringliteral">&#39;DRYG&#39;</span>,  ztot_rc_dryg(:,:) * zrhodjontstep(:,:) )</div>
<div class="line"><a id="l02577" name="l02577"></a><span class="lineno"> 2577</span>    <span class="keyword">CALL </span>budget_store_add_phy(d, tbudgets(nbudget_rc), <span class="stringliteral">&#39;CVRC&#39;</span>, -ztot_rr_cvrc(:,:) * zrhodjontstep(:,:) )</div>
<div class="line"><a id="l02578" name="l02578"></a><span class="lineno"> 2578</span>    <span class="keyword">CALL </span>budget_store_add_phy(d, tbudgets(nbudget_rc), <span class="stringliteral">&#39;CORR2&#39;</span>, ztot_rc_corr2(:,:) * zrhodjontstep(:,:) )</div>
<div class="line"><a id="l02579" name="l02579"></a><span class="lineno"> 2579</span>    <span class="keyword">CALL </span>budget_store_add_phy(d, tbudgets(nbudget_rc), <span class="stringliteral">&#39;WETH&#39;</span>,  ztot_rc_weth(:,:)  * zrhodjontstep(:,:) )</div>
<div class="line"><a id="l02580" name="l02580"></a><span class="lineno"> 2580</span><span class="keywordflow">  END IF</span></div>
<div class="line"><a id="l02581" name="l02581"></a><span class="lineno"> 2581</span> </div>
<div class="line"><a id="l02582" name="l02582"></a><span class="lineno"> 2582</span>  <span class="keywordflow">IF</span> ( buconf%LBUDGET_RR ) <span class="keywordflow">then</span></div>
<div class="line"><a id="l02583" name="l02583"></a><span class="lineno"> 2583</span>    <span class="keyword">CALL </span>budget_store_add_phy(d, tbudgets(nbudget_rr), <span class="stringliteral">&#39;AUTO&#39;</span>, -ztot_rc_auto(:,:) * zrhodjontstep(:,:) )</div>
<div class="line"><a id="l02584" name="l02584"></a><span class="lineno"> 2584</span>    <span class="keyword">CALL </span>budget_store_add_phy(d, tbudgets(nbudget_rr), <span class="stringliteral">&#39;ACCR&#39;</span>, -ztot_rc_accr(:,:) * zrhodjontstep(:,:) )</div>
<div class="line"><a id="l02585" name="l02585"></a><span class="lineno"> 2585</span>    <span class="keyword">CALL </span>budget_store_add_phy(d, tbudgets(nbudget_rr), <span class="stringliteral">&#39;REVA&#39;</span>,  ztot_rr_evap(:,:) * zrhodjontstep(:,:) )</div>
<div class="line"><a id="l02586" name="l02586"></a><span class="lineno"> 2586</span>    <span class="keyword">CALL </span>budget_store_add_phy(d, tbudgets(nbudget_rr), <span class="stringliteral">&#39;HONR&#39;</span>,  ztot_rr_honr(:,:) * zrhodjontstep(:,:) )</div>
<div class="line"><a id="l02587" name="l02587"></a><span class="lineno"> 2587</span>    <span class="keyword">CALL </span>budget_store_add_phy(d, tbudgets(nbudget_rr), <span class="stringliteral">&#39;ACC&#39;</span>,  (ztot_rc_rimss(:,:) + ztot_rc_rimsg(:,:)) &amp;</div>
<div class="line"><a id="l02588" name="l02588"></a><span class="lineno"> 2588</span>                                                          * zrhodjontstep(:,:) )</div>
<div class="line"><a id="l02589" name="l02589"></a><span class="lineno"> 2589</span>    <span class="keyword">CALL </span>budget_store_add_phy(d, tbudgets(nbudget_rr), <span class="stringliteral">&#39;CFRZ&#39;</span>,  ztot_rr_cfrz(:,:) * zrhodjontstep(:,:) )</div>
<div class="line"><a id="l02590" name="l02590"></a><span class="lineno"> 2590</span>    <span class="keyword">CALL </span>budget_store_add_phy(d, tbudgets(nbudget_rr), <span class="stringliteral">&#39;WETG&#39;</span>,  ztot_rr_wetg(:,:) * zrhodjontstep(:,:) )</div>
<div class="line"><a id="l02591" name="l02591"></a><span class="lineno"> 2591</span>    <span class="keyword">CALL </span>budget_store_add_phy(d, tbudgets(nbudget_rr), <span class="stringliteral">&#39;DRYG&#39;</span>,  ztot_rr_dryg(:,:) * zrhodjontstep(:,:) )</div>
<div class="line"><a id="l02592" name="l02592"></a><span class="lineno"> 2592</span>    <span class="keyword">CALL </span>budget_store_add_phy(d, tbudgets(nbudget_rr), <span class="stringliteral">&#39;GMLT&#39;</span>,  ztot_rr_gmlt(:,:) * zrhodjontstep(:,:) )</div>
<div class="line"><a id="l02593" name="l02593"></a><span class="lineno"> 2593</span>    <span class="keyword">CALL </span>budget_store_add_phy(d, tbudgets(nbudget_rr), <span class="stringliteral">&#39;CVRC&#39;</span>,  ztot_rr_cvrc(:,:) * zrhodjontstep(:,:) )</div>
<div class="line"><a id="l02594" name="l02594"></a><span class="lineno"> 2594</span>    <span class="keyword">CALL </span>budget_store_add_phy(d, tbudgets(nbudget_rr), <span class="stringliteral">&#39;CORR2&#39;</span>, ztot_rr_corr2(:,:)* zrhodjontstep(:,:) )</div>
<div class="line"><a id="l02595" name="l02595"></a><span class="lineno"> 2595</span>    <span class="keyword">CALL </span>budget_store_add_phy(d, tbudgets(nbudget_rr), <span class="stringliteral">&#39;WETH&#39;</span>,  ztot_rr_weth(:,:) * zrhodjontstep(:,:) )</div>
<div class="line"><a id="l02596" name="l02596"></a><span class="lineno"> 2596</span>    <span class="keyword">CALL </span>budget_store_add_phy(d, tbudgets(nbudget_rr), <span class="stringliteral">&#39;HMLT&#39;</span>,  ztot_rr_hmlt(:,:) * zrhodjontstep(:,:) )</div>
<div class="line"><a id="l02597" name="l02597"></a><span class="lineno"> 2597</span><span class="keywordflow">  END IF</span></div>
<div class="line"><a id="l02598" name="l02598"></a><span class="lineno"> 2598</span> </div>
<div class="line"><a id="l02599" name="l02599"></a><span class="lineno"> 2599</span>  <span class="keywordflow">IF</span> ( buconf%LBUDGET_RI ) <span class="keywordflow">then</span></div>
<div class="line"><a id="l02600" name="l02600"></a><span class="lineno"> 2600</span>    <span class="keyword">CALL </span>budget_store_add_phy(d, tbudgets(nbudget_ri), <span class="stringliteral">&#39;HONC&#39;</span>,  -ztot_rc_honc(:,:) * zrhodjontstep(:,:) )</div>
<div class="line"><a id="l02601" name="l02601"></a><span class="lineno"> 2601</span>    <span class="keyword">CALL </span>budget_store_add_phy(d, tbudgets(nbudget_ri), <span class="stringliteral">&#39;CNVI&#39;</span>,   ztot_ri_cnvi(:,:) * zrhodjontstep(:,:) )</div>
<div class="line"><a id="l02602" name="l02602"></a><span class="lineno"> 2602</span>    <span class="keyword">CALL </span>budget_store_add_phy(d, tbudgets(nbudget_ri), <span class="stringliteral">&#39;CNVS&#39;</span>,   ztot_ri_cnvs(:,:) * zrhodjontstep(:,:) )</div>
<div class="line"><a id="l02603" name="l02603"></a><span class="lineno"> 2603</span>    <span class="keyword">CALL </span>budget_store_add_phy(d, tbudgets(nbudget_ri), <span class="stringliteral">&#39;AGGS&#39;</span>,   ztot_ri_aggs(:,:) * zrhodjontstep(:,:) )</div>
<div class="line"><a id="l02604" name="l02604"></a><span class="lineno"> 2604</span>    <span class="keyword">CALL </span>budget_store_add_phy(d, tbudgets(nbudget_ri), <span class="stringliteral">&#39;IMLT&#39;</span>,  -ztot_rc_imlt(:,:) * zrhodjontstep(:,:) )</div>
<div class="line"><a id="l02605" name="l02605"></a><span class="lineno"> 2605</span>    <span class="keyword">CALL </span>budget_store_add_phy(d, tbudgets(nbudget_ri), <span class="stringliteral">&#39;BERFI&#39;</span>, -ztot_rc_berfi(:,:) * zrhodjontstep(:,:) )</div>
<div class="line"><a id="l02606" name="l02606"></a><span class="lineno"> 2606</span>    <span class="keyword">CALL </span>budget_store_add_phy(d, tbudgets(nbudget_ri), <span class="stringliteral">&#39;HMS&#39;</span>,    ztot_ri_hms(:,:) * zrhodjontstep(:,:) )</div>
<div class="line"><a id="l02607" name="l02607"></a><span class="lineno"> 2607</span>    <span class="keyword">CALL </span>budget_store_add_phy(d, tbudgets(nbudget_ri), <span class="stringliteral">&#39;CFRZ&#39;</span>,   ztot_ri_cfrz(:,:) * zrhodjontstep(:,:) )</div>
<div class="line"><a id="l02608" name="l02608"></a><span class="lineno"> 2608</span>    <span class="keyword">CALL </span>budget_store_add_phy(d, tbudgets(nbudget_ri), <span class="stringliteral">&#39;DEPI&#39;</span>,   ztot_ri_depi(:,:) * zrhodjontstep(:,:) )</div>
<div class="line"><a id="l02609" name="l02609"></a><span class="lineno"> 2609</span>    <span class="keyword">CALL </span>budget_store_add_phy(d, tbudgets(nbudget_ri), <span class="stringliteral">&#39;CIBU&#39;</span>,   ztot_ri_cibu(:,:) * zrhodjontstep(:,:) )</div>
<div class="line"><a id="l02610" name="l02610"></a><span class="lineno"> 2610</span>    <span class="keyword">CALL </span>budget_store_add_phy(d, tbudgets(nbudget_ri), <span class="stringliteral">&#39;RDSF&#39;</span>,   ztot_ri_rdsf(:,:) * zrhodjontstep(:,:) )</div>
<div class="line"><a id="l02611" name="l02611"></a><span class="lineno"> 2611</span>    <span class="keyword">CALL </span>budget_store_add_phy(d, tbudgets(nbudget_ri), <span class="stringliteral">&#39;WETG&#39;</span>,   ztot_ri_wetg(:,:) * zrhodjontstep(:,:) )</div>
<div class="line"><a id="l02612" name="l02612"></a><span class="lineno"> 2612</span>    <span class="keyword">CALL </span>budget_store_add_phy(d, tbudgets(nbudget_ri), <span class="stringliteral">&#39;DRYG&#39;</span>,   ztot_ri_dryg(:,:) * zrhodjontstep(:,:) )</div>
<div class="line"><a id="l02613" name="l02613"></a><span class="lineno"> 2613</span>    <span class="keyword">CALL </span>budget_store_add_phy(d, tbudgets(nbudget_ri), <span class="stringliteral">&#39;HMG&#39;</span>,    ztot_ri_hmg(:,:) * zrhodjontstep(:,:) )</div>
<div class="line"><a id="l02614" name="l02614"></a><span class="lineno"> 2614</span>    <span class="keyword">CALL </span>budget_store_add_phy(d, tbudgets(nbudget_ri), <span class="stringliteral">&#39;CORR2&#39;</span>,  ztot_ri_corr2(:,:) * zrhodjontstep(:,:) )</div>
<div class="line"><a id="l02615" name="l02615"></a><span class="lineno"> 2615</span>    <span class="keyword">CALL </span>budget_store_add_phy(d, tbudgets(nbudget_ri), <span class="stringliteral">&#39;WETH&#39;</span>,   ztot_ri_weth(:,:) * zrhodjontstep(:,:) )</div>
<div class="line"><a id="l02616" name="l02616"></a><span class="lineno"> 2616</span>    <span class="keywordflow">IF</span> (limap%LCRYSTAL_SHAPE) <span class="keywordflow">THEN</span></div>
<div class="line"><a id="l02617" name="l02617"></a><span class="lineno"> 2617</span>      <span class="keyword">CALL </span>budget_store_add_phy(d, tbudgets(nbudget_ri), <span class="stringliteral">&#39;ISCS&#39;</span>, ztot_shri_iscs(:,:) * zrhodjontstep(:,:) )</div>
<div class="line"><a id="l02618" name="l02618"></a><span class="lineno"> 2618</span><span class="keywordflow">    END IF</span></div>
<div class="line"><a id="l02619" name="l02619"></a><span class="lineno"> 2619</span><span class="keywordflow">  END IF</span></div>
<div class="line"><a id="l02620" name="l02620"></a><span class="lineno"> 2620</span> </div>
<div class="line"><a id="l02621" name="l02621"></a><span class="lineno"> 2621</span>  <span class="keywordflow">IF</span> ( buconf%LBUDGET_RS ) <span class="keywordflow">then</span></div>
<div class="line"><a id="l02622" name="l02622"></a><span class="lineno"> 2622</span>    <span class="keyword">CALL </span>budget_store_add_phy(d, tbudgets(nbudget_rs), <span class="stringliteral">&#39;CNVI&#39;</span>, -ztot_ri_cnvi(:,:) * zrhodjontstep(:,:) )</div>
<div class="line"><a id="l02623" name="l02623"></a><span class="lineno"> 2623</span>    <span class="keyword">CALL </span>budget_store_add_phy(d, tbudgets(nbudget_rs), <span class="stringliteral">&#39;DEPS&#39;</span>,  ztot_rs_deps(:,:) * zrhodjontstep(:,:) )</div>
<div class="line"><a id="l02624" name="l02624"></a><span class="lineno"> 2624</span>    <span class="keyword">CALL </span>budget_store_add_phy(d, tbudgets(nbudget_rs), <span class="stringliteral">&#39;CNVS&#39;</span>, -ztot_ri_cnvs(:,:) * zrhodjontstep(:,:) )</div>
<div class="line"><a id="l02625" name="l02625"></a><span class="lineno"> 2625</span>    <span class="keyword">CALL </span>budget_store_add_phy(d, tbudgets(nbudget_rs), <span class="stringliteral">&#39;AGGS&#39;</span>, -ztot_ri_aggs(:,:) * zrhodjontstep(:,:) )</div>
<div class="line"><a id="l02626" name="l02626"></a><span class="lineno"> 2626</span><span class="comment">!    call BUDGET_STORE_ADD_PHY(D, TBUDGETS(NBUDGET_RS), &#39;RIM&#39;,   ztot_rs_rim (:,:) * zrhodjontstep(:,:) )</span></div>
<div class="line"><a id="l02627" name="l02627"></a><span class="lineno"> 2627</span>    <span class="keyword">CALL </span>budget_store_add_phy(d, tbudgets(nbudget_rs), <span class="stringliteral">&#39;RIM&#39;</span>, (-ztot_rc_rimss(:,:) -  ztot_rs_rimcg(:,:)) &amp; </div>
<div class="line"><a id="l02628" name="l02628"></a><span class="lineno"> 2628</span>                                                          * zrhodjontstep(:,:) )</div>
<div class="line"><a id="l02629" name="l02629"></a><span class="lineno"> 2629</span>    <span class="keyword">CALL </span>budget_store_add_phy(d, tbudgets(nbudget_rs), <span class="stringliteral">&#39;HMS&#39;</span>,   ztot_rs_hms(:,:) * zrhodjontstep(:,:) )</div>
<div class="line"><a id="l02630" name="l02630"></a><span class="lineno"> 2630</span><span class="comment">!    call BUDGET_STORE_ADD_PHY(D, TBUDGETS(NBUDGET_RS), &#39;ACC&#39;,   ztot_rs_acc (:,:) * zrhodjontstep(:,:) )</span></div>
<div class="line"><a id="l02631" name="l02631"></a><span class="lineno"> 2631</span>    <span class="keyword">CALL </span>budget_store_add_phy(d, tbudgets(nbudget_rs), <span class="stringliteral">&#39;ACC&#39;</span>,  (ztot_rr_accss(:,:) - ztot_rs_accrg(:,:)) &amp;</div>
<div class="line"><a id="l02632" name="l02632"></a><span class="lineno"> 2632</span>                                                          * zrhodjontstep(:,:) )</div>
<div class="line"><a id="l02633" name="l02633"></a><span class="lineno"> 2633</span>    <span class="keyword">CALL </span>budget_store_add_phy(d, tbudgets(nbudget_rs), <span class="stringliteral">&#39;CMEL&#39;</span>,  ztot_rs_cmel(:,:) * zrhodjontstep(:,:) )</div>
<div class="line"><a id="l02634" name="l02634"></a><span class="lineno"> 2634</span>    <span class="keyword">CALL </span>budget_store_add_phy(d, tbudgets(nbudget_rs), <span class="stringliteral">&#39;CIBU&#39;</span>, -ztot_ri_cibu(:,:) * zrhodjontstep(:,:) )</div>
<div class="line"><a id="l02635" name="l02635"></a><span class="lineno"> 2635</span>    <span class="keyword">CALL </span>budget_store_add_phy(d, tbudgets(nbudget_rs), <span class="stringliteral">&#39;WETG&#39;</span>,  ztot_rs_wetg(:,:) * zrhodjontstep(:,:) )</div>
<div class="line"><a id="l02636" name="l02636"></a><span class="lineno"> 2636</span>    <span class="keyword">CALL </span>budget_store_add_phy(d, tbudgets(nbudget_rs), <span class="stringliteral">&#39;DRYG&#39;</span>,  ztot_rs_dryg(:,:) * zrhodjontstep(:,:) )</div>
<div class="line"><a id="l02637" name="l02637"></a><span class="lineno"> 2637</span>    <span class="keyword">CALL </span>budget_store_add_phy(d, tbudgets(nbudget_rs), <span class="stringliteral">&#39;WETH&#39;</span>,  ztot_rs_weth(:,:) * zrhodjontstep(:,:) )</div>
<div class="line"><a id="l02638" name="l02638"></a><span class="lineno"> 2638</span>    <span class="keywordflow">IF</span> (limap%LCRYSTAL_SHAPE) <span class="keywordflow">THEN</span></div>
<div class="line"><a id="l02639" name="l02639"></a><span class="lineno"> 2639</span>      <span class="keyword">CALL </span>budget_store_add_phy(d, tbudgets(nbudget_rs), <span class="stringliteral">&#39;ISCS&#39;</span>, -ztot_shri_iscs(:,:) * zrhodjontstep(:,:) )</div>
<div class="line"><a id="l02640" name="l02640"></a><span class="lineno"> 2640</span><span class="keywordflow">    END IF</span></div>
<div class="line"><a id="l02641" name="l02641"></a><span class="lineno"> 2641</span><span class="keywordflow">  END IF</span></div>
<div class="line"><a id="l02642" name="l02642"></a><span class="lineno"> 2642</span> </div>
<div class="line"><a id="l02643" name="l02643"></a><span class="lineno"> 2643</span>  <span class="keywordflow">IF</span> ( buconf%LBUDGET_RG ) <span class="keywordflow">then</span></div>
<div class="line"><a id="l02644" name="l02644"></a><span class="lineno"> 2644</span>    <span class="keyword">CALL </span>budget_store_add_phy(d, tbudgets(nbudget_rg), <span class="stringliteral">&#39;HONR&#39;</span>, -ztot_rr_honr(:,:) * zrhodjontstep(:,:) )</div>
<div class="line"><a id="l02645" name="l02645"></a><span class="lineno"> 2645</span>    <span class="keyword">CALL </span>budget_store_add_phy(d, tbudgets(nbudget_rg), <span class="stringliteral">&#39;DEPG&#39;</span>,  ztot_rg_depg(:,:) * zrhodjontstep(:,:) )</div>
<div class="line"><a id="l02646" name="l02646"></a><span class="lineno"> 2646</span>    <span class="keyword">CALL </span>budget_store_add_phy(d, tbudgets(nbudget_rg), <span class="stringliteral">&#39;RIM&#39;</span>,  (-ztot_rc_rimsg(:,:) +  ztot_rs_rimcg(:,:) ) &amp;</div>
<div class="line"><a id="l02647" name="l02647"></a><span class="lineno"> 2647</span>                                                          * zrhodjontstep(:,:) )</div>
<div class="line"><a id="l02648" name="l02648"></a><span class="lineno"> 2648</span>    <span class="keyword">CALL </span>budget_store_add_phy(d, tbudgets(nbudget_rg), <span class="stringliteral">&#39;ACC&#39;</span>,  (ztot_rr_accsg(:,:) + ztot_rs_accrg(:,:)) &amp; </div>
<div class="line"><a id="l02649" name="l02649"></a><span class="lineno"> 2649</span>                                                          * zrhodjontstep(:,:) )</div>
<div class="line"><a id="l02650" name="l02650"></a><span class="lineno"> 2650</span>    <span class="keyword">CALL </span>budget_store_add_phy(d, tbudgets(nbudget_rg), <span class="stringliteral">&#39;CMEL&#39;</span>, -ztot_rs_cmel(:,:) * zrhodjontstep(:,:) )</div>
<div class="line"><a id="l02651" name="l02651"></a><span class="lineno"> 2651</span>    <span class="keyword">CALL </span>budget_store_add_phy(d, tbudgets(nbudget_rg), <span class="stringliteral">&#39;CFRZ&#39;</span>, ( -ztot_rr_cfrz(:,:) - ztot_ri_cfrz(:,:) ) &amp;</div>
<div class="line"><a id="l02652" name="l02652"></a><span class="lineno"> 2652</span>                                                         * zrhodjontstep(:,:) )</div>
<div class="line"><a id="l02653" name="l02653"></a><span class="lineno"> 2653</span>    <span class="keyword">CALL </span>budget_store_add_phy(d, tbudgets(nbudget_rg), <span class="stringliteral">&#39;RDSF&#39;</span>, -ztot_ri_rdsf(:,:) * zrhodjontstep(:,:) )</div>
<div class="line"><a id="l02654" name="l02654"></a><span class="lineno"> 2654</span>    <span class="keyword">CALL </span>budget_store_add_phy(d, tbudgets(nbudget_rg), <span class="stringliteral">&#39;WETG&#39;</span>,  ztot_rg_wetg(:,:) * zrhodjontstep(:,:) )</div>
<div class="line"><a id="l02655" name="l02655"></a><span class="lineno"> 2655</span>    <span class="keyword">CALL </span>budget_store_add_phy(d, tbudgets(nbudget_rg), <span class="stringliteral">&#39;DRYG&#39;</span>,  ztot_rg_dryg(:,:) * zrhodjontstep(:,:) )</div>
<div class="line"><a id="l02656" name="l02656"></a><span class="lineno"> 2656</span>    <span class="keyword">CALL </span>budget_store_add_phy(d, tbudgets(nbudget_rg), <span class="stringliteral">&#39;HMG&#39;</span>,   ztot_rg_hmg(:,:) * zrhodjontstep(:,:) )</div>
<div class="line"><a id="l02657" name="l02657"></a><span class="lineno"> 2657</span>    <span class="keyword">CALL </span>budget_store_add_phy(d, tbudgets(nbudget_rg), <span class="stringliteral">&#39;GMLT&#39;</span>, -ztot_rr_gmlt(:,:) * zrhodjontstep(:,:) )</div>
<div class="line"><a id="l02658" name="l02658"></a><span class="lineno"> 2658</span>    <span class="keyword">CALL </span>budget_store_add_phy(d, tbudgets(nbudget_rg), <span class="stringliteral">&#39;WETH&#39;</span>,  ztot_rg_weth(:,:) * zrhodjontstep(:,:) )</div>
<div class="line"><a id="l02659" name="l02659"></a><span class="lineno"> 2659</span>    <span class="keyword">CALL </span>budget_store_add_phy(d, tbudgets(nbudget_rg), <span class="stringliteral">&#39;COHG&#39;</span>,  ztot_rg_cohg(:,:) * zrhodjontstep(:,:) )</div>
<div class="line"><a id="l02660" name="l02660"></a><span class="lineno"> 2660</span><span class="keywordflow">  END IF</span></div>
<div class="line"><a id="l02661" name="l02661"></a><span class="lineno"> 2661</span> </div>
<div class="line"><a id="l02662" name="l02662"></a><span class="lineno"> 2662</span>  <span class="keywordflow">IF</span> ( buconf%LBUDGET_RH ) <span class="keywordflow">then</span></div>
<div class="line"><a id="l02663" name="l02663"></a><span class="lineno"> 2663</span>    <span class="keyword">CALL </span>budget_store_add_phy(d, tbudgets(nbudget_rh), <span class="stringliteral">&#39;WETG&#39;</span>,  ztot_rh_wetg(:,:) * zrhodjontstep(:,:) )</div>
<div class="line"><a id="l02664" name="l02664"></a><span class="lineno"> 2664</span>    <span class="keyword">CALL </span>budget_store_add_phy(d, tbudgets(nbudget_rh), <span class="stringliteral">&#39;DEPH&#39;</span>,  ztot_rh_deph(:,:) * zrhodjontstep(:,:) )</div>
<div class="line"><a id="l02665" name="l02665"></a><span class="lineno"> 2665</span>    <span class="keyword">CALL </span>budget_store_add_phy(d, tbudgets(nbudget_rh), <span class="stringliteral">&#39;WETH&#39;</span>,  ztot_rh_weth(:,:) * zrhodjontstep(:,:) )</div>
<div class="line"><a id="l02666" name="l02666"></a><span class="lineno"> 2666</span>    <span class="keyword">CALL </span>budget_store_add_phy(d, tbudgets(nbudget_rh), <span class="stringliteral">&#39;COHG&#39;</span>, -ztot_rg_cohg(:,:) * zrhodjontstep(:,:) )</div>
<div class="line"><a id="l02667" name="l02667"></a><span class="lineno"> 2667</span>    <span class="keyword">CALL </span>budget_store_add_phy(d, tbudgets(nbudget_rh), <span class="stringliteral">&#39;HMLT&#39;</span>, -ztot_rr_hmlt(:,:) * zrhodjontstep(:,:) )</div>
<div class="line"><a id="l02668" name="l02668"></a><span class="lineno"> 2668</span><span class="keywordflow">  END IF</span></div>
<div class="line"><a id="l02669" name="l02669"></a><span class="lineno"> 2669</span> </div>
<div class="line"><a id="l02670" name="l02670"></a><span class="lineno"> 2670</span>  <span class="keywordflow">IF</span> ( buconf%LBUDGET_SV ) <span class="keywordflow">then</span></div>
<div class="line"><a id="l02671" name="l02671"></a><span class="lineno"> 2671</span>    <span class="comment">!</span></div>
<div class="line"><a id="l02672" name="l02672"></a><span class="lineno"> 2672</span>    <span class="comment">! Cloud droplets</span></div>
<div class="line"><a id="l02673" name="l02673"></a><span class="lineno"> 2673</span>    <span class="comment">!</span></div>
<div class="line"><a id="l02674" name="l02674"></a><span class="lineno"> 2674</span>    <span class="keywordflow">IF</span> (limap%NMOM_C.GE.2) <span class="keywordflow">then</span> </div>
<div class="line"><a id="l02675" name="l02675"></a><span class="lineno"> 2675</span>       idx = nbudget_sv1 - 1 + tnsv%NSV_LIMA_NC</div>
<div class="line"><a id="l02676" name="l02676"></a><span class="lineno"> 2676</span>       <span class="keyword">CALL </span>budget_store_add_phy(d, tbudgets(idx), <span class="stringliteral">&#39;SELF&#39;</span>,  ztot_cc_self(:,:) * zrhodjontstep(:,:) )</div>
<div class="line"><a id="l02677" name="l02677"></a><span class="lineno"> 2677</span>       <span class="keyword">CALL </span>budget_store_add_phy(d, tbudgets(idx), <span class="stringliteral">&#39;AUTO&#39;</span>,  ztot_cc_auto(:,:) * zrhodjontstep(:,:) )</div>
<div class="line"><a id="l02678" name="l02678"></a><span class="lineno"> 2678</span>       <span class="keyword">CALL </span>budget_store_add_phy(d, tbudgets(idx), <span class="stringliteral">&#39;ACCR&#39;</span>,  ztot_cc_accr(:,:) * zrhodjontstep(:,:) )</div>
<div class="line"><a id="l02679" name="l02679"></a><span class="lineno"> 2679</span>       <span class="comment">!call BUDGET_STORE_ADD_PHY(D, TBUDGETS(IDX), &#39;REVA&#39;,  0. )</span></div>
<div class="line"><a id="l02680" name="l02680"></a><span class="lineno"> 2680</span>       <span class="keyword">CALL </span>budget_store_add_phy(d, tbudgets(idx), <span class="stringliteral">&#39;HONC&#39;</span>,  ztot_cc_honc(:,:) * zrhodjontstep(:,:) )</div>
<div class="line"><a id="l02681" name="l02681"></a><span class="lineno"> 2681</span>       <span class="keyword">CALL </span>budget_store_add_phy(d, tbudgets(idx), <span class="stringliteral">&#39;IMLT&#39;</span>,  ztot_cc_imlt(:,:) * zrhodjontstep(:,:) )</div>
<div class="line"><a id="l02682" name="l02682"></a><span class="lineno"> 2682</span>       <span class="keyword">CALL </span>budget_store_add_phy(d, tbudgets(idx), <span class="stringliteral">&#39;RIM&#39;</span>,   ztot_cc_rim(:,:) * zrhodjontstep(:,:) )</div>
<div class="line"><a id="l02683" name="l02683"></a><span class="lineno"> 2683</span>       <span class="keyword">CALL </span>budget_store_add_phy(d, tbudgets(idx), <span class="stringliteral">&#39;WETG&#39;</span>,  ztot_cc_wetg(:,:) * zrhodjontstep(:,:) )</div>
<div class="line"><a id="l02684" name="l02684"></a><span class="lineno"> 2684</span>       <span class="keyword">CALL </span>budget_store_add_phy(d, tbudgets(idx), <span class="stringliteral">&#39;DRYG&#39;</span>,  ztot_cc_dryg(:,:) * zrhodjontstep(:,:) )</div>
<div class="line"><a id="l02685" name="l02685"></a><span class="lineno"> 2685</span>       <span class="keyword">CALL </span>budget_store_add_phy(d, tbudgets(idx), <span class="stringliteral">&#39;CVRC&#39;</span>, -ztot_cr_cvrc(:,:) * zrhodjontstep(:,:) )</div>
<div class="line"><a id="l02686" name="l02686"></a><span class="lineno"> 2686</span>       <span class="keyword">CALL </span>budget_store_add_phy(d, tbudgets(idx), <span class="stringliteral">&#39;CORR2&#39;</span>, ztot_cc_corr2(:,:) * zrhodjontstep(:,:) )</div>
<div class="line"><a id="l02687" name="l02687"></a><span class="lineno"> 2687</span>       <span class="keyword">CALL </span>budget_store_add_phy(d, tbudgets(idx), <span class="stringliteral">&#39;WETH&#39;</span>,  ztot_cc_weth(:,:) * zrhodjontstep(:,:) )</div>
<div class="line"><a id="l02688" name="l02688"></a><span class="lineno"> 2688</span><span class="keywordflow">    END IF</span></div>
<div class="line"><a id="l02689" name="l02689"></a><span class="lineno"> 2689</span>    <span class="comment">!</span></div>
<div class="line"><a id="l02690" name="l02690"></a><span class="lineno"> 2690</span>    <span class="comment">! Rain drops</span></div>
<div class="line"><a id="l02691" name="l02691"></a><span class="lineno"> 2691</span>    <span class="comment">!</span></div>
<div class="line"><a id="l02692" name="l02692"></a><span class="lineno"> 2692</span>    <span class="keywordflow">IF</span> (limap%NMOM_R.GE.2) <span class="keywordflow">then</span></div>
<div class="line"><a id="l02693" name="l02693"></a><span class="lineno"> 2693</span>       idx = nbudget_sv1 - 1 + tnsv%NSV_LIMA_NR</div>
<div class="line"><a id="l02694" name="l02694"></a><span class="lineno"> 2694</span>       <span class="keyword">CALL </span>budget_store_add_phy(d, tbudgets(idx), <span class="stringliteral">&#39;AUTO&#39;</span>,  ztot_cr_auto(:,:) * zrhodjontstep(:,:) )</div>
<div class="line"><a id="l02695" name="l02695"></a><span class="lineno"> 2695</span>       <span class="keyword">CALL </span>budget_store_add_phy(d, tbudgets(idx), <span class="stringliteral">&#39;SCBU&#39;</span>,  ztot_cr_scbu(:,:) * zrhodjontstep(:,:) )</div>
<div class="line"><a id="l02696" name="l02696"></a><span class="lineno"> 2696</span>       <span class="keyword">CALL </span>budget_store_add_phy(d, tbudgets(idx), <span class="stringliteral">&#39;REVA&#39;</span>,  ztot_cr_evap(:,:) * zrhodjontstep(:,:) )</div>
<div class="line"><a id="l02697" name="l02697"></a><span class="lineno"> 2697</span>       <span class="keyword">CALL </span>budget_store_add_phy(d, tbudgets(idx), <span class="stringliteral">&#39;BRKU&#39;</span>,  ztot_cr_brku(:,:) * zrhodjontstep(:,:) )</div>
<div class="line"><a id="l02698" name="l02698"></a><span class="lineno"> 2698</span>       <span class="keyword">CALL </span>budget_store_add_phy(d, tbudgets(idx), <span class="stringliteral">&#39;HONR&#39;</span>,  ztot_cr_honr(:,:) * zrhodjontstep(:,:) )</div>
<div class="line"><a id="l02699" name="l02699"></a><span class="lineno"> 2699</span>       <span class="keyword">CALL </span>budget_store_add_phy(d, tbudgets(idx), <span class="stringliteral">&#39;ACC&#39;</span>,   ztot_cr_acc(:,:) * zrhodjontstep(:,:) )</div>
<div class="line"><a id="l02700" name="l02700"></a><span class="lineno"> 2700</span>       <span class="keyword">CALL </span>budget_store_add_phy(d, tbudgets(idx), <span class="stringliteral">&#39;CFRZ&#39;</span>,  ztot_cr_cfrz(:,:) * zrhodjontstep(:,:) )</div>
<div class="line"><a id="l02701" name="l02701"></a><span class="lineno"> 2701</span>       <span class="keyword">CALL </span>budget_store_add_phy(d, tbudgets(idx), <span class="stringliteral">&#39;WETG&#39;</span>,  ztot_cr_wetg(:,:) * zrhodjontstep(:,:) )</div>
<div class="line"><a id="l02702" name="l02702"></a><span class="lineno"> 2702</span>       <span class="keyword">CALL </span>budget_store_add_phy(d, tbudgets(idx), <span class="stringliteral">&#39;DRYG&#39;</span>,  ztot_cr_dryg(:,:) * zrhodjontstep(:,:) )</div>
<div class="line"><a id="l02703" name="l02703"></a><span class="lineno"> 2703</span>       <span class="keyword">CALL </span>budget_store_add_phy(d, tbudgets(idx), <span class="stringliteral">&#39;GMLT&#39;</span>,  ztot_cr_gmlt(:,:) * zrhodjontstep(:,:) )</div>
<div class="line"><a id="l02704" name="l02704"></a><span class="lineno"> 2704</span>       <span class="keyword">CALL </span>budget_store_add_phy(d, tbudgets(idx), <span class="stringliteral">&#39;CVRC&#39;</span>,  ztot_cr_cvrc(:,:) * zrhodjontstep(:,:) )</div>
<div class="line"><a id="l02705" name="l02705"></a><span class="lineno"> 2705</span>       <span class="keyword">CALL </span>budget_store_add_phy(d, tbudgets(idx), <span class="stringliteral">&#39;CORR2&#39;</span>, ztot_cr_corr2(:,:) * zrhodjontstep(:,:) )</div>
<div class="line"><a id="l02706" name="l02706"></a><span class="lineno"> 2706</span>       <span class="keyword">CALL </span>budget_store_add_phy(d, tbudgets(idx), <span class="stringliteral">&#39;WETH&#39;</span>,  ztot_cr_weth(:,:) * zrhodjontstep(:,:) )</div>
<div class="line"><a id="l02707" name="l02707"></a><span class="lineno"> 2707</span>       <span class="keyword">CALL </span>budget_store_add_phy(d, tbudgets(idx), <span class="stringliteral">&#39;HMLT&#39;</span>,  ztot_cr_hmlt(:,:) * zrhodjontstep(:,:) )</div>
<div class="line"><a id="l02708" name="l02708"></a><span class="lineno"> 2708</span><span class="keywordflow">    END IF</span></div>
<div class="line"><a id="l02709" name="l02709"></a><span class="lineno"> 2709</span>    <span class="comment">!</span></div>
<div class="line"><a id="l02710" name="l02710"></a><span class="lineno"> 2710</span>    <span class="comment">! Ice crystals</span></div>
<div class="line"><a id="l02711" name="l02711"></a><span class="lineno"> 2711</span>    <span class="comment">!</span></div>
<div class="line"><a id="l02712" name="l02712"></a><span class="lineno"> 2712</span>    <span class="keywordflow">IF</span> (limap%NMOM_I.GE.2) <span class="keywordflow">then</span></div>
<div class="line"><a id="l02713" name="l02713"></a><span class="lineno"> 2713</span>      <span class="keywordflow">IF</span> (.NOT. limap%LCRYSTAL_SHAPE) <span class="keywordflow">THEN</span></div>
<div class="line"><a id="l02714" name="l02714"></a><span class="lineno"> 2714</span>       idx = nbudget_sv1 - 1 + tnsv%NSV_LIMA_NI</div>
<div class="line"><a id="l02715" name="l02715"></a><span class="lineno"> 2715</span>       <span class="keyword">CALL </span>budget_store_add_phy(d, tbudgets(idx), <span class="stringliteral">&#39;HONC&#39;</span>,  -ztot_cc_honc(:,:) * zrhodjontstep(:,:) )</div>
<div class="line"><a id="l02716" name="l02716"></a><span class="lineno"> 2716</span>       <span class="keyword">CALL </span>budget_store_add_phy(d, tbudgets(idx), <span class="stringliteral">&#39;CNVI&#39;</span>,   ztot_ci_cnvi(:,:) * zrhodjontstep(:,:) )</div>
<div class="line"><a id="l02717" name="l02717"></a><span class="lineno"> 2717</span>       <span class="keyword">CALL </span>budget_store_add_phy(d, tbudgets(idx), <span class="stringliteral">&#39;CNVS&#39;</span>,   ztot_ci_cnvs(:,:) * zrhodjontstep(:,:) )</div>
<div class="line"><a id="l02718" name="l02718"></a><span class="lineno"> 2718</span>       <span class="keyword">CALL </span>budget_store_add_phy(d, tbudgets(idx), <span class="stringliteral">&#39;AGGS&#39;</span>,   ztot_ci_aggs(:,:) * zrhodjontstep(:,:) )</div>
<div class="line"><a id="l02719" name="l02719"></a><span class="lineno"> 2719</span>       <span class="keyword">CALL </span>budget_store_add_phy(d, tbudgets(idx), <span class="stringliteral">&#39;IMLT&#39;</span>,  -ztot_cc_imlt(:,:) * zrhodjontstep(:,:) )</div>
<div class="line"><a id="l02720" name="l02720"></a><span class="lineno"> 2720</span>       <span class="keyword">CALL </span>budget_store_add_phy(d, tbudgets(idx), <span class="stringliteral">&#39;HMS&#39;</span>,    ztot_ci_hms(:,:) * zrhodjontstep(:,:) )</div>
<div class="line"><a id="l02721" name="l02721"></a><span class="lineno"> 2721</span>       <span class="keyword">CALL </span>budget_store_add_phy(d, tbudgets(idx), <span class="stringliteral">&#39;CFRZ&#39;</span>,   ztot_ci_cfrz(:,:) * zrhodjontstep(:,:) )</div>
<div class="line"><a id="l02722" name="l02722"></a><span class="lineno"> 2722</span>       <span class="keyword">CALL </span>budget_store_add_phy(d, tbudgets(idx), <span class="stringliteral">&#39;CIBU&#39;</span>,   ztot_ci_cibu(:,:) * zrhodjontstep(:,:) )</div>
<div class="line"><a id="l02723" name="l02723"></a><span class="lineno"> 2723</span>       <span class="keyword">CALL </span>budget_store_add_phy(d, tbudgets(idx), <span class="stringliteral">&#39;RDSF&#39;</span>,   ztot_ci_rdsf(:,:) * zrhodjontstep(:,:) )</div>
<div class="line"><a id="l02724" name="l02724"></a><span class="lineno"> 2724</span>       <span class="keyword">CALL </span>budget_store_add_phy(d, tbudgets(idx), <span class="stringliteral">&#39;WETG&#39;</span>,   ztot_ci_wetg(:,:) * zrhodjontstep(:,:) )</div>
<div class="line"><a id="l02725" name="l02725"></a><span class="lineno"> 2725</span>       <span class="keyword">CALL </span>budget_store_add_phy(d, tbudgets(idx), <span class="stringliteral">&#39;DRYG&#39;</span>,   ztot_ci_dryg(:,:) * zrhodjontstep(:,:) )</div>
<div class="line"><a id="l02726" name="l02726"></a><span class="lineno"> 2726</span>       <span class="keyword">CALL </span>budget_store_add_phy(d, tbudgets(idx), <span class="stringliteral">&#39;HMG&#39;</span>,    ztot_ci_hmg(:,:) * zrhodjontstep(:,:) )</div>
<div class="line"><a id="l02727" name="l02727"></a><span class="lineno"> 2727</span>       <span class="keyword">CALL </span>budget_store_add_phy(d, tbudgets(idx), <span class="stringliteral">&#39;CORR2&#39;</span>,  ztot_ci_corr2(:,:) * zrhodjontstep(:,:) )</div>
<div class="line"><a id="l02728" name="l02728"></a><span class="lineno"> 2728</span>       <span class="keyword">CALL </span>budget_store_add_phy(d, tbudgets(idx), <span class="stringliteral">&#39;WETH&#39;</span>,   ztot_ci_weth(:,:) * zrhodjontstep(:,:) )</div>
<div class="line"><a id="l02729" name="l02729"></a><span class="lineno"> 2729</span>      <span class="keywordflow">ELSE</span></div>
<div class="line"><a id="l02730" name="l02730"></a><span class="lineno"> 2730</span>         <span class="keywordflow">DO</span> ish = 1, limap%NNB_CRYSTAL_SHAPE</div>
<div class="line"><a id="l02731" name="l02731"></a><span class="lineno"> 2731</span>           idx = nbudget_sv1 - 1 + tnsv%NSV_LIMA_NI + ish - 1</div>
<div class="line"><a id="l02732" name="l02732"></a><span class="lineno"> 2732</span>           <span class="keyword">CALL </span>budget_store_add_phy(d, tbudgets(idx), <span class="stringliteral">&#39;HONC&#39;</span>, ztot_shci_honc(:,:,ish) * zrhodjontstep(:,:) )</div>
<div class="line"><a id="l02733" name="l02733"></a><span class="lineno"> 2733</span>           <span class="keyword">CALL </span>budget_store_add_phy(d, tbudgets(idx), <span class="stringliteral">&#39;CNVI&#39;</span>, ztot_shci_cnvi(:,:,ish) * zrhodjontstep(:,:) )</div>
<div class="line"><a id="l02734" name="l02734"></a><span class="lineno"> 2734</span>           <span class="keyword">CALL </span>budget_store_add_phy(d, tbudgets(idx), <span class="stringliteral">&#39;HACH&#39;</span>, ztot_shci_hach(:,:,ish) * zrhodjontstep(:,:) )</div>
<div class="line"><a id="l02735" name="l02735"></a><span class="lineno"> 2735</span>           <span class="keyword">CALL </span>budget_store_add_phy(d, tbudgets(idx), <span class="stringliteral">&#39;CNVS&#39;</span>, ztot_shci_cnvs(:,:,ish) * zrhodjontstep(:,:) )</div>
<div class="line"><a id="l02736" name="l02736"></a><span class="lineno"> 2736</span>           <span class="keyword">CALL </span>budget_store_add_phy(d, tbudgets(idx), <span class="stringliteral">&#39;AGGS&#39;</span>, ztot_shci_aggs(:,:,ish) * zrhodjontstep(:,:) )</div>
<div class="line"><a id="l02737" name="l02737"></a><span class="lineno"> 2737</span>           <span class="keyword">CALL </span>budget_store_add_phy(d, tbudgets(idx), <span class="stringliteral">&#39;IMLT&#39;</span>, ztot_shci_imlt(:,:,ish) * zrhodjontstep(:,:) )</div>
<div class="line"><a id="l02738" name="l02738"></a><span class="lineno"> 2738</span>           <span class="keyword">CALL </span>budget_store_add_phy(d, tbudgets(idx), <span class="stringliteral">&#39;HMS&#39;</span>,  ztot_shci_hms(:,:,ish) * zrhodjontstep(:,:) )</div>
<div class="line"><a id="l02739" name="l02739"></a><span class="lineno"> 2739</span>           <span class="keyword">CALL </span>budget_store_add_phy(d, tbudgets(idx), <span class="stringliteral">&#39;CFRZ&#39;</span>, ztot_shci_cfrz(:,:,ish) * zrhodjontstep(:,:) )</div>
<div class="line"><a id="l02740" name="l02740"></a><span class="lineno"> 2740</span>           <span class="keyword">CALL </span>budget_store_add_phy(d, tbudgets(idx), <span class="stringliteral">&#39;CIBU&#39;</span>, ztot_shci_cibu(:,:,ish) * zrhodjontstep(:,:) )</div>
<div class="line"><a id="l02741" name="l02741"></a><span class="lineno"> 2741</span>           <span class="keyword">CALL </span>budget_store_add_phy(d, tbudgets(idx), <span class="stringliteral">&#39;RDSF&#39;</span>, ztot_shci_rdsf(:,:,ish) * zrhodjontstep(:,:) )</div>
<div class="line"><a id="l02742" name="l02742"></a><span class="lineno"> 2742</span>           <span class="keyword">CALL </span>budget_store_add_phy(d, tbudgets(idx), <span class="stringliteral">&#39;WETG&#39;</span>, ztot_shci_wetg(:,:,ish) * zrhodjontstep(:,:) )</div>
<div class="line"><a id="l02743" name="l02743"></a><span class="lineno"> 2743</span>           <span class="keyword">CALL </span>budget_store_add_phy(d, tbudgets(idx), <span class="stringliteral">&#39;DRYG&#39;</span>, ztot_shci_dryg(:,:,ish) * zrhodjontstep(:,:) )</div>
<div class="line"><a id="l02744" name="l02744"></a><span class="lineno"> 2744</span>           <span class="keyword">CALL </span>budget_store_add_phy(d, tbudgets(idx), <span class="stringliteral">&#39;HMG&#39;</span>,  ztot_shci_hmg(:,:,ish) * zrhodjontstep(:,:) )</div>
<div class="line"><a id="l02745" name="l02745"></a><span class="lineno"> 2745</span>           <span class="keyword">CALL </span>budget_store_add_phy(d, tbudgets(idx), <span class="stringliteral">&#39;CORR2&#39;</span>,ztot_shci_corr2(:,:,ish) * zrhodjontstep(:,:) )</div>
<div class="line"><a id="l02746" name="l02746"></a><span class="lineno"> 2746</span>           <span class="keyword">CALL </span>budget_store_add_phy(d, tbudgets(idx), <span class="stringliteral">&#39;ISC&#39;</span>,  ztot_shci_isc(:,:,ish) * zrhodjontstep(:,:) )</div>
<div class="line"><a id="l02747" name="l02747"></a><span class="lineno"> 2747</span>           <span class="keyword">CALL </span>budget_store_add_phy(d, tbudgets(idx), <span class="stringliteral">&#39;ISCS&#39;</span>, ztot_shci_iscs(:,:,ish) * zrhodjontstep(:,:) )</div>
<div class="line"><a id="l02748" name="l02748"></a><span class="lineno"> 2748</span><span class="keywordflow">         END DO</span></div>
<div class="line"><a id="l02749" name="l02749"></a><span class="lineno"> 2749</span><span class="keywordflow">      END IF</span></div>
<div class="line"><a id="l02750" name="l02750"></a><span class="lineno"> 2750</span><span class="keywordflow">    END IF</span></div>
<div class="line"><a id="l02751" name="l02751"></a><span class="lineno"> 2751</span>    <span class="comment">!</span></div>
<div class="line"><a id="l02752" name="l02752"></a><span class="lineno"> 2752</span>    <span class="comment">! Snow</span></div>
<div class="line"><a id="l02753" name="l02753"></a><span class="lineno"> 2753</span>    <span class="comment">!</span></div>
<div class="line"><a id="l02754" name="l02754"></a><span class="lineno"> 2754</span>    <span class="keywordflow">IF</span> (limap%NMOM_S.GE.2) <span class="keywordflow">then</span></div>
<div class="line"><a id="l02755" name="l02755"></a><span class="lineno"> 2755</span>       idx = nbudget_sv1 - 1 + tnsv%NSV_LIMA_NS</div>
<div class="line"><a id="l02756" name="l02756"></a><span class="lineno"> 2756</span>       <span class="keyword">CALL </span>budget_store_add_phy(d, tbudgets(idx), <span class="stringliteral">&#39;CNVI&#39;</span>,  -ztot_ci_cnvi(:,:) * zrhodjontstep(:,:) )</div>
<div class="line"><a id="l02757" name="l02757"></a><span class="lineno"> 2757</span>       <span class="keyword">CALL </span>budget_store_add_phy(d, tbudgets(idx), <span class="stringliteral">&#39;CNVS&#39;</span>,  -ztot_ci_cnvs(:,:) * zrhodjontstep(:,:) )</div>
<div class="line"><a id="l02758" name="l02758"></a><span class="lineno"> 2758</span>       <span class="keyword">CALL </span>budget_store_add_phy(d, tbudgets(idx), <span class="stringliteral">&#39;RIM&#39;</span>,    ztot_cs_rim(:,:)  * zrhodjontstep(:,:) )</div>
<div class="line"><a id="l02759" name="l02759"></a><span class="lineno"> 2759</span>       <span class="keyword">CALL </span>budget_store_add_phy(d, tbudgets(idx), <span class="stringliteral">&#39;ACC&#39;</span>,    ztot_cs_acc(:,:)  * zrhodjontstep(:,:) )</div>
<div class="line"><a id="l02760" name="l02760"></a><span class="lineno"> 2760</span>       <span class="keyword">CALL </span>budget_store_add_phy(d, tbudgets(idx), <span class="stringliteral">&#39;CMEL&#39;</span>,   ztot_cs_cmel(:,:) * zrhodjontstep(:,:) )</div>
<div class="line"><a id="l02761" name="l02761"></a><span class="lineno"> 2761</span>       <span class="keyword">CALL </span>budget_store_add_phy(d, tbudgets(idx), <span class="stringliteral">&#39;SSC&#39;</span>,    ztot_cs_ssc(:,:)  * zrhodjontstep(:,:) )</div>
<div class="line"><a id="l02762" name="l02762"></a><span class="lineno"> 2762</span>       <span class="keyword">CALL </span>budget_store_add_phy(d, tbudgets(idx), <span class="stringliteral">&#39;WETG&#39;</span>,   ztot_cs_wetg(:,:) * zrhodjontstep(:,:) )</div>
<div class="line"><a id="l02763" name="l02763"></a><span class="lineno"> 2763</span>       <span class="keyword">CALL </span>budget_store_add_phy(d, tbudgets(idx), <span class="stringliteral">&#39;DRYG&#39;</span>,   ztot_cs_dryg(:,:) * zrhodjontstep(:,:) )</div>
<div class="line"><a id="l02764" name="l02764"></a><span class="lineno"> 2764</span>       <span class="keyword">CALL </span>budget_store_add_phy(d, tbudgets(idx), <span class="stringliteral">&#39;WETH&#39;</span>,   ztot_cs_weth(:,:) * zrhodjontstep(:,:) )</div>
<div class="line"><a id="l02765" name="l02765"></a><span class="lineno"> 2765</span>       <span class="keywordflow">IF</span> (limap%LCRYSTAL_SHAPE) <span class="keywordflow">THEN</span></div>
<div class="line"><a id="l02766" name="l02766"></a><span class="lineno"> 2766</span>         <span class="keyword">ALLOCATE</span>(zaux_iscs(d%NIJT,d%NKT)) ; zaux_iscs(:,:) = 0.    </div>
<div class="line"><a id="l02767" name="l02767"></a><span class="lineno"> 2767</span>         <span class="keywordflow">DO</span> ish = 1, limap%NNB_CRYSTAL_SHAPE</div>
<div class="line"><a id="l02768" name="l02768"></a><span class="lineno"> 2768</span>           zaux_iscs(:,:) = sum(ztot_shci_iscs,dim=3)</div>
<div class="line"><a id="l02769" name="l02769"></a><span class="lineno"> 2769</span><span class="keywordflow">         END DO</span></div>
<div class="line"><a id="l02770" name="l02770"></a><span class="lineno"> 2770</span>         <span class="keyword">CALL </span>budget_store_add_phy(d, tbudgets(idx), <span class="stringliteral">&#39;ISCS&#39;</span>,  -zaux_iscs(:,:) * zrhodjontstep(:,:) ) </div>
<div class="line"><a id="l02771" name="l02771"></a><span class="lineno"> 2771</span>         <span class="keyword">DEALLOCATE</span>(zaux_iscs)</div>
<div class="line"><a id="l02772" name="l02772"></a><span class="lineno"> 2772</span><span class="keywordflow">       END IF</span></div>
<div class="line"><a id="l02773" name="l02773"></a><span class="lineno"> 2773</span><span class="keywordflow">    END IF</span></div>
<div class="line"><a id="l02774" name="l02774"></a><span class="lineno"> 2774</span>    <span class="comment">!</span></div>
<div class="line"><a id="l02775" name="l02775"></a><span class="lineno"> 2775</span>    <span class="comment">! Graupel</span></div>
<div class="line"><a id="l02776" name="l02776"></a><span class="lineno"> 2776</span>    <span class="comment">!</span></div>
<div class="line"><a id="l02777" name="l02777"></a><span class="lineno"> 2777</span>    <span class="keywordflow">IF</span> (limap%NMOM_G.GE.2) <span class="keywordflow">then</span></div>
<div class="line"><a id="l02778" name="l02778"></a><span class="lineno"> 2778</span>       idx = nbudget_sv1 - 1 + tnsv%NSV_LIMA_NG</div>
<div class="line"><a id="l02779" name="l02779"></a><span class="lineno"> 2779</span>       <span class="keyword">CALL </span>budget_store_add_phy(d, tbudgets(idx), <span class="stringliteral">&#39;RIM&#39;</span>,   -ztot_cs_rim(:,:)  * zrhodjontstep(:,:) )</div>
<div class="line"><a id="l02780" name="l02780"></a><span class="lineno"> 2780</span>       <span class="keyword">CALL </span>budget_store_add_phy(d, tbudgets(idx), <span class="stringliteral">&#39;ACC&#39;</span>,   -ztot_cs_acc(:,:)  * zrhodjontstep(:,:) )</div>
<div class="line"><a id="l02781" name="l02781"></a><span class="lineno"> 2781</span>       <span class="keyword">CALL </span>budget_store_add_phy(d, tbudgets(idx), <span class="stringliteral">&#39;CMEL&#39;</span>,  -ztot_cs_cmel(:,:) * zrhodjontstep(:,:) )</div>
<div class="line"><a id="l02782" name="l02782"></a><span class="lineno"> 2782</span>       <span class="keyword">CALL </span>budget_store_add_phy(d, tbudgets(idx), <span class="stringliteral">&#39;CFRZ&#39;</span>,  -ztot_cr_cfrz(:,:) * zrhodjontstep(:,:) )</div>
<div class="line"><a id="l02783" name="l02783"></a><span class="lineno"> 2783</span>       <span class="keyword">CALL </span>budget_store_add_phy(d, tbudgets(idx), <span class="stringliteral">&#39;WETG&#39;</span>,   ztot_cg_wetg(:,:) * zrhodjontstep(:,:) )</div>
<div class="line"><a id="l02784" name="l02784"></a><span class="lineno"> 2784</span>       <span class="keyword">CALL </span>budget_store_add_phy(d, tbudgets(idx), <span class="stringliteral">&#39;GMLT&#39;</span>,   ztot_cg_gmlt(:,:) * zrhodjontstep(:,:) )</div>
<div class="line"><a id="l02785" name="l02785"></a><span class="lineno"> 2785</span>       <span class="keyword">CALL </span>budget_store_add_phy(d, tbudgets(idx), <span class="stringliteral">&#39;WETH&#39;</span>,   ztot_cg_weth(:,:) * zrhodjontstep(:,:) )</div>
<div class="line"><a id="l02786" name="l02786"></a><span class="lineno"> 2786</span>       <span class="keyword">CALL </span>budget_store_add_phy(d, tbudgets(idx), <span class="stringliteral">&#39;COHG&#39;</span>,   ztot_cg_cohg(:,:) * zrhodjontstep(:,:) )</div>
<div class="line"><a id="l02787" name="l02787"></a><span class="lineno"> 2787</span><span class="keywordflow">    END IF</span></div>
<div class="line"><a id="l02788" name="l02788"></a><span class="lineno"> 2788</span>    <span class="comment">!</span></div>
<div class="line"><a id="l02789" name="l02789"></a><span class="lineno"> 2789</span>    <span class="comment">! Hail</span></div>
<div class="line"><a id="l02790" name="l02790"></a><span class="lineno"> 2790</span>    <span class="comment">!</span></div>
<div class="line"><a id="l02791" name="l02791"></a><span class="lineno"> 2791</span>    <span class="keywordflow">IF</span> (limap%NMOM_H.GE.2) <span class="keywordflow">then</span></div>
<div class="line"><a id="l02792" name="l02792"></a><span class="lineno"> 2792</span>       idx = nbudget_sv1 - 1 + tnsv%NSV_LIMA_NH</div>
<div class="line"><a id="l02793" name="l02793"></a><span class="lineno"> 2793</span>       <span class="keyword">CALL </span>budget_store_add_phy(d, tbudgets(idx), <span class="stringliteral">&#39;WETG&#39;</span>,  -ztot_cg_wetg(:,:) * zrhodjontstep(:,:) )</div>
<div class="line"><a id="l02794" name="l02794"></a><span class="lineno"> 2794</span>       <span class="keyword">CALL </span>budget_store_add_phy(d, tbudgets(idx), <span class="stringliteral">&#39;COHG&#39;</span>,  -ztot_cg_cohg(:,:) * zrhodjontstep(:,:) )</div>
<div class="line"><a id="l02795" name="l02795"></a><span class="lineno"> 2795</span>       <span class="keyword">CALL </span>budget_store_add_phy(d, tbudgets(idx), <span class="stringliteral">&#39;HMLT&#39;</span>,   ztot_ch_hmlt(:,:) * zrhodjontstep(:,:) )</div>
<div class="line"><a id="l02796" name="l02796"></a><span class="lineno"> 2796</span><span class="keywordflow">    END IF</span></div>
<div class="line"><a id="l02797" name="l02797"></a><span class="lineno"> 2797</span> </div>
<div class="line"><a id="l02798" name="l02798"></a><span class="lineno"> 2798</span>    <span class="keywordflow">DO</span> ii = 1, limap%NMOD_IFN</div>
<div class="line"><a id="l02799" name="l02799"></a><span class="lineno"> 2799</span>      idx = nbudget_sv1 - 1 + tnsv%NSV_LIMA_IFN_NUCL + ii - 1</div>
<div class="line"><a id="l02800" name="l02800"></a><span class="lineno"> 2800</span>      <span class="keyword">CALL </span>budget_store_add_phy(d, tbudgets(idx), <span class="stringliteral">&#39;IMLT&#39;</span>, ztot_ifnn_imlt(:, :, ii) * zrhodjontstep(:,:) )</div>
<div class="line"><a id="l02801" name="l02801"></a><span class="lineno"> 2801</span><span class="keywordflow">    END DO</span></div>
<div class="line"><a id="l02802" name="l02802"></a><span class="lineno"> 2802</span><span class="keywordflow">  END IF</span></div>
<div class="line"><a id="l02803" name="l02803"></a><span class="lineno"> 2803</span> </div>
<div class="line"><a id="l02804" name="l02804"></a><span class="lineno"> 2804</span>  <span class="keyword">DEALLOCATE</span>( zrhodjontstep )</div>
<div class="line"><a id="l02805" name="l02805"></a><span class="lineno"> 2805</span><span class="keywordflow">END IF</span></div>
<div class="line"><a id="l02806" name="l02806"></a><span class="lineno"> 2806</span><span class="comment">!</span></div>
<div class="line"><a id="l02807" name="l02807"></a><span class="lineno"> 2807</span><span class="keywordflow">IF</span> (<span class="keyword">ALLOCATED</span>(zcit_shape)) <span class="keyword">DEALLOCATE</span>(zcit_shape)</div>
<div class="line"><a id="l02808" name="l02808"></a><span class="lineno"> 2808</span><span class="keywordflow">IF</span> (<span class="keyword">ALLOCATED</span>(zcis_shape)) <span class="keyword">DEALLOCATE</span>(zcis_shape)</div>
<div class="line"><a id="l02809" name="l02809"></a><span class="lineno"> 2809</span><span class="keywordflow">IF</span> (<span class="keyword">ALLOCATED</span>(zrit_shape)) <span class="keyword">DEALLOCATE</span>(zrit_shape)</div>
<div class="line"><a id="l02810" name="l02810"></a><span class="lineno"> 2810</span><span class="keywordflow">IF</span> (<span class="keyword">ALLOCATED</span>(zris_shape)) <span class="keyword">DEALLOCATE</span>(zris_shape)</div>
<div class="line"><a id="l02811" name="l02811"></a><span class="lineno"> 2811</span><span class="keywordflow">IF</span> (<span class="keyword">ALLOCATED</span>(ztot_cr_brku)) <span class="keyword">DEALLOCATE</span>(ztot_cr_brku)</div>
<div class="line"><a id="l02812" name="l02812"></a><span class="lineno"> 2812</span><span class="keywordflow">IF</span> (<span class="keyword">ALLOCATED</span>(ztot_th_honr)) <span class="keyword">DEALLOCATE</span>(ztot_th_honr)</div>
<div class="line"><a id="l02813" name="l02813"></a><span class="lineno"> 2813</span><span class="keywordflow">IF</span> (<span class="keyword">ALLOCATED</span>(ztot_rr_honr)) <span class="keyword">DEALLOCATE</span>(ztot_rr_honr)</div>
<div class="line"><a id="l02814" name="l02814"></a><span class="lineno"> 2814</span><span class="keywordflow">IF</span> (<span class="keyword">ALLOCATED</span>(ztot_cr_honr)) <span class="keyword">DEALLOCATE</span>(ztot_cr_honr)</div>
<div class="line"><a id="l02815" name="l02815"></a><span class="lineno"> 2815</span><span class="keywordflow">IF</span> (<span class="keyword">ALLOCATED</span>(ztot_th_imlt)) <span class="keyword">DEALLOCATE</span>(ztot_th_imlt)</div>
<div class="line"><a id="l02816" name="l02816"></a><span class="lineno"> 2816</span><span class="keywordflow">IF</span> (<span class="keyword">ALLOCATED</span>(ztot_rc_imlt)) <span class="keyword">DEALLOCATE</span>(ztot_rc_imlt)</div>
<div class="line"><a id="l02817" name="l02817"></a><span class="lineno"> 2817</span><span class="keywordflow">IF</span> (<span class="keyword">ALLOCATED</span>(ztot_cc_imlt)) <span class="keyword">DEALLOCATE</span>(ztot_cc_imlt)</div>
<div class="line"><a id="l02818" name="l02818"></a><span class="lineno"> 2818</span><span class="keywordflow">IF</span> (<span class="keyword">ALLOCATED</span>(ztot_th_honc)) <span class="keyword">DEALLOCATE</span>(ztot_th_honc)</div>
<div class="line"><a id="l02819" name="l02819"></a><span class="lineno"> 2819</span><span class="keywordflow">IF</span> (<span class="keyword">ALLOCATED</span>(ztot_rc_honc)) <span class="keyword">DEALLOCATE</span>(ztot_rc_honc)</div>
<div class="line"><a id="l02820" name="l02820"></a><span class="lineno"> 2820</span><span class="keywordflow">IF</span> (<span class="keyword">ALLOCATED</span>(ztot_cc_honc)) <span class="keyword">DEALLOCATE</span>(ztot_cc_honc)</div>
<div class="line"><a id="l02821" name="l02821"></a><span class="lineno"> 2821</span><span class="keywordflow">IF</span> (<span class="keyword">ALLOCATED</span>(ztot_cc_self)) <span class="keyword">DEALLOCATE</span>(ztot_cc_self)</div>
<div class="line"><a id="l02822" name="l02822"></a><span class="lineno"> 2822</span><span class="keywordflow">IF</span> (<span class="keyword">ALLOCATED</span>(ztot_rc_auto)) <span class="keyword">DEALLOCATE</span>(ztot_rc_auto)</div>
<div class="line"><a id="l02823" name="l02823"></a><span class="lineno"> 2823</span><span class="keywordflow">IF</span> (<span class="keyword">ALLOCATED</span>(ztot_cc_auto)) <span class="keyword">DEALLOCATE</span>(ztot_cc_auto)</div>
<div class="line"><a id="l02824" name="l02824"></a><span class="lineno"> 2824</span><span class="keywordflow">IF</span> (<span class="keyword">ALLOCATED</span>(ztot_cr_auto)) <span class="keyword">DEALLOCATE</span>(ztot_cr_auto)</div>
<div class="line"><a id="l02825" name="l02825"></a><span class="lineno"> 2825</span><span class="keywordflow">IF</span> (<span class="keyword">ALLOCATED</span>(ztot_rc_accr)) <span class="keyword">DEALLOCATE</span>(ztot_rc_accr)</div>
<div class="line"><a id="l02826" name="l02826"></a><span class="lineno"> 2826</span><span class="keywordflow">IF</span> (<span class="keyword">ALLOCATED</span>(ztot_cc_accr)) <span class="keyword">DEALLOCATE</span>(ztot_cc_accr)</div>
<div class="line"><a id="l02827" name="l02827"></a><span class="lineno"> 2827</span><span class="keywordflow">IF</span> (<span class="keyword">ALLOCATED</span>(ztot_cr_scbu)) <span class="keyword">DEALLOCATE</span>(ztot_cr_scbu)</div>
<div class="line"><a id="l02828" name="l02828"></a><span class="lineno"> 2828</span><span class="keywordflow">IF</span> (<span class="keyword">ALLOCATED</span>(ztot_th_evap)) <span class="keyword">DEALLOCATE</span>(ztot_th_evap)</div>
<div class="line"><a id="l02829" name="l02829"></a><span class="lineno"> 2829</span><span class="keywordflow">IF</span> (<span class="keyword">ALLOCATED</span>(ztot_rr_evap)) <span class="keyword">DEALLOCATE</span>(ztot_rr_evap)</div>
<div class="line"><a id="l02830" name="l02830"></a><span class="lineno"> 2830</span><span class="keywordflow">IF</span> (<span class="keyword">ALLOCATED</span>(ztot_cr_evap)) <span class="keyword">DEALLOCATE</span>(ztot_cr_evap)</div>
<div class="line"><a id="l02831" name="l02831"></a><span class="lineno"> 2831</span><span class="keywordflow">IF</span> (<span class="keyword">ALLOCATED</span>(ztot_ri_cnvi)) <span class="keyword">DEALLOCATE</span>(ztot_ri_cnvi)</div>
<div class="line"><a id="l02832" name="l02832"></a><span class="lineno"> 2832</span><span class="keywordflow">IF</span> (<span class="keyword">ALLOCATED</span>(ztot_ci_cnvi)) <span class="keyword">DEALLOCATE</span>(ztot_ci_cnvi)</div>
<div class="line"><a id="l02833" name="l02833"></a><span class="lineno"> 2833</span><span class="keywordflow">IF</span> (<span class="keyword">ALLOCATED</span>(ztot_th_deps)) <span class="keyword">DEALLOCATE</span>(ztot_th_deps)</div>
<div class="line"><a id="l02834" name="l02834"></a><span class="lineno"> 2834</span><span class="keywordflow">IF</span> (<span class="keyword">ALLOCATED</span>(ztot_rs_deps)) <span class="keyword">DEALLOCATE</span>(ztot_rs_deps)</div>
<div class="line"><a id="l02835" name="l02835"></a><span class="lineno"> 2835</span><span class="keywordflow">IF</span> (<span class="keyword">ALLOCATED</span>(ztot_th_depi)) <span class="keyword">DEALLOCATE</span>(ztot_th_depi)</div>
<div class="line"><a id="l02836" name="l02836"></a><span class="lineno"> 2836</span><span class="keywordflow">IF</span> (<span class="keyword">ALLOCATED</span>(ztot_ri_depi)) <span class="keyword">DEALLOCATE</span>(ztot_ri_depi)</div>
<div class="line"><a id="l02837" name="l02837"></a><span class="lineno"> 2837</span><span class="keywordflow">IF</span> (<span class="keyword">ALLOCATED</span>(ztot_ri_cnvs)) <span class="keyword">DEALLOCATE</span>(ztot_ri_cnvs)</div>
<div class="line"><a id="l02838" name="l02838"></a><span class="lineno"> 2838</span><span class="keywordflow">IF</span> (<span class="keyword">ALLOCATED</span>(ztot_ci_cnvs)) <span class="keyword">DEALLOCATE</span>(ztot_ci_cnvs)</div>
<div class="line"><a id="l02839" name="l02839"></a><span class="lineno"> 2839</span><span class="keywordflow">IF</span> (<span class="keyword">ALLOCATED</span>(ztot_cs_ssc)) <span class="keyword">DEALLOCATE</span>(ztot_cs_ssc)</div>
<div class="line"><a id="l02840" name="l02840"></a><span class="lineno"> 2840</span><span class="keywordflow">IF</span> (<span class="keyword">ALLOCATED</span>(ztot_ci_isc)) <span class="keyword">DEALLOCATE</span>(ztot_ci_isc)</div>
<div class="line"><a id="l02841" name="l02841"></a><span class="lineno"> 2841</span><span class="keywordflow">IF</span> (<span class="keyword">ALLOCATED</span>(ztot_ri_aggs)) <span class="keyword">DEALLOCATE</span>(ztot_ri_aggs)</div>
<div class="line"><a id="l02842" name="l02842"></a><span class="lineno"> 2842</span><span class="keywordflow">IF</span> (<span class="keyword">ALLOCATED</span>(ztot_ci_aggs)) <span class="keyword">DEALLOCATE</span>(ztot_ci_aggs)</div>
<div class="line"><a id="l02843" name="l02843"></a><span class="lineno"> 2843</span><span class="keywordflow">IF</span> (<span class="keyword">ALLOCATED</span>(ztot_th_depg)) <span class="keyword">DEALLOCATE</span>(ztot_th_depg)</div>
<div class="line"><a id="l02844" name="l02844"></a><span class="lineno"> 2844</span><span class="keywordflow">IF</span> (<span class="keyword">ALLOCATED</span>(ztot_rg_depg)) <span class="keyword">DEALLOCATE</span>(ztot_rg_depg)</div>
<div class="line"><a id="l02845" name="l02845"></a><span class="lineno"> 2845</span><span class="keywordflow">IF</span> (<span class="keyword">ALLOCATED</span>(ztot_th_berfi)) <span class="keyword">DEALLOCATE</span>(ztot_th_berfi)</div>
<div class="line"><a id="l02846" name="l02846"></a><span class="lineno"> 2846</span><span class="keywordflow">IF</span> (<span class="keyword">ALLOCATED</span>(ztot_rc_berfi)) <span class="keyword">DEALLOCATE</span>(ztot_rc_berfi)</div>
<div class="line"><a id="l02847" name="l02847"></a><span class="lineno"> 2847</span><span class="keywordflow">IF</span> (<span class="keyword">ALLOCATED</span>(ztot_th_rim)) <span class="keyword">DEALLOCATE</span>(ztot_th_rim)</div>
<div class="line"><a id="l02848" name="l02848"></a><span class="lineno"> 2848</span><span class="keywordflow">IF</span> (<span class="keyword">ALLOCATED</span>(ztot_cc_rim)) <span class="keyword">DEALLOCATE</span>(ztot_cc_rim)</div>
<div class="line"><a id="l02849" name="l02849"></a><span class="lineno"> 2849</span><span class="keywordflow">IF</span> (<span class="keyword">ALLOCATED</span>(ztot_cs_rim)) <span class="keyword">DEALLOCATE</span>(ztot_cs_rim)</div>
<div class="line"><a id="l02850" name="l02850"></a><span class="lineno"> 2850</span><span class="keywordflow">IF</span> (<span class="keyword">ALLOCATED</span>(ztot_rc_rimss)) <span class="keyword">DEALLOCATE</span>(ztot_rc_rimss)</div>
<div class="line"><a id="l02851" name="l02851"></a><span class="lineno"> 2851</span><span class="keywordflow">IF</span> (<span class="keyword">ALLOCATED</span>(ztot_rc_rimsg)) <span class="keyword">DEALLOCATE</span>(ztot_rc_rimsg)</div>
<div class="line"><a id="l02852" name="l02852"></a><span class="lineno"> 2852</span><span class="keywordflow">IF</span> (<span class="keyword">ALLOCATED</span>(ztot_rs_rimcg)) <span class="keyword">DEALLOCATE</span>(ztot_rs_rimcg)</div>
<div class="line"><a id="l02853" name="l02853"></a><span class="lineno"> 2853</span><span class="keywordflow">IF</span> (<span class="keyword">ALLOCATED</span>(ztot_ri_hms)) <span class="keyword">DEALLOCATE</span>(ztot_ri_hms)</div>
<div class="line"><a id="l02854" name="l02854"></a><span class="lineno"> 2854</span><span class="keywordflow">IF</span> (<span class="keyword">ALLOCATED</span>(ztot_ci_hms)) <span class="keyword">DEALLOCATE</span>(ztot_ci_hms)</div>
<div class="line"><a id="l02855" name="l02855"></a><span class="lineno"> 2855</span><span class="keywordflow">IF</span> (<span class="keyword">ALLOCATED</span>(ztot_rs_hms)) <span class="keyword">DEALLOCATE</span>(ztot_rs_hms)</div>
<div class="line"><a id="l02856" name="l02856"></a><span class="lineno"> 2856</span><span class="keywordflow">IF</span> (<span class="keyword">ALLOCATED</span>(ztot_th_acc)) <span class="keyword">DEALLOCATE</span>(ztot_th_acc)</div>
<div class="line"><a id="l02857" name="l02857"></a><span class="lineno"> 2857</span><span class="keywordflow">IF</span> (<span class="keyword">ALLOCATED</span>(ztot_cr_acc)) <span class="keyword">DEALLOCATE</span>(ztot_cr_acc)</div>
<div class="line"><a id="l02858" name="l02858"></a><span class="lineno"> 2858</span><span class="keywordflow">IF</span> (<span class="keyword">ALLOCATED</span>(ztot_cs_acc)) <span class="keyword">DEALLOCATE</span>(ztot_cs_acc)</div>
<div class="line"><a id="l02859" name="l02859"></a><span class="lineno"> 2859</span><span class="keywordflow">IF</span> (<span class="keyword">ALLOCATED</span>(ztot_rr_accss)) <span class="keyword">DEALLOCATE</span>(ztot_rr_accss)</div>
<div class="line"><a id="l02860" name="l02860"></a><span class="lineno"> 2860</span><span class="keywordflow">IF</span> (<span class="keyword">ALLOCATED</span>(ztot_rr_accsg)) <span class="keyword">DEALLOCATE</span>(ztot_rr_accsg)</div>
<div class="line"><a id="l02861" name="l02861"></a><span class="lineno"> 2861</span><span class="keywordflow">IF</span> (<span class="keyword">ALLOCATED</span>(ztot_rs_accrg)) <span class="keyword">DEALLOCATE</span>(ztot_rs_accrg)</div>
<div class="line"><a id="l02862" name="l02862"></a><span class="lineno"> 2862</span><span class="keywordflow">IF</span> (<span class="keyword">ALLOCATED</span>(ztot_rs_cmel)) <span class="keyword">DEALLOCATE</span>(ztot_rs_cmel)</div>
<div class="line"><a id="l02863" name="l02863"></a><span class="lineno"> 2863</span><span class="keywordflow">IF</span> (<span class="keyword">ALLOCATED</span>(ztot_cs_cmel)) <span class="keyword">DEALLOCATE</span>(ztot_cs_cmel)</div>
<div class="line"><a id="l02864" name="l02864"></a><span class="lineno"> 2864</span><span class="keywordflow">IF</span> (<span class="keyword">ALLOCATED</span>(ztot_th_cfrz)) <span class="keyword">DEALLOCATE</span>(ztot_th_cfrz)</div>
<div class="line"><a id="l02865" name="l02865"></a><span class="lineno"> 2865</span><span class="keywordflow">IF</span> (<span class="keyword">ALLOCATED</span>(ztot_rr_cfrz)) <span class="keyword">DEALLOCATE</span>(ztot_rr_cfrz)</div>
<div class="line"><a id="l02866" name="l02866"></a><span class="lineno"> 2866</span><span class="keywordflow">IF</span> (<span class="keyword">ALLOCATED</span>(ztot_cr_cfrz)) <span class="keyword">DEALLOCATE</span>(ztot_cr_cfrz)</div>
<div class="line"><a id="l02867" name="l02867"></a><span class="lineno"> 2867</span><span class="keywordflow">IF</span> (<span class="keyword">ALLOCATED</span>(ztot_ri_cfrz)) <span class="keyword">DEALLOCATE</span>(ztot_ri_cfrz)</div>
<div class="line"><a id="l02868" name="l02868"></a><span class="lineno"> 2868</span><span class="keywordflow">IF</span> (<span class="keyword">ALLOCATED</span>(ztot_ci_cfrz)) <span class="keyword">DEALLOCATE</span>(ztot_ci_cfrz)</div>
<div class="line"><a id="l02869" name="l02869"></a><span class="lineno"> 2869</span><span class="keywordflow">IF</span> (<span class="keyword">ALLOCATED</span>(ztot_ri_cibu)) <span class="keyword">DEALLOCATE</span>(ztot_ri_cibu)</div>
<div class="line"><a id="l02870" name="l02870"></a><span class="lineno"> 2870</span><span class="keywordflow">IF</span> (<span class="keyword">ALLOCATED</span>(ztot_ci_cibu)) <span class="keyword">DEALLOCATE</span>(ztot_ci_cibu)</div>
<div class="line"><a id="l02871" name="l02871"></a><span class="lineno"> 2871</span><span class="keywordflow">IF</span> (<span class="keyword">ALLOCATED</span>(ztot_ri_rdsf)) <span class="keyword">DEALLOCATE</span>(ztot_ri_rdsf)</div>
<div class="line"><a id="l02872" name="l02872"></a><span class="lineno"> 2872</span><span class="keywordflow">IF</span> (<span class="keyword">ALLOCATED</span>(ztot_ci_rdsf)) <span class="keyword">DEALLOCATE</span>(ztot_ci_rdsf)</div>
<div class="line"><a id="l02873" name="l02873"></a><span class="lineno"> 2873</span><span class="keywordflow">IF</span> (<span class="keyword">ALLOCATED</span>(ztot_th_wetg)) <span class="keyword">DEALLOCATE</span>(ztot_th_wetg)</div>
<div class="line"><a id="l02874" name="l02874"></a><span class="lineno"> 2874</span><span class="keywordflow">IF</span> (<span class="keyword">ALLOCATED</span>(ztot_rc_wetg)) <span class="keyword">DEALLOCATE</span>(ztot_rc_wetg)</div>
<div class="line"><a id="l02875" name="l02875"></a><span class="lineno"> 2875</span><span class="keywordflow">IF</span> (<span class="keyword">ALLOCATED</span>(ztot_cc_wetg)) <span class="keyword">DEALLOCATE</span>(ztot_cc_wetg)</div>
<div class="line"><a id="l02876" name="l02876"></a><span class="lineno"> 2876</span><span class="keywordflow">IF</span> (<span class="keyword">ALLOCATED</span>(ztot_rr_wetg)) <span class="keyword">DEALLOCATE</span>(ztot_rr_wetg)</div>
<div class="line"><a id="l02877" name="l02877"></a><span class="lineno"> 2877</span><span class="keywordflow">IF</span> (<span class="keyword">ALLOCATED</span>(ztot_cr_wetg)) <span class="keyword">DEALLOCATE</span>(ztot_cr_wetg)</div>
<div class="line"><a id="l02878" name="l02878"></a><span class="lineno"> 2878</span><span class="keywordflow">IF</span> (<span class="keyword">ALLOCATED</span>(ztot_ri_wetg)) <span class="keyword">DEALLOCATE</span>(ztot_ri_wetg)</div>
<div class="line"><a id="l02879" name="l02879"></a><span class="lineno"> 2879</span><span class="keywordflow">IF</span> (<span class="keyword">ALLOCATED</span>(ztot_ci_wetg)) <span class="keyword">DEALLOCATE</span>(ztot_ci_wetg)</div>
<div class="line"><a id="l02880" name="l02880"></a><span class="lineno"> 2880</span><span class="keywordflow">IF</span> (<span class="keyword">ALLOCATED</span>(ztot_rs_wetg)) <span class="keyword">DEALLOCATE</span>(ztot_rs_wetg)</div>
<div class="line"><a id="l02881" name="l02881"></a><span class="lineno"> 2881</span><span class="keywordflow">IF</span> (<span class="keyword">ALLOCATED</span>(ztot_cs_wetg)) <span class="keyword">DEALLOCATE</span>(ztot_cs_wetg)</div>
<div class="line"><a id="l02882" name="l02882"></a><span class="lineno"> 2882</span><span class="keywordflow">IF</span> (<span class="keyword">ALLOCATED</span>(ztot_rg_wetg)) <span class="keyword">DEALLOCATE</span>(ztot_rg_wetg)</div>
<div class="line"><a id="l02883" name="l02883"></a><span class="lineno"> 2883</span><span class="keywordflow">IF</span> (<span class="keyword">ALLOCATED</span>(ztot_cg_wetg)) <span class="keyword">DEALLOCATE</span>(ztot_cg_wetg)</div>
<div class="line"><a id="l02884" name="l02884"></a><span class="lineno"> 2884</span><span class="keywordflow">IF</span> (<span class="keyword">ALLOCATED</span>(ztot_rh_wetg)) <span class="keyword">DEALLOCATE</span>(ztot_rh_wetg)</div>
<div class="line"><a id="l02885" name="l02885"></a><span class="lineno"> 2885</span><span class="keywordflow">IF</span> (<span class="keyword">ALLOCATED</span>(ztot_th_dryg)) <span class="keyword">DEALLOCATE</span>(ztot_th_dryg)</div>
<div class="line"><a id="l02886" name="l02886"></a><span class="lineno"> 2886</span><span class="keywordflow">IF</span> (<span class="keyword">ALLOCATED</span>(ztot_rc_dryg)) <span class="keyword">DEALLOCATE</span>(ztot_rc_dryg)</div>
<div class="line"><a id="l02887" name="l02887"></a><span class="lineno"> 2887</span><span class="keywordflow">IF</span> (<span class="keyword">ALLOCATED</span>(ztot_cc_dryg)) <span class="keyword">DEALLOCATE</span>(ztot_cc_dryg)</div>
<div class="line"><a id="l02888" name="l02888"></a><span class="lineno"> 2888</span><span class="keywordflow">IF</span> (<span class="keyword">ALLOCATED</span>(ztot_rr_dryg)) <span class="keyword">DEALLOCATE</span>(ztot_rr_dryg)</div>
<div class="line"><a id="l02889" name="l02889"></a><span class="lineno"> 2889</span><span class="keywordflow">IF</span> (<span class="keyword">ALLOCATED</span>(ztot_cr_dryg)) <span class="keyword">DEALLOCATE</span>(ztot_cr_dryg)</div>
<div class="line"><a id="l02890" name="l02890"></a><span class="lineno"> 2890</span><span class="keywordflow">IF</span> (<span class="keyword">ALLOCATED</span>(ztot_ri_dryg)) <span class="keyword">DEALLOCATE</span>(ztot_ri_dryg)</div>
<div class="line"><a id="l02891" name="l02891"></a><span class="lineno"> 2891</span><span class="keywordflow">IF</span> (<span class="keyword">ALLOCATED</span>(ztot_ci_dryg)) <span class="keyword">DEALLOCATE</span>(ztot_ci_dryg)</div>
<div class="line"><a id="l02892" name="l02892"></a><span class="lineno"> 2892</span><span class="keywordflow">IF</span> (<span class="keyword">ALLOCATED</span>(ztot_rs_dryg)) <span class="keyword">DEALLOCATE</span>(ztot_rs_dryg)</div>
<div class="line"><a id="l02893" name="l02893"></a><span class="lineno"> 2893</span><span class="keywordflow">IF</span> (<span class="keyword">ALLOCATED</span>(ztot_cs_dryg)) <span class="keyword">DEALLOCATE</span>(ztot_cs_dryg)</div>
<div class="line"><a id="l02894" name="l02894"></a><span class="lineno"> 2894</span><span class="keywordflow">IF</span> (<span class="keyword">ALLOCATED</span>(ztot_rg_dryg)) <span class="keyword">DEALLOCATE</span>(ztot_rg_dryg)</div>
<div class="line"><a id="l02895" name="l02895"></a><span class="lineno"> 2895</span><span class="keywordflow">IF</span> (<span class="keyword">ALLOCATED</span>(ztot_ri_hmg)) <span class="keyword">DEALLOCATE</span>(ztot_ri_hmg)</div>
<div class="line"><a id="l02896" name="l02896"></a><span class="lineno"> 2896</span><span class="keywordflow">IF</span> (<span class="keyword">ALLOCATED</span>(ztot_ci_hmg)) <span class="keyword">DEALLOCATE</span>(ztot_ci_hmg)</div>
<div class="line"><a id="l02897" name="l02897"></a><span class="lineno"> 2897</span><span class="keywordflow">IF</span> (<span class="keyword">ALLOCATED</span>(ztot_rg_hmg)) <span class="keyword">DEALLOCATE</span>(ztot_rg_hmg)</div>
<div class="line"><a id="l02898" name="l02898"></a><span class="lineno"> 2898</span><span class="keywordflow">IF</span> (<span class="keyword">ALLOCATED</span>(ztot_th_gmlt)) <span class="keyword">DEALLOCATE</span>(ztot_th_gmlt)</div>
<div class="line"><a id="l02899" name="l02899"></a><span class="lineno"> 2899</span><span class="keywordflow">IF</span> (<span class="keyword">ALLOCATED</span>(ztot_rr_gmlt)) <span class="keyword">DEALLOCATE</span>(ztot_rr_gmlt)</div>
<div class="line"><a id="l02900" name="l02900"></a><span class="lineno"> 2900</span><span class="keywordflow">IF</span> (<span class="keyword">ALLOCATED</span>(ztot_cr_gmlt)) <span class="keyword">DEALLOCATE</span>(ztot_cr_gmlt)</div>
<div class="line"><a id="l02901" name="l02901"></a><span class="lineno"> 2901</span><span class="keywordflow">IF</span> (<span class="keyword">ALLOCATED</span>(ztot_cg_gmlt)) <span class="keyword">DEALLOCATE</span>(ztot_cg_gmlt)</div>
<div class="line"><a id="l02902" name="l02902"></a><span class="lineno"> 2902</span><span class="keywordflow">IF</span> (<span class="keyword">ALLOCATED</span>(ztot_th_deph)) <span class="keyword">DEALLOCATE</span>(ztot_th_deph)</div>
<div class="line"><a id="l02903" name="l02903"></a><span class="lineno"> 2903</span><span class="keywordflow">IF</span> (<span class="keyword">ALLOCATED</span>(ztot_rh_deph)) <span class="keyword">DEALLOCATE</span>(ztot_rh_deph)</div>
<div class="line"><a id="l02904" name="l02904"></a><span class="lineno"> 2904</span><span class="keywordflow">IF</span> (<span class="keyword">ALLOCATED</span>(ztot_th_weth)) <span class="keyword">DEALLOCATE</span>(ztot_th_weth)</div>
<div class="line"><a id="l02905" name="l02905"></a><span class="lineno"> 2905</span><span class="keywordflow">IF</span> (<span class="keyword">ALLOCATED</span>(ztot_rc_weth)) <span class="keyword">DEALLOCATE</span>(ztot_rc_weth)</div>
<div class="line"><a id="l02906" name="l02906"></a><span class="lineno"> 2906</span><span class="keywordflow">IF</span> (<span class="keyword">ALLOCATED</span>(ztot_cc_weth)) <span class="keyword">DEALLOCATE</span>(ztot_cc_weth)</div>
<div class="line"><a id="l02907" name="l02907"></a><span class="lineno"> 2907</span><span class="keywordflow">IF</span> (<span class="keyword">ALLOCATED</span>(ztot_rr_weth)) <span class="keyword">DEALLOCATE</span>(ztot_rr_weth)</div>
<div class="line"><a id="l02908" name="l02908"></a><span class="lineno"> 2908</span><span class="keywordflow">IF</span> (<span class="keyword">ALLOCATED</span>(ztot_cr_weth)) <span class="keyword">DEALLOCATE</span>(ztot_cr_weth)</div>
<div class="line"><a id="l02909" name="l02909"></a><span class="lineno"> 2909</span><span class="keywordflow">IF</span> (<span class="keyword">ALLOCATED</span>(ztot_ri_weth)) <span class="keyword">DEALLOCATE</span>(ztot_ri_weth)</div>
<div class="line"><a id="l02910" name="l02910"></a><span class="lineno"> 2910</span><span class="keywordflow">IF</span> (<span class="keyword">ALLOCATED</span>(ztot_ci_weth)) <span class="keyword">DEALLOCATE</span>(ztot_ci_weth)</div>
<div class="line"><a id="l02911" name="l02911"></a><span class="lineno"> 2911</span><span class="keywordflow">IF</span> (<span class="keyword">ALLOCATED</span>(ztot_rs_weth)) <span class="keyword">DEALLOCATE</span>(ztot_rs_weth)</div>
<div class="line"><a id="l02912" name="l02912"></a><span class="lineno"> 2912</span><span class="keywordflow">IF</span> (<span class="keyword">ALLOCATED</span>(ztot_cs_weth)) <span class="keyword">DEALLOCATE</span>(ztot_cs_weth)</div>
<div class="line"><a id="l02913" name="l02913"></a><span class="lineno"> 2913</span><span class="keywordflow">IF</span> (<span class="keyword">ALLOCATED</span>(ztot_rg_weth)) <span class="keyword">DEALLOCATE</span>(ztot_rg_weth)</div>
<div class="line"><a id="l02914" name="l02914"></a><span class="lineno"> 2914</span><span class="keywordflow">IF</span> (<span class="keyword">ALLOCATED</span>(ztot_cg_weth)) <span class="keyword">DEALLOCATE</span>(ztot_cg_weth)</div>
<div class="line"><a id="l02915" name="l02915"></a><span class="lineno"> 2915</span><span class="keywordflow">IF</span> (<span class="keyword">ALLOCATED</span>(ztot_rh_weth)) <span class="keyword">DEALLOCATE</span>(ztot_rh_weth)</div>
<div class="line"><a id="l02916" name="l02916"></a><span class="lineno"> 2916</span><span class="keywordflow">IF</span> (<span class="keyword">ALLOCATED</span>(ztot_rg_cohg)) <span class="keyword">DEALLOCATE</span>(ztot_rg_cohg)</div>
<div class="line"><a id="l02917" name="l02917"></a><span class="lineno"> 2917</span><span class="keywordflow">IF</span> (<span class="keyword">ALLOCATED</span>(ztot_cg_cohg)) <span class="keyword">DEALLOCATE</span>(ztot_cg_cohg)</div>
<div class="line"><a id="l02918" name="l02918"></a><span class="lineno"> 2918</span><span class="keywordflow">IF</span> (<span class="keyword">ALLOCATED</span>(ztot_th_hmlt)) <span class="keyword">DEALLOCATE</span>(ztot_th_hmlt)</div>
<div class="line"><a id="l02919" name="l02919"></a><span class="lineno"> 2919</span><span class="keywordflow">IF</span> (<span class="keyword">ALLOCATED</span>(ztot_rr_hmlt)) <span class="keyword">DEALLOCATE</span>(ztot_rr_hmlt)</div>
<div class="line"><a id="l02920" name="l02920"></a><span class="lineno"> 2920</span><span class="keywordflow">IF</span> (<span class="keyword">ALLOCATED</span>(ztot_cr_hmlt)) <span class="keyword">DEALLOCATE</span>(ztot_cr_hmlt)</div>
<div class="line"><a id="l02921" name="l02921"></a><span class="lineno"> 2921</span><span class="keywordflow">IF</span> (<span class="keyword">ALLOCATED</span>(ztot_ch_hmlt)) <span class="keyword">DEALLOCATE</span>(ztot_ch_hmlt)</div>
<div class="line"><a id="l02922" name="l02922"></a><span class="lineno"> 2922</span><span class="keywordflow">IF</span> (<span class="keyword">ALLOCATED</span>(ztot_rr_cvrc)) <span class="keyword">DEALLOCATE</span>(ztot_rr_cvrc)</div>
<div class="line"><a id="l02923" name="l02923"></a><span class="lineno"> 2923</span><span class="keywordflow">IF</span> (<span class="keyword">ALLOCATED</span>(ztot_cr_cvrc)) <span class="keyword">DEALLOCATE</span>(ztot_cr_cvrc)</div>
<div class="line"><a id="l02924" name="l02924"></a><span class="lineno"> 2924</span><span class="keywordflow">IF</span> (<span class="keyword">ALLOCATED</span>(ztot_rv_corr2)) <span class="keyword">DEALLOCATE</span>(ztot_rv_corr2)</div>
<div class="line"><a id="l02925" name="l02925"></a><span class="lineno"> 2925</span><span class="keywordflow">IF</span> (<span class="keyword">ALLOCATED</span>(ztot_rc_corr2)) <span class="keyword">DEALLOCATE</span>(ztot_rc_corr2)</div>
<div class="line"><a id="l02926" name="l02926"></a><span class="lineno"> 2926</span><span class="keywordflow">IF</span> (<span class="keyword">ALLOCATED</span>(ztot_rr_corr2)) <span class="keyword">DEALLOCATE</span>(ztot_rr_corr2)</div>
<div class="line"><a id="l02927" name="l02927"></a><span class="lineno"> 2927</span><span class="keywordflow">IF</span> (<span class="keyword">ALLOCATED</span>(ztot_ri_corr2)) <span class="keyword">DEALLOCATE</span>(ztot_ri_corr2)</div>
<div class="line"><a id="l02928" name="l02928"></a><span class="lineno"> 2928</span><span class="keywordflow">IF</span> (<span class="keyword">ALLOCATED</span>(ztot_cc_corr2)) <span class="keyword">DEALLOCATE</span>(ztot_cc_corr2)</div>
<div class="line"><a id="l02929" name="l02929"></a><span class="lineno"> 2929</span><span class="keywordflow">IF</span> (<span class="keyword">ALLOCATED</span>(ztot_cr_corr2)) <span class="keyword">DEALLOCATE</span>(ztot_cr_corr2)</div>
<div class="line"><a id="l02930" name="l02930"></a><span class="lineno"> 2930</span><span class="keywordflow">IF</span> (<span class="keyword">ALLOCATED</span>(ztot_ci_corr2)) <span class="keyword">DEALLOCATE</span>(ztot_ci_corr2)</div>
<div class="line"><a id="l02931" name="l02931"></a><span class="lineno"> 2931</span><span class="keywordflow">IF</span> (<span class="keyword">ALLOCATED</span>(ztot_ifnn_imlt)) <span class="keyword">DEALLOCATE</span>(ztot_ifnn_imlt)</div>
<div class="line"><a id="l02932" name="l02932"></a><span class="lineno"> 2932</span><span class="keywordflow">IF</span> (<span class="keyword">ALLOCATED</span>(ztot_shci_honc)) <span class="keyword">DEALLOCATE</span>(ztot_shci_honc)</div>
<div class="line"><a id="l02933" name="l02933"></a><span class="lineno"> 2933</span><span class="keywordflow">IF</span> (<span class="keyword">ALLOCATED</span>(ztot_shci_cnvi)) <span class="keyword">DEALLOCATE</span>(ztot_shci_cnvi)</div>
<div class="line"><a id="l02934" name="l02934"></a><span class="lineno"> 2934</span><span class="keywordflow">IF</span> (<span class="keyword">ALLOCATED</span>(ztot_shci_hms)) <span class="keyword">DEALLOCATE</span>(ztot_shci_hms)</div>
<div class="line"><a id="l02935" name="l02935"></a><span class="lineno"> 2935</span><span class="keywordflow">IF</span> (<span class="keyword">ALLOCATED</span>(ztot_shci_hmg)) <span class="keyword">DEALLOCATE</span>(ztot_shci_hmg)</div>
<div class="line"><a id="l02936" name="l02936"></a><span class="lineno"> 2936</span><span class="keywordflow">IF</span> (<span class="keyword">ALLOCATED</span>(ztot_shci_cfrz)) <span class="keyword">DEALLOCATE</span>(ztot_shci_cfrz)</div>
<div class="line"><a id="l02937" name="l02937"></a><span class="lineno"> 2937</span><span class="keywordflow">IF</span> (<span class="keyword">ALLOCATED</span>(ztot_shci_cibu)) <span class="keyword">DEALLOCATE</span>(ztot_shci_cibu)</div>
<div class="line"><a id="l02938" name="l02938"></a><span class="lineno"> 2938</span><span class="keywordflow">IF</span> (<span class="keyword">ALLOCATED</span>(ztot_shci_rdsf)) <span class="keyword">DEALLOCATE</span>(ztot_shci_rdsf)</div>
<div class="line"><a id="l02939" name="l02939"></a><span class="lineno"> 2939</span><span class="keywordflow">IF</span> (<span class="keyword">ALLOCATED</span>(ztot_shci_wetg)) <span class="keyword">DEALLOCATE</span>(ztot_shci_wetg)</div>
<div class="line"><a id="l02940" name="l02940"></a><span class="lineno"> 2940</span><span class="keywordflow">IF</span> (<span class="keyword">ALLOCATED</span>(ztot_shci_dryg)) <span class="keyword">DEALLOCATE</span>(ztot_shci_dryg)</div>
<div class="line"><a id="l02941" name="l02941"></a><span class="lineno"> 2941</span><span class="keywordflow">IF</span> (<span class="keyword">ALLOCATED</span>(ztot_shci_corr2)) <span class="keyword">DEALLOCATE</span>(ztot_shci_corr2)</div>
<div class="line"><a id="l02942" name="l02942"></a><span class="lineno"> 2942</span><span class="keywordflow">IF</span> (<span class="keyword">ALLOCATED</span>(ztot_shci_imlt)) <span class="keyword">DEALLOCATE</span>(ztot_shci_imlt)</div>
<div class="line"><a id="l02943" name="l02943"></a><span class="lineno"> 2943</span><span class="keywordflow">IF</span> (<span class="keyword">ALLOCATED</span>(ztot_shci_hach)) <span class="keyword">DEALLOCATE</span>(ztot_shci_hach)</div>
<div class="line"><a id="l02944" name="l02944"></a><span class="lineno"> 2944</span><span class="keywordflow">IF</span> (<span class="keyword">ALLOCATED</span>(ztot_shci_cnvs)) <span class="keyword">DEALLOCATE</span>(ztot_shci_cnvs)</div>
<div class="line"><a id="l02945" name="l02945"></a><span class="lineno"> 2945</span><span class="keywordflow">IF</span> (<span class="keyword">ALLOCATED</span>(ztot_shci_aggs)) <span class="keyword">DEALLOCATE</span>(ztot_shci_aggs)</div>
<div class="line"><a id="l02946" name="l02946"></a><span class="lineno"> 2946</span><span class="keywordflow">IF</span> (<span class="keyword">ALLOCATED</span>(ztot_shci_isc)) <span class="keyword">DEALLOCATE</span>(ztot_shci_isc)</div>
<div class="line"><a id="l02947" name="l02947"></a><span class="lineno"> 2947</span><span class="keywordflow">IF</span> (<span class="keyword">ALLOCATED</span>(ztot_shci_iscs)) <span class="keyword">DEALLOCATE</span>(ztot_shci_iscs)</div>
<div class="line"><a id="l02948" name="l02948"></a><span class="lineno"> 2948</span><span class="keywordflow">IF</span> (<span class="keyword">ALLOCATED</span>(ztot_shri_iscs)) <span class="keyword">DEALLOCATE</span>(ztot_shri_iscs)</div>
<div class="line"><a id="l02949" name="l02949"></a><span class="lineno"> 2949</span><span class="comment">!</span></div>
<div class="line"><a id="l02950" name="l02950"></a><span class="lineno"> 2950</span><span class="keywordflow">IF</span> (lhook) <span class="keyword">CALL </span>dr_hook(<span class="stringliteral">&#39;LIMA&#39;</span>, 1, zhook_handle)</div>
<div class="line"><a id="l02951" name="l02951"></a><span class="lineno"> 2951</span><span class="keyword">END SUBROUTINE </span><a class="code hl_function" href="lima_8F90.html#a45fe64d21afbc6cace563fda83cb1e79">lima</a></div>
</div>
<div class="line"><a id="l02952" name="l02952"></a><span class="lineno"> 2952</span> </div>
<div class="ttc" id="alima_8F90_html_a45fe64d21afbc6cace563fda83cb1e79"><div class="ttname"><a href="lima_8F90.html#a45fe64d21afbc6cace563fda83cb1e79">lima</a></div><div class="ttdeci">subroutine lima(limap, limaw, limac, limam, tnsv, d, cst, nebn, iced, icep, elecd, elecp, buconf, tbudgets, hactccn, kbudgets, krr, ptstep, oelec, prhodref, pexnref, pdzz, pthvrefzikb, prhodj, ppabst, kcarb, ksoa, ksp, odust, osalt, oorilam, odthrad, pdthrad, ptht, prt, psvt, pw_nu, paero, psolorg, pmi, pths, prs, psvs, pinprc, pindep, pinprr, pinpri, pinprs, pinprg, pinprh, pevap3d, pcldfr, picefr, pprcfr, pfpr, platham_iaggs, pefieldw, psv_elec_t, psv_elec_s)</div><div class="ttdef"><b>Definition</b> <a href="lima_8F90_source.html#l00007">lima.F90:19</a></div></div>
<div class="ttc" id="anamespacemodd__budget_html"><div class="ttname"><a href="namespacemodd__budget.html">modd_budget</a></div><div class="ttdef"><b>Definition</b> <a href="modd__budget_8F90_source.html#l00002">modd_budget.F90:2</a></div></div>
<div class="ttc" id="anamespacemodd__budget_html_a032a9fef7c9e0c47fa34eae42fc05279"><div class="ttname"><a href="namespacemodd__budget.html#a032a9fef7c9e0c47fa34eae42fc05279">modd_budget::nbudget_rv</a></div><div class="ttdeci">integer, parameter nbudget_rv</div><div class="ttdef"><b>Definition</b> <a href="modd__budget_8F90_source.html#l00052">modd_budget.F90:52</a></div></div>
<div class="ttc" id="anamespacemodd__budget_html_a07dc15edaf8cd68c1036451fc7b536b9"><div class="ttname"><a href="namespacemodd__budget.html#a07dc15edaf8cd68c1036451fc7b536b9">modd_budget::nbudget_rh</a></div><div class="ttdeci">integer, parameter nbudget_rh</div><div class="ttdef"><b>Definition</b> <a href="modd__budget_8F90_source.html#l00058">modd_budget.F90:58</a></div></div>
<div class="ttc" id="anamespacemodd__budget_html_a0d120a8b4c8fb6af560c814c1d3c2c19"><div class="ttname"><a href="namespacemodd__budget.html#a0d120a8b4c8fb6af560c814c1d3c2c19">modd_budget::nbudget_th</a></div><div class="ttdeci">integer, parameter nbudget_th</div><div class="ttdef"><b>Definition</b> <a href="modd__budget_8F90_source.html#l00050">modd_budget.F90:50</a></div></div>
<div class="ttc" id="anamespacemodd__budget_html_a4e4985c2c538a46dd511258704757086"><div class="ttname"><a href="namespacemodd__budget.html#a4e4985c2c538a46dd511258704757086">modd_budget::nbudget_rs</a></div><div class="ttdeci">integer, parameter nbudget_rs</div><div class="ttdef"><b>Definition</b> <a href="modd__budget_8F90_source.html#l00056">modd_budget.F90:56</a></div></div>
<div class="ttc" id="anamespacemodd__budget_html_a4ea4532bcfa769b5ed97e4d1e68a8113"><div class="ttname"><a href="namespacemodd__budget.html#a4ea4532bcfa769b5ed97e4d1e68a8113">modd_budget::nbudget_ri</a></div><div class="ttdeci">integer, parameter nbudget_ri</div><div class="ttdef"><b>Definition</b> <a href="modd__budget_8F90_source.html#l00055">modd_budget.F90:55</a></div></div>
<div class="ttc" id="anamespacemodd__budget_html_a685847647e25e21af43ab48da13b1797"><div class="ttname"><a href="namespacemodd__budget.html#a685847647e25e21af43ab48da13b1797">modd_budget::nbudget_rc</a></div><div class="ttdeci">integer, parameter nbudget_rc</div><div class="ttdef"><b>Definition</b> <a href="modd__budget_8F90_source.html#l00053">modd_budget.F90:53</a></div></div>
<div class="ttc" id="anamespacemodd__budget_html_aab05ad1db5848733632fdbcefeb4a0a0"><div class="ttname"><a href="namespacemodd__budget.html#aab05ad1db5848733632fdbcefeb4a0a0">modd_budget::nbudget_sv1</a></div><div class="ttdeci">integer, parameter nbudget_sv1</div><div class="ttdef"><b>Definition</b> <a href="modd__budget_8F90_source.html#l00059">modd_budget.F90:59</a></div></div>
<div class="ttc" id="anamespacemodd__budget_html_aac4cd9c30fac3b66cb3078dad55fb1e2"><div class="ttname"><a href="namespacemodd__budget.html#aac4cd9c30fac3b66cb3078dad55fb1e2">modd_budget::nbudget_rr</a></div><div class="ttdeci">integer, parameter nbudget_rr</div><div class="ttdef"><b>Definition</b> <a href="modd__budget_8F90_source.html#l00054">modd_budget.F90:54</a></div></div>
<div class="ttc" id="anamespacemodd__budget_html_aef76ce44ca163871fcb14427eae825a9"><div class="ttname"><a href="namespacemodd__budget.html#aef76ce44ca163871fcb14427eae825a9">modd_budget::nbudget_rg</a></div><div class="ttdeci">integer, parameter nbudget_rg</div><div class="ttdef"><b>Definition</b> <a href="modd__budget_8F90_source.html#l00057">modd_budget.F90:57</a></div></div>
<div class="ttc" id="anamespacemodd__cst_html"><div class="ttname"><a href="namespacemodd__cst.html">modd_cst</a></div><div class="ttdef"><b>Definition</b> <a href="modd__cst_8F90_source.html#l00007">modd_cst.F90:7</a></div></div>
<div class="ttc" id="anamespacemodd__dimphyex_html"><div class="ttname"><a href="namespacemodd__dimphyex.html">modd_dimphyex</a></div><div class="ttdef"><b>Definition</b> <a href="modd__dimphyexn_8F90_source.html#l00007">modd_dimphyexn.F90:7</a></div></div>
<div class="ttc" id="anamespacemodd__elec__descr_html"><div class="ttname"><a href="namespacemodd__elec__descr.html">modd_elec_descr</a></div><div class="ttdef"><b>Definition</b> <a href="modd__elec__descr_8F90_source.html#l00007">modd_elec_descr.F90:7</a></div></div>
<div class="ttc" id="anamespacemodd__elec__param_html"><div class="ttname"><a href="namespacemodd__elec__param.html">modd_elec_param</a></div><div class="ttdef"><b>Definition</b> <a href="modd__elec__param_8F90_source.html#l00007">modd_elec_param.F90:7</a></div></div>
<div class="ttc" id="anamespacemodd__neb__n_html"><div class="ttname"><a href="namespacemodd__neb__n.html">modd_neb_n</a></div><div class="ttdef"><b>Definition</b> <a href="modd__nebn_8F90_source.html#l00006">modd_nebn.F90:6</a></div></div>
<div class="ttc" id="anamespacemodd__nsv_html"><div class="ttname"><a href="namespacemodd__nsv.html">modd_nsv</a></div><div class="ttdef"><b>Definition</b> <a href="modd__nsv_8F90_source.html#l00007">modd_nsv.F90:7</a></div></div>
<div class="ttc" id="anamespacemodd__param__lima__cold_html"><div class="ttname"><a href="namespacemodd__param__lima__cold.html">modd_param_lima_cold</a></div><div class="ttdef"><b>Definition</b> <a href="modd__param__lima__cold_8F90_source.html#l00007">modd_param_lima_cold.F90:7</a></div></div>
<div class="ttc" id="anamespacemodd__param__lima__mixed_html"><div class="ttname"><a href="namespacemodd__param__lima__mixed.html">modd_param_lima_mixed</a></div><div class="ttdef"><b>Definition</b> <a href="modd__param__lima__mixed_8F90_source.html#l00002">modd_param_lima_mixed.F90:2</a></div></div>
<div class="ttc" id="anamespacemodd__param__lima__warm_html"><div class="ttname"><a href="namespacemodd__param__lima__warm.html">modd_param_lima_warm</a></div><div class="ttdef"><b>Definition</b> <a href="modd__param__lima__warm_8F90_source.html#l00007">modd_param_lima_warm.F90:7</a></div></div>
<div class="ttc" id="anamespacemodd__param__lima_html"><div class="ttname"><a href="namespacemodd__param__lima.html">modd_param_lima</a></div><div class="ttdef"><b>Definition</b> <a href="modd__param__lima_8F90_source.html#l00007">modd_param_lima.F90:7</a></div></div>
<div class="ttc" id="anamespacemodd__rain__ice__descr__n_html"><div class="ttname"><a href="namespacemodd__rain__ice__descr__n.html">modd_rain_ice_descr_n</a></div><div class="ttdef"><b>Definition</b> <a href="modd__rain__ice__descrn_8F90_source.html#l00006">modd_rain_ice_descrn.F90:6</a></div></div>
<div class="ttc" id="anamespacemodd__rain__ice__param__n_html"><div class="ttname"><a href="namespacemodd__rain__ice__param__n.html">modd_rain_ice_param_n</a></div><div class="ttdef"><b>Definition</b> <a href="modd__rain__ice__paramn_8F90_source.html#l00006">modd_rain_ice_paramn.F90:6</a></div></div>
<div class="ttc" id="anamespacemode__budget__phy_html"><div class="ttname"><a href="namespacemode__budget__phy.html">mode_budget_phy</a></div><div class="ttdef"><b>Definition</b> <a href="mode__budget__phy_8F90_source.html#l00001">mode_budget_phy.F90:1</a></div></div>
<div class="ttc" id="anamespacemode__budget__phy_html_a45dce5bc68868ab14b72a6c987fd5d08"><div class="ttname"><a href="namespacemode__budget__phy.html#a45dce5bc68868ab14b72a6c987fd5d08">mode_budget_phy::budget_store_init_phy</a></div><div class="ttdeci">subroutine budget_store_init_phy(d, tpbudget, hsource, pvars)</div><div class="ttdef"><b>Definition</b> <a href="mode__budget__phy_8F90_source.html#l00012">mode_budget_phy.F90:13</a></div></div>
<div class="ttc" id="anamespacemode__budget__phy_html_aa498d2363e7683e361ea7dfdc83cf561"><div class="ttname"><a href="namespacemode__budget__phy.html#aa498d2363e7683e361ea7dfdc83cf561">mode_budget_phy::budget_store_add_phy</a></div><div class="ttdeci">subroutine budget_store_add_phy(d, tpbudget, hsource, pvars)</div><div class="ttdef"><b>Definition</b> <a href="mode__budget__phy_8F90_source.html#l00036">mode_budget_phy.F90:37</a></div></div>
<div class="ttc" id="anamespacemode__budget__phy_html_adb853e4fb0b59cc93057b507a52bd8ce"><div class="ttname"><a href="namespacemode__budget__phy.html#adb853e4fb0b59cc93057b507a52bd8ce">mode_budget_phy::budget_store_end_phy</a></div><div class="ttdeci">subroutine budget_store_end_phy(d, tpbudget, hsource, pvars)</div><div class="ttdef"><b>Definition</b> <a href="mode__budget__phy_8F90_source.html#l00027">mode_budget_phy.F90:28</a></div></div>
<div class="ttc" id="anamespacemode__elec__tendencies_html"><div class="ttname"><a href="namespacemode__elec__tendencies.html">mode_elec_tendencies</a></div><div class="ttdef"><b>Definition</b> <a href="mode__elec__tendencies_8F90_source.html#l00006">mode_elec_tendencies.F90:6</a></div></div>
<div class="ttc" id="anamespacemode__elec__tendencies_html_ab701b2e9e36d93e528e034f7f34d98d4"><div class="ttname"><a href="namespacemode__elec__tendencies.html#ab701b2e9e36d93e528e034f7f34d98d4">mode_elec_tendencies::elec_tendencies</a></div><div class="ttdeci">subroutine elec_tendencies(d, cst, iced, icep, elecd, elecp, krr, kmicro, ptstep, odmicro, buconf, tbudgets, kbudgets, hcloud, pthvrefzikb, prhodref, prhodj, pzt, pcit, prvt, prct, prrt, prit, prst, prgt, pqpit, pqct, pqrt, pqit, pqst, pqgt, pqnit, pqpis, pqcs, pqrs, pqis, pqss, pqgs, pqnis, prvheni, prrhong, primltc, prchoni, prvdeps, priaggs, priauts, prvdepg, prcautr, prcaccr, prrevav, prcrimss, prcrimsg, prsrimcg, prraccss, prraccsg, prsaccrg, prsmltg, pricfrrg, prrcfrig, prcwetg, priwetg, prrwetg, prswetg, prcdryg, pridryg, prrdryg, prsdryg, prgmltr, prcberi, prcmltsr, pricfrr, pcct, pcrt, pcst, pcgt, prvhenc, prchinc, prvhonh, prrcvrc, pricnvi, prvdepi, prshmsi, prghmgi, pricibu, prirdsf, prccorr2, prrcorr2, pricorr2, prwetgh, prcweth, priweth, prsweth, prgweth, prrweth, prcdryh, pridryh, prsdryh, prrdryh, prgdryh, prhmltr, prdryhg, prht, prhs, pcht, pqht, pqhs)</div><div class="ttdef"><b>Definition</b> <a href="mode__elec__tendencies_8F90_source.html#l00012">mode_elec_tendencies.F90:38</a></div></div>
<div class="ttc" id="anamespacemode__lima__compute__cloud__fractions_html"><div class="ttname"><a href="namespacemode__lima__compute__cloud__fractions.html">mode_lima_compute_cloud_fractions</a></div><div class="ttdef"><b>Definition</b> <a href="mode__lima__compute__cloud__fractions_8F90_source.html#l00006">mode_lima_compute_cloud_fractions.F90:6</a></div></div>
<div class="ttc" id="anamespacemode__lima__compute__cloud__fractions_html_ab0ef7be0a4b7adc256c4aab0a9a31e7e"><div class="ttname"><a href="namespacemode__lima__compute__cloud__fractions.html#ab0ef7be0a4b7adc256c4aab0a9a31e7e">mode_lima_compute_cloud_fractions::lima_compute_cloud_fractions</a></div><div class="ttdeci">subroutine lima_compute_cloud_fractions(limap, d, pcct, prct, pcrt, prrt, pcit, prit, pcst, prst, pcgt, prgt, pcht, prht, pcldfr, picefr, pprcfr)</div><div class="ttdef"><b>Definition</b> <a href="mode__lima__compute__cloud__fractions_8F90_source.html#l00010">mode_lima_compute_cloud_fractions.F90:18</a></div></div>
<div class="ttc" id="anamespacemode__lima__inst__procs_html"><div class="ttname"><a href="namespacemode__lima__inst__procs.html">mode_lima_inst_procs</a></div><div class="ttdef"><b>Definition</b> <a href="mode__lima__inst__procs_8F90_source.html#l00006">mode_lima_inst_procs.F90:6</a></div></div>
<div class="ttc" id="anamespacemode__lima__inst__procs_html_a6c03116b37ea1e7e88795475346cdf6c"><div class="ttname"><a href="namespacemode__lima__inst__procs.html#a6c03116b37ea1e7e88795475346cdf6c">mode_lima_inst_procs::lima_inst_procs</a></div><div class="ttdeci">subroutine lima_inst_procs(cst, limap, limaw, ksize, ptstep, odcompute, pexnref, ppabst, ptht, prvt, prct, prrt, prit, prst, prgt, pcct, pcrt, pcit, pcit_shape, pint, p_cr_brku, p_th_honr, p_rr_honr, p_cr_honr, p_th_imlt, p_rc_imlt, p_cc_imlt, p_shci_imlt, pb_th, pb_rv, pb_rc, pb_rr, pb_ri, pb_rg, pb_cc, pb_cr, pb_ci, pb_ci_shape, pb_cg, pb_ifnn, pcf1d, pif1d, ppf1d)</div><div class="ttdef"><b>Definition</b> <a href="mode__lima__inst__procs_8F90_source.html#l00010">mode_lima_inst_procs.F90:22</a></div></div>
<div class="ttc" id="anamespacemode__lima__nucleation__procs_html"><div class="ttname"><a href="namespacemode__lima__nucleation__procs.html">mode_lima_nucleation_procs</a></div><div class="ttdef"><b>Definition</b> <a href="mode__lima__nucleation__procs_8F90_source.html#l00006">mode_lima_nucleation_procs.F90:6</a></div></div>
<div class="ttc" id="anamespacemode__lima__nucleation__procs_html_a72240eeca7448319f2b8eb01e72fc9df"><div class="ttname"><a href="namespacemode__lima__nucleation__procs.html#a72240eeca7448319f2b8eb01e72fc9df">mode_lima_nucleation_procs::lima_nucleation_procs</a></div><div class="ttdeci">subroutine lima_nucleation_procs(limap, limaw, limac, tnsv, d, cst, nebn, buconf, tbudgets, kbudgets, kcarb, ksoa, ksp, odust, osalt, oorilam, ptstep, prhodj, prhodref, pexnref, ppabst, pt, pdthrad, pw_nu, ptht, prvt, prct, prrt, prit, prst, prgt, prht, pcct, pcrt, pcit, pcit_shape, paero, psolorg, pmi, hactccn, pnft, pnat, pift, pint, pnit, pnht, pcldfr, picefr, pprcfr, ptot_rv_henu, ptot_rc_hinc, ptot_ri_hind, ptot_rv_honh)</div><div class="ttdef"><b>Definition</b> <a href="mode__lima__nucleation__procs_8F90_source.html#l00010">mode_lima_nucleation_procs.F90:20</a></div></div>
<div class="ttc" id="anamespacemode__lima__sedimentation_html"><div class="ttname"><a href="namespacemode__lima__sedimentation.html">mode_lima_sedimentation</a></div><div class="ttdef"><b>Definition</b> <a href="mode__lima__sedimentation_8F90_source.html#l00006">mode_lima_sedimentation.F90:6</a></div></div>
<div class="ttc" id="anamespacemode__lima__sedimentation_html_ad5d080255221def1b9da5ec90c72ca2e"><div class="ttname"><a href="namespacemode__lima__sedimentation.html#ad5d080255221def1b9da5ec90c72ca2e">mode_lima_sedimentation::lima_sedimentation</a></div><div class="ttdeci">subroutine lima_sedimentation(limap, limaw, limac, limam, d, cst, hphase, kmoments, kid, kishape, ksplitg, ptstep, oelec, elecp, elecd, pdzz, prhodref, pthvrefzikb, ppabst, pt, prt_sum, pcpt, prs, pcs, pinpr, pfpr, pefieldw, pqs, plbdai_shape)</div><div class="ttdef"><b>Definition</b> <a href="mode__lima__sedimentation_8F90_source.html#l00010">mode_lima_sedimentation.F90:15</a></div></div>
<div class="ttc" id="anamespacemode__lima__shape__compute__lbda_html"><div class="ttname"><a href="namespacemode__lima__shape__compute__lbda.html">mode_lima_shape_compute_lbda</a></div><div class="ttdef"><b>Definition</b> <a href="mode__lima__shape__compute__lbda_8F90_source.html#l00002">mode_lima_shape_compute_lbda.F90:2</a></div></div>
<div class="ttc" id="anamespacemode__lima__shape__compute__lbda_html_a6798cc7c83b4469883cdc6a4b13cd832"><div class="ttname"><a href="namespacemode__lima__shape__compute__lbda.html#a6798cc7c83b4469883cdc6a4b13cd832">mode_lima_shape_compute_lbda::lima_shape_compute_lbda_3d</a></div><div class="ttdeci">subroutine lima_shape_compute_lbda_3d(d, limap, limac, pri, pci_shape, pri_shape, plbdai_shape)</div><div class="ttdef"><b>Definition</b> <a href="mode__lima__shape__compute__lbda_8F90_source.html#l00115">mode_lima_shape_compute_lbda.F90:117</a></div></div>
<div class="ttc" id="anamespacemode__lima__tendencies_html"><div class="ttname"><a href="namespacemode__lima__tendencies.html">mode_lima_tendencies</a></div><div class="ttdef"><b>Definition</b> <a href="mode__lima__tendencies_8F90_source.html#l00006">mode_lima_tendencies.F90:6</a></div></div>
<div class="ttc" id="anamespacemode__lima__tendencies_html_acefa2d69ebd2194440988a2afd517425"><div class="ttname"><a href="namespacemode__lima__tendencies.html#acefa2d69ebd2194440988a2afd517425">mode_lima_tendencies::lima_tendencies</a></div><div class="ttdeci">subroutine lima_tendencies(cst, limap, limaw, limac, limam, ksize, ptstep, odcompute, pexnref, prhodref, ppabst, ptht, prvt, prct, prrt, prit, prst, prgt, prht, pcct, pcrt, pcit, pcit_shape, pcst, pcgt, pcht, p_th_honc, p_rc_honc, p_cc_honc, p_shci_honc, p_cc_self, p_rc_auto, p_cc_auto, p_cr_auto, p_rc_accr, p_cc_accr, p_cr_scbu, p_th_evap, p_rr_evap, p_cr_evap, p_ri_cnvi, p_ci_cnvi, p_shci_cnvi, p_th_deps, p_rs_deps, p_th_depi, p_ri_depi, p_shci_hach, p_ri_cnvs, p_ci_cnvs, p_shci_cnvs, p_cs_ssc, p_ci_isc, p_shci_isc, p_shri_iscs, p_shci_iscs, p_ri_aggs, p_ci_aggs, p_shci_aggs, p_th_depg, p_rg_depg, p_th_berfi, p_rc_berfi, p_th_rim, p_cc_rim, p_cs_rim, p_rc_rimss, p_rc_rimsg, p_rs_rimcg, p_ri_hms, p_ci_hms, p_rs_hms, p_shci_hms, p_th_acc, p_cr_acc, p_cs_acc, p_rr_accss, p_rr_accsg, p_rs_accrg, p_rs_cmel, p_cs_cmel, p_th_cfrz, p_rr_cfrz, p_cr_cfrz, p_ri_cfrz, p_ci_cfrz, p_shci_cfrz, p_ri_cibu, p_ci_cibu, p_shci_cibu, p_ri_rdsf, p_ci_rdsf, p_shci_rdsf, p_th_wetg, p_rc_wetg, p_cc_wetg, p_rr_wetg, p_cr_wetg, p_ri_wetg, p_ci_wetg, p_rs_wetg, p_cs_wetg, p_rg_wetg, p_cg_wetg, p_rh_wetg, p_shci_wetg, p_th_dryg, p_rc_dryg, p_cc_dryg, p_rr_dryg, p_cr_dryg, p_ri_dryg, p_ci_dryg, p_rs_dryg, p_cs_dryg, p_rg_dryg, p_shci_dryg, p_ri_hmg, p_ci_hmg, p_rg_hmg, p_shci_hmg, p_th_gmlt, p_rr_gmlt, p_cr_gmlt, p_cg_gmlt, p_th_deph, p_rh_deph, p_th_weth, p_rc_weth, p_cc_weth, p_rr_weth, p_cr_weth, p_ri_weth, p_ci_weth, p_rs_weth, p_cs_weth, p_rg_weth, p_cg_weth, p_rh_weth, p_rg_cohg, p_cg_cohg, p_th_hmlt, p_rr_hmlt, p_cr_hmlt, p_ch_hmlt, pa_th, pa_rv, pa_rc, pa_cc, pa_rr, pa_cr, pa_ri, pa_ci, pa_ci_shape, pa_rs, pa_cs, pa_rg, pa_cg, pa_rh, pa_ch, pevap3d, pcf1d, pif1d, ppf1d, platham_iaggs)</div><div class="ttdef"><b>Definition</b> <a href="mode__lima__tendencies_8F90_source.html#l00010">mode_lima_tendencies.F90:53</a></div></div>
<div class="ttc" id="astructmodd__budget_1_1tbudgetconf__t_html"><div class="ttname"><a href="structmodd__budget_1_1tbudgetconf__t.html">modd_budget::tbudgetconf_t</a></div><div class="ttdef"><b>Definition</b> <a href="modd__budget_8F90_source.html#l00065">modd_budget.F90:65</a></div></div>
<div class="ttc" id="astructmodd__budget_1_1tbudgetdata_html"><div class="ttname"><a href="structmodd__budget_1_1tbudgetdata.html">modd_budget::tbudgetdata</a></div><div class="ttdef"><b>Definition</b> <a href="modd__budget_8F90_source.html#l00061">modd_budget.F90:61</a></div></div>
<div class="ttc" id="astructmodd__cst_1_1cst__t_html"><div class="ttname"><a href="structmodd__cst_1_1cst__t.html">modd_cst::cst_t</a></div><div class="ttdef"><b>Definition</b> <a href="modd__cst_8F90_source.html#l00053">modd_cst.F90:53</a></div></div>
<div class="ttc" id="astructmodd__dimphyex_1_1dimphyex__t_html"><div class="ttname"><a href="structmodd__dimphyex_1_1dimphyex__t.html">modd_dimphyex::dimphyex_t</a></div><div class="ttdef"><b>Definition</b> <a href="modd__dimphyexn_8F90_source.html#l00038">modd_dimphyexn.F90:38</a></div></div>
<div class="ttc" id="astructmodd__elec__descr_1_1elec__descr__t_html"><div class="ttname"><a href="structmodd__elec__descr_1_1elec__descr__t.html">modd_elec_descr::elec_descr_t</a></div><div class="ttdef"><b>Definition</b> <a href="modd__elec__descr_8F90_source.html#l00160">modd_elec_descr.F90:160</a></div></div>
<div class="ttc" id="astructmodd__elec__param_1_1elec__param__t_html"><div class="ttname"><a href="structmodd__elec__param_1_1elec__param__t.html">modd_elec_param::elec_param_t</a></div><div class="ttdef"><b>Definition</b> <a href="modd__elec__param_8F90_source.html#l00164">modd_elec_param.F90:164</a></div></div>
<div class="ttc" id="astructmodd__neb__n_1_1neb__t_html"><div class="ttname"><a href="structmodd__neb__n_1_1neb__t.html">modd_neb_n::neb_t</a></div><div class="ttdef"><b>Definition</b> <a href="modd__nebn_8F90_source.html#l00040">modd_nebn.F90:40</a></div></div>
<div class="ttc" id="astructmodd__nsv_1_1nsv__t_html"><div class="ttname"><a href="structmodd__nsv_1_1nsv__t.html">modd_nsv::nsv_t</a></div><div class="ttdef"><b>Definition</b> <a href="modd__nsv_8F90_source.html#l00048">modd_nsv.F90:48</a></div></div>
<div class="ttc" id="astructmodd__param__lima_1_1param__lima__t_html"><div class="ttname"><a href="structmodd__param__lima_1_1param__lima__t.html">modd_param_lima::param_lima_t</a></div><div class="ttdef"><b>Definition</b> <a href="modd__param__lima_8F90_source.html#l00042">modd_param_lima.F90:42</a></div></div>
<div class="ttc" id="astructmodd__param__lima__cold_1_1param__lima__cold__t_html"><div class="ttname"><a href="structmodd__param__lima__cold_1_1param__lima__cold__t.html">modd_param_lima_cold::param_lima_cold_t</a></div><div class="ttdef"><b>Definition</b> <a href="modd__param__lima__cold_8F90_source.html#l00050">modd_param_lima_cold.F90:50</a></div></div>
<div class="ttc" id="astructmodd__param__lima__mixed_1_1param__lima__mixed__t_html"><div class="ttname"><a href="structmodd__param__lima__mixed_1_1param__lima__mixed__t.html">modd_param_lima_mixed::param_lima_mixed_t</a></div><div class="ttdef"><b>Definition</b> <a href="modd__param__lima__mixed_8F90_source.html#l00024">modd_param_lima_mixed.F90:24</a></div></div>
<div class="ttc" id="astructmodd__param__lima__warm_1_1param__lima__warm__t_html"><div class="ttname"><a href="structmodd__param__lima__warm_1_1param__lima__warm__t.html">modd_param_lima_warm::param_lima_warm_t</a></div><div class="ttdef"><b>Definition</b> <a href="modd__param__lima__warm_8F90_source.html#l00031">modd_param_lima_warm.F90:31</a></div></div>
<div class="ttc" id="astructmodd__rain__ice__descr__n_1_1rain__ice__descr__t_html"><div class="ttname"><a href="structmodd__rain__ice__descr__n_1_1rain__ice__descr__t.html">modd_rain_ice_descr_n::rain_ice_descr_t</a></div><div class="ttdef"><b>Definition</b> <a href="modd__rain__ice__descrn_8F90_source.html#l00057">modd_rain_ice_descrn.F90:57</a></div></div>
<div class="ttc" id="astructmodd__rain__ice__param__n_1_1rain__ice__param__t_html"><div class="ttname"><a href="structmodd__rain__ice__param__n_1_1rain__ice__param__t.html">modd_rain_ice_param_n::rain_ice_param_t</a></div><div class="ttdef"><b>Definition</b> <a href="modd__rain__ice__paramn_8F90_source.html#l00045">modd_rain_ice_paramn.F90:45</a></div></div>
</div><!-- fragment --></div><!-- contents -->
<!-- start footer part -->
<hr class="footer"/><address class="footer"><small>
Generated by&#160;<a href="https://www.doxygen.org/index.html"><img class="footer" src="doxygen.svg" width="104" height="31" alt="doxygen"/></a> 1.9.8
</small></address>
</body>
</html>
