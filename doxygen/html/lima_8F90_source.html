<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "https://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
<head>
<meta http-equiv="Content-Type" content="text/xhtml;charset=UTF-8"/>
<meta http-equiv="X-UA-Compatible" content="IE=9"/>
<meta name="generator" content="Doxygen 1.9.1"/>
<meta name="viewport" content="width=device-width, initial-scale=1"/>
<title>PHYEX: /home/runner/work/PHYEX/PHYEX/src/common/micro/lima.F90 Source File</title>
<link href="tabs.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="jquery.js"></script>
<script type="text/javascript" src="dynsections.js"></script>
<link href="search/search.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="search/searchdata.js"></script>
<script type="text/javascript" src="search/search.js"></script>
<link href="doxygen.css" rel="stylesheet" type="text/css" />
</head>
<body>
<div id="top"><!-- do not remove this div, it is closed by doxygen! -->
<div id="titlearea">
<table cellspacing="0" cellpadding="0">
 <tbody>
 <tr style="height: 56px;">
  <td id="projectalign" style="padding-left: 0.5em;">
   <div id="projectname">PHYEX
   </div>
   <div id="projectbrief">PHYsique EXternalisée</div>
  </td>
 </tr>
 </tbody>
</table>
</div>
<!-- end header part -->
<!-- Generated by Doxygen 1.9.1 -->
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:cf05388f2679ee054f2beb29a391d25f4e673ac3&amp;dn=gpl-2.0.txt GPL-v2 */
var searchBox = new SearchBox("searchBox", "search",false,'Search','.html');
/* @license-end */
</script>
<script type="text/javascript" src="menudata.js"></script>
<script type="text/javascript" src="menu.js"></script>
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:cf05388f2679ee054f2beb29a391d25f4e673ac3&amp;dn=gpl-2.0.txt GPL-v2 */
$(function() {
  initMenu('',true,false,'search.php','Search');
  $(document).ready(function() { init_search(); });
});
/* @license-end */</script>
<div id="main-nav"></div>
<!-- window showing the filter options -->
<div id="MSearchSelectWindow"
     onmouseover="return searchBox.OnSearchSelectShow()"
     onmouseout="return searchBox.OnSearchSelectHide()"
     onkeydown="return searchBox.OnSearchSelectKey(event)">
</div>

<!-- iframe showing the search results (closed by default) -->
<div id="MSearchResultsWindow">
<iframe src="javascript:void(0)" frameborder="0" 
        name="MSearchResults" id="MSearchResults">
</iframe>
</div>

<div id="nav-path" class="navpath">
  <ul>
<li class="navelem"><a class="el" href="dir_68267d1309a1af8e8297ef4c3efbcdba.html">src</a></li><li class="navelem"><a class="el" href="dir_fdedb0aba14d44ce9d99bc100e026e6a.html">common</a></li><li class="navelem"><a class="el" href="dir_c5d5b95b88135def9ba8c8b29e8b7b93.html">micro</a></li>  </ul>
</div>
</div><!-- top -->
<div class="header">
  <div class="headertitle">
<div class="title">lima.F90</div>  </div>
</div><!--header-->
<div class="contents">
<a href="lima_8F90.html">Go to the documentation of this file.</a><div class="fragment"><div class="line"><a name="l00001"></a><span class="lineno">    1</span>&#160;<span class="comment">!MNH_LIC Copyright 2013-2021 CNRS, Meteo-France and Universite Paul Sabatier</span></div>
<div class="line"><a name="l00002"></a><span class="lineno">    2</span>&#160;<span class="comment">!MNH_LIC This is part of the Meso-NH software governed by the CeCILL-C licence</span></div>
<div class="line"><a name="l00003"></a><span class="lineno">    3</span>&#160;<span class="comment">!MNH_LIC version 1. See LICENSE, CeCILL-C_V1-en.txt and CeCILL-C_V1-fr.txt</span></div>
<div class="line"><a name="l00004"></a><span class="lineno">    4</span>&#160;<span class="comment">!MNH_LIC for details. version 1.</span></div>
<div class="line"><a name="l00005"></a><span class="lineno">    5</span>&#160;<span class="comment">!-----------------------------------------------------------------</span></div>
<div class="line"><a name="l00006"></a><span class="lineno">    6</span>&#160;<span class="comment">!     #####################################################################</span></div>
<div class="line"><a name="l00007"></a><span class="lineno"><a class="line" href="lima_8F90.html#a2fc9b9d056ed2dbe01597d9f1d42ae4d">    7</a></span>&#160;<span class="keyword">SUBROUTINE </span><a class="code" href="lima_8F90.html#a2fc9b9d056ed2dbe01597d9f1d42ae4d">lima</a> ( D, CST, ICED, ICEP, ELECD, ELECP,BUCONF, TBUDGETS, KBUDGETS,&amp;</div>
<div class="line"><a name="l00008"></a><span class="lineno">    8</span>&#160;                  PTSTEP, OELEC,                                          &amp;</div>
<div class="line"><a name="l00009"></a><span class="lineno">    9</span>&#160;                  PRHODREF, PEXNREF, PDZZ,PTHVREFZIKB,                    &amp;</div>
<div class="line"><a name="l00010"></a><span class="lineno">   10</span>&#160;                  PRHODJ, PPABST,                                         &amp;</div>
<div class="line"><a name="l00011"></a><span class="lineno">   11</span>&#160;                  NCCN, NIFN, NIMM,                                       &amp;</div>
<div class="line"><a name="l00012"></a><span class="lineno">   12</span>&#160;                  PDTHRAD, PTHT, PRT, PSVT, PW_NU,                        &amp;</div>
<div class="line"><a name="l00013"></a><span class="lineno">   13</span>&#160;                  PTHS, PRS, PSVS,                                        &amp;</div>
<div class="line"><a name="l00014"></a><span class="lineno">   14</span>&#160;                  PINPRC, PINDEP, PINPRR, PINPRI, PINPRS, PINPRG, PINPRH, &amp;</div>
<div class="line"><a name="l00015"></a><span class="lineno">   15</span>&#160;                  PEVAP3D, PCLDFR, PICEFR, PPRCFR, PFPR,                  &amp;</div>
<div class="line"><a name="l00016"></a><span class="lineno">   16</span>&#160;                  PLATHAM_IAGGS, PEFIELDW, PSV_ELEC_T, PSV_ELEC_S         )</div>
<div class="line"><a name="l00017"></a><span class="lineno">   17</span>&#160;<span class="comment">!     #####################################################################</span></div>
<div class="line"><a name="l00018"></a><span class="lineno">   18</span>&#160;<span class="comment">!</span></div>
<div class="line"><a name="l00019"></a><span class="lineno">   19</span>&#160;<span class="comment">!!    PURPOSE</span></div>
<div class="line"><a name="l00020"></a><span class="lineno">   20</span>&#160;<span class="comment">!!    -------</span></div>
<div class="line"><a name="l00021"></a><span class="lineno">   21</span>&#160;<span class="comment">!!      Compute explicit microphysical sources using the 2-moment scheme LIMA     </span></div>
<div class="line"><a name="l00022"></a><span class="lineno">   22</span>&#160;<span class="comment">!!    using the time-splitting method</span></div>
<div class="line"><a name="l00023"></a><span class="lineno">   23</span>&#160;<span class="comment">!!</span></div>
<div class="line"><a name="l00024"></a><span class="lineno">   24</span>&#160;<span class="comment">!!    REFERENCE</span></div>
<div class="line"><a name="l00025"></a><span class="lineno">   25</span>&#160;<span class="comment">!!    ---------</span></div>
<div class="line"><a name="l00026"></a><span class="lineno">   26</span>&#160;<span class="comment">!!      Vié et al. (GMD, 2016)</span></div>
<div class="line"><a name="l00027"></a><span class="lineno">   27</span>&#160;<span class="comment">!!      Meso-NH scientific documentation</span></div>
<div class="line"><a name="l00028"></a><span class="lineno">   28</span>&#160;<span class="comment">!!</span></div>
<div class="line"><a name="l00029"></a><span class="lineno">   29</span>&#160;<span class="comment">!!    AUTHOR</span></div>
<div class="line"><a name="l00030"></a><span class="lineno">   30</span>&#160;<span class="comment">!!    ------</span></div>
<div class="line"><a name="l00031"></a><span class="lineno">   31</span>&#160;<span class="comment">!!      S. Riette  * CNRM *</span></div>
<div class="line"><a name="l00032"></a><span class="lineno">   32</span>&#160;<span class="comment">!!      B. Vié     * CNRM *</span></div>
<div class="line"><a name="l00033"></a><span class="lineno">   33</span>&#160;<span class="comment">!!</span></div>
<div class="line"><a name="l00034"></a><span class="lineno">   34</span>&#160;<span class="comment">!!    MODIFICATIONS</span></div>
<div class="line"><a name="l00035"></a><span class="lineno">   35</span>&#160;<span class="comment">!!    -------------</span></div>
<div class="line"><a name="l00036"></a><span class="lineno">   36</span>&#160;<span class="comment">!!      Original   15/03/2018</span></div>
<div class="line"><a name="l00037"></a><span class="lineno">   37</span>&#160;<span class="comment">!!</span></div>
<div class="line"><a name="l00038"></a><span class="lineno">   38</span>&#160;<span class="comment">!  B. Vie         02/2019: minor correction on budget</span></div>
<div class="line"><a name="l00039"></a><span class="lineno">   39</span>&#160;<span class="comment">!  P. Wautelet    02/2020: use the new data structures and subroutines for budgets (no more budget calls in this subroutine)</span></div>
<div class="line"><a name="l00040"></a><span class="lineno">   40</span>&#160;<span class="comment">!  P. Wautelet 26/02/2020: bugfix: corrected condition to write budget CORR_BU_RRS</span></div>
<div class="line"><a name="l00041"></a><span class="lineno">   41</span>&#160;<span class="comment">!  B. Vie      03/03/2020: use DTHRAD instead of dT/dt in Smax diagnostic computation</span></div>
<div class="line"><a name="l00042"></a><span class="lineno">   42</span>&#160;<span class="comment">!  P. Wautelet 28/05/2020: bugfix: correct array start for PSVT and PSVS</span></div>
<div class="line"><a name="l00043"></a><span class="lineno">   43</span>&#160;<span class="comment">!  P. Wautelet 03/02/2021: budgets: add new source if LIMA splitting: CORR2</span></div>
<div class="line"><a name="l00044"></a><span class="lineno">   44</span>&#160;<span class="comment">!  B. Vie         06/2021: add subgrid condensation with LIMA</span></div>
<div class="line"><a name="l00045"></a><span class="lineno">   45</span>&#160;<span class="comment">!  C. Barthe      04/2022: add cloud electrification</span></div>
<div class="line"><a name="l00046"></a><span class="lineno">   46</span>&#160;<span class="comment">!  C. Barthe      03/2023: add CIBU, RDSF and 2 moments for s, g and h in cloud electrification</span></div>
<div class="line"><a name="l00047"></a><span class="lineno">   47</span>&#160;<span class="comment">!</span></div>
<div class="line"><a name="l00048"></a><span class="lineno">   48</span>&#160;<span class="comment">!-----------------------------------------------------------------</span></div>
<div class="line"><a name="l00049"></a><span class="lineno">   49</span>&#160;<span class="comment">!</span></div>
<div class="line"><a name="l00050"></a><span class="lineno">   50</span>&#160;<span class="comment">!*       0.    DECLARATIONS</span></div>
<div class="line"><a name="l00051"></a><span class="lineno">   51</span>&#160;<span class="comment">!              ------------</span></div>
<div class="line"><a name="l00052"></a><span class="lineno">   52</span>&#160;<span class="keywordtype">USE </span><a class="code" href="namespacemodd__dimphyex.html">modd_dimphyex</a>,        <span class="keywordtype">ONLY</span>: <a class="code" href="structmodd__dimphyex_1_1dimphyex__t.html">dimphyex_t</a></div>
<div class="line"><a name="l00053"></a><span class="lineno">   53</span>&#160;<span class="keywordtype">USE </span><a class="code" href="namespacemodd__rain__ice__descr__n.html">modd_rain_ice_descr_n</a>,<span class="keywordtype">ONLY</span>: <a class="code" href="structmodd__rain__ice__descr__n_1_1rain__ice__descr__t.html">rain_ice_descr_t</a></div>
<div class="line"><a name="l00054"></a><span class="lineno">   54</span>&#160;<span class="keywordtype">USE </span><a class="code" href="namespacemodd__rain__ice__param__n.html">modd_rain_ice_param_n</a>,<span class="keywordtype">ONLY</span>: <a class="code" href="structmodd__rain__ice__param__n_1_1rain__ice__param__t.html">rain_ice_param_t</a></div>
<div class="line"><a name="l00055"></a><span class="lineno">   55</span>&#160;<span class="keywordtype">USE </span><a class="code" href="namespacemodd__elec__param.html">modd_elec_param</a>,      <span class="keywordtype">ONLY</span>: <a class="code" href="structmodd__elec__param_1_1elec__param__t.html">elec_param_t</a></div>
<div class="line"><a name="l00056"></a><span class="lineno">   56</span>&#160;<span class="keywordtype">USE </span><a class="code" href="namespacemodd__elec__descr.html">modd_elec_descr</a>,      <span class="keywordtype">ONLY</span>: <a class="code" href="structmodd__elec__descr_1_1elec__descr__t.html">elec_descr_t</a></div>
<div class="line"><a name="l00057"></a><span class="lineno">   57</span>&#160;<span class="keywordtype">USE </span><a class="code" href="namespacemodd__budget.html">modd_budget</a>,          <span class="keywordtype">ONLY</span>: <a class="code" href="structmodd__budget_1_1tbudgetdata.html">tbudgetdata</a>, <a class="code" href="structmodd__budget_1_1tbudgetconf__t.html">tbudgetconf_t</a>, <a class="code" href="namespacemodd__budget.html#a0d120a8b4c8fb6af560c814c1d3c2c19">nbudget_th</a>, <a class="code" href="namespacemodd__budget.html#a032a9fef7c9e0c47fa34eae42fc05279">nbudget_rv</a>, <a class="code" href="namespacemodd__budget.html#a685847647e25e21af43ab48da13b1797">nbudget_rc</a>, &amp;</div>
<div class="line"><a name="l00058"></a><span class="lineno">   58</span>&#160;                                <a class="code" href="namespacemodd__budget.html#a4ea4532bcfa769b5ed97e4d1e68a8113">nbudget_ri</a>, <a class="code" href="namespacemodd__budget.html#aac4cd9c30fac3b66cb3078dad55fb1e2">nbudget_rr</a>, <a class="code" href="namespacemodd__budget.html#a4e4985c2c538a46dd511258704757086">nbudget_rs</a>, <a class="code" href="namespacemodd__budget.html#aef76ce44ca163871fcb14427eae825a9">nbudget_rg</a>, <a class="code" href="namespacemodd__budget.html#a07dc15edaf8cd68c1036451fc7b536b9">nbudget_rh</a>, <a class="code" href="namespacemodd__budget.html#aab05ad1db5848733632fdbcefeb4a0a0">nbudget_sv1</a></div>
<div class="line"><a name="l00059"></a><span class="lineno">   59</span>&#160;<span class="keywordtype">USE </span><a class="code" href="namespacemodd__cst.html">modd_cst</a>,             <span class="keywordtype">ONLY</span>: <a class="code" href="structmodd__cst_1_1cst__t.html">cst_t</a></div>
<div class="line"><a name="l00060"></a><span class="lineno">   60</span>&#160;<span class="keywordtype">USE </span><a class="code" href="namespacemodd__nsv.html">modd_nsv</a>,             <span class="keywordtype">ONLY</span>: <a class="code" href="namespacemodd__nsv.html#a40a6809489f33d2332c09e3cdf634f64">nsv_lima_nc</a>, <a class="code" href="namespacemodd__nsv.html#a0f254b896adb763119f451ed055d2463">nsv_lima_nr</a>, <a class="code" href="namespacemodd__nsv.html#a6893062dccf1eaf4b3c7176ed79bf69c">nsv_lima_ccn_free</a>, <a class="code" href="namespacemodd__nsv.html#a2716603ec6e0fb69695c2b3e0e166e6f">nsv_lima_ccn_acti</a>, &amp;</div>
<div class="line"><a name="l00061"></a><span class="lineno">   61</span>&#160;                                <a class="code" href="namespacemodd__nsv.html#a42ef78d1d5be64b40c0969a07598e268">nsv_lima_ni</a>, <a class="code" href="namespacemodd__nsv.html#a88f9a0bd54e36147cedeb35da2648aac">nsv_lima_ns</a>, <a class="code" href="namespacemodd__nsv.html#a822424cae100267f4e55c551af04dae9">nsv_lima_ng</a>, <a class="code" href="namespacemodd__nsv.html#aee0d9e88c097894c400536f6199a19c3">nsv_lima_nh</a>,             &amp;</div>
<div class="line"><a name="l00062"></a><span class="lineno">   62</span>&#160;                                <a class="code" href="namespacemodd__nsv.html#a5608d5ba016412097d360f6598df7811">nsv_lima_ifn_free</a>, <a class="code" href="namespacemodd__nsv.html#a519df160018b4cf7fe248a758edba5b9">nsv_lima_ifn_nucl</a>, <a class="code" href="namespacemodd__nsv.html#ae44e7d7392e3e216eefb2dc5e11be202">nsv_lima_imm_nucl</a>, <a class="code" href="namespacemodd__nsv.html#a9ac00e065d57a5a8d3a6ba7565274e98">nsv_lima_hom_haze</a>, &amp;</div>
<div class="line"><a name="l00063"></a><span class="lineno">   63</span>&#160;                                <a class="code" href="namespacemodd__nsv.html#a8c00f36702d1825185256967b62b74fa">nsv_lima_beg</a>, <a class="code" href="namespacemodd__nsv.html#a864b10357f60be51dc3ecd1ffad90ccf">nsv_elecbeg</a></div>
<div class="line"><a name="l00064"></a><span class="lineno">   64</span>&#160;<span class="keywordtype">USE </span><a class="code" href="namespacemodd__param__lima.html">modd_param_lima</a>,      <span class="keywordtype">ONLY</span>: <a class="code" href="namespacemodd__param__lima.html#a19683462cda57db522fcb0b8988b8d27">nmod_ccn</a>, <a class="code" href="namespacemodd__param__lima.html#a2b98a3f23053acfd971d523a0778f209">nmod_ifn</a>, <a class="code" href="namespacemodd__param__lima.html#a773a34608ac83913168a35ea1a39332a">nmod_imm</a>, <a class="code" href="namespacemodd__param__lima.html#a0b11d7560a8fc0aa79bb054ab51fea88">lhhoni</a>,      &amp;</div>
<div class="line"><a name="l00065"></a><span class="lineno">   65</span>&#160;                                <a class="code" href="namespacemodd__param__lima.html#a26311f544ad0754b05441ca002035b5e">lfeedbackt</a>, <a class="code" href="namespacemodd__param__lima.html#a95606fe7b31187a9c1e64d68309835b9">nmaxiter</a>, <a class="code" href="namespacemodd__param__lima.html#ac8bffc7c7ac478bc8ec56c0d66c22ca6">xmrstep</a>, <a class="code" href="namespacemodd__param__lima.html#aaad997be2c66fe3610699ba4c79f46f4">xtstep_ts</a>,               &amp;</div>
<div class="line"><a name="l00066"></a><span class="lineno">   66</span>&#160;                                <a class="code" href="namespacemodd__param__lima.html#a06ed3012b0f8fd4872b87c1b4207600b">lsedc</a>, <a class="code" href="namespacemodd__param__lima.html#a5ba3388c0be2ffe78c0b41f36f8002a9">lsedi</a>, <a class="code" href="namespacemodd__param__lima.html#aefc493a9b25fa3023153181d64911a68">xrtmin</a>, <a class="code" href="namespacemodd__param__lima.html#a4c82daf9a772a83a3f85b392b0ec8ca1">xctmin</a>, <a class="code" href="namespacemodd__param__lima.html#af6ffb8236514eaf51d5b82367c6dec79">ldepoc</a>, <a class="code" href="namespacemodd__param__lima.html#a67bee94fe370e1412c94db0e58b0b06a">xvdepoc</a>,                  &amp;</div>
<div class="line"><a name="l00067"></a><span class="lineno">   67</span>&#160;                                <a class="code" href="namespacemodd__param__lima.html#ab0c8298b017b75cbd419d8b1980b0053">nmom_c</a>, <a class="code" href="namespacemodd__param__lima.html#a7accc5c4a0a391c040a1de5e966eea04">nmom_r</a>, <a class="code" href="namespacemodd__param__lima.html#ab11c5caa054b5039171a4f10908abea1">nmom_i</a>, <a class="code" href="namespacemodd__param__lima.html#a63b4f80fe043e01602ef78b2caf0e487">nmom_s</a>, <a class="code" href="namespacemodd__param__lima.html#acd76d6876dec7668fc081a4380690182">nmom_g</a>, <a class="code" href="namespacemodd__param__lima.html#a8a40a50a7778130438208e2974634384">nmom_h</a></div>
<div class="line"><a name="l00068"></a><span class="lineno">   68</span>&#160; </div>
<div class="line"><a name="l00069"></a><span class="lineno">   69</span>&#160;<span class="keywordtype">USE </span><a class="code" href="namespacemode__budget__phy.html">mode_budget_phy</a>,      <span class="keywordtype">ONLY</span>: <a class="code" href="namespacemode__budget__phy.html#a865df6090077e33576dd3b4866709b87">budget_store_add_phy</a>, <a class="code" href="namespacemode__budget__phy.html#a618f66dd5a60cc85cb7470daae98cc3e">budget_store_init_phy</a>, <a class="code" href="namespacemode__budget__phy.html#a9a2b3c894fd97b1caeef3dc8c7049411">budget_store_end_phy</a></div>
<div class="line"><a name="l00070"></a><span class="lineno">   70</span>&#160;<span class="keywordtype">use </span><a class="code" href="namespacemode__tools.html">mode_tools</a>,           <span class="keywordtype">only</span>: countjv</div>
<div class="line"><a name="l00071"></a><span class="lineno">   71</span>&#160; </div>
<div class="line"><a name="l00072"></a><span class="lineno">   72</span>&#160;<span class="keywordtype">USE </span><a class="code" href="namespacemode__lima__compute__cloud__fractions.html">mode_lima_compute_cloud_fractions</a>, <span class="keywordtype">ONLY</span>: <a class="code" href="namespacemode__lima__compute__cloud__fractions.html#a9b4b0f198611ec0fcdb7ba57060bec04">lima_compute_cloud_fractions</a></div>
<div class="line"><a name="l00073"></a><span class="lineno">   73</span>&#160; </div>
<div class="line"><a name="l00074"></a><span class="lineno">   74</span>&#160;<span class="keywordtype">USE </span><a class="code" href="namespacemode__lima__inst__procs.html">mode_lima_inst_procs</a>, <span class="keywordtype">ONLY</span>: <a class="code" href="namespacemode__lima__inst__procs.html#ad1cb4d142928d7af0554b9d16b3bf80a">lima_inst_procs</a></div>
<div class="line"><a name="l00075"></a><span class="lineno">   75</span>&#160;<span class="keywordtype">USE </span><a class="code" href="namespacemode__lima__nucleation__procs.html">mode_lima_nucleation_procs</a>, <span class="keywordtype">ONLY</span>: <a class="code" href="namespacemode__lima__nucleation__procs.html#a5b69aa75f91239168e58d5081abd4d7e">lima_nucleation_procs</a></div>
<div class="line"><a name="l00076"></a><span class="lineno">   76</span>&#160;<span class="keywordtype">USE </span><a class="code" href="namespacemode__lima__sedimentation.html">mode_lima_sedimentation</a>, <span class="keywordtype">ONLY</span>: <a class="code" href="namespacemode__lima__sedimentation.html#a964e14d529764f1a85ca486687463413">lima_sedimentation</a></div>
<div class="line"><a name="l00077"></a><span class="lineno">   77</span>&#160;<span class="keywordtype">USE </span><a class="code" href="namespacemode__lima__tendencies.html">mode_lima_tendencies</a>, <span class="keywordtype">ONLY</span>: <a class="code" href="namespacemode__lima__tendencies.html#ad5cd63b41ca201209913ffcf730450f6">lima_tendencies</a></div>
<div class="line"><a name="l00078"></a><span class="lineno">   78</span>&#160;<span class="comment">!</span></div>
<div class="line"><a name="l00079"></a><span class="lineno">   79</span>&#160;<span class="keywordtype">USE </span><a class="code" href="namespacemode__elec__tendencies.html">mode_elec_tendencies</a>, <span class="keywordtype">ONLY</span> : <a class="code" href="namespacemode__elec__tendencies.html#a7b9c94cea6e8bcbfca43adef1031fb44">elec_tendencies</a></div>
<div class="line"><a name="l00080"></a><span class="lineno">   80</span>&#160;<span class="comment">!</span></div>
<div class="line"><a name="l00081"></a><span class="lineno">   81</span>&#160;<span class="keywordtype">IMPLICIT NONE</span></div>
<div class="line"><a name="l00082"></a><span class="lineno">   82</span>&#160;<span class="comment">!</span></div>
<div class="line"><a name="l00083"></a><span class="lineno">   83</span>&#160;<span class="comment">!*       0.1   Declarations of dummy arguments :</span></div>
<div class="line"><a name="l00084"></a><span class="lineno">   84</span>&#160;<span class="comment">!</span></div>
<div class="line"><a name="l00085"></a><span class="lineno">   85</span>&#160;<span class="keywordtype">TYPE</span>(<a class="code" href="structmodd__dimphyex_1_1dimphyex__t.html">dimphyex_t</a>),         <span class="keywordtype">INTENT(IN)</span>    :: D</div>
<div class="line"><a name="l00086"></a><span class="lineno">   86</span>&#160;<span class="keywordtype">TYPE</span>(<a class="code" href="structmodd__cst_1_1cst__t.html">cst_t</a>),              <span class="keywordtype">INTENT(IN)</span>    :: CST</div>
<div class="line"><a name="l00087"></a><span class="lineno">   87</span>&#160;<span class="keywordtype">TYPE</span>(<a class="code" href="structmodd__rain__ice__descr__n_1_1rain__ice__descr__t.html">rain_ice_descr_t</a>),   <span class="keywordtype">INTENT(IN)</span>    :: ICED</div>
<div class="line"><a name="l00088"></a><span class="lineno">   88</span>&#160;<span class="keywordtype">TYPE</span>(<a class="code" href="structmodd__rain__ice__param__n_1_1rain__ice__param__t.html">rain_ice_param_t</a>),   <span class="keywordtype">INTENT(IN)</span>    :: ICEP</div>
<div class="line"><a name="l00089"></a><span class="lineno">   89</span>&#160;<span class="keywordtype">TYPE</span>(<a class="code" href="structmodd__elec__param_1_1elec__param__t.html">elec_param_t</a>),       <span class="keywordtype">INTENT(IN)</span>    :: ELECP   <span class="comment">! electrical parameters</span></div>
<div class="line"><a name="l00090"></a><span class="lineno">   90</span>&#160;<span class="keywordtype">TYPE</span>(<a class="code" href="structmodd__elec__descr_1_1elec__descr__t.html">elec_descr_t</a>),       <span class="keywordtype">INTENT(IN)</span>    :: ELECD   <span class="comment">! electrical descriptive csts</span></div>
<div class="line"><a name="l00091"></a><span class="lineno">   91</span>&#160;<span class="keywordtype">TYPE</span>(<a class="code" href="structmodd__budget_1_1tbudgetconf__t.html">tbudgetconf_t</a>),      <span class="keywordtype">INTENT(IN)</span>    :: BUCONF</div>
<div class="line"><a name="l00092"></a><span class="lineno">   92</span>&#160;<span class="keywordtype">TYPE</span>(<a class="code" href="structmodd__budget_1_1tbudgetdata.html">tbudgetdata</a>), <span class="keywordtype">DIMENSION(KBUDGETS)</span>, <span class="keywordtype">INTENT(INOUT)</span> :: TBUDGETS</div>
<div class="line"><a name="l00093"></a><span class="lineno">   93</span>&#160;<span class="keywordtype">INTEGER</span>,                  <span class="keywordtype">INTENT(IN)</span>    :: KBUDGETS</div>
<div class="line"><a name="l00094"></a><span class="lineno">   94</span>&#160;<span class="comment">!</span></div>
<div class="line"><a name="l00095"></a><span class="lineno">   95</span>&#160;<span class="keywordtype">REAL</span>,                     <span class="keywordtype">INTENT(IN)</span>    :: PTSTEP     <span class="comment">! Time step</span></div>
<div class="line"><a name="l00096"></a><span class="lineno">   96</span>&#160;<span class="comment">!</span></div>
<div class="line"><a name="l00097"></a><span class="lineno">   97</span>&#160;<span class="keywordtype">LOGICAL</span>,                  <span class="keywordtype">INTENT(IN)</span>    :: OELEC      <span class="comment">! if true, cloud electrification is activated</span></div>
<div class="line"><a name="l00098"></a><span class="lineno">   98</span>&#160;<span class="comment">!</span></div>
<div class="line"><a name="l00099"></a><span class="lineno">   99</span>&#160;<span class="keywordtype">REAL</span>, <span class="keywordtype">DIMENSION(:,:,:)</span>,   <span class="keywordtype">INTENT(IN)</span>    :: PRHODREF   <span class="comment">! Reference density</span></div>
<div class="line"><a name="l00100"></a><span class="lineno">  100</span>&#160;<span class="keywordtype">REAL</span>, <span class="keywordtype">DIMENSION(:,:,:)</span>,   <span class="keywordtype">INTENT(IN)</span>    :: PEXNREF    <span class="comment">! Reference Exner function</span></div>
<div class="line"><a name="l00101"></a><span class="lineno">  101</span>&#160;<span class="keywordtype">REAL</span>, <span class="keywordtype">DIMENSION(:,:,:)</span>,   <span class="keywordtype">INTENT(IN)</span>    :: PDZZ       <span class="comment">! Layer thikness (m)</span></div>
<div class="line"><a name="l00102"></a><span class="lineno">  102</span>&#160;<span class="comment">!</span></div>
<div class="line"><a name="l00103"></a><span class="lineno">  103</span>&#160;<span class="keywordtype">REAL</span>, <span class="keywordtype">DIMENSION(:,:,:)</span>,   <span class="keywordtype">INTENT(IN)</span>    :: PRHODJ     <span class="comment">! Dry density * Jacobian</span></div>
<div class="line"><a name="l00104"></a><span class="lineno">  104</span>&#160;<span class="keywordtype">REAL</span>, <span class="keywordtype">DIMENSION(:,:,:)</span>,   <span class="keywordtype">INTENT(IN)</span>    :: PPABST     <span class="comment">! absolute pressure at t</span></div>
<div class="line"><a name="l00105"></a><span class="lineno">  105</span>&#160;<span class="comment">!</span></div>
<div class="line"><a name="l00106"></a><span class="lineno">  106</span>&#160;<span class="keywordtype">INTEGER</span>,                  <span class="keywordtype">INTENT(IN)</span>    :: NCCN       <span class="comment">! for array size declarations</span></div>
<div class="line"><a name="l00107"></a><span class="lineno">  107</span>&#160;<span class="keywordtype">INTEGER</span>,                  <span class="keywordtype">INTENT(IN)</span>    :: NIFN       <span class="comment">! for array size declarations</span></div>
<div class="line"><a name="l00108"></a><span class="lineno">  108</span>&#160;<span class="keywordtype">INTEGER</span>,                  <span class="keywordtype">INTENT(IN)</span>    :: NIMM       <span class="comment">! for array size declarations</span></div>
<div class="line"><a name="l00109"></a><span class="lineno">  109</span>&#160;<span class="comment">!</span></div>
<div class="line"><a name="l00110"></a><span class="lineno">  110</span>&#160;<span class="keywordtype">REAL</span>, <span class="keywordtype">DIMENSION(:,:,:)</span>,   <span class="keywordtype">INTENT(IN)</span>    :: PDTHRAD    <span class="comment">! dT/dt due to radiation</span></div>
<div class="line"><a name="l00111"></a><span class="lineno">  111</span>&#160;<span class="keywordtype">REAL</span>, <span class="keywordtype">DIMENSION(:,:,:)</span>,   <span class="keywordtype">INTENT(IN)</span>    :: PTHT       <span class="comment">! Theta at time t</span></div>
<div class="line"><a name="l00112"></a><span class="lineno">  112</span>&#160;<span class="keywordtype">REAL</span>, <span class="keywordtype">DIMENSION(:,:,:,:)</span>, <span class="keywordtype">INTENT(IN)</span>    :: PRT        <span class="comment">! Mixing ratios at time t</span></div>
<div class="line"><a name="l00113"></a><span class="lineno">  113</span>&#160;<span class="keywordtype">REAL</span>, <span class="keywordtype">DIMENSION(:,:,:,:)</span>, <span class="keywordtype">INTENT(IN)</span>    :: PSVT       <span class="comment">! Concentrations at time t</span></div>
<div class="line"><a name="l00114"></a><span class="lineno">  114</span>&#160;<span class="keywordtype">REAL</span>, <span class="keywordtype">DIMENSION(:,:,:)</span>,   <span class="keywordtype">INTENT(IN)</span>    :: PW_NU      <span class="comment">! w for CCN activation</span></div>
<div class="line"><a name="l00115"></a><span class="lineno">  115</span>&#160;<span class="comment">!</span></div>
<div class="line"><a name="l00116"></a><span class="lineno">  116</span>&#160;<span class="keywordtype">REAL</span>, <span class="keywordtype">DIMENSION(:,:,:)</span>,   <span class="keywordtype">INTENT(INOUT)</span> :: PTHS       <span class="comment">! Theta source</span></div>
<div class="line"><a name="l00117"></a><span class="lineno">  117</span>&#160;<span class="keywordtype">REAL</span>, <span class="keywordtype">DIMENSION(:,:,:,:)</span>, <span class="keywordtype">INTENT(INOUT)</span> :: PRS        <span class="comment">! Mixing ratios sources</span></div>
<div class="line"><a name="l00118"></a><span class="lineno">  118</span>&#160;<span class="keywordtype">REAL</span>, <span class="keywordtype">DIMENSION(:,:,:,:)</span>, <span class="keywordtype">INTENT(INOUT)</span> :: PSVS       <span class="comment">! Concentration sources</span></div>
<div class="line"><a name="l00119"></a><span class="lineno">  119</span>&#160;<span class="comment">!</span></div>
<div class="line"><a name="l00120"></a><span class="lineno">  120</span>&#160;<span class="keywordtype">REAL</span>, <span class="keywordtype">DIMENSION(:,:)</span>,     <span class="keywordtype">INTENT(OUT)</span>   :: PINPRC     <span class="comment">! Cloud instant precip</span></div>
<div class="line"><a name="l00121"></a><span class="lineno">  121</span>&#160;<span class="keywordtype">REAL</span>, <span class="keywordtype">DIMENSION(:,:)</span>,     <span class="keywordtype">INTENT(OUT)</span>   :: PINDEP     <span class="comment">! Cloud droplets deposition</span></div>
<div class="line"><a name="l00122"></a><span class="lineno">  122</span>&#160;<span class="keywordtype">REAL</span>, <span class="keywordtype">DIMENSION(:,:)</span>,     <span class="keywordtype">INTENT(OUT)</span>   :: PINPRR     <span class="comment">! Rain instant precip</span></div>
<div class="line"><a name="l00123"></a><span class="lineno">  123</span>&#160;<span class="keywordtype">REAL</span>, <span class="keywordtype">DIMENSION(:,:)</span>,     <span class="keywordtype">INTENT(OUT)</span>   :: PINPRI     <span class="comment">! Rain instant precip</span></div>
<div class="line"><a name="l00124"></a><span class="lineno">  124</span>&#160;<span class="keywordtype">REAL</span>, <span class="keywordtype">DIMENSION(:,:)</span>,     <span class="keywordtype">INTENT(OUT)</span>   :: PINPRS     <span class="comment">! Snow instant precip</span></div>
<div class="line"><a name="l00125"></a><span class="lineno">  125</span>&#160;<span class="keywordtype">REAL</span>, <span class="keywordtype">DIMENSION(:,:)</span>,     <span class="keywordtype">INTENT(OUT)</span>   :: PINPRG     <span class="comment">! Graupel instant precip</span></div>
<div class="line"><a name="l00126"></a><span class="lineno">  126</span>&#160;<span class="keywordtype">REAL</span>, <span class="keywordtype">DIMENSION(:,:)</span>,     <span class="keywordtype">INTENT(OUT)</span>   :: PINPRH     <span class="comment">! Rain instant precip</span></div>
<div class="line"><a name="l00127"></a><span class="lineno">  127</span>&#160;<span class="keywordtype">REAL</span>, <span class="keywordtype">DIMENSION(:,:,:)</span>,   <span class="keywordtype">INTENT(OUT)</span>   :: PEVAP3D    <span class="comment">! Rain evap profile</span></div>
<div class="line"><a name="l00128"></a><span class="lineno">  128</span>&#160;<span class="comment">!</span></div>
<div class="line"><a name="l00129"></a><span class="lineno">  129</span>&#160;<span class="keywordtype">REAL</span>, <span class="keywordtype">DIMENSION(:,:,:)</span>,   <span class="keywordtype">INTENT(INOUT)</span> :: PCLDFR     <span class="comment">! Cloud fraction</span></div>
<div class="line"><a name="l00130"></a><span class="lineno">  130</span>&#160;<span class="keywordtype">REAL</span>, <span class="keywordtype">DIMENSION(:,:,:)</span>,   <span class="keywordtype">INTENT(INOUT)</span> :: PICEFR     <span class="comment">! Cloud fraction</span></div>
<div class="line"><a name="l00131"></a><span class="lineno">  131</span>&#160;<span class="keywordtype">REAL</span>, <span class="keywordtype">DIMENSION(:,:,:)</span>,   <span class="keywordtype">INTENT(INOUT)</span> :: PPRCFR     <span class="comment">! Cloud fraction</span></div>
<div class="line"><a name="l00132"></a><span class="lineno">  132</span>&#160;<span class="keywordtype">REAL</span>, <span class="keywordtype">DIMENSION(:,:,:,:)</span>, <span class="keywordtype">INTENT(INOUT)</span> :: PFPR       <span class="comment">! Precipitation fluxes in altitude</span></div>
<div class="line"><a name="l00133"></a><span class="lineno">  133</span>&#160;<span class="comment">!</span></div>
<div class="line"><a name="l00134"></a><span class="lineno">  134</span>&#160;<span class="keywordtype">REAL</span>, <span class="keywordtype">DIMENSION(:,:,:)</span>,   <span class="keywordtype">OPTIONAL</span>, <span class="keywordtype">INTENT(IN)</span>    :: PLATHAM_IAGGS  <span class="comment">! Factor for IAGGS modification due to Efield</span></div>
<div class="line"><a name="l00135"></a><span class="lineno">  135</span>&#160;<span class="keywordtype">REAL</span>, <span class="keywordtype">DIMENSION(:,:,:)</span>,   <span class="keywordtype">OPTIONAL</span>, <span class="keywordtype">INTENT(IN)</span>    :: PEFIELDW   <span class="comment">! Vertical component of the electric field</span></div>
<div class="line"><a name="l00136"></a><span class="lineno">  136</span>&#160;<span class="keywordtype">REAL</span>, <span class="keywordtype">DIMENSION(:,:,:,:)</span>, <span class="keywordtype">OPTIONAL</span>, <span class="keywordtype">INTENT(IN)</span>    :: PSV_ELEC_T <span class="comment">! Charge density at time t</span></div>
<div class="line"><a name="l00137"></a><span class="lineno">  137</span>&#160;<span class="keywordtype">REAL</span>, <span class="keywordtype">DIMENSION(:,:,:,:)</span>, <span class="keywordtype">OPTIONAL</span>, <span class="keywordtype">INTENT(INOUT)</span> :: PSV_ELEC_S <span class="comment">! Charge density sources</span></div>
<div class="line"><a name="l00138"></a><span class="lineno">  138</span>&#160;<span class="comment">!</span></div>
<div class="line"><a name="l00139"></a><span class="lineno">  139</span>&#160;<span class="keywordtype">REAL</span>, <span class="keywordtype">INTENT(IN)</span>                :: PTHVREFZIKB <span class="comment">! Reference thv at IKB for electricity</span></div>
<div class="line"><a name="l00140"></a><span class="lineno">  140</span>&#160;<span class="comment">!*       0.2   Declarations of local variables :</span></div>
<div class="line"><a name="l00141"></a><span class="lineno">  141</span>&#160;<span class="comment">!</span></div>
<div class="line"><a name="l00142"></a><span class="lineno">  142</span>&#160;<span class="comment">!</span></div>
<div class="line"><a name="l00143"></a><span class="lineno">  143</span>&#160;<span class="comment">! Prognostic variables and sources</span></div>
<div class="line"><a name="l00144"></a><span class="lineno">  144</span>&#160;<span class="keywordtype">REAL</span>, <span class="keywordtype">DIMENSION(SIZE(PRT,1),SIZE(PRT,2),SIZE(PRT,3))</span>      :: ZTHT, ZRVT, ZRCT, ZRRT, ZRIT, ZRST, ZRGT, ZRHT</div>
<div class="line"><a name="l00145"></a><span class="lineno">  145</span>&#160;<span class="keywordtype">REAL</span>, <span class="keywordtype">DIMENSION(SIZE(PRT,1),SIZE(PRT,2),SIZE(PRT,3))</span>      :: ZCCT, ZCRT, ZCIT, ZCST, ZCGT, ZCHT</div>
<div class="line"><a name="l00146"></a><span class="lineno">  146</span>&#160;<span class="keywordtype">REAL</span>, <span class="keywordtype">DIMENSION(SIZE(PRT,1),SIZE(PRT,2),SIZE(PRT,3))</span>      :: ZTHS, ZRVS, ZRCS, ZRRS, ZRIS, ZRSS, ZRGS, ZRHS</div>
<div class="line"><a name="l00147"></a><span class="lineno">  147</span>&#160;<span class="keywordtype">REAL</span>, <span class="keywordtype">DIMENSION(SIZE(PRT,1),SIZE(PRT,2),SIZE(PRT,3))</span>      :: ZCCS, ZCRS, ZCIS, ZCSS, ZCGS, ZCHS</div>
<div class="line"><a name="l00148"></a><span class="lineno">  148</span>&#160;<span class="keywordtype">REAL</span>, <span class="keywordtype">DIMENSION(SIZE(PRT,1),SIZE(PRT,2),SIZE(PRT,3),NCCN)</span> :: ZCCNFT, ZCCNAT</div>
<div class="line"><a name="l00149"></a><span class="lineno">  149</span>&#160;<span class="keywordtype">REAL</span>, <span class="keywordtype">DIMENSION(SIZE(PRT,1),SIZE(PRT,2),SIZE(PRT,3),NCCN)</span> :: ZCCNFS, ZCCNAS</div>
<div class="line"><a name="l00150"></a><span class="lineno">  150</span>&#160;<span class="keywordtype">REAL</span>, <span class="keywordtype">DIMENSION(SIZE(PRT,1),SIZE(PRT,2),SIZE(PRT,3),NIFN)</span> :: ZIFNFT, ZIFNNT</div>
<div class="line"><a name="l00151"></a><span class="lineno">  151</span>&#160;<span class="keywordtype">REAL</span>, <span class="keywordtype">DIMENSION(SIZE(PRT,1),SIZE(PRT,2),SIZE(PRT,3),NIFN)</span> :: ZIFNFS, ZIFNNS</div>
<div class="line"><a name="l00152"></a><span class="lineno">  152</span>&#160;<span class="keywordtype">REAL</span>, <span class="keywordtype">DIMENSION(SIZE(PRT,1),SIZE(PRT,2),SIZE(PRT,3),NIMM)</span> :: ZIMMNT</div>
<div class="line"><a name="l00153"></a><span class="lineno">  153</span>&#160;<span class="keywordtype">REAL</span>, <span class="keywordtype">DIMENSION(SIZE(PRT,1),SIZE(PRT,2),SIZE(PRT,3),NIMM)</span> :: ZIMMNS</div>
<div class="line"><a name="l00154"></a><span class="lineno">  154</span>&#160;<span class="keywordtype">REAL</span>, <span class="keywordtype">DIMENSION(SIZE(PRT,1),SIZE(PRT,2),SIZE(PRT,3))</span>      :: ZHOMFT</div>
<div class="line"><a name="l00155"></a><span class="lineno">  155</span>&#160;<span class="keywordtype">REAL</span>, <span class="keywordtype">DIMENSION(SIZE(PRT,1),SIZE(PRT,2),SIZE(PRT,3))</span>      :: ZHOMFS</div>
<div class="line"><a name="l00156"></a><span class="lineno">  156</span>&#160; </div>
<div class="line"><a name="l00157"></a><span class="lineno">  157</span>&#160;<span class="comment">!</span></div>
<div class="line"><a name="l00158"></a><span class="lineno">  158</span>&#160;<span class="comment">! Other 3D thermodynamical variables</span></div>
<div class="line"><a name="l00159"></a><span class="lineno">  159</span>&#160;<span class="keywordtype">REAL</span>, <span class="keywordtype">DIMENSION(SIZE(PRT,1),SIZE(PRT,2),SIZE(PRT,3))</span>      :: ZEXN, ZT</div>
<div class="line"><a name="l00160"></a><span class="lineno">  160</span>&#160; </div>
<div class="line"><a name="l00161"></a><span class="lineno">  161</span>&#160;<span class="comment">!</span></div>
<div class="line"><a name="l00162"></a><span class="lineno">  162</span>&#160;<span class="comment">! Packed prognostic &amp; thermo variables</span></div>
<div class="line"><a name="l00163"></a><span class="lineno">  163</span>&#160;<span class="keywordtype">REAL</span>, <span class="keywordtype">DIMENSION(:)</span>,   <span class="keywordtype">ALLOCATABLE</span> ::                               &amp;</div>
<div class="line"><a name="l00164"></a><span class="lineno">  164</span>&#160;     ZP1D, ZRHODREF1D, ZEXNREF1D, ZEXN1D,                          &amp;</div>
<div class="line"><a name="l00165"></a><span class="lineno">  165</span>&#160;     ZTHT1D,                                                       &amp;</div>
<div class="line"><a name="l00166"></a><span class="lineno">  166</span>&#160;     ZRVT1D, ZRCT1D, ZRRT1D, ZRIT1D, ZRST1D, ZRGT1D, ZRHT1D,       &amp;</div>
<div class="line"><a name="l00167"></a><span class="lineno">  167</span>&#160;     ZCCT1D, ZCRT1D, ZCIT1D, ZCST1D, ZCGT1D, ZCHT1D,               &amp;</div>
<div class="line"><a name="l00168"></a><span class="lineno">  168</span>&#160;     ZEVAP1D</div>
<div class="line"><a name="l00169"></a><span class="lineno">  169</span>&#160;<span class="keywordtype">REAL</span>, <span class="keywordtype">DIMENSION(:,:)</span>, <span class="keywordtype">ALLOCATABLE</span> :: ZIFNN1D</div>
<div class="line"><a name="l00170"></a><span class="lineno">  170</span>&#160; </div>
<div class="line"><a name="l00171"></a><span class="lineno">  171</span>&#160;<span class="comment">!</span></div>
<div class="line"><a name="l00172"></a><span class="lineno">  172</span>&#160;<span class="comment">! for each process &amp; species inside the loop, we need 1D packed variables to store instant tendencies for hydrometeors</span></div>
<div class="line"><a name="l00173"></a><span class="lineno">  173</span>&#160;<span class="keywordtype">REAL</span>, <span class="keywordtype">DIMENSION(:)</span>, <span class="keywordtype">ALLOCATABLE</span> ::                          &amp;</div>
<div class="line"><a name="l00174"></a><span class="lineno">  174</span>&#160;<span class="comment">! mixing ratio &amp; concentration changes by instantaneous processes (kg/kg and #/kg) :</span></div>
<div class="line"><a name="l00175"></a><span class="lineno">  175</span>&#160;     z_cr_brku,                                             &amp; <span class="comment">! spontaneous break up of drops (BRKU) : Nr</span></div>
<div class="line"><a name="l00176"></a><span class="lineno">  176</span>&#160;     z_th_honr, z_rr_honr, z_cr_honr,                       &amp; <span class="comment">! rain drops homogeneous freezing (HONR) : rr, Nr, rg=-rr, th</span></div>
<div class="line"><a name="l00177"></a><span class="lineno">  177</span>&#160;     z_th_imlt, z_rc_imlt, z_cc_imlt,                       &amp; <span class="comment">! ice melting (IMLT) : rc, Nc, ri=-rc, Ni=-Nc, th, IFNF, IFNA</span></div>
<div class="line"><a name="l00178"></a><span class="lineno">  178</span>&#160;<span class="comment">! mixing ratio &amp; concentration tendencies by continuous processes (kg/kg/s and #/kg/s) :</span></div>
<div class="line"><a name="l00179"></a><span class="lineno">  179</span>&#160;     z_th_honc, z_rc_honc, z_cc_honc,                       &amp; <span class="comment">! droplets homogeneous freezing (HONC) : rc, Nc, ri=-rc, Ni=-Nc, th</span></div>
<div class="line"><a name="l00180"></a><span class="lineno">  180</span>&#160;     z_cc_self,                                             &amp; <span class="comment">! self collection of droplets (SELF) : Nc</span></div>
<div class="line"><a name="l00181"></a><span class="lineno">  181</span>&#160;     z_rc_auto, z_cc_auto, z_cr_auto,                       &amp; <span class="comment">! autoconversion of cloud droplets (AUTO) : rc, Nc, rr=-rc, Nr</span></div>
<div class="line"><a name="l00182"></a><span class="lineno">  182</span>&#160;     z_rc_accr, z_cc_accr,                                  &amp; <span class="comment">! accretion of droplets by rain drops (ACCR) : rc, Nc, rr=-rr</span></div>
<div class="line"><a name="l00183"></a><span class="lineno">  183</span>&#160;     z_cr_scbu,                                             &amp; <span class="comment">! self collectio break up of drops (SCBU) : Nr</span></div>
<div class="line"><a name="l00184"></a><span class="lineno">  184</span>&#160;<span class="comment">!      Z_TH_EVAP, Z_RC_EVAP, Z_CC_EVAP, Z_RR_EVAP, Z_CR_EVAP, &amp; ! evaporation of rain drops (EVAP) : rv=-rr-rc, rc, Nc, rr, Nr, th</span></div>
<div class="line"><a name="l00185"></a><span class="lineno">  185</span>&#160;     z_th_evap, z_rr_evap, z_cr_evap,                       &amp; <span class="comment">! evaporation of rain drops (EVAP) : rv=-rr-rc, rc, Nc, rr, Nr, th</span></div>
<div class="line"><a name="l00186"></a><span class="lineno">  186</span>&#160;     z_ri_cnvi, z_ci_cnvi,                                  &amp; <span class="comment">! conversion snow -&gt; ice (CNVI) : ri, Ni, rs=-ri</span></div>
<div class="line"><a name="l00187"></a><span class="lineno">  187</span>&#160;     z_th_deps, z_rs_deps,                                  &amp; <span class="comment">! deposition of vapor on snow (DEPS) : rv=-rs, rs, th</span></div>
<div class="line"><a name="l00188"></a><span class="lineno">  188</span>&#160;     z_th_depi, z_ri_depi,                                  &amp; <span class="comment">! deposition of vapor on ice (DEPI) : rv=-ri, ri, th</span></div>
<div class="line"><a name="l00189"></a><span class="lineno">  189</span>&#160;     z_ri_cnvs, z_ci_cnvs,                                  &amp; <span class="comment">! conversion ice -&gt; snow (CNVS) : ri, Ni, rs=-ri</span></div>
<div class="line"><a name="l00190"></a><span class="lineno">  190</span>&#160;     z_cs_ssc,                                              &amp; <span class="comment">! self collection of snow (SSC) : Ns</span></div>
<div class="line"><a name="l00191"></a><span class="lineno">  191</span>&#160;     z_ri_aggs, z_ci_aggs,                                  &amp; <span class="comment">! aggregation of ice on snow (AGGS) : ri, Ni, rs=-ri</span></div>
<div class="line"><a name="l00192"></a><span class="lineno">  192</span>&#160;     z_th_depg, z_rg_depg,                                  &amp; <span class="comment">! deposition of vapor on graupel (DEPG) : rv=-rg, rg, th</span></div>
<div class="line"><a name="l00193"></a><span class="lineno">  193</span>&#160;     z_th_berfi, z_rc_berfi,                                &amp; <span class="comment">! Bergeron (BERFI) : rc, ri=-rc, th</span></div>
<div class="line"><a name="l00194"></a><span class="lineno">  194</span>&#160;<span class="comment">!++cb++</span></div>
<div class="line"><a name="l00195"></a><span class="lineno">  195</span>&#160;<span class="comment">!     Z_TH_RIM, Z_RC_RIM, Z_CC_RIM, Z_RS_RIM, Z_CS_RIM, Z_RG_RIM,      &amp; ! cloud droplet riming (RIM) : rc, Nc, rs, Ns, rg, Ng=-Ns, th</span></div>
<div class="line"><a name="l00196"></a><span class="lineno">  196</span>&#160;     z_th_rim, z_cc_rim, z_cs_rim, z_rc_rimss, z_rc_rimsg, z_rs_rimcg, &amp; <span class="comment">! cloud droplet riming (RIM) : rc, Nc, rs, rg, th</span></div>
<div class="line"><a name="l00197"></a><span class="lineno">  197</span>&#160;<span class="comment">!--cb--</span></div>
<div class="line"><a name="l00198"></a><span class="lineno">  198</span>&#160;     z_ri_hms, z_ci_hms, z_rs_hms,                          &amp; <span class="comment">! hallett mossop snow (HMS) : ri, Ni, rs</span></div>
<div class="line"><a name="l00199"></a><span class="lineno">  199</span>&#160;<span class="comment">!++cb++</span></div>
<div class="line"><a name="l00200"></a><span class="lineno">  200</span>&#160;<span class="comment">!     Z_TH_ACC, Z_RR_ACC, Z_CR_ACC, Z_RS_ACC, Z_CS_ACC, Z_RG_ACC,      &amp; ! rain accretion on aggregates (ACC) : rr, Nr, rs, Ns, rg, Ng=-Ns, th</span></div>
<div class="line"><a name="l00201"></a><span class="lineno">  201</span>&#160;     z_th_acc, z_cr_acc, z_cs_acc, z_rr_accss, z_rr_accsg, z_rs_accrg, &amp; <span class="comment">! rain accretion on aggregates (ACC) : rr, Nr, rs, rg, th</span></div>
<div class="line"><a name="l00202"></a><span class="lineno">  202</span>&#160;<span class="comment">!--cb--</span></div>
<div class="line"><a name="l00203"></a><span class="lineno">  203</span>&#160;     z_rs_cmel, z_cs_cmel,                                  &amp; <span class="comment">! conversion-melting (CMEL) : rs, rg=-rs</span></div>
<div class="line"><a name="l00204"></a><span class="lineno">  204</span>&#160;     z_th_cfrz, z_rr_cfrz, z_cr_cfrz, z_ri_cfrz, z_ci_cfrz, &amp; <span class="comment">! rain freezing (CFRZ) : rr, Nr, ri, Ni, rg=-rr-ri, th</span></div>
<div class="line"><a name="l00205"></a><span class="lineno">  205</span>&#160;     z_ri_cibu, z_ci_cibu,                                  &amp; <span class="comment">! collisional ice break-up (CIBU) : ri, Ni, rs=-ri</span></div>
<div class="line"><a name="l00206"></a><span class="lineno">  206</span>&#160;     z_ri_rdsf, z_ci_rdsf,                                  &amp; <span class="comment">! rain drops freezing shattering (RDSF) : ri, Ni, rg=-ri</span></div>
<div class="line"><a name="l00207"></a><span class="lineno">  207</span>&#160;     z_th_wetg, z_rc_wetg, z_cc_wetg, z_rr_wetg, z_cr_wetg, &amp; <span class="comment">! wet growth of graupel (WETG) : rc, NC, rr, Nr, ri, Ni, rs, rg, rh, th</span></div>
<div class="line"><a name="l00208"></a><span class="lineno">  208</span>&#160;     z_ri_wetg, z_ci_wetg, z_rs_wetg, z_cs_wetg, z_rg_wetg, z_cg_wetg, z_rh_wetg, &amp; <span class="comment">! wet growth of graupel (WETG) : rc, NC, rr, Nr, ri, Ni, rs, Ns, rg, Ng, rh, Nh=-Ng, th</span></div>
<div class="line"><a name="l00209"></a><span class="lineno">  209</span>&#160;     z_th_dryg, z_rc_dryg, z_cc_dryg, z_rr_dryg, z_cr_dryg, &amp; <span class="comment">! dry growth of graupel (DRYG) : rc, Nc, rr, Nr, ri, Ni, rs, rg, th</span></div>
<div class="line"><a name="l00210"></a><span class="lineno">  210</span>&#160;     z_ri_dryg, z_ci_dryg, z_rs_dryg, z_cs_dryg, z_rg_dryg, &amp; <span class="comment">! dry growth of graupel (DRYG) : rc, Nc, rr, Nr, ri, Ni, rs, Ns, rg, th</span></div>
<div class="line"><a name="l00211"></a><span class="lineno">  211</span>&#160;     z_ri_hmg, z_ci_hmg, z_rg_hmg,                          &amp; <span class="comment">! hallett mossop graupel (HMG) : ri, Ni, rg</span></div>
<div class="line"><a name="l00212"></a><span class="lineno">  212</span>&#160;     z_th_gmlt, z_rr_gmlt, z_cr_gmlt, z_cg_gmlt,            &amp; <span class="comment">! graupel melting (GMLT) : rr, Nr, rg=-rr, th</span></div>
<div class="line"><a name="l00213"></a><span class="lineno">  213</span>&#160;     z_th_deph, z_rh_deph,                                  &amp; <span class="comment">! deposition of vapor on hail (DEPH) : rv=-rh, rh, th</span></div>
<div class="line"><a name="l00214"></a><span class="lineno">  214</span>&#160;     z_th_weth, z_rc_weth, z_cc_weth, z_rr_weth, z_cr_weth, &amp; <span class="comment">! wet growth of hail (WETH) : rc, Nc, rr, Nr, ri, Ni, rs, rg, rh, th</span></div>
<div class="line"><a name="l00215"></a><span class="lineno">  215</span>&#160;     z_ri_weth, z_ci_weth, z_rs_weth, z_cs_weth, z_rg_weth, z_cg_weth, z_rh_weth, &amp; <span class="comment">! wet growth of hail (WETH) : rc, Nc, rr, Nr, ri, Ni, rs, rg, rh, th</span></div>
<div class="line"><a name="l00216"></a><span class="lineno">  216</span>&#160;     z_rg_cohg, z_cg_cohg,                                  &amp; <span class="comment">! conversion of hail into graupel (COHG) : rg, rh</span></div>
<div class="line"><a name="l00217"></a><span class="lineno">  217</span>&#160;     z_th_hmlt, z_rr_hmlt, z_cr_hmlt, z_ch_hmlt,            &amp; <span class="comment">! hail melting (HMLT) : rr, Nr, rh=-rr, th</span></div>
<div class="line"><a name="l00218"></a><span class="lineno">  218</span>&#160;     z_rv_corr2, z_rc_corr2, z_rr_corr2, z_ri_corr2,        &amp;</div>
<div class="line"><a name="l00219"></a><span class="lineno">  219</span>&#160;     z_cc_corr2, z_cr_corr2, z_ci_corr2,                    &amp;</div>
<div class="line"><a name="l00220"></a><span class="lineno">  220</span>&#160;<span class="comment">!++cb+ +</span></div>
<div class="line"><a name="l00221"></a><span class="lineno">  221</span>&#160;     z_ri_hind, z_rc_hinc, z_rv_henu, z_rv_honh</div>
<div class="line"><a name="l00222"></a><span class="lineno">  222</span>&#160;<span class="comment">!--cb--</span></div>
<div class="line"><a name="l00223"></a><span class="lineno">  223</span>&#160;<span class="comment">!</span></div>
<div class="line"><a name="l00224"></a><span class="lineno">  224</span>&#160;<span class="comment">! for the conversion from rain to cloud, we need a 3D variable instead of a 1D packed variable</span></div>
<div class="line"><a name="l00225"></a><span class="lineno">  225</span>&#160;<span class="keywordtype">REAL</span>, <span class="keywordtype">DIMENSION(SIZE(PTHT,1),SIZE(PTHT,2),SIZE(PTHT,3))</span> ::  &amp;</div>
<div class="line"><a name="l00226"></a><span class="lineno">  226</span>&#160;     Z_RR_CVRC, Z_CR_CVRC                                     <span class="comment">! conversion of rain into cloud droplets (CVRC)</span></div>
<div class="line"><a name="l00227"></a><span class="lineno">  227</span>&#160; </div>
<div class="line"><a name="l00228"></a><span class="lineno">  228</span>&#160;<span class="comment">!</span></div>
<div class="line"><a name="l00229"></a><span class="lineno">  229</span>&#160;<span class="comment">! Packed variables for total tendencies</span></div>
<div class="line"><a name="l00230"></a><span class="lineno">  230</span>&#160;<span class="keywordtype">REAL</span>, <span class="keywordtype">DIMENSION(:)</span>,   <span class="keywordtype">ALLOCATABLE</span> ::                                              &amp;</div>
<div class="line"><a name="l00231"></a><span class="lineno">  231</span>&#160;     ZA_TH, ZA_RV, ZA_RC, ZA_CC, ZA_RR, ZA_CR, ZA_RI, ZA_CI, ZA_RS, ZA_CS, ZA_RG, ZA_CG, ZA_RH, ZA_CH, &amp; <span class="comment">! ZA = continuous tendencies (kg/kg/s = S variable)</span></div>
<div class="line"><a name="l00232"></a><span class="lineno">  232</span>&#160;     ZB_TH, ZB_RV, ZB_RC, ZB_CC, ZB_RR, ZB_CR, ZB_RI, ZB_CI, ZB_RS, ZB_CS, ZB_RG, ZB_CG, ZB_RH, ZB_CH    <span class="comment">! ZB = instant mixing ratio change (kg/kg = T variable)</span></div>
<div class="line"><a name="l00233"></a><span class="lineno">  233</span>&#160;<span class="keywordtype">REAL</span>, <span class="keywordtype">DIMENSION(:,:)</span>, <span class="keywordtype">ALLOCATABLE</span> :: ZB_IFNN</div>
<div class="line"><a name="l00234"></a><span class="lineno">  234</span>&#160; </div>
<div class="line"><a name="l00235"></a><span class="lineno">  235</span>&#160;<span class="comment">!</span></div>
<div class="line"><a name="l00236"></a><span class="lineno">  236</span>&#160;<span class="comment">! for each process &amp; species, we need 3D variables to store total mmr and conc change (kg/kg and #/kg and theta)</span></div>
<div class="line"><a name="l00237"></a><span class="lineno">  237</span>&#160;<span class="keywordtype">REAL</span>, <span class="keywordtype">DIMENSION(:,:,:)</span>, <span class="keywordtype">ALLOCATABLE</span> ::                                     &amp;</div>
<div class="line"><a name="l00238"></a><span class="lineno">  238</span>&#160;<span class="comment">! instantaneous processes :</span></div>
<div class="line"><a name="l00239"></a><span class="lineno">  239</span>&#160;     ztot_cr_brku,                                                         &amp; <span class="comment">! spontaneous break up of drops (BRKU)</span></div>
<div class="line"><a name="l00240"></a><span class="lineno">  240</span>&#160;     ztot_th_honr, ztot_rr_honr, ztot_cr_honr,                             &amp; <span class="comment">! rain drops homogeneous freezing (HONR)</span></div>
<div class="line"><a name="l00241"></a><span class="lineno">  241</span>&#160;     ztot_th_imlt, ztot_rc_imlt, ztot_cc_imlt,                             &amp; <span class="comment">! ice melting (IMLT)</span></div>
<div class="line"><a name="l00242"></a><span class="lineno">  242</span>&#160;<span class="comment">! continuous processes :</span></div>
<div class="line"><a name="l00243"></a><span class="lineno">  243</span>&#160;     ztot_th_honc, ztot_rc_honc, ztot_cc_honc,                             &amp; <span class="comment">! droplets homogeneous freezing (HONC)</span></div>
<div class="line"><a name="l00244"></a><span class="lineno">  244</span>&#160;     ztot_cc_self,                                                         &amp; <span class="comment">! self collection of droplets (SELF)</span></div>
<div class="line"><a name="l00245"></a><span class="lineno">  245</span>&#160;     ztot_rc_auto, ztot_cc_auto, ztot_cr_auto,                             &amp; <span class="comment">! autoconversion of cloud droplets (AUTO)</span></div>
<div class="line"><a name="l00246"></a><span class="lineno">  246</span>&#160;     ztot_rc_accr, ztot_cc_accr,                                           &amp; <span class="comment">! accretion of droplets by rain drops (ACCR)</span></div>
<div class="line"><a name="l00247"></a><span class="lineno">  247</span>&#160;     ztot_cr_scbu,                                                         &amp; <span class="comment">! self collectio break up of drops (SCBU)</span></div>
<div class="line"><a name="l00248"></a><span class="lineno">  248</span>&#160;<span class="comment">!      ZTOT_TH_EVAP, ZTOT_RC_EVAP, ZTOT_CC_EVAP, ZTOT_RR_EVAP, ZTOT_CR_EVAP, &amp; ! evaporation of rain drops (EVAP)</span></div>
<div class="line"><a name="l00249"></a><span class="lineno">  249</span>&#160;     ztot_th_evap, ztot_rr_evap, ztot_cr_evap,                             &amp; <span class="comment">! evaporation of rain drops (EVAP)</span></div>
<div class="line"><a name="l00250"></a><span class="lineno">  250</span>&#160;     ztot_ri_cnvi, ztot_ci_cnvi,                                           &amp; <span class="comment">! conversion snow -&gt; ice (CNVI)</span></div>
<div class="line"><a name="l00251"></a><span class="lineno">  251</span>&#160;     ztot_th_deps, ztot_rs_deps,                                           &amp; <span class="comment">! deposition of vapor on snow (DEPS)</span></div>
<div class="line"><a name="l00252"></a><span class="lineno">  252</span>&#160;     ztot_th_depi, ztot_ri_depi,                                           &amp; <span class="comment">! deposition of vapor on ice (DEPI)</span></div>
<div class="line"><a name="l00253"></a><span class="lineno">  253</span>&#160;     ztot_ri_cnvs, ztot_ci_cnvs,                                           &amp; <span class="comment">! conversion ice -&gt; snow (CNVS)</span></div>
<div class="line"><a name="l00254"></a><span class="lineno">  254</span>&#160;     ztot_cs_ssc,                                                          &amp; <span class="comment">! self collection of snow (SSC)</span></div>
<div class="line"><a name="l00255"></a><span class="lineno">  255</span>&#160;     ztot_ri_aggs, ztot_ci_aggs,                                           &amp; <span class="comment">! aggregation of ice on snow (AGGS)</span></div>
<div class="line"><a name="l00256"></a><span class="lineno">  256</span>&#160;     ztot_th_depg, ztot_rg_depg,                                           &amp; <span class="comment">! deposition of vapor on graupel (DEPG)</span></div>
<div class="line"><a name="l00257"></a><span class="lineno">  257</span>&#160;     ztot_th_berfi, ztot_rc_berfi,                                         &amp; <span class="comment">! Bergeron (BERFI)</span></div>
<div class="line"><a name="l00258"></a><span class="lineno">  258</span>&#160;<span class="comment">!++cb++</span></div>
<div class="line"><a name="l00259"></a><span class="lineno">  259</span>&#160;<span class="comment">!     ZTOT_TH_RIM, ZTOT_RC_RIM, ZTOT_CC_RIM, ZTOT_RS_RIM, ZTOT_CS_RIM, ZTOT_RG_RIM,      &amp; ! cloud droplet riming (RIM)</span></div>
<div class="line"><a name="l00260"></a><span class="lineno">  260</span>&#160;     ztot_th_rim, ztot_cc_rim, ztot_cs_rim, ztot_rc_rimss, ztot_rc_rimsg, ztot_rs_rimcg, &amp; <span class="comment">! cloud droplet riming (RIM)</span></div>
<div class="line"><a name="l00261"></a><span class="lineno">  261</span>&#160;<span class="comment">!--cb--</span></div>
<div class="line"><a name="l00262"></a><span class="lineno">  262</span>&#160;     ztot_ri_hms, ztot_ci_hms, ztot_rs_hms,                                &amp; <span class="comment">! hallett mossop snow (HMS)</span></div>
<div class="line"><a name="l00263"></a><span class="lineno">  263</span>&#160;<span class="comment">!++cb++</span></div>
<div class="line"><a name="l00264"></a><span class="lineno">  264</span>&#160;<span class="comment">!     ZTOT_TH_ACC, ZTOT_RR_ACC, ZTOT_CR_ACC, ZTOT_RS_ACC, ZTOT_CS_ACC, ZTOT_RG_ACC,      &amp; ! rain accretion on aggregates (ACC)</span></div>
<div class="line"><a name="l00265"></a><span class="lineno">  265</span>&#160;     ztot_th_acc, ztot_cr_acc, ztot_cs_acc, ztot_rr_accss, ztot_rr_accsg, ztot_rs_accrg, &amp; <span class="comment">! rain accretion on aggregates (ACC)</span></div>
<div class="line"><a name="l00266"></a><span class="lineno">  266</span>&#160;<span class="comment">!--cb--</span></div>
<div class="line"><a name="l00267"></a><span class="lineno">  267</span>&#160;     ztot_rs_cmel, ztot_cs_cmel,                                                        &amp; <span class="comment">! conversion-melting (CMEL)</span></div>
<div class="line"><a name="l00268"></a><span class="lineno">  268</span>&#160;     ztot_th_cfrz, ztot_rr_cfrz, ztot_cr_cfrz, ztot_ri_cfrz, ztot_ci_cfrz, &amp; <span class="comment">! rain freezing (CFRZ)</span></div>
<div class="line"><a name="l00269"></a><span class="lineno">  269</span>&#160;     ztot_ri_cibu, ztot_ci_cibu,                                           &amp; <span class="comment">! collisional ice break-up (CIBU)</span></div>
<div class="line"><a name="l00270"></a><span class="lineno">  270</span>&#160;     ztot_ri_rdsf, ztot_ci_rdsf,                                           &amp; <span class="comment">! rain drops freezing shattering (RDSF)</span></div>
<div class="line"><a name="l00271"></a><span class="lineno">  271</span>&#160;     ztot_th_wetg, ztot_rc_wetg, ztot_cc_wetg, ztot_rr_wetg, ztot_cr_wetg, &amp; <span class="comment">! wet growth of graupel (WETG)</span></div>
<div class="line"><a name="l00272"></a><span class="lineno">  272</span>&#160;     ztot_ri_wetg, ztot_ci_wetg, ztot_rs_wetg, ztot_cs_wetg, ztot_rg_wetg, ztot_cg_wetg, ztot_rh_wetg, &amp; <span class="comment">! wet growth of graupel (WETG)</span></div>
<div class="line"><a name="l00273"></a><span class="lineno">  273</span>&#160;     ztot_th_dryg, ztot_rc_dryg, ztot_cc_dryg, ztot_rr_dryg, ztot_cr_dryg, &amp; <span class="comment">! dry growth of graupel (DRYG)</span></div>
<div class="line"><a name="l00274"></a><span class="lineno">  274</span>&#160;     ztot_ri_dryg, ztot_ci_dryg, ztot_rs_dryg, ztot_cs_dryg, ztot_rg_dryg,               &amp; <span class="comment">! dry growth of graupel (DRYG)</span></div>
<div class="line"><a name="l00275"></a><span class="lineno">  275</span>&#160;     ztot_ri_hmg, ztot_ci_hmg, ztot_rg_hmg,                                &amp; <span class="comment">! hallett mossop graupel (HMG)</span></div>
<div class="line"><a name="l00276"></a><span class="lineno">  276</span>&#160;     ztot_th_gmlt, ztot_rr_gmlt, ztot_cr_gmlt, ztot_cg_gmlt,               &amp; <span class="comment">! graupel melting (GMLT)</span></div>
<div class="line"><a name="l00277"></a><span class="lineno">  277</span>&#160;     ztot_th_deph, ztot_rh_deph,                                           &amp; <span class="comment">! deposition of vapor on hail (DEPH)</span></div>
<div class="line"><a name="l00278"></a><span class="lineno">  278</span>&#160;     ztot_th_weth, ztot_rc_weth, ztot_cc_weth, ztot_rr_weth, ztot_cr_weth, &amp; <span class="comment">! wet growth of hail (WETH)</span></div>
<div class="line"><a name="l00279"></a><span class="lineno">  279</span>&#160;     ztot_ri_weth, ztot_ci_weth, ztot_rs_weth, ztot_cs_weth, ztot_rg_weth, ztot_cg_weth, ztot_rh_weth, &amp; <span class="comment">! wet growth of hail (WETH)</span></div>
<div class="line"><a name="l00280"></a><span class="lineno">  280</span>&#160;     ztot_rg_cohg, ztot_cg_cohg,                                           &amp; <span class="comment">! conversion of hail into graupel (COHG)</span></div>
<div class="line"><a name="l00281"></a><span class="lineno">  281</span>&#160;     ztot_th_hmlt, ztot_rr_hmlt, ztot_cr_hmlt, ztot_ch_hmlt,               &amp; <span class="comment">! hail melting (HMLT)</span></div>
<div class="line"><a name="l00282"></a><span class="lineno">  282</span>&#160;     ztot_rr_cvrc, ztot_cr_cvrc,                                           &amp; <span class="comment">! conversion of rain into cloud droplets if diameter too small</span></div>
<div class="line"><a name="l00283"></a><span class="lineno">  283</span>&#160;     ztot_rv_corr2, ztot_rc_corr2, ztot_rr_corr2, ztot_ri_corr2,           &amp;</div>
<div class="line"><a name="l00284"></a><span class="lineno">  284</span>&#160;     ztot_cc_corr2, ztot_cr_corr2, ztot_ci_corr2,                          &amp;</div>
<div class="line"><a name="l00285"></a><span class="lineno">  285</span>&#160;<span class="comment">!++cb++</span></div>
<div class="line"><a name="l00286"></a><span class="lineno">  286</span>&#160;     ztot_ri_hind, ztot_rc_hinc, ztot_rv_henu, ztot_rv_honh</div>
<div class="line"><a name="l00287"></a><span class="lineno">  287</span>&#160;<span class="comment">!--cb--</span></div>
<div class="line"><a name="l00288"></a><span class="lineno">  288</span>&#160;<span class="keywordtype">REAL</span>, <span class="keywordtype">DIMENSION(:,:,:,:)</span>, <span class="keywordtype">ALLOCATABLE</span> :: ZTOT_IFNN_IMLT</div>
<div class="line"><a name="l00289"></a><span class="lineno">  289</span>&#160; </div>
<div class="line"><a name="l00290"></a><span class="lineno">  290</span>&#160;<span class="comment">!</span></div>
<div class="line"><a name="l00291"></a><span class="lineno">  291</span>&#160;<span class="comment">!For mixing-ratio splitting</span></div>
<div class="line"><a name="l00292"></a><span class="lineno">  292</span>&#160;<span class="keywordtype">REAL</span>, <span class="keywordtype">DIMENSION(SIZE(PRT,1),SIZE(PRT,2),SIZE(PRT,3))</span> :: Z0RVT,   Z0RCT,   Z0RRT,   Z0RIT,   Z0RST,   Z0RGT,   Z0RHT</div>
<div class="line"><a name="l00293"></a><span class="lineno">  293</span>&#160;<span class="keywordtype">REAL</span>, <span class="keywordtype">DIMENSION(:)</span>, <span class="keywordtype">ALLOCATABLE</span>                      :: Z0RVT1D, Z0RCT1D, Z0RRT1D, Z0RIT1D, Z0RST1D, Z0RGT1D, Z0RHT1D </div>
<div class="line"><a name="l00294"></a><span class="lineno">  294</span>&#160; </div>
<div class="line"><a name="l00295"></a><span class="lineno">  295</span>&#160;<span class="comment">!</span></div>
<div class="line"><a name="l00296"></a><span class="lineno">  296</span>&#160;<span class="comment">! Loop control variables</span></div>
<div class="line"><a name="l00297"></a><span class="lineno">  297</span>&#160;<span class="keywordtype">REAL</span>,    <span class="keywordtype">DIMENSION(SIZE(PRT,1),SIZE(PRT,2),SIZE(PRT,3))</span> :: ZTIME,   ZTIME_LASTCALL,   IITER</div>
<div class="line"><a name="l00298"></a><span class="lineno">  298</span>&#160;<span class="keywordtype">REAL</span>,    <span class="keywordtype">DIMENSION(:)</span>, <span class="keywordtype">ALLOCATABLE</span>                      :: ZTIME1D, ZTIME_LASTCALL1D, IITER1D, ZMAXTIME, ZTIME_THRESHOLD</div>
<div class="line"><a name="l00299"></a><span class="lineno">  299</span>&#160;<span class="keywordtype">LOGICAL</span>, <span class="keywordtype">DIMENSION(SIZE(PRT,1),SIZE(PRT,2),SIZE(PRT,3))</span> :: LLCOMPUTE</div>
<div class="line"><a name="l00300"></a><span class="lineno">  300</span>&#160;<span class="keywordtype">LOGICAL</span>, <span class="keywordtype">DIMENSION(:)</span>, <span class="keywordtype">ALLOCATABLE</span>                      :: LLCOMPUTE1D</div>
<div class="line"><a name="l00301"></a><span class="lineno">  301</span>&#160;<span class="keywordtype">REAL</span>                                                    :: ZTSTEP</div>
<div class="line"><a name="l00302"></a><span class="lineno">  302</span>&#160;<span class="keywordtype">INTEGER</span>                                                 :: INB_ITER_MAX</div>
<div class="line"><a name="l00303"></a><span class="lineno">  303</span>&#160;<span class="comment">!</span></div>
<div class="line"><a name="l00304"></a><span class="lineno">  304</span>&#160;<span class="comment">!For subgrid clouds</span></div>
<div class="line"><a name="l00305"></a><span class="lineno">  305</span>&#160;<span class="keywordtype">REAL</span>, <span class="keywordtype">DIMENSION(:)</span>, <span class="keywordtype">ALLOCATABLE</span>                      :: ZCF1D, ZIF1D, ZPF1D     <span class="comment">! 1D packed cloud, ice and precip. frac.</span></div>
<div class="line"><a name="l00306"></a><span class="lineno">  306</span>&#160; </div>
<div class="line"><a name="l00307"></a><span class="lineno">  307</span>&#160;<span class="comment">!</span></div>
<div class="line"><a name="l00308"></a><span class="lineno">  308</span>&#160;<span class="comment">! Various parameters</span></div>
<div class="line"><a name="l00309"></a><span class="lineno">  309</span>&#160;<span class="comment">! domain size and levels (AROME compatibility)</span></div>
<div class="line"><a name="l00310"></a><span class="lineno">  310</span>&#160;<span class="keywordtype">INTEGER</span> :: KRR</div>
<div class="line"><a name="l00311"></a><span class="lineno">  311</span>&#160;<span class="comment">! loops and packing</span></div>
<div class="line"><a name="l00312"></a><span class="lineno">  312</span>&#160;<span class="keywordtype">INTEGER</span> :: II, IPACK, JN</div>
<div class="line"><a name="l00313"></a><span class="lineno">  313</span>&#160;<span class="keywordtype">integer</span> :: idx</div>
<div class="line"><a name="l00314"></a><span class="lineno">  314</span>&#160;<span class="keywordtype">INTEGER</span>, <span class="keywordtype">DIMENSION(:)</span>, <span class="keywordtype">ALLOCATABLE</span> :: I1, I2, I3</div>
<div class="line"><a name="l00315"></a><span class="lineno">  315</span>&#160;<span class="comment">! Inverse ov PTSTEP</span></div>
<div class="line"><a name="l00316"></a><span class="lineno">  316</span>&#160;<span class="keywordtype">REAL</span> :: ZINV_TSTEP</div>
<div class="line"><a name="l00317"></a><span class="lineno">  317</span>&#160;<span class="comment">! Work arrays</span></div>
<div class="line"><a name="l00318"></a><span class="lineno">  318</span>&#160;<span class="keywordtype">REAL</span>, <span class="keywordtype">DIMENSION(SIZE(PRT,1),SIZE(PRT,2))</span>             :: ZW2D</div>
<div class="line"><a name="l00319"></a><span class="lineno">  319</span>&#160;<span class="keywordtype">REAL</span>, <span class="keywordtype">DIMENSION(SIZE(PRT,1),SIZE(PRT,2),SIZE(PRT,3))</span> :: ZRT_SUM <span class="comment">! Total condensed water mr</span></div>
<div class="line"><a name="l00320"></a><span class="lineno">  320</span>&#160;<span class="keywordtype">REAL</span>, <span class="keywordtype">DIMENSION(SIZE(PRT,1),SIZE(PRT,2),SIZE(PRT,3))</span> :: ZCPT    <span class="comment">! Total condensed water mr</span></div>
<div class="line"><a name="l00321"></a><span class="lineno">  321</span>&#160;<span class="keywordtype">LOGICAL</span>, <span class="keywordtype">DIMENSION(SIZE(PRT,1),SIZE(PRT,2))</span>          :: GDEP</div>
<div class="line"><a name="l00322"></a><span class="lineno">  322</span>&#160;<span class="keywordtype">real</span>, <span class="keywordtype">dimension(:,:,:)</span>, <span class="keywordtype">allocatable</span> :: zrhodjontstep</div>
<div class="line"><a name="l00323"></a><span class="lineno">  323</span>&#160;<span class="comment">!</span></div>
<div class="line"><a name="l00324"></a><span class="lineno">  324</span>&#160;<span class="keywordtype">INTEGER</span> :: ISV_LIMA_NC</div>
<div class="line"><a name="l00325"></a><span class="lineno">  325</span>&#160;<span class="keywordtype">INTEGER</span> :: ISV_LIMA_NR</div>
<div class="line"><a name="l00326"></a><span class="lineno">  326</span>&#160;<span class="keywordtype">INTEGER</span> :: ISV_LIMA_CCN_FREE</div>
<div class="line"><a name="l00327"></a><span class="lineno">  327</span>&#160;<span class="keywordtype">INTEGER</span> :: ISV_LIMA_CCN_ACTI</div>
<div class="line"><a name="l00328"></a><span class="lineno">  328</span>&#160;<span class="keywordtype">INTEGER</span> :: ISV_LIMA_NI</div>
<div class="line"><a name="l00329"></a><span class="lineno">  329</span>&#160;<span class="keywordtype">INTEGER</span> :: ISV_LIMA_NS</div>
<div class="line"><a name="l00330"></a><span class="lineno">  330</span>&#160;<span class="keywordtype">INTEGER</span> :: ISV_LIMA_NG</div>
<div class="line"><a name="l00331"></a><span class="lineno">  331</span>&#160;<span class="keywordtype">INTEGER</span> :: ISV_LIMA_NH</div>
<div class="line"><a name="l00332"></a><span class="lineno">  332</span>&#160;<span class="keywordtype">INTEGER</span> :: ISV_LIMA_IFN_FREE</div>
<div class="line"><a name="l00333"></a><span class="lineno">  333</span>&#160;<span class="keywordtype">INTEGER</span> :: ISV_LIMA_IFN_NUCL</div>
<div class="line"><a name="l00334"></a><span class="lineno">  334</span>&#160;<span class="keywordtype">INTEGER</span> :: ISV_LIMA_IMM_NUCL</div>
<div class="line"><a name="l00335"></a><span class="lineno">  335</span>&#160;<span class="keywordtype">INTEGER</span> :: ISV_LIMA_HOM_HAZE</div>
<div class="line"><a name="l00336"></a><span class="lineno">  336</span>&#160;<span class="comment">!</span></div>
<div class="line"><a name="l00337"></a><span class="lineno">  337</span>&#160;<span class="comment">! Variables for the electrification scheme</span></div>
<div class="line"><a name="l00338"></a><span class="lineno">  338</span>&#160;<span class="keywordtype">LOGICAL</span>, <span class="keywordtype">DIMENSION(:,:,:)</span>, <span class="keywordtype">ALLOCATABLE</span> :: GMASK_ELEC</div>
<div class="line"><a name="l00339"></a><span class="lineno">  339</span>&#160;<span class="keywordtype">INTEGER</span> :: JL    <span class="comment">! loop index</span></div>
<div class="line"><a name="l00340"></a><span class="lineno">  340</span>&#160;<span class="keywordtype">INTEGER</span> :: IELEC <span class="comment">! nb of points where the electrification scheme may apply</span></div>
<div class="line"><a name="l00341"></a><span class="lineno">  341</span>&#160;<span class="keywordtype">REAL</span>, <span class="keywordtype">DIMENSION(:,:,:)</span>, <span class="keywordtype">ALLOCATABLE</span> :: ZQPIT, ZQNIT, ZQCT, ZQRT, ZQIT, ZQST, ZQGT, ZQHT</div>
<div class="line"><a name="l00342"></a><span class="lineno">  342</span>&#160;<span class="keywordtype">REAL</span>, <span class="keywordtype">DIMENSION(:,:,:)</span>, <span class="keywordtype">ALLOCATABLE</span> :: ZQPIS, ZQNIS, ZQCS, ZQRS, ZQIS, ZQSS, ZQGS, ZQHS</div>
<div class="line"><a name="l00343"></a><span class="lineno">  343</span>&#160;<span class="keywordtype">REAL</span>, <span class="keywordtype">DIMENSION(:,:,:)</span>, <span class="keywordtype">ALLOCATABLE</span> :: ZRVT_ELEC, ZRCT_ELEC, ZRRT_ELEC, ZRIT_ELEC, ZRST_ELEC, ZRGT_ELEC, ZRHT_ELEC</div>
<div class="line"><a name="l00344"></a><span class="lineno">  344</span>&#160;<span class="keywordtype">REAL</span>, <span class="keywordtype">DIMENSION(:,:,:)</span>, <span class="keywordtype">ALLOCATABLE</span> :: ZCCT_ELEC, ZCRT_ELEC, ZCIT_ELEC, ZCST_ELEC, ZCGT_ELEC, ZCHT_ELEC</div>
<div class="line"><a name="l00345"></a><span class="lineno">  345</span>&#160;<span class="keywordtype">REAL</span>, <span class="keywordtype">DIMENSION(:)</span>,     <span class="keywordtype">ALLOCATABLE</span> :: ZLATHAM_IAGGS</div>
<div class="line"><a name="l00346"></a><span class="lineno">  346</span>&#160;<span class="comment">!</span></div>
<div class="line"><a name="l00347"></a><span class="lineno">  347</span>&#160;<span class="comment">!-------------------------------------------------------------------------------</span></div>
<div class="line"><a name="l00348"></a><span class="lineno">  348</span>&#160;<span class="comment">!</span></div>
<div class="line"><a name="l00349"></a><span class="lineno">  349</span>&#160;<span class="comment">!*       0.     Init</span></div>
<div class="line"><a name="l00350"></a><span class="lineno">  350</span>&#160;<span class="comment">!               ----</span></div>
<div class="line"><a name="l00351"></a><span class="lineno">  351</span>&#160;<span class="comment">!</span></div>
<div class="line"><a name="l00352"></a><span class="lineno">  352</span>&#160;isv_lima_nc       = <a class="code" href="namespacemodd__nsv.html#a40a6809489f33d2332c09e3cdf634f64">nsv_lima_nc</a>       - <a class="code" href="namespacemodd__nsv.html#a8c00f36702d1825185256967b62b74fa">nsv_lima_beg</a> + 1</div>
<div class="line"><a name="l00353"></a><span class="lineno">  353</span>&#160;isv_lima_nr       = <a class="code" href="namespacemodd__nsv.html#a0f254b896adb763119f451ed055d2463">nsv_lima_nr</a>       - <a class="code" href="namespacemodd__nsv.html#a8c00f36702d1825185256967b62b74fa">nsv_lima_beg</a> + 1</div>
<div class="line"><a name="l00354"></a><span class="lineno">  354</span>&#160;isv_lima_ccn_free = <a class="code" href="namespacemodd__nsv.html#a6893062dccf1eaf4b3c7176ed79bf69c">nsv_lima_ccn_free</a> - <a class="code" href="namespacemodd__nsv.html#a8c00f36702d1825185256967b62b74fa">nsv_lima_beg</a> + 1</div>
<div class="line"><a name="l00355"></a><span class="lineno">  355</span>&#160;isv_lima_ccn_acti = <a class="code" href="namespacemodd__nsv.html#a2716603ec6e0fb69695c2b3e0e166e6f">nsv_lima_ccn_acti</a> - <a class="code" href="namespacemodd__nsv.html#a8c00f36702d1825185256967b62b74fa">nsv_lima_beg</a> + 1</div>
<div class="line"><a name="l00356"></a><span class="lineno">  356</span>&#160;isv_lima_ni       = <a class="code" href="namespacemodd__nsv.html#a42ef78d1d5be64b40c0969a07598e268">nsv_lima_ni</a>       - <a class="code" href="namespacemodd__nsv.html#a8c00f36702d1825185256967b62b74fa">nsv_lima_beg</a> + 1</div>
<div class="line"><a name="l00357"></a><span class="lineno">  357</span>&#160;isv_lima_ns       = <a class="code" href="namespacemodd__nsv.html#a88f9a0bd54e36147cedeb35da2648aac">nsv_lima_ns</a>       - <a class="code" href="namespacemodd__nsv.html#a8c00f36702d1825185256967b62b74fa">nsv_lima_beg</a> + 1</div>
<div class="line"><a name="l00358"></a><span class="lineno">  358</span>&#160;isv_lima_ng       = <a class="code" href="namespacemodd__nsv.html#a822424cae100267f4e55c551af04dae9">nsv_lima_ng</a>       - <a class="code" href="namespacemodd__nsv.html#a8c00f36702d1825185256967b62b74fa">nsv_lima_beg</a> + 1</div>
<div class="line"><a name="l00359"></a><span class="lineno">  359</span>&#160;isv_lima_nh       = <a class="code" href="namespacemodd__nsv.html#aee0d9e88c097894c400536f6199a19c3">nsv_lima_nh</a>       - <a class="code" href="namespacemodd__nsv.html#a8c00f36702d1825185256967b62b74fa">nsv_lima_beg</a> + 1</div>
<div class="line"><a name="l00360"></a><span class="lineno">  360</span>&#160;isv_lima_ifn_free = <a class="code" href="namespacemodd__nsv.html#a5608d5ba016412097d360f6598df7811">nsv_lima_ifn_free</a> - <a class="code" href="namespacemodd__nsv.html#a8c00f36702d1825185256967b62b74fa">nsv_lima_beg</a> + 1</div>
<div class="line"><a name="l00361"></a><span class="lineno">  361</span>&#160;isv_lima_ifn_nucl = <a class="code" href="namespacemodd__nsv.html#a519df160018b4cf7fe248a758edba5b9">nsv_lima_ifn_nucl</a> - <a class="code" href="namespacemodd__nsv.html#a8c00f36702d1825185256967b62b74fa">nsv_lima_beg</a> + 1</div>
<div class="line"><a name="l00362"></a><span class="lineno">  362</span>&#160;isv_lima_imm_nucl = <a class="code" href="namespacemodd__nsv.html#ae44e7d7392e3e216eefb2dc5e11be202">nsv_lima_imm_nucl</a> - <a class="code" href="namespacemodd__nsv.html#a8c00f36702d1825185256967b62b74fa">nsv_lima_beg</a> + 1</div>
<div class="line"><a name="l00363"></a><span class="lineno">  363</span>&#160;isv_lima_hom_haze = <a class="code" href="namespacemodd__nsv.html#a9ac00e065d57a5a8d3a6ba7565274e98">nsv_lima_hom_haze</a> - <a class="code" href="namespacemodd__nsv.html#a8c00f36702d1825185256967b62b74fa">nsv_lima_beg</a> + 1</div>
<div class="line"><a name="l00364"></a><span class="lineno">  364</span>&#160;<span class="comment">!</span></div>
<div class="line"><a name="l00365"></a><span class="lineno">  365</span>&#160;zths(:,:,:) = pths(:,:,:)</div>
<div class="line"><a name="l00366"></a><span class="lineno">  366</span>&#160;ztht(:,:,:) = pths(:,:,:) * ptstep</div>
<div class="line"><a name="l00367"></a><span class="lineno">  367</span>&#160;zrvt(:,:,:) = 0.</div>
<div class="line"><a name="l00368"></a><span class="lineno">  368</span>&#160;zrvs(:,:,:) = 0.</div>
<div class="line"><a name="l00369"></a><span class="lineno">  369</span>&#160;zrct(:,:,:) = 0.</div>
<div class="line"><a name="l00370"></a><span class="lineno">  370</span>&#160;zrcs(:,:,:) = 0.</div>
<div class="line"><a name="l00371"></a><span class="lineno">  371</span>&#160;zrrt(:,:,:) = 0.</div>
<div class="line"><a name="l00372"></a><span class="lineno">  372</span>&#160;zrrs(:,:,:) = 0.</div>
<div class="line"><a name="l00373"></a><span class="lineno">  373</span>&#160;zrit(:,:,:) = 0.</div>
<div class="line"><a name="l00374"></a><span class="lineno">  374</span>&#160;zris(:,:,:) = 0.</div>
<div class="line"><a name="l00375"></a><span class="lineno">  375</span>&#160;zrst(:,:,:) = 0.</div>
<div class="line"><a name="l00376"></a><span class="lineno">  376</span>&#160;zrss(:,:,:) = 0.</div>
<div class="line"><a name="l00377"></a><span class="lineno">  377</span>&#160;zrgt(:,:,:) = 0.</div>
<div class="line"><a name="l00378"></a><span class="lineno">  378</span>&#160;zrgs(:,:,:) = 0.</div>
<div class="line"><a name="l00379"></a><span class="lineno">  379</span>&#160;zrht(:,:,:) = 0.</div>
<div class="line"><a name="l00380"></a><span class="lineno">  380</span>&#160;zrhs(:,:,:) = 0.</div>
<div class="line"><a name="l00381"></a><span class="lineno">  381</span>&#160;zrt_sum(:,:,:) = 0.</div>
<div class="line"><a name="l00382"></a><span class="lineno">  382</span>&#160;zcct(:,:,:)   = 0.</div>
<div class="line"><a name="l00383"></a><span class="lineno">  383</span>&#160;zccs(:,:,:)   = 0.</div>
<div class="line"><a name="l00384"></a><span class="lineno">  384</span>&#160;zcrt(:,:,:)   = 0.</div>
<div class="line"><a name="l00385"></a><span class="lineno">  385</span>&#160;zcrs(:,:,:)   = 0.</div>
<div class="line"><a name="l00386"></a><span class="lineno">  386</span>&#160;zcit(:,:,:)   = 0.</div>
<div class="line"><a name="l00387"></a><span class="lineno">  387</span>&#160;zcis(:,:,:)   = 0.</div>
<div class="line"><a name="l00388"></a><span class="lineno">  388</span>&#160;zcst(:,:,:)   = 0.</div>
<div class="line"><a name="l00389"></a><span class="lineno">  389</span>&#160;zcss(:,:,:)   = 0.</div>
<div class="line"><a name="l00390"></a><span class="lineno">  390</span>&#160;zcgt(:,:,:)   = 0.</div>
<div class="line"><a name="l00391"></a><span class="lineno">  391</span>&#160;zcgs(:,:,:)   = 0.</div>
<div class="line"><a name="l00392"></a><span class="lineno">  392</span>&#160;zcht(:,:,:)   = 0.</div>
<div class="line"><a name="l00393"></a><span class="lineno">  393</span>&#160;zchs(:,:,:)   = 0.</div>
<div class="line"><a name="l00394"></a><span class="lineno">  394</span>&#160;zccnft(:,:,:,:) = 0.</div>
<div class="line"><a name="l00395"></a><span class="lineno">  395</span>&#160;zccnat(:,:,:,:) = 0.</div>
<div class="line"><a name="l00396"></a><span class="lineno">  396</span>&#160;zccnfs(:,:,:,:) = 0.</div>
<div class="line"><a name="l00397"></a><span class="lineno">  397</span>&#160;zccnas(:,:,:,:) = 0.</div>
<div class="line"><a name="l00398"></a><span class="lineno">  398</span>&#160;zifnft(:,:,:,:) = 0.</div>
<div class="line"><a name="l00399"></a><span class="lineno">  399</span>&#160;zifnnt(:,:,:,:) = 0.</div>
<div class="line"><a name="l00400"></a><span class="lineno">  400</span>&#160;zifnfs(:,:,:,:) = 0.</div>
<div class="line"><a name="l00401"></a><span class="lineno">  401</span>&#160;zifnns(:,:,:,:) = 0.</div>
<div class="line"><a name="l00402"></a><span class="lineno">  402</span>&#160;zimmnt(:,:,:,:) = 0.</div>
<div class="line"><a name="l00403"></a><span class="lineno">  403</span>&#160;zimmns(:,:,:,:) = 0.</div>
<div class="line"><a name="l00404"></a><span class="lineno">  404</span>&#160;zhomft(:,:,:)   = 0.</div>
<div class="line"><a name="l00405"></a><span class="lineno">  405</span>&#160;zhomfs(:,:,:)   = 0.</div>
<div class="line"><a name="l00406"></a><span class="lineno">  406</span>&#160; </div>
<div class="line"><a name="l00407"></a><span class="lineno">  407</span>&#160;<span class="comment">!++cb++</span></div>
<div class="line"><a name="l00408"></a><span class="lineno">  408</span>&#160;<span class="keywordflow">if</span> ( buconf%lbu_enable .OR. oelec) <span class="keywordflow">then</span></div>
<div class="line"><a name="l00409"></a><span class="lineno">  409</span>&#160;<span class="comment">!--cb--</span></div>
<div class="line"><a name="l00410"></a><span class="lineno">  410</span>&#160;  z_rr_cvrc(:,:,:) = 0.</div>
<div class="line"><a name="l00411"></a><span class="lineno">  411</span>&#160;  z_cr_cvrc(:,:,:) = 0.</div>
<div class="line"><a name="l00412"></a><span class="lineno">  412</span>&#160;  <span class="keyword">allocate</span>( ztot_cr_brku(<span class="keyword">size</span>( ptht, 1), <span class="keyword">size</span>( ptht, 2), <span class="keyword">size</span>( ptht, 3) ) ); ztot_cr_brku(:,:,:) = 0.</div>
<div class="line"><a name="l00413"></a><span class="lineno">  413</span>&#160;  <span class="keyword">allocate</span>( ztot_th_honr(<span class="keyword">size</span>( ptht, 1), <span class="keyword">size</span>( ptht, 2), <span class="keyword">size</span>( ptht, 3) ) ); ztot_th_honr(:,:,:) = 0.</div>
<div class="line"><a name="l00414"></a><span class="lineno">  414</span>&#160;  <span class="keyword">allocate</span>( ztot_rr_honr(<span class="keyword">size</span>( ptht, 1), <span class="keyword">size</span>( ptht, 2), <span class="keyword">size</span>( ptht, 3) ) ); ztot_rr_honr(:,:,:) = 0.</div>
<div class="line"><a name="l00415"></a><span class="lineno">  415</span>&#160;  <span class="keyword">allocate</span>( ztot_cr_honr(<span class="keyword">size</span>( ptht, 1), <span class="keyword">size</span>( ptht, 2), <span class="keyword">size</span>( ptht, 3) ) ); ztot_cr_honr(:,:,:) = 0.</div>
<div class="line"><a name="l00416"></a><span class="lineno">  416</span>&#160;  <span class="keyword">allocate</span>( ztot_th_imlt(<span class="keyword">size</span>( ptht, 1), <span class="keyword">size</span>( ptht, 2), <span class="keyword">size</span>( ptht, 3) ) ); ztot_th_imlt(:,:,:) = 0.</div>
<div class="line"><a name="l00417"></a><span class="lineno">  417</span>&#160;  <span class="keyword">allocate</span>( ztot_rc_imlt(<span class="keyword">size</span>( ptht, 1), <span class="keyword">size</span>( ptht, 2), <span class="keyword">size</span>( ptht, 3) ) ); ztot_rc_imlt(:,:,:) = 0.</div>
<div class="line"><a name="l00418"></a><span class="lineno">  418</span>&#160;  <span class="keyword">allocate</span>( ztot_cc_imlt(<span class="keyword">size</span>( ptht, 1), <span class="keyword">size</span>( ptht, 2), <span class="keyword">size</span>( ptht, 3) ) ); ztot_cc_imlt(:,:,:) = 0.</div>
<div class="line"><a name="l00419"></a><span class="lineno">  419</span>&#160;  <span class="keyword">allocate</span>( ztot_ifnn_imlt(<span class="keyword">size</span>( ptht, 1), <span class="keyword">size</span>( ptht, 2), <span class="keyword">size</span>( ptht, 3), <a class="code" href="namespacemodd__param__lima.html#a2b98a3f23053acfd971d523a0778f209">nmod_ifn</a> ) ); ztot_ifnn_imlt(:,:,:,:) = 0.</div>
<div class="line"><a name="l00420"></a><span class="lineno">  420</span>&#160;  <span class="keyword">allocate</span>( ztot_th_honc(<span class="keyword">size</span>( ptht, 1), <span class="keyword">size</span>( ptht, 2), <span class="keyword">size</span>( ptht, 3) ) ); ztot_th_honc(:,:,:) = 0.</div>
<div class="line"><a name="l00421"></a><span class="lineno">  421</span>&#160;  <span class="keyword">allocate</span>( ztot_rc_honc(<span class="keyword">size</span>( ptht, 1), <span class="keyword">size</span>( ptht, 2), <span class="keyword">size</span>( ptht, 3) ) ); ztot_rc_honc(:,:,:) = 0.</div>
<div class="line"><a name="l00422"></a><span class="lineno">  422</span>&#160;  <span class="keyword">allocate</span>( ztot_cc_honc(<span class="keyword">size</span>( ptht, 1), <span class="keyword">size</span>( ptht, 2), <span class="keyword">size</span>( ptht, 3) ) ); ztot_cc_honc(:,:,:) = 0.</div>
<div class="line"><a name="l00423"></a><span class="lineno">  423</span>&#160;  <span class="keyword">allocate</span>( ztot_cc_self(<span class="keyword">size</span>( ptht, 1), <span class="keyword">size</span>( ptht, 2), <span class="keyword">size</span>( ptht, 3) ) ); ztot_cc_self(:,:,:) = 0.</div>
<div class="line"><a name="l00424"></a><span class="lineno">  424</span>&#160;  <span class="keyword">allocate</span>( ztot_rc_auto(<span class="keyword">size</span>( ptht, 1), <span class="keyword">size</span>( ptht, 2), <span class="keyword">size</span>( ptht, 3) ) ); ztot_rc_auto(:,:,:) = 0.</div>
<div class="line"><a name="l00425"></a><span class="lineno">  425</span>&#160;  <span class="keyword">allocate</span>( ztot_cc_auto(<span class="keyword">size</span>( ptht, 1), <span class="keyword">size</span>( ptht, 2), <span class="keyword">size</span>( ptht, 3) ) ); ztot_cc_auto(:,:,:) = 0.</div>
<div class="line"><a name="l00426"></a><span class="lineno">  426</span>&#160;  <span class="keyword">allocate</span>( ztot_cr_auto(<span class="keyword">size</span>( ptht, 1), <span class="keyword">size</span>( ptht, 2), <span class="keyword">size</span>( ptht, 3) ) ); ztot_cr_auto(:,:,:) = 0.</div>
<div class="line"><a name="l00427"></a><span class="lineno">  427</span>&#160;  <span class="keyword">allocate</span>( ztot_rc_accr(<span class="keyword">size</span>( ptht, 1), <span class="keyword">size</span>( ptht, 2), <span class="keyword">size</span>( ptht, 3) ) ); ztot_rc_accr(:,:,:) = 0.</div>
<div class="line"><a name="l00428"></a><span class="lineno">  428</span>&#160;  <span class="keyword">allocate</span>( ztot_cc_accr(<span class="keyword">size</span>( ptht, 1), <span class="keyword">size</span>( ptht, 2), <span class="keyword">size</span>( ptht, 3) ) ); ztot_cc_accr(:,:,:) = 0.</div>
<div class="line"><a name="l00429"></a><span class="lineno">  429</span>&#160;  <span class="keyword">allocate</span>( ztot_cr_scbu(<span class="keyword">size</span>( ptht, 1), <span class="keyword">size</span>( ptht, 2), <span class="keyword">size</span>( ptht, 3) ) ); ztot_cr_scbu(:,:,:) = 0.</div>
<div class="line"><a name="l00430"></a><span class="lineno">  430</span>&#160;  <span class="keyword">allocate</span>( ztot_th_evap(<span class="keyword">size</span>( ptht, 1), <span class="keyword">size</span>( ptht, 2), <span class="keyword">size</span>( ptht, 3) ) ); ztot_th_evap(:,:,:) = 0.</div>
<div class="line"><a name="l00431"></a><span class="lineno">  431</span>&#160;<span class="comment">!   allocate( ZTOT_RC_EVAP (size( ptht, 1), size( ptht, 2), size( ptht, 3) ) ); ZTOT_RC_EVAP(:,:,:) = 0.</span></div>
<div class="line"><a name="l00432"></a><span class="lineno">  432</span>&#160;<span class="comment">!   allocate( ZTOT_CC_EVAP (size( ptht, 1), size( ptht, 2), size( ptht, 3) ) ); ZTOT_CC_EVAP(:,:,:) = 0.</span></div>
<div class="line"><a name="l00433"></a><span class="lineno">  433</span>&#160;  <span class="keyword">allocate</span>( ztot_rr_evap(<span class="keyword">size</span>( ptht, 1), <span class="keyword">size</span>( ptht, 2), <span class="keyword">size</span>( ptht, 3) ) ); ztot_rr_evap(:,:,:) = 0.</div>
<div class="line"><a name="l00434"></a><span class="lineno">  434</span>&#160;  <span class="keyword">allocate</span>( ztot_cr_evap(<span class="keyword">size</span>( ptht, 1), <span class="keyword">size</span>( ptht, 2), <span class="keyword">size</span>( ptht, 3) ) ); ztot_cr_evap(:,:,:) = 0.</div>
<div class="line"><a name="l00435"></a><span class="lineno">  435</span>&#160;  <span class="keyword">allocate</span>( ztot_ri_cnvi(<span class="keyword">size</span>( ptht, 1), <span class="keyword">size</span>( ptht, 2), <span class="keyword">size</span>( ptht, 3) ) ); ztot_ri_cnvi(:,:,:) = 0.</div>
<div class="line"><a name="l00436"></a><span class="lineno">  436</span>&#160;  <span class="keyword">allocate</span>( ztot_ci_cnvi(<span class="keyword">size</span>( ptht, 1), <span class="keyword">size</span>( ptht, 2), <span class="keyword">size</span>( ptht, 3) ) ); ztot_ci_cnvi(:,:,:) = 0.</div>
<div class="line"><a name="l00437"></a><span class="lineno">  437</span>&#160;  <span class="keyword">allocate</span>( ztot_th_deps(<span class="keyword">size</span>( ptht, 1), <span class="keyword">size</span>( ptht, 2), <span class="keyword">size</span>( ptht, 3) ) ); ztot_th_deps(:,:,:) = 0.</div>
<div class="line"><a name="l00438"></a><span class="lineno">  438</span>&#160;  <span class="keyword">allocate</span>( ztot_rs_deps(<span class="keyword">size</span>( ptht, 1), <span class="keyword">size</span>( ptht, 2), <span class="keyword">size</span>( ptht, 3) ) ); ztot_rs_deps(:,:,:) = 0.</div>
<div class="line"><a name="l00439"></a><span class="lineno">  439</span>&#160;  <span class="keyword">allocate</span>( ztot_th_depi(<span class="keyword">size</span>( ptht, 1), <span class="keyword">size</span>( ptht, 2), <span class="keyword">size</span>( ptht, 3) ) ); ztot_th_depi(:,:,:) = 0.</div>
<div class="line"><a name="l00440"></a><span class="lineno">  440</span>&#160;  <span class="keyword">allocate</span>( ztot_ri_depi(<span class="keyword">size</span>( ptht, 1), <span class="keyword">size</span>( ptht, 2), <span class="keyword">size</span>( ptht, 3) ) ); ztot_ri_depi(:,:,:) = 0.</div>
<div class="line"><a name="l00441"></a><span class="lineno">  441</span>&#160;  <span class="keyword">allocate</span>( ztot_ri_cnvs(<span class="keyword">size</span>( ptht, 1), <span class="keyword">size</span>( ptht, 2), <span class="keyword">size</span>( ptht, 3) ) ); ztot_ri_cnvs(:,:,:) = 0.</div>
<div class="line"><a name="l00442"></a><span class="lineno">  442</span>&#160;  <span class="keyword">allocate</span>( ztot_ci_cnvs(<span class="keyword">size</span>( ptht, 1), <span class="keyword">size</span>( ptht, 2), <span class="keyword">size</span>( ptht, 3) ) ); ztot_ci_cnvs(:,:,:) = 0.</div>
<div class="line"><a name="l00443"></a><span class="lineno">  443</span>&#160;  <span class="keyword">allocate</span>( ztot_cs_ssc(<span class="keyword">size</span>( ptht, 1), <span class="keyword">size</span>( ptht, 2), <span class="keyword">size</span>( ptht, 3) ) ); ztot_cs_ssc(:,:,:) = 0.</div>
<div class="line"><a name="l00444"></a><span class="lineno">  444</span>&#160;  <span class="keyword">allocate</span>( ztot_ri_aggs(<span class="keyword">size</span>( ptht, 1), <span class="keyword">size</span>( ptht, 2), <span class="keyword">size</span>( ptht, 3) ) ); ztot_ri_aggs(:,:,:) = 0.</div>
<div class="line"><a name="l00445"></a><span class="lineno">  445</span>&#160;  <span class="keyword">allocate</span>( ztot_ci_aggs(<span class="keyword">size</span>( ptht, 1), <span class="keyword">size</span>( ptht, 2), <span class="keyword">size</span>( ptht, 3) ) ); ztot_ci_aggs(:,:,:) = 0.</div>
<div class="line"><a name="l00446"></a><span class="lineno">  446</span>&#160;  <span class="keyword">allocate</span>( ztot_th_depg(<span class="keyword">size</span>( ptht, 1), <span class="keyword">size</span>( ptht, 2), <span class="keyword">size</span>( ptht, 3) ) ); ztot_th_depg(:,:,:) = 0.</div>
<div class="line"><a name="l00447"></a><span class="lineno">  447</span>&#160;  <span class="keyword">allocate</span>( ztot_rg_depg(<span class="keyword">size</span>( ptht, 1), <span class="keyword">size</span>( ptht, 2), <span class="keyword">size</span>( ptht, 3) ) ); ztot_rg_depg(:,:,:) = 0.</div>
<div class="line"><a name="l00448"></a><span class="lineno">  448</span>&#160;  <span class="keyword">allocate</span>( ztot_th_berfi(<span class="keyword">size</span>( ptht, 1), <span class="keyword">size</span>( ptht, 2), <span class="keyword">size</span>( ptht, 3) ) ); ztot_th_berfi(:,:,:) = 0.</div>
<div class="line"><a name="l00449"></a><span class="lineno">  449</span>&#160;  <span class="keyword">allocate</span>( ztot_rc_berfi(<span class="keyword">size</span>( ptht, 1), <span class="keyword">size</span>( ptht, 2), <span class="keyword">size</span>( ptht, 3) ) ); ztot_rc_berfi(:,:,:) = 0.</div>
<div class="line"><a name="l00450"></a><span class="lineno">  450</span>&#160;<span class="comment">!++cb++ need rcrimss, rcrimsg and rsrimcg to be consistent with ice3</span></div>
<div class="line"><a name="l00451"></a><span class="lineno">  451</span>&#160;  <span class="keyword">allocate</span>( ztot_th_rim(<span class="keyword">size</span>( ptht, 1), <span class="keyword">size</span>( ptht, 2), <span class="keyword">size</span>( ptht, 3) ) ); ztot_th_rim(:,:,:) = 0.</div>
<div class="line"><a name="l00452"></a><span class="lineno">  452</span>&#160;<span class="comment">!  allocate( ZTOT_RC_RIM  (size( ptht, 1), size( ptht, 2), size( ptht, 3) ) ); ZTOT_RC_RIM(:,:,:) = 0.</span></div>
<div class="line"><a name="l00453"></a><span class="lineno">  453</span>&#160;  <span class="keyword">allocate</span>( ztot_cc_rim(<span class="keyword">size</span>( ptht, 1), <span class="keyword">size</span>( ptht, 2), <span class="keyword">size</span>( ptht, 3) ) ); ztot_cc_rim(:,:,:) = 0.</div>
<div class="line"><a name="l00454"></a><span class="lineno">  454</span>&#160;<span class="comment">!  allocate( ZTOT_RS_RIM  (size( ptht, 1), size( ptht, 2), size( ptht, 3) ) ); ZTOT_RS_RIM(:,:,:) = 0.</span></div>
<div class="line"><a name="l00455"></a><span class="lineno">  455</span>&#160;  <span class="keyword">allocate</span>( ztot_cs_rim(<span class="keyword">size</span>( ptht, 1), <span class="keyword">size</span>( ptht, 2), <span class="keyword">size</span>( ptht, 3) ) ); ztot_cs_rim(:,:,:) = 0.</div>
<div class="line"><a name="l00456"></a><span class="lineno">  456</span>&#160;<span class="comment">!  allocate( ZTOT_RG_RIM  (size( ptht, 1), size( ptht, 2), size( ptht, 3) ) ); ZTOT_RG_RIM(:,:,:) = 0.</span></div>
<div class="line"><a name="l00457"></a><span class="lineno">  457</span>&#160;  <span class="keyword">allocate</span>( ztot_rc_rimss(<span class="keyword">size</span>( ptht, 1), <span class="keyword">size</span>( ptht, 2), <span class="keyword">size</span>( ptht, 3) ) ); ztot_rc_rimss(:,:,:) = 0.</div>
<div class="line"><a name="l00458"></a><span class="lineno">  458</span>&#160;  <span class="keyword">allocate</span>( ztot_rc_rimsg(<span class="keyword">size</span>( ptht, 1), <span class="keyword">size</span>( ptht, 2), <span class="keyword">size</span>( ptht, 3) ) ); ztot_rc_rimsg(:,:,:) = 0.</div>
<div class="line"><a name="l00459"></a><span class="lineno">  459</span>&#160;  <span class="keyword">allocate</span>( ztot_rs_rimcg(<span class="keyword">size</span>( ptht, 1), <span class="keyword">size</span>( ptht, 2), <span class="keyword">size</span>( ptht, 3) ) ); ztot_rs_rimcg(:,:,:) = 0.</div>
<div class="line"><a name="l00460"></a><span class="lineno">  460</span>&#160;<span class="comment">!--cb--</span></div>
<div class="line"><a name="l00461"></a><span class="lineno">  461</span>&#160;  <span class="keyword">allocate</span>( ztot_ri_hms(<span class="keyword">size</span>( ptht, 1), <span class="keyword">size</span>( ptht, 2), <span class="keyword">size</span>( ptht, 3) ) ); ztot_ri_hms(:,:,:) = 0.</div>
<div class="line"><a name="l00462"></a><span class="lineno">  462</span>&#160;  <span class="keyword">allocate</span>( ztot_ci_hms(<span class="keyword">size</span>( ptht, 1), <span class="keyword">size</span>( ptht, 2), <span class="keyword">size</span>( ptht, 3) ) ); ztot_ci_hms(:,:,:) = 0.</div>
<div class="line"><a name="l00463"></a><span class="lineno">  463</span>&#160;  <span class="keyword">allocate</span>( ztot_rs_hms(<span class="keyword">size</span>( ptht, 1), <span class="keyword">size</span>( ptht, 2), <span class="keyword">size</span>( ptht, 3) ) ); ztot_rs_hms(:,:,:) = 0.</div>
<div class="line"><a name="l00464"></a><span class="lineno">  464</span>&#160;<span class="comment">!++cb++ need rraccss, rraccsg and rsaccrg to be consistent with ice3</span></div>
<div class="line"><a name="l00465"></a><span class="lineno">  465</span>&#160;  <span class="keyword">allocate</span>( ztot_th_acc(<span class="keyword">size</span>( ptht, 1), <span class="keyword">size</span>( ptht, 2), <span class="keyword">size</span>( ptht, 3) ) ); ztot_th_acc(:,:,:) = 0.</div>
<div class="line"><a name="l00466"></a><span class="lineno">  466</span>&#160;<span class="comment">!  allocate( ZTOT_RR_ACC  (size( ptht, 1), size( ptht, 2), size( ptht, 3) ) ); ZTOT_RR_ACC(:,:,:) = 0.</span></div>
<div class="line"><a name="l00467"></a><span class="lineno">  467</span>&#160;  <span class="keyword">allocate</span>( ztot_cr_acc(<span class="keyword">size</span>( ptht, 1), <span class="keyword">size</span>( ptht, 2), <span class="keyword">size</span>( ptht, 3) ) ); ztot_cr_acc(:,:,:) = 0.</div>
<div class="line"><a name="l00468"></a><span class="lineno">  468</span>&#160;<span class="comment">!  allocate( ZTOT_RS_ACC  (size( ptht, 1), size( ptht, 2), size( ptht, 3) ) ); ZTOT_RS_ACC(:,:,:) = 0.</span></div>
<div class="line"><a name="l00469"></a><span class="lineno">  469</span>&#160;  <span class="keyword">allocate</span>( ztot_cs_acc(<span class="keyword">size</span>( ptht, 1), <span class="keyword">size</span>( ptht, 2), <span class="keyword">size</span>( ptht, 3) ) ); ztot_cs_acc(:,:,:) = 0.</div>
<div class="line"><a name="l00470"></a><span class="lineno">  470</span>&#160;<span class="comment">!  allocate( ZTOT_RG_ACC  (size( ptht, 1), size( ptht, 2), size( ptht, 3) ) ); ZTOT_RG_ACC(:,:,:) = 0.</span></div>
<div class="line"><a name="l00471"></a><span class="lineno">  471</span>&#160;  <span class="keyword">allocate</span>( ztot_rr_accss(<span class="keyword">size</span>( ptht, 1), <span class="keyword">size</span>( ptht, 2), <span class="keyword">size</span>( ptht, 3) ) ); ztot_rr_accss(:,:,:) = 0.</div>
<div class="line"><a name="l00472"></a><span class="lineno">  472</span>&#160;  <span class="keyword">allocate</span>( ztot_rr_accsg(<span class="keyword">size</span>( ptht, 1), <span class="keyword">size</span>( ptht, 2), <span class="keyword">size</span>( ptht, 3) ) ); ztot_rr_accsg(:,:,:) = 0.</div>
<div class="line"><a name="l00473"></a><span class="lineno">  473</span>&#160;  <span class="keyword">allocate</span>( ztot_rs_accrg(<span class="keyword">size</span>( ptht, 1), <span class="keyword">size</span>( ptht, 2), <span class="keyword">size</span>( ptht, 3) ) ); ztot_rs_accrg(:,:,:) = 0.</div>
<div class="line"><a name="l00474"></a><span class="lineno">  474</span>&#160;<span class="comment">!--cb--</span></div>
<div class="line"><a name="l00475"></a><span class="lineno">  475</span>&#160;  <span class="keyword">allocate</span>( ztot_rs_cmel(<span class="keyword">size</span>( ptht, 1), <span class="keyword">size</span>( ptht, 2), <span class="keyword">size</span>( ptht, 3) ) ); ztot_rs_cmel(:,:,:) = 0.</div>
<div class="line"><a name="l00476"></a><span class="lineno">  476</span>&#160;  <span class="keyword">allocate</span>( ztot_cs_cmel(<span class="keyword">size</span>( ptht, 1), <span class="keyword">size</span>( ptht, 2), <span class="keyword">size</span>( ptht, 3) ) ); ztot_cs_cmel(:,:,:) = 0.</div>
<div class="line"><a name="l00477"></a><span class="lineno">  477</span>&#160;  <span class="keyword">allocate</span>( ztot_th_cfrz(<span class="keyword">size</span>( ptht, 1), <span class="keyword">size</span>( ptht, 2), <span class="keyword">size</span>( ptht, 3) ) ); ztot_th_cfrz(:,:,:) = 0.</div>
<div class="line"><a name="l00478"></a><span class="lineno">  478</span>&#160;  <span class="keyword">allocate</span>( ztot_rr_cfrz(<span class="keyword">size</span>( ptht, 1), <span class="keyword">size</span>( ptht, 2), <span class="keyword">size</span>( ptht, 3) ) ); ztot_rr_cfrz(:,:,:) = 0.</div>
<div class="line"><a name="l00479"></a><span class="lineno">  479</span>&#160;  <span class="keyword">allocate</span>( ztot_cr_cfrz(<span class="keyword">size</span>( ptht, 1), <span class="keyword">size</span>( ptht, 2), <span class="keyword">size</span>( ptht, 3) ) ); ztot_cr_cfrz(:,:,:) = 0.</div>
<div class="line"><a name="l00480"></a><span class="lineno">  480</span>&#160;  <span class="keyword">allocate</span>( ztot_ri_cfrz(<span class="keyword">size</span>( ptht, 1), <span class="keyword">size</span>( ptht, 2), <span class="keyword">size</span>( ptht, 3) ) ); ztot_ri_cfrz(:,:,:) = 0.</div>
<div class="line"><a name="l00481"></a><span class="lineno">  481</span>&#160;  <span class="keyword">allocate</span>( ztot_ci_cfrz(<span class="keyword">size</span>( ptht, 1), <span class="keyword">size</span>( ptht, 2), <span class="keyword">size</span>( ptht, 3) ) ); ztot_ci_cfrz(:,:,:) = 0.</div>
<div class="line"><a name="l00482"></a><span class="lineno">  482</span>&#160;  <span class="keyword">allocate</span>( ztot_ri_cibu(<span class="keyword">size</span>( ptht, 1), <span class="keyword">size</span>( ptht, 2), <span class="keyword">size</span>( ptht, 3) ) ); ztot_ri_cibu(:,:,:) = 0.</div>
<div class="line"><a name="l00483"></a><span class="lineno">  483</span>&#160;  <span class="keyword">allocate</span>( ztot_ci_cibu(<span class="keyword">size</span>( ptht, 1), <span class="keyword">size</span>( ptht, 2), <span class="keyword">size</span>( ptht, 3) ) ); ztot_ci_cibu(:,:,:) = 0.</div>
<div class="line"><a name="l00484"></a><span class="lineno">  484</span>&#160;  <span class="keyword">allocate</span>( ztot_ri_rdsf(<span class="keyword">size</span>( ptht, 1), <span class="keyword">size</span>( ptht, 2), <span class="keyword">size</span>( ptht, 3) ) ); ztot_ri_rdsf(:,:,:) = 0.</div>
<div class="line"><a name="l00485"></a><span class="lineno">  485</span>&#160;  <span class="keyword">allocate</span>( ztot_ci_rdsf(<span class="keyword">size</span>( ptht, 1), <span class="keyword">size</span>( ptht, 2), <span class="keyword">size</span>( ptht, 3) ) ); ztot_ci_rdsf(:,:,:) = 0.</div>
<div class="line"><a name="l00486"></a><span class="lineno">  486</span>&#160;  <span class="keyword">allocate</span>( ztot_th_wetg(<span class="keyword">size</span>( ptht, 1), <span class="keyword">size</span>( ptht, 2), <span class="keyword">size</span>( ptht, 3) ) ); ztot_th_wetg(:,:,:) = 0.</div>
<div class="line"><a name="l00487"></a><span class="lineno">  487</span>&#160;  <span class="keyword">allocate</span>( ztot_rc_wetg(<span class="keyword">size</span>( ptht, 1), <span class="keyword">size</span>( ptht, 2), <span class="keyword">size</span>( ptht, 3) ) ); ztot_rc_wetg(:,:,:) = 0.</div>
<div class="line"><a name="l00488"></a><span class="lineno">  488</span>&#160;  <span class="keyword">allocate</span>( ztot_cc_wetg(<span class="keyword">size</span>( ptht, 1), <span class="keyword">size</span>( ptht, 2), <span class="keyword">size</span>( ptht, 3) ) ); ztot_cc_wetg(:,:,:) = 0.</div>
<div class="line"><a name="l00489"></a><span class="lineno">  489</span>&#160;  <span class="keyword">allocate</span>( ztot_rr_wetg(<span class="keyword">size</span>( ptht, 1), <span class="keyword">size</span>( ptht, 2), <span class="keyword">size</span>( ptht, 3) ) ); ztot_rr_wetg(:,:,:) = 0.</div>
<div class="line"><a name="l00490"></a><span class="lineno">  490</span>&#160;  <span class="keyword">allocate</span>( ztot_cr_wetg(<span class="keyword">size</span>( ptht, 1), <span class="keyword">size</span>( ptht, 2), <span class="keyword">size</span>( ptht, 3) ) ); ztot_cr_wetg(:,:,:) = 0.</div>
<div class="line"><a name="l00491"></a><span class="lineno">  491</span>&#160;  <span class="keyword">allocate</span>( ztot_ri_wetg(<span class="keyword">size</span>( ptht, 1), <span class="keyword">size</span>( ptht, 2), <span class="keyword">size</span>( ptht, 3) ) ); ztot_ri_wetg(:,:,:) = 0.</div>
<div class="line"><a name="l00492"></a><span class="lineno">  492</span>&#160;  <span class="keyword">allocate</span>( ztot_ci_wetg(<span class="keyword">size</span>( ptht, 1), <span class="keyword">size</span>( ptht, 2), <span class="keyword">size</span>( ptht, 3) ) ); ztot_ci_wetg(:,:,:) = 0.</div>
<div class="line"><a name="l00493"></a><span class="lineno">  493</span>&#160;  <span class="keyword">allocate</span>( ztot_rs_wetg(<span class="keyword">size</span>( ptht, 1), <span class="keyword">size</span>( ptht, 2), <span class="keyword">size</span>( ptht, 3) ) ); ztot_rs_wetg(:,:,:) = 0.</div>
<div class="line"><a name="l00494"></a><span class="lineno">  494</span>&#160;  <span class="keyword">allocate</span>( ztot_cs_wetg(<span class="keyword">size</span>( ptht, 1), <span class="keyword">size</span>( ptht, 2), <span class="keyword">size</span>( ptht, 3) ) ); ztot_cs_wetg(:,:,:) = 0.</div>
<div class="line"><a name="l00495"></a><span class="lineno">  495</span>&#160;  <span class="keyword">allocate</span>( ztot_rg_wetg(<span class="keyword">size</span>( ptht, 1), <span class="keyword">size</span>( ptht, 2), <span class="keyword">size</span>( ptht, 3) ) ); ztot_rg_wetg(:,:,:) = 0.</div>
<div class="line"><a name="l00496"></a><span class="lineno">  496</span>&#160;  <span class="keyword">allocate</span>( ztot_cg_wetg(<span class="keyword">size</span>( ptht, 1), <span class="keyword">size</span>( ptht, 2), <span class="keyword">size</span>( ptht, 3) ) ); ztot_cg_wetg(:,:,:) = 0.</div>
<div class="line"><a name="l00497"></a><span class="lineno">  497</span>&#160;  <span class="keyword">allocate</span>( ztot_rh_wetg(<span class="keyword">size</span>( ptht, 1), <span class="keyword">size</span>( ptht, 2), <span class="keyword">size</span>( ptht, 3) ) ); ztot_rh_wetg(:,:,:) = 0.</div>
<div class="line"><a name="l00498"></a><span class="lineno">  498</span>&#160;  <span class="keyword">allocate</span>( ztot_th_dryg(<span class="keyword">size</span>( ptht, 1), <span class="keyword">size</span>( ptht, 2), <span class="keyword">size</span>( ptht, 3) ) ); ztot_th_dryg(:,:,:) = 0.</div>
<div class="line"><a name="l00499"></a><span class="lineno">  499</span>&#160;  <span class="keyword">allocate</span>( ztot_rc_dryg(<span class="keyword">size</span>( ptht, 1), <span class="keyword">size</span>( ptht, 2), <span class="keyword">size</span>( ptht, 3) ) ); ztot_rc_dryg(:,:,:) = 0.</div>
<div class="line"><a name="l00500"></a><span class="lineno">  500</span>&#160;  <span class="keyword">allocate</span>( ztot_cc_dryg(<span class="keyword">size</span>( ptht, 1), <span class="keyword">size</span>( ptht, 2), <span class="keyword">size</span>( ptht, 3) ) ); ztot_cc_dryg(:,:,:) = 0.</div>
<div class="line"><a name="l00501"></a><span class="lineno">  501</span>&#160;  <span class="keyword">allocate</span>( ztot_rr_dryg(<span class="keyword">size</span>( ptht, 1), <span class="keyword">size</span>( ptht, 2), <span class="keyword">size</span>( ptht, 3) ) ); ztot_rr_dryg(:,:,:) = 0.</div>
<div class="line"><a name="l00502"></a><span class="lineno">  502</span>&#160;  <span class="keyword">allocate</span>( ztot_cr_dryg(<span class="keyword">size</span>( ptht, 1), <span class="keyword">size</span>( ptht, 2), <span class="keyword">size</span>( ptht, 3) ) ); ztot_cr_dryg(:,:,:) = 0.</div>
<div class="line"><a name="l00503"></a><span class="lineno">  503</span>&#160;  <span class="keyword">allocate</span>( ztot_ri_dryg(<span class="keyword">size</span>( ptht, 1), <span class="keyword">size</span>( ptht, 2), <span class="keyword">size</span>( ptht, 3) ) ); ztot_ri_dryg(:,:,:) = 0.</div>
<div class="line"><a name="l00504"></a><span class="lineno">  504</span>&#160;  <span class="keyword">allocate</span>( ztot_ci_dryg(<span class="keyword">size</span>( ptht, 1), <span class="keyword">size</span>( ptht, 2), <span class="keyword">size</span>( ptht, 3) ) ); ztot_ci_dryg(:,:,:) = 0.</div>
<div class="line"><a name="l00505"></a><span class="lineno">  505</span>&#160;  <span class="keyword">allocate</span>( ztot_rs_dryg(<span class="keyword">size</span>( ptht, 1), <span class="keyword">size</span>( ptht, 2), <span class="keyword">size</span>( ptht, 3) ) ); ztot_rs_dryg(:,:,:) = 0.</div>
<div class="line"><a name="l00506"></a><span class="lineno">  506</span>&#160;  <span class="keyword">allocate</span>( ztot_cs_dryg(<span class="keyword">size</span>( ptht, 1), <span class="keyword">size</span>( ptht, 2), <span class="keyword">size</span>( ptht, 3) ) ); ztot_cs_dryg(:,:,:) = 0.</div>
<div class="line"><a name="l00507"></a><span class="lineno">  507</span>&#160;  <span class="keyword">allocate</span>( ztot_rg_dryg(<span class="keyword">size</span>( ptht, 1), <span class="keyword">size</span>( ptht, 2), <span class="keyword">size</span>( ptht, 3) ) ); ztot_rg_dryg(:,:,:) = 0.</div>
<div class="line"><a name="l00508"></a><span class="lineno">  508</span>&#160;  <span class="keyword">allocate</span>( ztot_ri_hmg(<span class="keyword">size</span>( ptht, 1), <span class="keyword">size</span>( ptht, 2), <span class="keyword">size</span>( ptht, 3) ) ); ztot_ri_hmg(:,:,:) = 0.</div>
<div class="line"><a name="l00509"></a><span class="lineno">  509</span>&#160;  <span class="keyword">allocate</span>( ztot_ci_hmg(<span class="keyword">size</span>( ptht, 1), <span class="keyword">size</span>( ptht, 2), <span class="keyword">size</span>( ptht, 3) ) ); ztot_ci_hmg(:,:,:) = 0.</div>
<div class="line"><a name="l00510"></a><span class="lineno">  510</span>&#160;  <span class="keyword">allocate</span>( ztot_rg_hmg(<span class="keyword">size</span>( ptht, 1), <span class="keyword">size</span>( ptht, 2), <span class="keyword">size</span>( ptht, 3) ) ); ztot_rg_hmg(:,:,:) = 0.</div>
<div class="line"><a name="l00511"></a><span class="lineno">  511</span>&#160;  <span class="keyword">allocate</span>( ztot_th_gmlt(<span class="keyword">size</span>( ptht, 1), <span class="keyword">size</span>( ptht, 2), <span class="keyword">size</span>( ptht, 3) ) ); ztot_th_gmlt(:,:,:) = 0.</div>
<div class="line"><a name="l00512"></a><span class="lineno">  512</span>&#160;  <span class="keyword">allocate</span>( ztot_rr_gmlt(<span class="keyword">size</span>( ptht, 1), <span class="keyword">size</span>( ptht, 2), <span class="keyword">size</span>( ptht, 3) ) ); ztot_rr_gmlt(:,:,:) = 0.</div>
<div class="line"><a name="l00513"></a><span class="lineno">  513</span>&#160;  <span class="keyword">allocate</span>( ztot_cr_gmlt(<span class="keyword">size</span>( ptht, 1), <span class="keyword">size</span>( ptht, 2), <span class="keyword">size</span>( ptht, 3) ) ); ztot_cr_gmlt(:,:,:) = 0.</div>
<div class="line"><a name="l00514"></a><span class="lineno">  514</span>&#160;  <span class="keyword">allocate</span>( ztot_cg_gmlt(<span class="keyword">size</span>( ptht, 1), <span class="keyword">size</span>( ptht, 2), <span class="keyword">size</span>( ptht, 3) ) ); ztot_cg_gmlt(:,:,:) = 0.</div>
<div class="line"><a name="l00515"></a><span class="lineno">  515</span>&#160;  <span class="keyword">allocate</span>( ztot_th_deph(<span class="keyword">size</span>( ptht, 1), <span class="keyword">size</span>( ptht, 2), <span class="keyword">size</span>( ptht, 3) ) ); ztot_th_deph(:,:,:) = 0.</div>
<div class="line"><a name="l00516"></a><span class="lineno">  516</span>&#160;  <span class="keyword">allocate</span>( ztot_rh_deph(<span class="keyword">size</span>( ptht, 1), <span class="keyword">size</span>( ptht, 2), <span class="keyword">size</span>( ptht, 3) ) ); ztot_rh_deph(:,:,:) = 0.</div>
<div class="line"><a name="l00517"></a><span class="lineno">  517</span>&#160;  <span class="keyword">allocate</span>( ztot_th_weth(<span class="keyword">size</span>( ptht, 1), <span class="keyword">size</span>( ptht, 2), <span class="keyword">size</span>( ptht, 3) ) ); ztot_th_weth(:,:,:) = 0.</div>
<div class="line"><a name="l00518"></a><span class="lineno">  518</span>&#160;  <span class="keyword">allocate</span>( ztot_rc_weth(<span class="keyword">size</span>( ptht, 1), <span class="keyword">size</span>( ptht, 2), <span class="keyword">size</span>( ptht, 3) ) ); ztot_rc_weth(:,:,:) = 0.</div>
<div class="line"><a name="l00519"></a><span class="lineno">  519</span>&#160;  <span class="keyword">allocate</span>( ztot_cc_weth(<span class="keyword">size</span>( ptht, 1), <span class="keyword">size</span>( ptht, 2), <span class="keyword">size</span>( ptht, 3) ) ); ztot_cc_weth(:,:,:) = 0.</div>
<div class="line"><a name="l00520"></a><span class="lineno">  520</span>&#160;  <span class="keyword">allocate</span>( ztot_rr_weth(<span class="keyword">size</span>( ptht, 1), <span class="keyword">size</span>( ptht, 2), <span class="keyword">size</span>( ptht, 3) ) ); ztot_rr_weth(:,:,:) = 0.</div>
<div class="line"><a name="l00521"></a><span class="lineno">  521</span>&#160;  <span class="keyword">allocate</span>( ztot_cr_weth(<span class="keyword">size</span>( ptht, 1), <span class="keyword">size</span>( ptht, 2), <span class="keyword">size</span>( ptht, 3) ) ); ztot_cr_weth(:,:,:) = 0.</div>
<div class="line"><a name="l00522"></a><span class="lineno">  522</span>&#160;  <span class="keyword">allocate</span>( ztot_ri_weth(<span class="keyword">size</span>( ptht, 1), <span class="keyword">size</span>( ptht, 2), <span class="keyword">size</span>( ptht, 3) ) ); ztot_ri_weth(:,:,:) = 0.</div>
<div class="line"><a name="l00523"></a><span class="lineno">  523</span>&#160;  <span class="keyword">allocate</span>( ztot_ci_weth(<span class="keyword">size</span>( ptht, 1), <span class="keyword">size</span>( ptht, 2), <span class="keyword">size</span>( ptht, 3) ) ); ztot_ci_weth(:,:,:) = 0.</div>
<div class="line"><a name="l00524"></a><span class="lineno">  524</span>&#160;  <span class="keyword">allocate</span>( ztot_rs_weth(<span class="keyword">size</span>( ptht, 1), <span class="keyword">size</span>( ptht, 2), <span class="keyword">size</span>( ptht, 3) ) ); ztot_rs_weth(:,:,:) = 0.</div>
<div class="line"><a name="l00525"></a><span class="lineno">  525</span>&#160;  <span class="keyword">allocate</span>( ztot_cs_weth(<span class="keyword">size</span>( ptht, 1), <span class="keyword">size</span>( ptht, 2), <span class="keyword">size</span>( ptht, 3) ) ); ztot_cs_weth(:,:,:) = 0.</div>
<div class="line"><a name="l00526"></a><span class="lineno">  526</span>&#160;  <span class="keyword">allocate</span>( ztot_rg_weth(<span class="keyword">size</span>( ptht, 1), <span class="keyword">size</span>( ptht, 2), <span class="keyword">size</span>( ptht, 3) ) ); ztot_rg_weth(:,:,:) = 0.</div>
<div class="line"><a name="l00527"></a><span class="lineno">  527</span>&#160;  <span class="keyword">allocate</span>( ztot_cg_weth(<span class="keyword">size</span>( ptht, 1), <span class="keyword">size</span>( ptht, 2), <span class="keyword">size</span>( ptht, 3) ) ); ztot_cg_weth(:,:,:) = 0.</div>
<div class="line"><a name="l00528"></a><span class="lineno">  528</span>&#160;  <span class="keyword">allocate</span>( ztot_rh_weth(<span class="keyword">size</span>( ptht, 1), <span class="keyword">size</span>( ptht, 2), <span class="keyword">size</span>( ptht, 3) ) ); ztot_rh_weth(:,:,:) = 0.</div>
<div class="line"><a name="l00529"></a><span class="lineno">  529</span>&#160;  <span class="keyword">allocate</span>( ztot_rg_cohg(<span class="keyword">size</span>( ptht, 1), <span class="keyword">size</span>( ptht, 2), <span class="keyword">size</span>( ptht, 3) ) ); ztot_rg_cohg(:,:,:) = 0.</div>
<div class="line"><a name="l00530"></a><span class="lineno">  530</span>&#160;  <span class="keyword">allocate</span>( ztot_cg_cohg(<span class="keyword">size</span>( ptht, 1), <span class="keyword">size</span>( ptht, 2), <span class="keyword">size</span>( ptht, 3) ) ); ztot_cg_cohg(:,:,:) = 0.</div>
<div class="line"><a name="l00531"></a><span class="lineno">  531</span>&#160;  <span class="keyword">allocate</span>( ztot_th_hmlt(<span class="keyword">size</span>( ptht, 1), <span class="keyword">size</span>( ptht, 2), <span class="keyword">size</span>( ptht, 3) ) ); ztot_th_hmlt(:,:,:) = 0.</div>
<div class="line"><a name="l00532"></a><span class="lineno">  532</span>&#160;  <span class="keyword">allocate</span>( ztot_rr_hmlt(<span class="keyword">size</span>( ptht, 1), <span class="keyword">size</span>( ptht, 2), <span class="keyword">size</span>( ptht, 3) ) ); ztot_rr_hmlt(:,:,:) = 0.</div>
<div class="line"><a name="l00533"></a><span class="lineno">  533</span>&#160;  <span class="keyword">allocate</span>( ztot_cr_hmlt(<span class="keyword">size</span>( ptht, 1), <span class="keyword">size</span>( ptht, 2), <span class="keyword">size</span>( ptht, 3) ) ); ztot_cr_hmlt(:,:,:) = 0.</div>
<div class="line"><a name="l00534"></a><span class="lineno">  534</span>&#160;  <span class="keyword">allocate</span>( ztot_ch_hmlt(<span class="keyword">size</span>( ptht, 1), <span class="keyword">size</span>( ptht, 2), <span class="keyword">size</span>( ptht, 3) ) ); ztot_ch_hmlt(:,:,:) = 0.</div>
<div class="line"><a name="l00535"></a><span class="lineno">  535</span>&#160;  <span class="keyword">allocate</span>( ztot_rr_cvrc(<span class="keyword">size</span>( ptht, 1), <span class="keyword">size</span>( ptht, 2), <span class="keyword">size</span>( ptht, 3) ) ); ztot_rr_cvrc(:,:,:) = 0.</div>
<div class="line"><a name="l00536"></a><span class="lineno">  536</span>&#160;  <span class="keyword">allocate</span>( ztot_cr_cvrc(<span class="keyword">size</span>( ptht, 1), <span class="keyword">size</span>( ptht, 2), <span class="keyword">size</span>( ptht, 3) ) ); ztot_cr_cvrc(:,:,:) = 0.</div>
<div class="line"><a name="l00537"></a><span class="lineno">  537</span>&#160; </div>
<div class="line"><a name="l00538"></a><span class="lineno">  538</span>&#160;  <span class="keyword">allocate</span>( ztot_rv_corr2(<span class="keyword">size</span>( ptht, 1), <span class="keyword">size</span>( ptht, 2), <span class="keyword">size</span>( ptht, 3) ) ); ztot_rv_corr2(:,:,:) = 0.</div>
<div class="line"><a name="l00539"></a><span class="lineno">  539</span>&#160;  <span class="keyword">allocate</span>( ztot_rc_corr2(<span class="keyword">size</span>( ptht, 1), <span class="keyword">size</span>( ptht, 2), <span class="keyword">size</span>( ptht, 3) ) ); ztot_rc_corr2(:,:,:) = 0.</div>
<div class="line"><a name="l00540"></a><span class="lineno">  540</span>&#160;  <span class="keyword">allocate</span>( ztot_rr_corr2(<span class="keyword">size</span>( ptht, 1), <span class="keyword">size</span>( ptht, 2), <span class="keyword">size</span>( ptht, 3) ) ); ztot_rr_corr2(:,:,:) = 0.</div>
<div class="line"><a name="l00541"></a><span class="lineno">  541</span>&#160;  <span class="keyword">allocate</span>( ztot_ri_corr2(<span class="keyword">size</span>( ptht, 1), <span class="keyword">size</span>( ptht, 2), <span class="keyword">size</span>( ptht, 3) ) ); ztot_ri_corr2(:,:,:) = 0.</div>
<div class="line"><a name="l00542"></a><span class="lineno">  542</span>&#160;  <span class="keyword">allocate</span>( ztot_cc_corr2(<span class="keyword">size</span>( ptht, 1), <span class="keyword">size</span>( ptht, 2), <span class="keyword">size</span>( ptht, 3) ) ); ztot_cc_corr2(:,:,:) = 0.</div>
<div class="line"><a name="l00543"></a><span class="lineno">  543</span>&#160;  <span class="keyword">allocate</span>( ztot_cr_corr2(<span class="keyword">size</span>( ptht, 1), <span class="keyword">size</span>( ptht, 2), <span class="keyword">size</span>( ptht, 3) ) ); ztot_cr_corr2(:,:,:) = 0.</div>
<div class="line"><a name="l00544"></a><span class="lineno">  544</span>&#160;  <span class="keyword">allocate</span>( ztot_ci_corr2(<span class="keyword">size</span>( ptht, 1), <span class="keyword">size</span>( ptht, 2), <span class="keyword">size</span>( ptht, 3) ) ); ztot_ci_corr2(:,:,:) = 0.</div>
<div class="line"><a name="l00545"></a><span class="lineno">  545</span>&#160;<span class="keywordflow">END IF</span></div>
<div class="line"><a name="l00546"></a><span class="lineno">  546</span>&#160;<span class="comment">!</span></div>
<div class="line"><a name="l00547"></a><span class="lineno">  547</span>&#160;<span class="comment">!++cb++ necessaire pour l&#39;electricite</span></div>
<div class="line"><a name="l00548"></a><span class="lineno">  548</span>&#160;<span class="keyword">ALLOCATE</span> (ztot_ri_hind(<span class="keyword">SIZE</span>(ptht,1),<span class="keyword">SIZE</span>(ptht,2),<span class="keyword">SIZE</span>(ptht,3))) ; ztot_ri_hind(:,:,:) = 0.</div>
<div class="line"><a name="l00549"></a><span class="lineno">  549</span>&#160;<span class="keyword">ALLOCATE</span> (ztot_rc_hinc(<span class="keyword">SIZE</span>(ptht,1),<span class="keyword">SIZE</span>(ptht,2),<span class="keyword">SIZE</span>(ptht,3))) ; ztot_rc_hinc(:,:,:) = 0.</div>
<div class="line"><a name="l00550"></a><span class="lineno">  550</span>&#160;<span class="keyword">ALLOCATE</span> (ztot_rv_henu(<span class="keyword">SIZE</span>(ptht,1),<span class="keyword">SIZE</span>(ptht,2),<span class="keyword">SIZE</span>(ptht,3))) ; ztot_rv_henu(:,:,:) = 0.</div>
<div class="line"><a name="l00551"></a><span class="lineno">  551</span>&#160;<span class="keyword">ALLOCATE</span> (ztot_rv_honh(<span class="keyword">SIZE</span>(ptht,1),<span class="keyword">SIZE</span>(ptht,2),<span class="keyword">SIZE</span>(ptht,3))) ; ztot_rv_honh(:,:,:) = 0.</div>
<div class="line"><a name="l00552"></a><span class="lineno">  552</span>&#160;<span class="comment">!--cb--</span></div>
<div class="line"><a name="l00553"></a><span class="lineno">  553</span>&#160;<span class="comment">!</span></div>
<div class="line"><a name="l00554"></a><span class="lineno">  554</span>&#160;<span class="comment">! Initial values computed as source * PTSTEP</span></div>
<div class="line"><a name="l00555"></a><span class="lineno">  555</span>&#160;<span class="comment">!</span></div>
<div class="line"><a name="l00556"></a><span class="lineno">  556</span>&#160;<span class="comment">! Mixing ratios</span></div>
<div class="line"><a name="l00557"></a><span class="lineno">  557</span>&#160;<span class="comment">!</span></div>
<div class="line"><a name="l00558"></a><span class="lineno">  558</span>&#160;krr=<span class="keyword">SIZE</span>(prt,4)</div>
<div class="line"><a name="l00559"></a><span class="lineno">  559</span>&#160;zrvt(:,:,:) = prs(:,:,:,1) * ptstep</div>
<div class="line"><a name="l00560"></a><span class="lineno">  560</span>&#160;zrvs(:,:,:) = prs(:,:,:,1)</div>
<div class="line"><a name="l00561"></a><span class="lineno">  561</span>&#160;<span class="keywordflow">IF</span> ( krr .GE. 2 ) zrct(:,:,:) = prs(:,:,:,2) * ptstep</div>
<div class="line"><a name="l00562"></a><span class="lineno">  562</span>&#160;<span class="keywordflow">IF</span> ( krr .GE. 2 ) zrcs(:,:,:) = prs(:,:,:,2)</div>
<div class="line"><a name="l00563"></a><span class="lineno">  563</span>&#160;<span class="keywordflow">IF</span> ( krr .GE. 3 ) zrrt(:,:,:) = prs(:,:,:,3) * ptstep</div>
<div class="line"><a name="l00564"></a><span class="lineno">  564</span>&#160;<span class="keywordflow">IF</span> ( krr .GE. 3 ) zrrs(:,:,:) = prs(:,:,:,3)</div>
<div class="line"><a name="l00565"></a><span class="lineno">  565</span>&#160;<span class="keywordflow">IF</span> ( krr .GE. 4 ) zrit(:,:,:) = prs(:,:,:,4) * ptstep</div>
<div class="line"><a name="l00566"></a><span class="lineno">  566</span>&#160;<span class="keywordflow">IF</span> ( krr .GE. 4 ) zris(:,:,:) = prs(:,:,:,4)</div>
<div class="line"><a name="l00567"></a><span class="lineno">  567</span>&#160;<span class="keywordflow">IF</span> ( krr .GE. 5 ) zrst(:,:,:) = prs(:,:,:,5) * ptstep</div>
<div class="line"><a name="l00568"></a><span class="lineno">  568</span>&#160;<span class="keywordflow">IF</span> ( krr .GE. 5 ) zrss(:,:,:) = prs(:,:,:,5)</div>
<div class="line"><a name="l00569"></a><span class="lineno">  569</span>&#160;<span class="keywordflow">IF</span> ( krr .GE. 6 ) zrgt(:,:,:) = prs(:,:,:,6) * ptstep</div>
<div class="line"><a name="l00570"></a><span class="lineno">  570</span>&#160;<span class="keywordflow">IF</span> ( krr .GE. 6 ) zrgs(:,:,:) = prs(:,:,:,6)</div>
<div class="line"><a name="l00571"></a><span class="lineno">  571</span>&#160;<span class="keywordflow">IF</span> ( krr .GE. 7 ) zrht(:,:,:) = prs(:,:,:,7) * ptstep</div>
<div class="line"><a name="l00572"></a><span class="lineno">  572</span>&#160;<span class="keywordflow">IF</span> ( krr .GE. 7 ) zrhs(:,:,:) = prs(:,:,:,7)</div>
<div class="line"><a name="l00573"></a><span class="lineno">  573</span>&#160;<span class="comment">!</span></div>
<div class="line"><a name="l00574"></a><span class="lineno">  574</span>&#160;<span class="comment">! Concentrations</span></div>
<div class="line"><a name="l00575"></a><span class="lineno">  575</span>&#160;<span class="comment">!</span></div>
<div class="line"><a name="l00576"></a><span class="lineno">  576</span>&#160;<span class="keywordflow">IF</span> ( <a class="code" href="namespacemodd__param__lima.html#ab0c8298b017b75cbd419d8b1980b0053">nmom_c</a>.GE.2) <span class="keywordflow">THEN</span></div>
<div class="line"><a name="l00577"></a><span class="lineno">  577</span>&#160;   zcct(:,:,:)   = psvs(:,:,:,isv_lima_nc) * ptstep</div>
<div class="line"><a name="l00578"></a><span class="lineno">  578</span>&#160;   zccs(:,:,:)   = psvs(:,:,:,isv_lima_nc)</div>
<div class="line"><a name="l00579"></a><span class="lineno">  579</span>&#160;<span class="keywordflow">ELSE</span></div>
<div class="line"><a name="l00580"></a><span class="lineno">  580</span>&#160;   zcct(:,:,:)   = 300.e6 / prhodref(:,:,:)</div>
<div class="line"><a name="l00581"></a><span class="lineno">  581</span>&#160;   zccs(:,:,:)   = zcct(:,:,:) / ptstep</div>
<div class="line"><a name="l00582"></a><span class="lineno">  582</span>&#160;<span class="keywordflow">END IF</span></div>
<div class="line"><a name="l00583"></a><span class="lineno">  583</span>&#160;<span class="keywordflow">IF</span> ( <a class="code" href="namespacemodd__param__lima.html#a7accc5c4a0a391c040a1de5e966eea04">nmom_r</a>.GE.2) zcrt(:,:,:)   = psvs(:,:,:,isv_lima_nr) * ptstep</div>
<div class="line"><a name="l00584"></a><span class="lineno">  584</span>&#160;<span class="keywordflow">IF</span> ( <a class="code" href="namespacemodd__param__lima.html#a7accc5c4a0a391c040a1de5e966eea04">nmom_r</a>.GE.2) zcrs(:,:,:)   = psvs(:,:,:,isv_lima_nr)</div>
<div class="line"><a name="l00585"></a><span class="lineno">  585</span>&#160;<span class="keywordflow">IF</span> ( <a class="code" href="namespacemodd__param__lima.html#ab11c5caa054b5039171a4f10908abea1">nmom_i</a>.GE.2) zcit(:,:,:)   = psvs(:,:,:,isv_lima_ni) * ptstep</div>
<div class="line"><a name="l00586"></a><span class="lineno">  586</span>&#160;<span class="keywordflow">IF</span> ( <a class="code" href="namespacemodd__param__lima.html#ab11c5caa054b5039171a4f10908abea1">nmom_i</a>.GE.2) zcis(:,:,:)   = psvs(:,:,:,isv_lima_ni)</div>
<div class="line"><a name="l00587"></a><span class="lineno">  587</span>&#160;<span class="keywordflow">IF</span> ( <a class="code" href="namespacemodd__param__lima.html#a63b4f80fe043e01602ef78b2caf0e487">nmom_s</a>.GE.2) zcst(:,:,:)   = psvs(:,:,:,isv_lima_ns) * ptstep</div>
<div class="line"><a name="l00588"></a><span class="lineno">  588</span>&#160;<span class="keywordflow">IF</span> ( <a class="code" href="namespacemodd__param__lima.html#a63b4f80fe043e01602ef78b2caf0e487">nmom_s</a>.GE.2) zcss(:,:,:)   = psvs(:,:,:,isv_lima_ns)</div>
<div class="line"><a name="l00589"></a><span class="lineno">  589</span>&#160;<span class="keywordflow">IF</span> ( <a class="code" href="namespacemodd__param__lima.html#acd76d6876dec7668fc081a4380690182">nmom_g</a>.GE.2) zcgt(:,:,:)   = psvs(:,:,:,isv_lima_ng) * ptstep</div>
<div class="line"><a name="l00590"></a><span class="lineno">  590</span>&#160;<span class="keywordflow">IF</span> ( <a class="code" href="namespacemodd__param__lima.html#acd76d6876dec7668fc081a4380690182">nmom_g</a>.GE.2) zcgs(:,:,:)   = psvs(:,:,:,isv_lima_ng)</div>
<div class="line"><a name="l00591"></a><span class="lineno">  591</span>&#160;<span class="keywordflow">IF</span> ( <a class="code" href="namespacemodd__param__lima.html#a8a40a50a7778130438208e2974634384">nmom_h</a>.GE.2) zcht(:,:,:)   = psvs(:,:,:,isv_lima_nh) * ptstep</div>
<div class="line"><a name="l00592"></a><span class="lineno">  592</span>&#160;<span class="keywordflow">IF</span> ( <a class="code" href="namespacemodd__param__lima.html#a8a40a50a7778130438208e2974634384">nmom_h</a>.GE.2) zchs(:,:,:)   = psvs(:,:,:,isv_lima_nh)</div>
<div class="line"><a name="l00593"></a><span class="lineno">  593</span>&#160;<span class="comment">!</span></div>
<div class="line"><a name="l00594"></a><span class="lineno">  594</span>&#160;<span class="keywordflow">IF</span> ( <a class="code" href="namespacemodd__param__lima.html#a19683462cda57db522fcb0b8988b8d27">nmod_ccn</a> .GE. 1 ) zccnft(:,:,:,:) = psvs(:,:,:,isv_lima_ccn_free:isv_lima_ccn_free+<a class="code" href="namespacemodd__param__lima.html#a19683462cda57db522fcb0b8988b8d27">nmod_ccn</a>-1) * ptstep</div>
<div class="line"><a name="l00595"></a><span class="lineno">  595</span>&#160;<span class="keywordflow">IF</span> ( <a class="code" href="namespacemodd__param__lima.html#a19683462cda57db522fcb0b8988b8d27">nmod_ccn</a> .GE. 1 ) zccnat(:,:,:,:) = psvs(:,:,:,isv_lima_ccn_acti:isv_lima_ccn_acti+<a class="code" href="namespacemodd__param__lima.html#a19683462cda57db522fcb0b8988b8d27">nmod_ccn</a>-1) * ptstep</div>
<div class="line"><a name="l00596"></a><span class="lineno">  596</span>&#160;<span class="keywordflow">IF</span> ( <a class="code" href="namespacemodd__param__lima.html#a19683462cda57db522fcb0b8988b8d27">nmod_ccn</a> .GE. 1 ) zccnfs(:,:,:,:) = psvs(:,:,:,isv_lima_ccn_free:isv_lima_ccn_free+<a class="code" href="namespacemodd__param__lima.html#a19683462cda57db522fcb0b8988b8d27">nmod_ccn</a>-1)</div>
<div class="line"><a name="l00597"></a><span class="lineno">  597</span>&#160;<span class="keywordflow">IF</span> ( <a class="code" href="namespacemodd__param__lima.html#a19683462cda57db522fcb0b8988b8d27">nmod_ccn</a> .GE. 1 ) zccnas(:,:,:,:) = psvs(:,:,:,isv_lima_ccn_acti:isv_lima_ccn_acti+<a class="code" href="namespacemodd__param__lima.html#a19683462cda57db522fcb0b8988b8d27">nmod_ccn</a>-1)</div>
<div class="line"><a name="l00598"></a><span class="lineno">  598</span>&#160;<span class="comment">!</span></div>
<div class="line"><a name="l00599"></a><span class="lineno">  599</span>&#160;<span class="keywordflow">IF</span> ( <a class="code" href="namespacemodd__param__lima.html#a2b98a3f23053acfd971d523a0778f209">nmod_ifn</a> .GE. 1 ) zifnft(:,:,:,:) = psvs(:,:,:,isv_lima_ifn_free:isv_lima_ifn_free+<a class="code" href="namespacemodd__param__lima.html#a2b98a3f23053acfd971d523a0778f209">nmod_ifn</a>-1) * ptstep</div>
<div class="line"><a name="l00600"></a><span class="lineno">  600</span>&#160;<span class="keywordflow">IF</span> ( <a class="code" href="namespacemodd__param__lima.html#a2b98a3f23053acfd971d523a0778f209">nmod_ifn</a> .GE. 1 ) zifnnt(:,:,:,:) = psvs(:,:,:,isv_lima_ifn_nucl:isv_lima_ifn_nucl+<a class="code" href="namespacemodd__param__lima.html#a2b98a3f23053acfd971d523a0778f209">nmod_ifn</a>-1) * ptstep</div>
<div class="line"><a name="l00601"></a><span class="lineno">  601</span>&#160;<span class="keywordflow">IF</span> ( <a class="code" href="namespacemodd__param__lima.html#a2b98a3f23053acfd971d523a0778f209">nmod_ifn</a> .GE. 1 ) zifnfs(:,:,:,:) = psvs(:,:,:,isv_lima_ifn_free:isv_lima_ifn_free+<a class="code" href="namespacemodd__param__lima.html#a2b98a3f23053acfd971d523a0778f209">nmod_ifn</a>-1)</div>
<div class="line"><a name="l00602"></a><span class="lineno">  602</span>&#160;<span class="keywordflow">IF</span> ( <a class="code" href="namespacemodd__param__lima.html#a2b98a3f23053acfd971d523a0778f209">nmod_ifn</a> .GE. 1 ) zifnns(:,:,:,:) = psvs(:,:,:,isv_lima_ifn_nucl:isv_lima_ifn_nucl+<a class="code" href="namespacemodd__param__lima.html#a2b98a3f23053acfd971d523a0778f209">nmod_ifn</a>-1)</div>
<div class="line"><a name="l00603"></a><span class="lineno">  603</span>&#160;<span class="comment">!</span></div>
<div class="line"><a name="l00604"></a><span class="lineno">  604</span>&#160;<span class="keywordflow">IF</span> ( <a class="code" href="namespacemodd__param__lima.html#a773a34608ac83913168a35ea1a39332a">nmod_imm</a> .GE. 1 ) zimmnt(:,:,:,:) = psvs(:,:,:,isv_lima_imm_nucl:isv_lima_imm_nucl+<a class="code" href="namespacemodd__param__lima.html#a773a34608ac83913168a35ea1a39332a">nmod_imm</a>-1) * ptstep</div>
<div class="line"><a name="l00605"></a><span class="lineno">  605</span>&#160;<span class="keywordflow">IF</span> ( <a class="code" href="namespacemodd__param__lima.html#a773a34608ac83913168a35ea1a39332a">nmod_imm</a> .GE. 1 ) zimmns(:,:,:,:) = psvs(:,:,:,isv_lima_imm_nucl:isv_lima_imm_nucl+<a class="code" href="namespacemodd__param__lima.html#a773a34608ac83913168a35ea1a39332a">nmod_imm</a>-1)</div>
<div class="line"><a name="l00606"></a><span class="lineno">  606</span>&#160;<span class="comment">!</span></div>
<div class="line"><a name="l00607"></a><span class="lineno">  607</span>&#160;<span class="keywordflow">IF</span> ( <a class="code" href="namespacemodd__param__lima.html#a0b11d7560a8fc0aa79bb054ab51fea88">lhhoni</a> ) zhomft(:,:,:) = psvs(:,:,:,isv_lima_hom_haze) * ptstep</div>
<div class="line"><a name="l00608"></a><span class="lineno">  608</span>&#160;<span class="keywordflow">IF</span> ( <a class="code" href="namespacemodd__param__lima.html#a0b11d7560a8fc0aa79bb054ab51fea88">lhhoni</a> ) zhomfs(:,:,:) = psvs(:,:,:,isv_lima_hom_haze)</div>
<div class="line"><a name="l00609"></a><span class="lineno">  609</span>&#160;<span class="comment">!</span></div>
<div class="line"><a name="l00610"></a><span class="lineno">  610</span>&#160;zinv_tstep  = 1./ptstep</div>
<div class="line"><a name="l00611"></a><span class="lineno">  611</span>&#160;zexn(:,:,:) = (ppabst(:,:,:)/cst%XP00)**(cst%XRD/cst%XCPD)</div>
<div class="line"><a name="l00612"></a><span class="lineno">  612</span>&#160;zt(:,:,:)   = ztht(:,:,:) * zexn(:,:,:)</div>
<div class="line"><a name="l00613"></a><span class="lineno">  613</span>&#160;<span class="comment">!</span></div>
<div class="line"><a name="l00614"></a><span class="lineno">  614</span>&#160;<span class="comment">! Electric charge density</span></div>
<div class="line"><a name="l00615"></a><span class="lineno">  615</span>&#160;<span class="comment">!</span></div>
<div class="line"><a name="l00616"></a><span class="lineno">  616</span>&#160;<span class="keywordflow">IF</span> (oelec) <span class="keywordflow">THEN</span></div>
<div class="line"><a name="l00617"></a><span class="lineno">  617</span>&#160;  <span class="keyword">ALLOCATE</span>(zqpit(<span class="keyword">SIZE</span>(ptht,1),<span class="keyword">SIZE</span>(ptht,2),<span class="keyword">SIZE</span>(ptht,3)))</div>
<div class="line"><a name="l00618"></a><span class="lineno">  618</span>&#160;  <span class="keyword">ALLOCATE</span>(zqct(<span class="keyword">SIZE</span>(ptht,1),<span class="keyword">SIZE</span>(ptht,2),<span class="keyword">SIZE</span>(ptht,3)))</div>
<div class="line"><a name="l00619"></a><span class="lineno">  619</span>&#160;  <span class="keyword">ALLOCATE</span>(zqrt(<span class="keyword">SIZE</span>(ptht,1),<span class="keyword">SIZE</span>(ptht,2),<span class="keyword">SIZE</span>(ptht,3)))</div>
<div class="line"><a name="l00620"></a><span class="lineno">  620</span>&#160;  <span class="keyword">ALLOCATE</span>(zqit(<span class="keyword">SIZE</span>(ptht,1),<span class="keyword">SIZE</span>(ptht,2),<span class="keyword">SIZE</span>(ptht,3)))</div>
<div class="line"><a name="l00621"></a><span class="lineno">  621</span>&#160;  <span class="keyword">ALLOCATE</span>(zqst(<span class="keyword">SIZE</span>(ptht,1),<span class="keyword">SIZE</span>(ptht,2),<span class="keyword">SIZE</span>(ptht,3)))</div>
<div class="line"><a name="l00622"></a><span class="lineno">  622</span>&#160;  <span class="keyword">ALLOCATE</span>(zqgt(<span class="keyword">SIZE</span>(ptht,1),<span class="keyword">SIZE</span>(ptht,2),<span class="keyword">SIZE</span>(ptht,3)))</div>
<div class="line"><a name="l00623"></a><span class="lineno">  623</span>&#160;  <span class="keyword">ALLOCATE</span>(zqnit(<span class="keyword">SIZE</span>(ptht,1),<span class="keyword">SIZE</span>(ptht,2),<span class="keyword">SIZE</span>(ptht,3)))</div>
<div class="line"><a name="l00624"></a><span class="lineno">  624</span>&#160;  <span class="keywordflow">IF</span> (krr == 7) <span class="keyword">ALLOCATE</span>(zqht(<span class="keyword">SIZE</span>(ptht,1),<span class="keyword">SIZE</span>(ptht,2),<span class="keyword">SIZE</span>(ptht,3)))</div>
<div class="line"><a name="l00625"></a><span class="lineno">  625</span>&#160;  <span class="comment">!</span></div>
<div class="line"><a name="l00626"></a><span class="lineno">  626</span>&#160;  <span class="keyword">ALLOCATE</span>(zqpis(<span class="keyword">SIZE</span>(ptht,1),<span class="keyword">SIZE</span>(ptht,2),<span class="keyword">SIZE</span>(ptht,3)))</div>
<div class="line"><a name="l00627"></a><span class="lineno">  627</span>&#160;  <span class="keyword">ALLOCATE</span>(zqcs(<span class="keyword">SIZE</span>(ptht,1),<span class="keyword">SIZE</span>(ptht,2),<span class="keyword">SIZE</span>(ptht,3)))</div>
<div class="line"><a name="l00628"></a><span class="lineno">  628</span>&#160;  <span class="keyword">ALLOCATE</span>(zqrs(<span class="keyword">SIZE</span>(ptht,1),<span class="keyword">SIZE</span>(ptht,2),<span class="keyword">SIZE</span>(ptht,3)))</div>
<div class="line"><a name="l00629"></a><span class="lineno">  629</span>&#160;  <span class="keyword">ALLOCATE</span>(zqis(<span class="keyword">SIZE</span>(ptht,1),<span class="keyword">SIZE</span>(ptht,2),<span class="keyword">SIZE</span>(ptht,3)))</div>
<div class="line"><a name="l00630"></a><span class="lineno">  630</span>&#160;  <span class="keyword">ALLOCATE</span>(zqss(<span class="keyword">SIZE</span>(ptht,1),<span class="keyword">SIZE</span>(ptht,2),<span class="keyword">SIZE</span>(ptht,3)))</div>
<div class="line"><a name="l00631"></a><span class="lineno">  631</span>&#160;  <span class="keyword">ALLOCATE</span>(zqgs(<span class="keyword">SIZE</span>(ptht,1),<span class="keyword">SIZE</span>(ptht,2),<span class="keyword">SIZE</span>(ptht,3)))</div>
<div class="line"><a name="l00632"></a><span class="lineno">  632</span>&#160;  <span class="keyword">ALLOCATE</span>(zqnis(<span class="keyword">SIZE</span>(ptht,1),<span class="keyword">SIZE</span>(ptht,2),<span class="keyword">SIZE</span>(ptht,3)))</div>
<div class="line"><a name="l00633"></a><span class="lineno">  633</span>&#160;  <span class="keywordflow">IF</span> (krr == 7) <span class="keyword">ALLOCATE</span>(zqhs(<span class="keyword">SIZE</span>(ptht,1),<span class="keyword">SIZE</span>(ptht,2),<span class="keyword">SIZE</span>(ptht,3)))</div>
<div class="line"><a name="l00634"></a><span class="lineno">  634</span>&#160;  <span class="comment">!</span></div>
<div class="line"><a name="l00635"></a><span class="lineno">  635</span>&#160;  <span class="keyword">ALLOCATE</span>(zrvt_elec(<span class="keyword">SIZE</span>(ptht,1),<span class="keyword">SIZE</span>(ptht,2),<span class="keyword">SIZE</span>(ptht,3)))</div>
<div class="line"><a name="l00636"></a><span class="lineno">  636</span>&#160;  <span class="keyword">ALLOCATE</span>(zrct_elec(<span class="keyword">SIZE</span>(ptht,1),<span class="keyword">SIZE</span>(ptht,2),<span class="keyword">SIZE</span>(ptht,3)))</div>
<div class="line"><a name="l00637"></a><span class="lineno">  637</span>&#160;  <span class="keyword">ALLOCATE</span>(zrrt_elec(<span class="keyword">SIZE</span>(ptht,1),<span class="keyword">SIZE</span>(ptht,2),<span class="keyword">SIZE</span>(ptht,3)))</div>
<div class="line"><a name="l00638"></a><span class="lineno">  638</span>&#160;  <span class="keyword">ALLOCATE</span>(zrit_elec(<span class="keyword">SIZE</span>(ptht,1),<span class="keyword">SIZE</span>(ptht,2),<span class="keyword">SIZE</span>(ptht,3)))</div>
<div class="line"><a name="l00639"></a><span class="lineno">  639</span>&#160;  <span class="keyword">ALLOCATE</span>(zrst_elec(<span class="keyword">SIZE</span>(ptht,1),<span class="keyword">SIZE</span>(ptht,2),<span class="keyword">SIZE</span>(ptht,3)))</div>
<div class="line"><a name="l00640"></a><span class="lineno">  640</span>&#160;  <span class="keyword">ALLOCATE</span>(zrgt_elec(<span class="keyword">SIZE</span>(ptht,1),<span class="keyword">SIZE</span>(ptht,2),<span class="keyword">SIZE</span>(ptht,3)))</div>
<div class="line"><a name="l00641"></a><span class="lineno">  641</span>&#160;  <span class="keywordflow">IF</span> (krr == 7) <span class="keyword">ALLOCATE</span>(zrht_elec(<span class="keyword">SIZE</span>(ptht,1),<span class="keyword">SIZE</span>(ptht,2),<span class="keyword">SIZE</span>(ptht,3)))</div>
<div class="line"><a name="l00642"></a><span class="lineno">  642</span>&#160;  <span class="keyword">ALLOCATE</span>(zcct_elec(<span class="keyword">SIZE</span>(ptht,1),<span class="keyword">SIZE</span>(ptht,2),<span class="keyword">SIZE</span>(ptht,3)))</div>
<div class="line"><a name="l00643"></a><span class="lineno">  643</span>&#160;  <span class="keyword">ALLOCATE</span>(zcrt_elec(<span class="keyword">SIZE</span>(ptht,1),<span class="keyword">SIZE</span>(ptht,2),<span class="keyword">SIZE</span>(ptht,3)))</div>
<div class="line"><a name="l00644"></a><span class="lineno">  644</span>&#160;  <span class="keyword">ALLOCATE</span>(zcit_elec(<span class="keyword">SIZE</span>(ptht,1),<span class="keyword">SIZE</span>(ptht,2),<span class="keyword">SIZE</span>(ptht,3)))</div>
<div class="line"><a name="l00645"></a><span class="lineno">  645</span>&#160;  <span class="keyword">ALLOCATE</span>(zcst_elec(<span class="keyword">SIZE</span>(ptht,1),<span class="keyword">SIZE</span>(ptht,2),<span class="keyword">SIZE</span>(ptht,3)))</div>
<div class="line"><a name="l00646"></a><span class="lineno">  646</span>&#160;  <span class="keyword">ALLOCATE</span>(zcgt_elec(<span class="keyword">SIZE</span>(ptht,1),<span class="keyword">SIZE</span>(ptht,2),<span class="keyword">SIZE</span>(ptht,3)))</div>
<div class="line"><a name="l00647"></a><span class="lineno">  647</span>&#160;  <span class="keywordflow">IF</span> (krr == 7) <span class="keyword">ALLOCATE</span>(zcht_elec(<span class="keyword">SIZE</span>(ptht,1),<span class="keyword">SIZE</span>(ptht,2),<span class="keyword">SIZE</span>(ptht,3)))</div>
<div class="line"><a name="l00648"></a><span class="lineno">  648</span>&#160;<span class="comment">!</span></div>
<div class="line"><a name="l00649"></a><span class="lineno">  649</span>&#160;<span class="comment">!++cb++ 21/04/23 source * ptstep</span></div>
<div class="line"><a name="l00650"></a><span class="lineno">  650</span>&#160;  zqpit(:,:,:) = psv_elec_s(:,:,:,1) * ptstep</div>
<div class="line"><a name="l00651"></a><span class="lineno">  651</span>&#160;  zqct(:,:,:)  = psv_elec_s(:,:,:,2) * ptstep</div>
<div class="line"><a name="l00652"></a><span class="lineno">  652</span>&#160;  zqrt(:,:,:)  = psv_elec_s(:,:,:,3) * ptstep</div>
<div class="line"><a name="l00653"></a><span class="lineno">  653</span>&#160;  zqit(:,:,:)  = psv_elec_s(:,:,:,4) * ptstep</div>
<div class="line"><a name="l00654"></a><span class="lineno">  654</span>&#160;  zqst(:,:,:)  = psv_elec_s(:,:,:,5) * ptstep</div>
<div class="line"><a name="l00655"></a><span class="lineno">  655</span>&#160;  zqgt(:,:,:)  = psv_elec_s(:,:,:,6) * ptstep</div>
<div class="line"><a name="l00656"></a><span class="lineno">  656</span>&#160;  <span class="keywordflow">IF</span> (krr == 6) <span class="keywordflow">THEN</span></div>
<div class="line"><a name="l00657"></a><span class="lineno">  657</span>&#160;    zqnit(:,:,:)  = psv_elec_s(:,:,:,7) * ptstep</div>
<div class="line"><a name="l00658"></a><span class="lineno">  658</span>&#160;  <span class="keywordflow">ELSE</span> <span class="keywordflow">IF</span> (krr == 7) <span class="keywordflow">THEN</span></div>
<div class="line"><a name="l00659"></a><span class="lineno">  659</span>&#160;    zqht(:,:,:)  = psv_elec_s(:,:,:,7) * ptstep</div>
<div class="line"><a name="l00660"></a><span class="lineno">  660</span>&#160;    zqnit(:,:,:) = psv_elec_s(:,:,:,8) * ptstep</div>
<div class="line"><a name="l00661"></a><span class="lineno">  661</span>&#160;<span class="keywordflow">  END IF</span></div>
<div class="line"><a name="l00662"></a><span class="lineno">  662</span>&#160;  <span class="comment">!</span></div>
<div class="line"><a name="l00663"></a><span class="lineno">  663</span>&#160;  zqpis(:,:,:) = psv_elec_s(:,:,:,1)</div>
<div class="line"><a name="l00664"></a><span class="lineno">  664</span>&#160;  zqcs(:,:,:)  = psv_elec_s(:,:,:,2)</div>
<div class="line"><a name="l00665"></a><span class="lineno">  665</span>&#160;  zqrs(:,:,:)  = psv_elec_s(:,:,:,3)</div>
<div class="line"><a name="l00666"></a><span class="lineno">  666</span>&#160;  zqis(:,:,:)  = psv_elec_s(:,:,:,4)</div>
<div class="line"><a name="l00667"></a><span class="lineno">  667</span>&#160;  zqss(:,:,:)  = psv_elec_s(:,:,:,5)</div>
<div class="line"><a name="l00668"></a><span class="lineno">  668</span>&#160;  zqgs(:,:,:)  = psv_elec_s(:,:,:,6)</div>
<div class="line"><a name="l00669"></a><span class="lineno">  669</span>&#160;  <span class="keywordflow">IF</span> (krr == 6) <span class="keywordflow">THEN</span></div>
<div class="line"><a name="l00670"></a><span class="lineno">  670</span>&#160;    zqnis(:,:,:)  = psv_elec_s(:,:,:,7)</div>
<div class="line"><a name="l00671"></a><span class="lineno">  671</span>&#160;  <span class="keywordflow">ELSE</span> <span class="keywordflow">IF</span> (krr == 7) <span class="keywordflow">THEN</span></div>
<div class="line"><a name="l00672"></a><span class="lineno">  672</span>&#160;    zqhs(:,:,:)  = psv_elec_s(:,:,:,7)</div>
<div class="line"><a name="l00673"></a><span class="lineno">  673</span>&#160;    zqnis(:,:,:) = psv_elec_s(:,:,:,8) </div>
<div class="line"><a name="l00674"></a><span class="lineno">  674</span>&#160;<span class="keywordflow">  END IF</span></div>
<div class="line"><a name="l00675"></a><span class="lineno">  675</span>&#160;<span class="keywordflow">END IF</span></div>
<div class="line"><a name="l00676"></a><span class="lineno">  676</span>&#160;<span class="comment">!</span></div>
<div class="line"><a name="l00677"></a><span class="lineno">  677</span>&#160;<span class="comment">!-------------------------------------------------------------------------------</span></div>
<div class="line"><a name="l00678"></a><span class="lineno">  678</span>&#160;<span class="comment">!</span></div>
<div class="line"><a name="l00679"></a><span class="lineno">  679</span>&#160;<span class="comment">!*       0.     Check mean diameter for cloud, rain  and ice</span></div>
<div class="line"><a name="l00680"></a><span class="lineno">  680</span>&#160;<span class="comment">!               --------------------------------------------</span></div>
<div class="line"><a name="l00681"></a><span class="lineno">  681</span>&#160;<span class="comment">! if ( BUCONF%lbu_enable ) then</span></div>
<div class="line"><a name="l00682"></a><span class="lineno">  682</span>&#160;<span class="comment">!   if ( BUCONF%lbudget_rc .and. lwarm .and. lrain ) call BUDGET_STORE_INIT_PHY(D, TBUDGETS(NBUDGET_RC), &#39;CORR&#39;, zrcs(:, :, :) * prhodj(:, :, :) )</span></div>
<div class="line"><a name="l00683"></a><span class="lineno">  683</span>&#160;<span class="comment">!   if ( BUCONF%lbudget_rr .and. lwarm .and. lrain ) call BUDGET_STORE_INIT_PHY(D, TBUDGETS(NBUDGET_RR), &#39;CORR&#39;, zrrs(:, :, :) * prhodj(:, :, :) )</span></div>
<div class="line"><a name="l00684"></a><span class="lineno">  684</span>&#160;<span class="comment">!   if ( BUCONF%lbudget_ri .and. lcold .and. lsnow ) call BUDGET_STORE_INIT_PHY(D, TBUDGETS(NBUDGET_RI), &#39;CORR&#39;, zris(:, :, :) * prhodj(:, :, :) )</span></div>
<div class="line"><a name="l00685"></a><span class="lineno">  685</span>&#160;<span class="comment">!   if ( BUCONF%lbudget_rs .and. lcold .and. lsnow ) call BUDGET_STORE_INIT_PHY(D, TBUDGETS(NBUDGET_RS), &#39;CORR&#39;, zrss(:, :, :) * prhodj(:, :, :) )</span></div>
<div class="line"><a name="l00686"></a><span class="lineno">  686</span>&#160;<span class="comment">!   if ( BUCONF%lbudget_sv ) then</span></div>
<div class="line"><a name="l00687"></a><span class="lineno">  687</span>&#160;<span class="comment">!     if ( lwarm .and. lrain .and. nmom_c.ge.2) &amp;</span></div>
<div class="line"><a name="l00688"></a><span class="lineno">  688</span>&#160;<span class="comment">!       call BUDGET_STORE_INIT_PHY(D, TBUDGETS(NBUDGET_SV1 - 1 + nsv_lima_nc), &#39;CORR&#39;, zccs(:, :, :) * prhodj(:, :, :) )</span></div>
<div class="line"><a name="l00689"></a><span class="lineno">  689</span>&#160;<span class="comment">!     if ( lwarm .and. lrain .and. nmom_r.ge.2) &amp;</span></div>
<div class="line"><a name="l00690"></a><span class="lineno">  690</span>&#160;<span class="comment">!       call BUDGET_STORE_INIT_PHY(D, TBUDGETS(NBUDGET_SV1 - 1 + nsv_lima_nr), &#39;CORR&#39;, zcrs(:, :, :) * prhodj(:, :, :) )</span></div>
<div class="line"><a name="l00691"></a><span class="lineno">  691</span>&#160;<span class="comment">!     if ( lcold .and. lsnow .and. nmom_i.ge.2) &amp;</span></div>
<div class="line"><a name="l00692"></a><span class="lineno">  692</span>&#160;<span class="comment">!       call BUDGET_STORE_INIT_PHY(D, TBUDGETS(NBUDGET_SV1 - 1 + nsv_lima_ni), &#39;CORR&#39;, zcis(:, :, :) * prhodj(:, :, :) )</span></div>
<div class="line"><a name="l00693"></a><span class="lineno">  693</span>&#160;<span class="comment">!   end if</span></div>
<div class="line"><a name="l00694"></a><span class="lineno">  694</span>&#160;<span class="comment">! end if</span></div>
<div class="line"><a name="l00695"></a><span class="lineno">  695</span>&#160;<span class="comment">!!$IF (NMOM_R.GE.2) THEN</span></div>
<div class="line"><a name="l00696"></a><span class="lineno">  696</span>&#160;<span class="comment">!!$   WHERE( ZRCT&gt;XRTMIN(2) .AND. ZCCT&gt;XCTMIN(2) .AND. ZRCT&gt;XAC*ZCCT*(100.E-6)**XBC )</span></div>
<div class="line"><a name="l00697"></a><span class="lineno">  697</span>&#160;<span class="comment">!!$      ZRRT=ZRRT+ZRCT</span></div>
<div class="line"><a name="l00698"></a><span class="lineno">  698</span>&#160;<span class="comment">!!$      ZRRS=ZRRS+ZRCS</span></div>
<div class="line"><a name="l00699"></a><span class="lineno">  699</span>&#160;<span class="comment">!!$      ZCRT=ZCRT+ZCCT</span></div>
<div class="line"><a name="l00700"></a><span class="lineno">  700</span>&#160;<span class="comment">!!$      ZCRS=ZCRS+ZCCS</span></div>
<div class="line"><a name="l00701"></a><span class="lineno">  701</span>&#160;<span class="comment">!!$      ZRCT=0.</span></div>
<div class="line"><a name="l00702"></a><span class="lineno">  702</span>&#160;<span class="comment">!!$      ZCCT=0.</span></div>
<div class="line"><a name="l00703"></a><span class="lineno">  703</span>&#160;<span class="comment">!!$      ZRCS=0.</span></div>
<div class="line"><a name="l00704"></a><span class="lineno">  704</span>&#160;<span class="comment">!!$      ZCCS=0.</span></div>
<div class="line"><a name="l00705"></a><span class="lineno">  705</span>&#160;<span class="comment">!!$   END WHERE</span></div>
<div class="line"><a name="l00706"></a><span class="lineno">  706</span>&#160;<span class="comment">!!$END IF</span></div>
<div class="line"><a name="l00707"></a><span class="lineno">  707</span>&#160;<span class="comment">!!$!</span></div>
<div class="line"><a name="l00708"></a><span class="lineno">  708</span>&#160;<span class="comment">!!$IF (NMOM_R.GE.2) THEN</span></div>
<div class="line"><a name="l00709"></a><span class="lineno">  709</span>&#160;<span class="comment">!!$   WHERE( ZRRT&gt;XRTMIN(3) .AND. ZCRT&gt;XCTMIN(3) .AND. ZRRT&lt;XAR*ZCRT*(60.E-6)**XBR )</span></div>
<div class="line"><a name="l00710"></a><span class="lineno">  710</span>&#160;<span class="comment">!!$      ZRCT=ZRCT+ZRRT</span></div>
<div class="line"><a name="l00711"></a><span class="lineno">  711</span>&#160;<span class="comment">!!$      ZRCS=ZRCS+ZRRS</span></div>
<div class="line"><a name="l00712"></a><span class="lineno">  712</span>&#160;<span class="comment">!!$      ZCCT=ZCCT+ZCRT</span></div>
<div class="line"><a name="l00713"></a><span class="lineno">  713</span>&#160;<span class="comment">!!$      ZCCS=ZCCS+ZCRS</span></div>
<div class="line"><a name="l00714"></a><span class="lineno">  714</span>&#160;<span class="comment">!!$      ZRRT=0.</span></div>
<div class="line"><a name="l00715"></a><span class="lineno">  715</span>&#160;<span class="comment">!!$      ZCRT=0.</span></div>
<div class="line"><a name="l00716"></a><span class="lineno">  716</span>&#160;<span class="comment">!!$      ZRRS=0.</span></div>
<div class="line"><a name="l00717"></a><span class="lineno">  717</span>&#160;<span class="comment">!!$      ZCRS=0.</span></div>
<div class="line"><a name="l00718"></a><span class="lineno">  718</span>&#160;<span class="comment">!!$   END WHERE</span></div>
<div class="line"><a name="l00719"></a><span class="lineno">  719</span>&#160;<span class="comment">!!$END IF</span></div>
<div class="line"><a name="l00720"></a><span class="lineno">  720</span>&#160;<span class="comment">!!$!</span></div>
<div class="line"><a name="l00721"></a><span class="lineno">  721</span>&#160;<span class="comment">!!$IF (NMOM_S.GE.2) THEN</span></div>
<div class="line"><a name="l00722"></a><span class="lineno">  722</span>&#160;<span class="comment">!!$   WHERE( ZRIT&gt;XRTMIN(4) .AND. ZCIT&gt;XCTMIN(4) .AND. ZRIT&gt;XAI*ZCIT*(250.E-6)**XBI )</span></div>
<div class="line"><a name="l00723"></a><span class="lineno">  723</span>&#160;<span class="comment">!!$      ZRST=ZRST+ZRIT</span></div>
<div class="line"><a name="l00724"></a><span class="lineno">  724</span>&#160;<span class="comment">!!$      ZRSS=ZRSS+ZRIS</span></div>
<div class="line"><a name="l00725"></a><span class="lineno">  725</span>&#160;<span class="comment">!!$      ZRIT=0.</span></div>
<div class="line"><a name="l00726"></a><span class="lineno">  726</span>&#160;<span class="comment">!!$      ZCIT=0.</span></div>
<div class="line"><a name="l00727"></a><span class="lineno">  727</span>&#160;<span class="comment">!!$      ZRIS=0.</span></div>
<div class="line"><a name="l00728"></a><span class="lineno">  728</span>&#160;<span class="comment">!!$      ZCIS=0.</span></div>
<div class="line"><a name="l00729"></a><span class="lineno">  729</span>&#160;<span class="comment">!!$   END WHERE</span></div>
<div class="line"><a name="l00730"></a><span class="lineno">  730</span>&#160;<span class="comment">!!$END IF</span></div>
<div class="line"><a name="l00731"></a><span class="lineno">  731</span>&#160;<span class="comment">!</span></div>
<div class="line"><a name="l00732"></a><span class="lineno">  732</span>&#160;<span class="comment">! if ( BUCONF%lbu_enable ) then</span></div>
<div class="line"><a name="l00733"></a><span class="lineno">  733</span>&#160;<span class="comment">!   if ( BUCONF%lbudget_rc .and. lwarm .and. lrain ) call BUDGET_STORE_END_PHY(D, TBUDGETS(NBUDGET_RC), &#39;CORR&#39;, zrcs(:, :, :) * prhodj(:, :, :) )</span></div>
<div class="line"><a name="l00734"></a><span class="lineno">  734</span>&#160;<span class="comment">!   if ( BUCONF%lbudget_rr .and. lwarm .and. lrain ) call BUDGET_STORE_END_PHY(D, TBUDGETS(NBUDGET_RR), &#39;CORR&#39;, zrrs(:, :, :) * prhodj(:, :, :) )</span></div>
<div class="line"><a name="l00735"></a><span class="lineno">  735</span>&#160;<span class="comment">!   if ( BUCONF%lbudget_ri .and. lcold .and. lsnow ) call BUDGET_STORE_END_PHY(D, TBUDGETS(NBUDGET_RI), &#39;CORR&#39;, zris(:, :, :) * prhodj(:, :, :) )</span></div>
<div class="line"><a name="l00736"></a><span class="lineno">  736</span>&#160;<span class="comment">!   if ( BUCONF%lbudget_rs .and. lcold .and. lsnow ) call BUDGET_STORE_END_PHY(D, TBUDGETS(NBUDGET_RS), &#39;CORR&#39;, zrss(:, :, :) * prhodj(:, :, :) )</span></div>
<div class="line"><a name="l00737"></a><span class="lineno">  737</span>&#160;<span class="comment">!   if ( BUCONF%lbudget_sv ) then</span></div>
<div class="line"><a name="l00738"></a><span class="lineno">  738</span>&#160;<span class="comment">!     if ( lwarm .and. lrain .and. nmom_c.ge.2) &amp;</span></div>
<div class="line"><a name="l00739"></a><span class="lineno">  739</span>&#160;<span class="comment">!       call BUDGET_STORE_END_PHY(D, TBUDGETS(NBUDGET_SV1 - 1 + nsv_lima_nc), &#39;CORR&#39;, zccs(:, :, :) * prhodj(:, :, :) )</span></div>
<div class="line"><a name="l00740"></a><span class="lineno">  740</span>&#160;<span class="comment">!     if ( lwarm .and. lrain .and. nmom_r.ge.2) &amp;</span></div>
<div class="line"><a name="l00741"></a><span class="lineno">  741</span>&#160;<span class="comment">!       call BUDGET_STORE_END_PHY(D, TBUDGETS(NBUDGET_SV1 - 1 + nsv_lima_nr), &#39;CORR&#39;, zcrs(:, :, :) * prhodj(:, :, :) )</span></div>
<div class="line"><a name="l00742"></a><span class="lineno">  742</span>&#160;<span class="comment">!     if ( lcold .and. lsnow .and. nmom_i.ge.2) &amp;</span></div>
<div class="line"><a name="l00743"></a><span class="lineno">  743</span>&#160;<span class="comment">!       call BUDGET_STORE_END_PHY(D, TBUDGETS(NBUDGET_SV1 - 1 + nsv_lima_ni), &#39;CORR&#39;, zcis(:, :, :) * prhodj(:, :, :) )</span></div>
<div class="line"><a name="l00744"></a><span class="lineno">  744</span>&#160;<span class="comment">!   end if</span></div>
<div class="line"><a name="l00745"></a><span class="lineno">  745</span>&#160;<span class="comment">! end if</span></div>
<div class="line"><a name="l00746"></a><span class="lineno">  746</span>&#160;<span class="comment">!-------------------------------------------------------------------------------</span></div>
<div class="line"><a name="l00747"></a><span class="lineno">  747</span>&#160;<span class="comment">!</span></div>
<div class="line"><a name="l00748"></a><span class="lineno">  748</span>&#160;<span class="comment">!*       1.     Sedimentation</span></div>
<div class="line"><a name="l00749"></a><span class="lineno">  749</span>&#160;<span class="comment">!               -------------</span></div>
<div class="line"><a name="l00750"></a><span class="lineno">  750</span>&#160;<span class="comment">!</span></div>
<div class="line"><a name="l00751"></a><span class="lineno">  751</span>&#160;<span class="comment">!</span></div>
<div class="line"><a name="l00752"></a><span class="lineno">  752</span>&#160;pinprc=0.</div>
<div class="line"><a name="l00753"></a><span class="lineno">  753</span>&#160;pindep=0.</div>
<div class="line"><a name="l00754"></a><span class="lineno">  754</span>&#160;pinprr=0.</div>
<div class="line"><a name="l00755"></a><span class="lineno">  755</span>&#160;pinpri=0.</div>
<div class="line"><a name="l00756"></a><span class="lineno">  756</span>&#160;pinprs=0.</div>
<div class="line"><a name="l00757"></a><span class="lineno">  757</span>&#160;pinprg=0.</div>
<div class="line"><a name="l00758"></a><span class="lineno">  758</span>&#160;pinprh=0.</div>
<div class="line"><a name="l00759"></a><span class="lineno">  759</span>&#160;<span class="keywordflow">if</span> ( buconf%lbu_enable ) <span class="keywordflow">then</span></div>
<div class="line"><a name="l00760"></a><span class="lineno">  760</span>&#160;  <span class="keywordflow">if</span> ( buconf%lbudget_th ) &amp;</div>
<div class="line"><a name="l00761"></a><span class="lineno">  761</span>&#160;       <span class="keyword">call </span><a class="code" href="namespacemode__budget__phy.html#a618f66dd5a60cc85cb7470daae98cc3e">budget_store_init_phy</a>(d, tbudgets(<a class="code" href="namespacemodd__budget.html#a0d120a8b4c8fb6af560c814c1d3c2c19">nbudget_th</a>), <span class="stringliteral">&#39;SEDI&#39;</span>, zths(:, :, :) * prhodj(:, :, :) )</div>
<div class="line"><a name="l00762"></a><span class="lineno">  762</span>&#160;  <span class="keywordflow">if</span> ( buconf%lbudget_rc .and. <a class="code" href="namespacemodd__param__lima.html#ab0c8298b017b75cbd419d8b1980b0053">nmom_c</a>.ge.1 .and. <a class="code" href="namespacemodd__param__lima.html#a06ed3012b0f8fd4872b87c1b4207600b">lsedc</a> ) &amp;</div>
<div class="line"><a name="l00763"></a><span class="lineno">  763</span>&#160;       <span class="keyword">call </span><a class="code" href="namespacemode__budget__phy.html#a618f66dd5a60cc85cb7470daae98cc3e">budget_store_init_phy</a>(d, tbudgets(<a class="code" href="namespacemodd__budget.html#a685847647e25e21af43ab48da13b1797">nbudget_rc</a>), <span class="stringliteral">&#39;SEDI&#39;</span>, zrcs(:, :, :) * prhodj(:, :, :) )</div>
<div class="line"><a name="l00764"></a><span class="lineno">  764</span>&#160;  <span class="keywordflow">if</span> ( buconf%lbudget_rr .and. <a class="code" href="namespacemodd__param__lima.html#a7accc5c4a0a391c040a1de5e966eea04">nmom_r</a>.ge.1 ) &amp;</div>
<div class="line"><a name="l00765"></a><span class="lineno">  765</span>&#160;       <span class="keyword">call </span><a class="code" href="namespacemode__budget__phy.html#a618f66dd5a60cc85cb7470daae98cc3e">budget_store_init_phy</a>(d, tbudgets(<a class="code" href="namespacemodd__budget.html#aac4cd9c30fac3b66cb3078dad55fb1e2">nbudget_rr</a>), <span class="stringliteral">&#39;SEDI&#39;</span>, zrrs(:, :, :) * prhodj(:, :, :) )</div>
<div class="line"><a name="l00766"></a><span class="lineno">  766</span>&#160;  <span class="keywordflow">if</span> ( buconf%lbudget_ri .and. <a class="code" href="namespacemodd__param__lima.html#ab11c5caa054b5039171a4f10908abea1">nmom_i</a>.ge.1 .and. <a class="code" href="namespacemodd__param__lima.html#a5ba3388c0be2ffe78c0b41f36f8002a9">lsedi</a> ) &amp;</div>
<div class="line"><a name="l00767"></a><span class="lineno">  767</span>&#160;       <span class="keyword">call </span><a class="code" href="namespacemode__budget__phy.html#a618f66dd5a60cc85cb7470daae98cc3e">budget_store_init_phy</a>(d, tbudgets(<a class="code" href="namespacemodd__budget.html#a4ea4532bcfa769b5ed97e4d1e68a8113">nbudget_ri</a>), <span class="stringliteral">&#39;SEDI&#39;</span>, zris(:, :, :) * prhodj(:, :, :) )</div>
<div class="line"><a name="l00768"></a><span class="lineno">  768</span>&#160;  <span class="keywordflow">if</span> ( buconf%lbudget_rs .and. <a class="code" href="namespacemodd__param__lima.html#a63b4f80fe043e01602ef78b2caf0e487">nmom_s</a>.ge.1 ) &amp;</div>
<div class="line"><a name="l00769"></a><span class="lineno">  769</span>&#160;       <span class="keyword">call </span><a class="code" href="namespacemode__budget__phy.html#a618f66dd5a60cc85cb7470daae98cc3e">budget_store_init_phy</a>(d, tbudgets(<a class="code" href="namespacemodd__budget.html#a4e4985c2c538a46dd511258704757086">nbudget_rs</a>), <span class="stringliteral">&#39;SEDI&#39;</span>, zrss(:, :, :) * prhodj(:, :, :) )</div>
<div class="line"><a name="l00770"></a><span class="lineno">  770</span>&#160;  <span class="keywordflow">if</span> ( buconf%lbudget_rg .and. <a class="code" href="namespacemodd__param__lima.html#acd76d6876dec7668fc081a4380690182">nmom_g</a>.ge.1 ) &amp;</div>
<div class="line"><a name="l00771"></a><span class="lineno">  771</span>&#160;       <span class="keyword">call </span><a class="code" href="namespacemode__budget__phy.html#a618f66dd5a60cc85cb7470daae98cc3e">budget_store_init_phy</a>(d, tbudgets(<a class="code" href="namespacemodd__budget.html#aef76ce44ca163871fcb14427eae825a9">nbudget_rg</a>), <span class="stringliteral">&#39;SEDI&#39;</span>, zrgs(:, :, :) * prhodj(:, :, :) )</div>
<div class="line"><a name="l00772"></a><span class="lineno">  772</span>&#160;  <span class="keywordflow">if</span> ( buconf%lbudget_rh .and. <a class="code" href="namespacemodd__param__lima.html#a8a40a50a7778130438208e2974634384">nmom_h</a>.ge.1 ) &amp;</div>
<div class="line"><a name="l00773"></a><span class="lineno">  773</span>&#160;       <span class="keyword">call </span><a class="code" href="namespacemode__budget__phy.html#a618f66dd5a60cc85cb7470daae98cc3e">budget_store_init_phy</a>(d, tbudgets(<a class="code" href="namespacemodd__budget.html#a07dc15edaf8cd68c1036451fc7b536b9">nbudget_rh</a>), <span class="stringliteral">&#39;SEDI&#39;</span>, zrhs(:, :, :) * prhodj(:, :, :) )</div>
<div class="line"><a name="l00774"></a><span class="lineno">  774</span>&#160;  <span class="keywordflow">if</span> ( buconf%lbudget_sv ) <span class="keywordflow">then</span></div>
<div class="line"><a name="l00775"></a><span class="lineno">  775</span>&#160;    <span class="keywordflow">if</span> ( <a class="code" href="namespacemodd__param__lima.html#a06ed3012b0f8fd4872b87c1b4207600b">lsedc</a> .and. <a class="code" href="namespacemodd__param__lima.html#ab0c8298b017b75cbd419d8b1980b0053">nmom_c</a>.ge.2) &amp;</div>
<div class="line"><a name="l00776"></a><span class="lineno">  776</span>&#160;      <span class="keyword">call </span><a class="code" href="namespacemode__budget__phy.html#a618f66dd5a60cc85cb7470daae98cc3e">budget_store_init_phy</a>(d, tbudgets(<a class="code" href="namespacemodd__budget.html#aab05ad1db5848733632fdbcefeb4a0a0">nbudget_sv1</a> - 1 + <a class="code" href="namespacemodd__nsv.html#a40a6809489f33d2332c09e3cdf634f64">nsv_lima_nc</a>), <span class="stringliteral">&#39;SEDI&#39;</span>, zccs(:, :, :) * prhodj(:, :, :) )</div>
<div class="line"><a name="l00777"></a><span class="lineno">  777</span>&#160;    <span class="keywordflow">if</span> ( <a class="code" href="namespacemodd__param__lima.html#a7accc5c4a0a391c040a1de5e966eea04">nmom_r</a>.ge.2) &amp;</div>
<div class="line"><a name="l00778"></a><span class="lineno">  778</span>&#160;      <span class="keyword">call </span><a class="code" href="namespacemode__budget__phy.html#a618f66dd5a60cc85cb7470daae98cc3e">budget_store_init_phy</a>(d, tbudgets(<a class="code" href="namespacemodd__budget.html#aab05ad1db5848733632fdbcefeb4a0a0">nbudget_sv1</a> - 1 + <a class="code" href="namespacemodd__nsv.html#a0f254b896adb763119f451ed055d2463">nsv_lima_nr</a>), <span class="stringliteral">&#39;SEDI&#39;</span>, zcrs(:, :, :) * prhodj(:, :, :) )</div>
<div class="line"><a name="l00779"></a><span class="lineno">  779</span>&#160;    <span class="keywordflow">if</span> ( <a class="code" href="namespacemodd__param__lima.html#a5ba3388c0be2ffe78c0b41f36f8002a9">lsedi</a> .and. <a class="code" href="namespacemodd__param__lima.html#ab11c5caa054b5039171a4f10908abea1">nmom_i</a>.ge.2) &amp;</div>
<div class="line"><a name="l00780"></a><span class="lineno">  780</span>&#160;      <span class="keyword">call </span><a class="code" href="namespacemode__budget__phy.html#a618f66dd5a60cc85cb7470daae98cc3e">budget_store_init_phy</a>(d, tbudgets(<a class="code" href="namespacemodd__budget.html#aab05ad1db5848733632fdbcefeb4a0a0">nbudget_sv1</a> - 1 + <a class="code" href="namespacemodd__nsv.html#a42ef78d1d5be64b40c0969a07598e268">nsv_lima_ni</a>), <span class="stringliteral">&#39;SEDI&#39;</span>, zcis(:, :, :) * prhodj(:, :, :) )</div>
<div class="line"><a name="l00781"></a><span class="lineno">  781</span>&#160;    <span class="keywordflow">if</span> ( <a class="code" href="namespacemodd__param__lima.html#a63b4f80fe043e01602ef78b2caf0e487">nmom_s</a>.ge.2) &amp;</div>
<div class="line"><a name="l00782"></a><span class="lineno">  782</span>&#160;      <span class="keyword">call </span><a class="code" href="namespacemode__budget__phy.html#a618f66dd5a60cc85cb7470daae98cc3e">budget_store_init_phy</a>(d, tbudgets(<a class="code" href="namespacemodd__budget.html#aab05ad1db5848733632fdbcefeb4a0a0">nbudget_sv1</a> - 1 + <a class="code" href="namespacemodd__nsv.html#a88f9a0bd54e36147cedeb35da2648aac">nsv_lima_ns</a>), <span class="stringliteral">&#39;SEDI&#39;</span>, zcss(:, :, :) * prhodj(:, :, :) )</div>
<div class="line"><a name="l00783"></a><span class="lineno">  783</span>&#160;    <span class="keywordflow">if</span> ( <a class="code" href="namespacemodd__param__lima.html#acd76d6876dec7668fc081a4380690182">nmom_g</a>.ge.2) &amp;</div>
<div class="line"><a name="l00784"></a><span class="lineno">  784</span>&#160;      <span class="keyword">call </span><a class="code" href="namespacemode__budget__phy.html#a618f66dd5a60cc85cb7470daae98cc3e">budget_store_init_phy</a>(d, tbudgets(<a class="code" href="namespacemodd__budget.html#aab05ad1db5848733632fdbcefeb4a0a0">nbudget_sv1</a> - 1 + <a class="code" href="namespacemodd__nsv.html#a822424cae100267f4e55c551af04dae9">nsv_lima_ng</a>), <span class="stringliteral">&#39;SEDI&#39;</span>, zcgs(:, :, :) * prhodj(:, :, :) )</div>
<div class="line"><a name="l00785"></a><span class="lineno">  785</span>&#160;    <span class="keywordflow">if</span> ( <a class="code" href="namespacemodd__param__lima.html#a8a40a50a7778130438208e2974634384">nmom_h</a>.ge.2) &amp;</div>
<div class="line"><a name="l00786"></a><span class="lineno">  786</span>&#160;      <span class="keyword">call </span><a class="code" href="namespacemode__budget__phy.html#a618f66dd5a60cc85cb7470daae98cc3e">budget_store_init_phy</a>(d, tbudgets(<a class="code" href="namespacemodd__budget.html#aab05ad1db5848733632fdbcefeb4a0a0">nbudget_sv1</a> - 1 + <a class="code" href="namespacemodd__nsv.html#aee0d9e88c097894c400536f6199a19c3">nsv_lima_nh</a>), <span class="stringliteral">&#39;SEDI&#39;</span>, zchs(:, :, :) * prhodj(:, :, :) )</div>
<div class="line"><a name="l00787"></a><span class="lineno">  787</span>&#160;    <span class="comment">!</span></div>
<div class="line"><a name="l00788"></a><span class="lineno">  788</span>&#160;    <span class="keywordflow">if</span> (oelec) <span class="keywordflow">then</span></div>
<div class="line"><a name="l00789"></a><span class="lineno">  789</span>&#160;      <span class="keywordflow">if</span> ( <a class="code" href="namespacemodd__param__lima.html#a06ed3012b0f8fd4872b87c1b4207600b">lsedc</a> ) &amp;</div>
<div class="line"><a name="l00790"></a><span class="lineno">  790</span>&#160;        <span class="keyword">call </span><a class="code" href="namespacemode__budget__phy.html#a618f66dd5a60cc85cb7470daae98cc3e">budget_store_init_phy</a>(d, tbudgets(<a class="code" href="namespacemodd__budget.html#aab05ad1db5848733632fdbcefeb4a0a0">nbudget_sv1</a> - 1 + <a class="code" href="namespacemodd__nsv.html#a864b10357f60be51dc3ecd1ffad90ccf">nsv_elecbeg</a> + 1), <span class="stringliteral">&#39;SEDI&#39;</span>, zqcs(:, :, :) * prhodj(:, :, :) )</div>
<div class="line"><a name="l00791"></a><span class="lineno">  791</span>&#160;      <span class="keyword">call </span><a class="code" href="namespacemode__budget__phy.html#a618f66dd5a60cc85cb7470daae98cc3e">budget_store_init_phy</a>(d, tbudgets(<a class="code" href="namespacemodd__budget.html#aab05ad1db5848733632fdbcefeb4a0a0">nbudget_sv1</a> - 1 + <a class="code" href="namespacemodd__nsv.html#a864b10357f60be51dc3ecd1ffad90ccf">nsv_elecbeg</a> + 2), <span class="stringliteral">&#39;SEDI&#39;</span>, zqrs(:, :, :) * prhodj(:, :, :) )</div>
<div class="line"><a name="l00792"></a><span class="lineno">  792</span>&#160;      <span class="keywordflow">if</span> ( <a class="code" href="namespacemodd__param__lima.html#a5ba3388c0be2ffe78c0b41f36f8002a9">lsedi</a> ) &amp;</div>
<div class="line"><a name="l00793"></a><span class="lineno">  793</span>&#160;        <span class="keyword">call </span><a class="code" href="namespacemode__budget__phy.html#a618f66dd5a60cc85cb7470daae98cc3e">budget_store_init_phy</a>(d, tbudgets(<a class="code" href="namespacemodd__budget.html#aab05ad1db5848733632fdbcefeb4a0a0">nbudget_sv1</a> - 1 + <a class="code" href="namespacemodd__nsv.html#a864b10357f60be51dc3ecd1ffad90ccf">nsv_elecbeg</a> + 3), <span class="stringliteral">&#39;SEDI&#39;</span>, zqis(:, :, :) * prhodj(:, :, :) )</div>
<div class="line"><a name="l00794"></a><span class="lineno">  794</span>&#160;      <span class="keyword">call </span><a class="code" href="namespacemode__budget__phy.html#a618f66dd5a60cc85cb7470daae98cc3e">budget_store_init_phy</a>(d, tbudgets(<a class="code" href="namespacemodd__budget.html#aab05ad1db5848733632fdbcefeb4a0a0">nbudget_sv1</a> - 1 + <a class="code" href="namespacemodd__nsv.html#a864b10357f60be51dc3ecd1ffad90ccf">nsv_elecbeg</a> + 4), <span class="stringliteral">&#39;SEDI&#39;</span>, zqss(:, :, :) * prhodj(:, :, :) )</div>
<div class="line"><a name="l00795"></a><span class="lineno">  795</span>&#160;      <span class="keyword">call </span><a class="code" href="namespacemode__budget__phy.html#a618f66dd5a60cc85cb7470daae98cc3e">budget_store_init_phy</a>(d, tbudgets(<a class="code" href="namespacemodd__budget.html#aab05ad1db5848733632fdbcefeb4a0a0">nbudget_sv1</a> - 1 + <a class="code" href="namespacemodd__nsv.html#a864b10357f60be51dc3ecd1ffad90ccf">nsv_elecbeg</a> + 5), <span class="stringliteral">&#39;SEDI&#39;</span>, zqgs(:, :, :) * prhodj(:, :, :) )</div>
<div class="line"><a name="l00796"></a><span class="lineno">  796</span>&#160;      <span class="keywordflow">if</span> (<a class="code" href="namespacemodd__param__lima.html#a8a40a50a7778130438208e2974634384">nmom_h</a> .ge. 1) &amp;</div>
<div class="line"><a name="l00797"></a><span class="lineno">  797</span>&#160;        <span class="keyword">call </span><a class="code" href="namespacemode__budget__phy.html#a618f66dd5a60cc85cb7470daae98cc3e">budget_store_init_phy</a>(d, tbudgets(<a class="code" href="namespacemodd__budget.html#aab05ad1db5848733632fdbcefeb4a0a0">nbudget_sv1</a> - 1 + <a class="code" href="namespacemodd__nsv.html#a864b10357f60be51dc3ecd1ffad90ccf">nsv_elecbeg</a> + 6), <span class="stringliteral">&#39;SEDI&#39;</span>, zqhs(:, :, :) * prhodj(:, :, :) )</div>
<div class="line"><a name="l00798"></a><span class="lineno">  798</span>&#160;<span class="keywordflow">    end if</span></div>
<div class="line"><a name="l00799"></a><span class="lineno">  799</span>&#160;<span class="keywordflow">  end if</span></div>
<div class="line"><a name="l00800"></a><span class="lineno">  800</span>&#160;<span class="keywordflow">end if</span></div>
<div class="line"><a name="l00801"></a><span class="lineno">  801</span>&#160;<span class="comment">!</span></div>
<div class="line"><a name="l00802"></a><span class="lineno">  802</span>&#160;pfpr(:,:,:,:)=0.</div>
<div class="line"><a name="l00803"></a><span class="lineno">  803</span>&#160;<span class="comment">!</span></div>
<div class="line"><a name="l00804"></a><span class="lineno">  804</span>&#160;<span class="comment">! sedimentation of cloud droplets</span></div>
<div class="line"><a name="l00805"></a><span class="lineno">  805</span>&#160;zrt_sum = (zrvs + zrcs + zrrs + zris + zrss + zrgs + zrhs)*ptstep</div>
<div class="line"><a name="l00806"></a><span class="lineno">  806</span>&#160;zcpt    = cst%XCPD + (cst%XCPV * zrvs + cst%XCL * (zrcs + zrrs) + cst%XCI * (zris + zrss + zrgs + zrhs))*ptstep</div>
<div class="line"><a name="l00807"></a><span class="lineno">  807</span>&#160;<span class="keywordflow">IF</span> (<a class="code" href="namespacemodd__param__lima.html#ab0c8298b017b75cbd419d8b1980b0053">nmom_c</a>.GE.1 .AND. <a class="code" href="namespacemodd__param__lima.html#a06ed3012b0f8fd4872b87c1b4207600b">lsedc</a>) <span class="keywordflow">THEN</span></div>
<div class="line"><a name="l00808"></a><span class="lineno">  808</span>&#160;  <span class="keywordflow">IF</span> (oelec) <span class="keywordflow">THEN</span></div>
<div class="line"><a name="l00809"></a><span class="lineno">  809</span>&#160;    <span class="keyword">CALL </span><a class="code" href="namespacemode__lima__sedimentation.html#a964e14d529764f1a85ca486687463413">lima_sedimentation</a>(d, cst, &amp;</div>
<div class="line"><a name="l00810"></a><span class="lineno">  810</span>&#160;                            <span class="stringliteral">&#39;L&#39;</span>, 2, 2, 1, ptstep, oelec, pdzz, prhodref, pthvrefzikb, ppabst, zt, zrt_sum, zcpt, &amp;</div>
<div class="line"><a name="l00811"></a><span class="lineno">  811</span>&#160;                            zrcs, zccs, pinprc, pfpr(:,:,:,2), pefieldw, zqcs)</div>
<div class="line"><a name="l00812"></a><span class="lineno">  812</span>&#160;  <span class="keywordflow">ELSE</span></div>
<div class="line"><a name="l00813"></a><span class="lineno">  813</span>&#160;    <span class="keyword">CALL </span><a class="code" href="namespacemode__lima__sedimentation.html#a964e14d529764f1a85ca486687463413">lima_sedimentation</a>(d, cst, &amp;</div>
<div class="line"><a name="l00814"></a><span class="lineno">  814</span>&#160;                            <span class="stringliteral">&#39;L&#39;</span>, 2, 2, 1, ptstep, oelec, pdzz, prhodref, pthvrefzikb, ppabst, zt, zrt_sum, zcpt, &amp;</div>
<div class="line"><a name="l00815"></a><span class="lineno">  815</span>&#160;                            zrcs, zccs, pinprc, pfpr(:,:,:,2))</div>
<div class="line"><a name="l00816"></a><span class="lineno">  816</span>&#160;<span class="keywordflow">  END IF</span></div>
<div class="line"><a name="l00817"></a><span class="lineno">  817</span>&#160;<span class="keywordflow">END IF</span></div>
<div class="line"><a name="l00818"></a><span class="lineno">  818</span>&#160;<span class="comment">!</span></div>
<div class="line"><a name="l00819"></a><span class="lineno">  819</span>&#160;<span class="comment">! sedimentation of raindrops</span></div>
<div class="line"><a name="l00820"></a><span class="lineno">  820</span>&#160;zrt_sum = (zrvs + zrcs + zrrs + zris + zrss + zrgs + zrhs)*ptstep</div>
<div class="line"><a name="l00821"></a><span class="lineno">  821</span>&#160;zcpt    = cst%XCPD + (cst%XCPV * zrvs + cst%XCL * (zrcs + zrrs) + cst%XCI * (zris + zrss + zrgs + zrhs))*ptstep</div>
<div class="line"><a name="l00822"></a><span class="lineno">  822</span>&#160;<span class="keywordflow">IF</span> (<a class="code" href="namespacemodd__param__lima.html#a7accc5c4a0a391c040a1de5e966eea04">nmom_r</a>.GE.1) <span class="keywordflow">THEN</span></div>
<div class="line"><a name="l00823"></a><span class="lineno">  823</span>&#160;  <span class="keywordflow">IF</span> (oelec) <span class="keywordflow">THEN</span></div>
<div class="line"><a name="l00824"></a><span class="lineno">  824</span>&#160;    <span class="keyword">CALL </span><a class="code" href="namespacemode__lima__sedimentation.html#a964e14d529764f1a85ca486687463413">lima_sedimentation</a>(d, cst, &amp;</div>
<div class="line"><a name="l00825"></a><span class="lineno">  825</span>&#160;                            <span class="stringliteral">&#39;L&#39;</span>, <a class="code" href="namespacemodd__param__lima.html#a7accc5c4a0a391c040a1de5e966eea04">nmom_r</a>, 3, 1, ptstep, oelec, pdzz, prhodref, pthvrefzikb,ppabst, zt, zrt_sum, zcpt, &amp;</div>
<div class="line"><a name="l00826"></a><span class="lineno">  826</span>&#160;                            zrrs, zcrs, pinprr, pfpr(:,:,:,3), pefieldw, zqrs)</div>
<div class="line"><a name="l00827"></a><span class="lineno">  827</span>&#160;  <span class="keywordflow">ELSE</span></div>
<div class="line"><a name="l00828"></a><span class="lineno">  828</span>&#160;    <span class="keyword">CALL </span><a class="code" href="namespacemode__lima__sedimentation.html#a964e14d529764f1a85ca486687463413">lima_sedimentation</a>(d, cst, &amp;</div>
<div class="line"><a name="l00829"></a><span class="lineno">  829</span>&#160;                            <span class="stringliteral">&#39;L&#39;</span>, <a class="code" href="namespacemodd__param__lima.html#a7accc5c4a0a391c040a1de5e966eea04">nmom_r</a>, 3, 1, ptstep, oelec, pdzz, prhodref,pthvrefzikb, ppabst, zt, zrt_sum, zcpt, &amp;</div>
<div class="line"><a name="l00830"></a><span class="lineno">  830</span>&#160;                            zrrs, zcrs, pinprr, pfpr(:,:,:,3))</div>
<div class="line"><a name="l00831"></a><span class="lineno">  831</span>&#160;<span class="keywordflow">  END IF</span></div>
<div class="line"><a name="l00832"></a><span class="lineno">  832</span>&#160;<span class="keywordflow">END IF</span></div>
<div class="line"><a name="l00833"></a><span class="lineno">  833</span>&#160;<span class="comment">!</span></div>
<div class="line"><a name="l00834"></a><span class="lineno">  834</span>&#160;<span class="comment">! sedimentation of ice crystals</span></div>
<div class="line"><a name="l00835"></a><span class="lineno">  835</span>&#160;zrt_sum = (zrvs + zrcs + zrrs + zris + zrss + zrgs + zrhs)*ptstep</div>
<div class="line"><a name="l00836"></a><span class="lineno">  836</span>&#160;zcpt    = cst%XCPD + (cst%XCPV * zrvs + cst%XCL * (zrcs + zrrs) + cst%XCI * (zris + zrss + zrgs + zrhs))*ptstep</div>
<div class="line"><a name="l00837"></a><span class="lineno">  837</span>&#160;<span class="keywordflow">IF</span> (<a class="code" href="namespacemodd__param__lima.html#ab11c5caa054b5039171a4f10908abea1">nmom_i</a>.GE.1 .AND. <a class="code" href="namespacemodd__param__lima.html#a5ba3388c0be2ffe78c0b41f36f8002a9">lsedi</a>) <span class="keywordflow">THEN</span></div>
<div class="line"><a name="l00838"></a><span class="lineno">  838</span>&#160;  <span class="keywordflow">IF</span> (oelec) <span class="keywordflow">THEN</span></div>
<div class="line"><a name="l00839"></a><span class="lineno">  839</span>&#160;    <span class="keyword">CALL </span><a class="code" href="namespacemode__lima__sedimentation.html#a964e14d529764f1a85ca486687463413">lima_sedimentation</a>(d, cst, &amp;</div>
<div class="line"><a name="l00840"></a><span class="lineno">  840</span>&#160;                            <span class="stringliteral">&#39;I&#39;</span>, <a class="code" href="namespacemodd__param__lima.html#ab11c5caa054b5039171a4f10908abea1">nmom_i</a>, 4, 1, ptstep, oelec, pdzz, prhodref,pthvrefzikb, ppabst, zt, zrt_sum, zcpt, &amp;</div>
<div class="line"><a name="l00841"></a><span class="lineno">  841</span>&#160;                            zris, zcis, zw2d, pfpr(:,:,:,4), pefieldw, zqis)</div>
<div class="line"><a name="l00842"></a><span class="lineno">  842</span>&#160;  <span class="keywordflow">ELSE</span></div>
<div class="line"><a name="l00843"></a><span class="lineno">  843</span>&#160;    <span class="keyword">CALL </span><a class="code" href="namespacemode__lima__sedimentation.html#a964e14d529764f1a85ca486687463413">lima_sedimentation</a>(d, cst, &amp;</div>
<div class="line"><a name="l00844"></a><span class="lineno">  844</span>&#160;                            <span class="stringliteral">&#39;I&#39;</span>, <a class="code" href="namespacemodd__param__lima.html#ab11c5caa054b5039171a4f10908abea1">nmom_i</a>, 4, 1, ptstep, oelec, pdzz, prhodref,pthvrefzikb, ppabst, zt, zrt_sum, zcpt, &amp;</div>
<div class="line"><a name="l00845"></a><span class="lineno">  845</span>&#160;                            zris, zcis, zw2d, pfpr(:,:,:,4))</div>
<div class="line"><a name="l00846"></a><span class="lineno">  846</span>&#160;<span class="keywordflow">  END IF</span></div>
<div class="line"><a name="l00847"></a><span class="lineno">  847</span>&#160;<span class="keywordflow">END IF</span></div>
<div class="line"><a name="l00848"></a><span class="lineno">  848</span>&#160;<span class="comment">!</span></div>
<div class="line"><a name="l00849"></a><span class="lineno">  849</span>&#160;<span class="comment">! sedimentation of snow/aggregates</span></div>
<div class="line"><a name="l00850"></a><span class="lineno">  850</span>&#160;zrt_sum = (zrvs + zrcs + zrrs + zris + zrss + zrgs + zrhs)*ptstep</div>
<div class="line"><a name="l00851"></a><span class="lineno">  851</span>&#160;zcpt    = cst%XCPD + (cst%XCPV * zrvs + cst%XCL * (zrcs + zrrs) + cst%XCI * (zris + zrss + zrgs + zrhs))*ptstep</div>
<div class="line"><a name="l00852"></a><span class="lineno">  852</span>&#160;<span class="keywordflow">IF</span> (<a class="code" href="namespacemodd__param__lima.html#a63b4f80fe043e01602ef78b2caf0e487">nmom_s</a>.GE.1) <span class="keywordflow">THEN</span></div>
<div class="line"><a name="l00853"></a><span class="lineno">  853</span>&#160;  <span class="keywordflow">IF</span> (oelec) <span class="keywordflow">THEN</span></div>
<div class="line"><a name="l00854"></a><span class="lineno">  854</span>&#160;    <span class="keyword">CALL </span><a class="code" href="namespacemode__lima__sedimentation.html#a964e14d529764f1a85ca486687463413">lima_sedimentation</a>(d, cst, &amp;</div>
<div class="line"><a name="l00855"></a><span class="lineno">  855</span>&#160;                            <span class="stringliteral">&#39;I&#39;</span>, <a class="code" href="namespacemodd__param__lima.html#a63b4f80fe043e01602ef78b2caf0e487">nmom_s</a>, 5, 1, ptstep, oelec, pdzz, prhodref, pthvrefzikb, ppabst, zt, zrt_sum, zcpt, &amp;</div>
<div class="line"><a name="l00856"></a><span class="lineno">  856</span>&#160;                            zrss, zcss, pinprs, pfpr(:,:,:,5), pefieldw, zqss)</div>
<div class="line"><a name="l00857"></a><span class="lineno">  857</span>&#160;  <span class="keywordflow">ELSE</span></div>
<div class="line"><a name="l00858"></a><span class="lineno">  858</span>&#160;    <span class="keyword">CALL </span><a class="code" href="namespacemode__lima__sedimentation.html#a964e14d529764f1a85ca486687463413">lima_sedimentation</a>(d, cst, &amp;</div>
<div class="line"><a name="l00859"></a><span class="lineno">  859</span>&#160;                            <span class="stringliteral">&#39;I&#39;</span>, <a class="code" href="namespacemodd__param__lima.html#a63b4f80fe043e01602ef78b2caf0e487">nmom_s</a>, 5, 1, ptstep, oelec, pdzz, prhodref, pthvrefzikb, ppabst,zt, zrt_sum, zcpt, &amp;</div>
<div class="line"><a name="l00860"></a><span class="lineno">  860</span>&#160;                            zrss, zcss, pinprs, pfpr(:,:,:,5))</div>
<div class="line"><a name="l00861"></a><span class="lineno">  861</span>&#160;<span class="keywordflow">  END IF</span></div>
<div class="line"><a name="l00862"></a><span class="lineno">  862</span>&#160;<span class="keywordflow">END IF</span></div>
<div class="line"><a name="l00863"></a><span class="lineno">  863</span>&#160;<span class="comment">!</span></div>
<div class="line"><a name="l00864"></a><span class="lineno">  864</span>&#160;<span class="comment">! sedimentation of graupel</span></div>
<div class="line"><a name="l00865"></a><span class="lineno">  865</span>&#160;zrt_sum = (zrvs + zrcs + zrrs + zris + zrss + zrgs + zrhs)*ptstep</div>
<div class="line"><a name="l00866"></a><span class="lineno">  866</span>&#160;zcpt    = cst%XCPD + (cst%XCPV * zrvs + cst%XCL * (zrcs + zrrs) + cst%XCI * (zris + zrss + zrgs + zrhs))*ptstep</div>
<div class="line"><a name="l00867"></a><span class="lineno">  867</span>&#160;<span class="keywordflow">IF</span> (<a class="code" href="namespacemodd__param__lima.html#acd76d6876dec7668fc081a4380690182">nmom_g</a>.GE.1) <span class="keywordflow">THEN</span></div>
<div class="line"><a name="l00868"></a><span class="lineno">  868</span>&#160;  <span class="keywordflow">IF</span> (oelec) <span class="keywordflow">THEN</span></div>
<div class="line"><a name="l00869"></a><span class="lineno">  869</span>&#160;    <span class="keyword">CALL </span><a class="code" href="namespacemode__lima__sedimentation.html#a964e14d529764f1a85ca486687463413">lima_sedimentation</a>(d, cst, &amp;</div>
<div class="line"><a name="l00870"></a><span class="lineno">  870</span>&#160;                            <span class="stringliteral">&#39;I&#39;</span>, <a class="code" href="namespacemodd__param__lima.html#acd76d6876dec7668fc081a4380690182">nmom_g</a>, 6, 1, ptstep, oelec, pdzz, prhodref, pthvrefzikb, ppabst, zt, zrt_sum, zcpt, &amp;</div>
<div class="line"><a name="l00871"></a><span class="lineno">  871</span>&#160;                            zrgs, zcgs, pinprg, pfpr(:,:,:,6), pefieldw, zqgs)</div>
<div class="line"><a name="l00872"></a><span class="lineno">  872</span>&#160;  <span class="keywordflow">ELSE</span></div>
<div class="line"><a name="l00873"></a><span class="lineno">  873</span>&#160;    <span class="keyword">CALL </span><a class="code" href="namespacemode__lima__sedimentation.html#a964e14d529764f1a85ca486687463413">lima_sedimentation</a>(d, cst, &amp;</div>
<div class="line"><a name="l00874"></a><span class="lineno">  874</span>&#160;                            <span class="stringliteral">&#39;I&#39;</span>, <a class="code" href="namespacemodd__param__lima.html#acd76d6876dec7668fc081a4380690182">nmom_g</a>, 6, 1, ptstep, oelec, pdzz, prhodref, pthvrefzikb, ppabst, zt, zrt_sum, zcpt, &amp;</div>
<div class="line"><a name="l00875"></a><span class="lineno">  875</span>&#160;                            zrgs, zcgs, pinprg, pfpr(:,:,:,6))</div>
<div class="line"><a name="l00876"></a><span class="lineno">  876</span>&#160;<span class="keywordflow">  END IF</span></div>
<div class="line"><a name="l00877"></a><span class="lineno">  877</span>&#160;<span class="keywordflow">END IF</span></div>
<div class="line"><a name="l00878"></a><span class="lineno">  878</span>&#160;<span class="comment">!</span></div>
<div class="line"><a name="l00879"></a><span class="lineno">  879</span>&#160;<span class="comment">! sedimentation of hail</span></div>
<div class="line"><a name="l00880"></a><span class="lineno">  880</span>&#160;zrt_sum = (zrvs + zrcs + zrrs + zris + zrss + zrgs + zrhs)*ptstep</div>
<div class="line"><a name="l00881"></a><span class="lineno">  881</span>&#160;zcpt    = cst%XCPD + (cst%XCPV * zrvs + cst%XCL * (zrcs + zrrs) + cst%XCI * (zris + zrss + zrgs + zrhs))*ptstep</div>
<div class="line"><a name="l00882"></a><span class="lineno">  882</span>&#160;<span class="keywordflow">IF</span> (<a class="code" href="namespacemodd__param__lima.html#a8a40a50a7778130438208e2974634384">nmom_h</a>.GE.1) <span class="keywordflow">THEN</span></div>
<div class="line"><a name="l00883"></a><span class="lineno">  883</span>&#160;  <span class="keywordflow">IF</span> (oelec) <span class="keywordflow">THEN</span></div>
<div class="line"><a name="l00884"></a><span class="lineno">  884</span>&#160;    <span class="keyword">CALL </span><a class="code" href="namespacemode__lima__sedimentation.html#a964e14d529764f1a85ca486687463413">lima_sedimentation</a>(d, cst, &amp;</div>
<div class="line"><a name="l00885"></a><span class="lineno">  885</span>&#160;                            <span class="stringliteral">&#39;I&#39;</span>, <a class="code" href="namespacemodd__param__lima.html#a8a40a50a7778130438208e2974634384">nmom_h</a>, 7, 1, ptstep, oelec, pdzz, prhodref, pthvrefzikb, ppabst, zt, zrt_sum, zcpt, &amp;</div>
<div class="line"><a name="l00886"></a><span class="lineno">  886</span>&#160;                            zrhs, zchs, pinprh, pfpr(:,:,:,7), pefieldw, zqhs)</div>
<div class="line"><a name="l00887"></a><span class="lineno">  887</span>&#160;  <span class="keywordflow">ELSE</span></div>
<div class="line"><a name="l00888"></a><span class="lineno">  888</span>&#160;    <span class="keyword">CALL </span><a class="code" href="namespacemode__lima__sedimentation.html#a964e14d529764f1a85ca486687463413">lima_sedimentation</a>(d, cst, &amp;</div>
<div class="line"><a name="l00889"></a><span class="lineno">  889</span>&#160;                            <span class="stringliteral">&#39;I&#39;</span>, <a class="code" href="namespacemodd__param__lima.html#a8a40a50a7778130438208e2974634384">nmom_h</a>, 7, 1, ptstep, oelec, pdzz, prhodref, pthvrefzikb, ppabst, zt, zrt_sum, zcpt, &amp;</div>
<div class="line"><a name="l00890"></a><span class="lineno">  890</span>&#160;                            zrhs, zchs, pinprh, pfpr(:,:,:,7))</div>
<div class="line"><a name="l00891"></a><span class="lineno">  891</span>&#160;<span class="keywordflow">  END IF</span></div>
<div class="line"><a name="l00892"></a><span class="lineno">  892</span>&#160;<span class="keywordflow">END IF</span></div>
<div class="line"><a name="l00893"></a><span class="lineno">  893</span>&#160;<span class="comment">!</span></div>
<div class="line"><a name="l00894"></a><span class="lineno">  894</span>&#160;zths(:,:,:) = zt(:,:,:) / zexn(:,:,:) * zinv_tstep</div>
<div class="line"><a name="l00895"></a><span class="lineno">  895</span>&#160;<span class="comment">!</span></div>
<div class="line"><a name="l00896"></a><span class="lineno">  896</span>&#160;<span class="comment">! Call budgets</span></div>
<div class="line"><a name="l00897"></a><span class="lineno">  897</span>&#160;<span class="comment">!</span></div>
<div class="line"><a name="l00898"></a><span class="lineno">  898</span>&#160;<span class="keywordflow">if</span> ( buconf%lbu_enable ) <span class="keywordflow">then</span></div>
<div class="line"><a name="l00899"></a><span class="lineno">  899</span>&#160;  <span class="keywordflow">if</span> ( buconf%lbudget_th ) &amp;</div>
<div class="line"><a name="l00900"></a><span class="lineno">  900</span>&#160;       <span class="keyword">call </span><a class="code" href="namespacemode__budget__phy.html#a9a2b3c894fd97b1caeef3dc8c7049411">budget_store_end_phy</a>(d, tbudgets(<a class="code" href="namespacemodd__budget.html#a0d120a8b4c8fb6af560c814c1d3c2c19">nbudget_th</a>), <span class="stringliteral">&#39;SEDI&#39;</span>, zths(:, :, :) * prhodj(:, :, :) )</div>
<div class="line"><a name="l00901"></a><span class="lineno">  901</span>&#160;  <span class="keywordflow">if</span> ( buconf%lbudget_rc .and. <a class="code" href="namespacemodd__param__lima.html#ab0c8298b017b75cbd419d8b1980b0053">nmom_c</a>.ge.1 .and. <a class="code" href="namespacemodd__param__lima.html#a06ed3012b0f8fd4872b87c1b4207600b">lsedc</a> ) &amp;</div>
<div class="line"><a name="l00902"></a><span class="lineno">  902</span>&#160;       <span class="keyword">call </span><a class="code" href="namespacemode__budget__phy.html#a9a2b3c894fd97b1caeef3dc8c7049411">budget_store_end_phy</a>(d, tbudgets(<a class="code" href="namespacemodd__budget.html#a685847647e25e21af43ab48da13b1797">nbudget_rc</a>), <span class="stringliteral">&#39;SEDI&#39;</span>, zrcs(:, :, :) * prhodj(:, :, :) )</div>
<div class="line"><a name="l00903"></a><span class="lineno">  903</span>&#160;  <span class="keywordflow">if</span> ( buconf%lbudget_rr .and. <a class="code" href="namespacemodd__param__lima.html#a7accc5c4a0a391c040a1de5e966eea04">nmom_r</a>.ge.1 ) &amp;</div>
<div class="line"><a name="l00904"></a><span class="lineno">  904</span>&#160;       <span class="keyword">call </span><a class="code" href="namespacemode__budget__phy.html#a9a2b3c894fd97b1caeef3dc8c7049411">budget_store_end_phy</a>(d, tbudgets(<a class="code" href="namespacemodd__budget.html#aac4cd9c30fac3b66cb3078dad55fb1e2">nbudget_rr</a>), <span class="stringliteral">&#39;SEDI&#39;</span>, zrrs(:, :, :) * prhodj(:, :, :) )</div>
<div class="line"><a name="l00905"></a><span class="lineno">  905</span>&#160;  <span class="keywordflow">if</span> ( buconf%lbudget_ri .and. <a class="code" href="namespacemodd__param__lima.html#ab11c5caa054b5039171a4f10908abea1">nmom_i</a>.ge.1 .and. <a class="code" href="namespacemodd__param__lima.html#a5ba3388c0be2ffe78c0b41f36f8002a9">lsedi</a> ) &amp;</div>
<div class="line"><a name="l00906"></a><span class="lineno">  906</span>&#160;       <span class="keyword">call </span><a class="code" href="namespacemode__budget__phy.html#a9a2b3c894fd97b1caeef3dc8c7049411">budget_store_end_phy</a>(d, tbudgets(<a class="code" href="namespacemodd__budget.html#a4ea4532bcfa769b5ed97e4d1e68a8113">nbudget_ri</a>), <span class="stringliteral">&#39;SEDI&#39;</span>, zris(:, :, :) * prhodj(:, :, :) )</div>
<div class="line"><a name="l00907"></a><span class="lineno">  907</span>&#160;  <span class="keywordflow">if</span> ( buconf%lbudget_rs .and. <a class="code" href="namespacemodd__param__lima.html#a63b4f80fe043e01602ef78b2caf0e487">nmom_s</a>.ge.1 ) &amp;</div>
<div class="line"><a name="l00908"></a><span class="lineno">  908</span>&#160;       <span class="keyword">call </span><a class="code" href="namespacemode__budget__phy.html#a9a2b3c894fd97b1caeef3dc8c7049411">budget_store_end_phy</a>(d, tbudgets(<a class="code" href="namespacemodd__budget.html#a4e4985c2c538a46dd511258704757086">nbudget_rs</a>), <span class="stringliteral">&#39;SEDI&#39;</span>, zrss(:, :, :) * prhodj(:, :, :) )</div>
<div class="line"><a name="l00909"></a><span class="lineno">  909</span>&#160;  <span class="keywordflow">if</span> ( buconf%lbudget_rg .and. <a class="code" href="namespacemodd__param__lima.html#acd76d6876dec7668fc081a4380690182">nmom_g</a>.ge.1 ) &amp;</div>
<div class="line"><a name="l00910"></a><span class="lineno">  910</span>&#160;       <span class="keyword">call </span><a class="code" href="namespacemode__budget__phy.html#a9a2b3c894fd97b1caeef3dc8c7049411">budget_store_end_phy</a>(d, tbudgets(<a class="code" href="namespacemodd__budget.html#aef76ce44ca163871fcb14427eae825a9">nbudget_rg</a>), <span class="stringliteral">&#39;SEDI&#39;</span>, zrgs(:, :, :) * prhodj(:, :, :) )</div>
<div class="line"><a name="l00911"></a><span class="lineno">  911</span>&#160;  <span class="keywordflow">if</span> ( buconf%lbudget_rh .and. <a class="code" href="namespacemodd__param__lima.html#a8a40a50a7778130438208e2974634384">nmom_h</a>.ge.1 ) &amp;</div>
<div class="line"><a name="l00912"></a><span class="lineno">  912</span>&#160;       <span class="keyword">call </span><a class="code" href="namespacemode__budget__phy.html#a9a2b3c894fd97b1caeef3dc8c7049411">budget_store_end_phy</a>(d, tbudgets(<a class="code" href="namespacemodd__budget.html#a07dc15edaf8cd68c1036451fc7b536b9">nbudget_rh</a>), <span class="stringliteral">&#39;SEDI&#39;</span>, zrhs(:, :, :) * prhodj(:, :, :) )</div>
<div class="line"><a name="l00913"></a><span class="lineno">  913</span>&#160;  <span class="keywordflow">if</span> ( buconf%lbudget_sv ) <span class="keywordflow">then</span></div>
<div class="line"><a name="l00914"></a><span class="lineno">  914</span>&#160;    <span class="keywordflow">if</span> ( <a class="code" href="namespacemodd__param__lima.html#a06ed3012b0f8fd4872b87c1b4207600b">lsedc</a> .and. <a class="code" href="namespacemodd__param__lima.html#ab0c8298b017b75cbd419d8b1980b0053">nmom_c</a>.ge.2 ) &amp;</div>
<div class="line"><a name="l00915"></a><span class="lineno">  915</span>&#160;      <span class="keyword">call </span><a class="code" href="namespacemode__budget__phy.html#a9a2b3c894fd97b1caeef3dc8c7049411">budget_store_end_phy</a>(d, tbudgets(<a class="code" href="namespacemodd__budget.html#aab05ad1db5848733632fdbcefeb4a0a0">nbudget_sv1</a> - 1 + <a class="code" href="namespacemodd__nsv.html#a40a6809489f33d2332c09e3cdf634f64">nsv_lima_nc</a>), <span class="stringliteral">&#39;SEDI&#39;</span>, zccs(:, :, :) * prhodj(:, :, :) )</div>
<div class="line"><a name="l00916"></a><span class="lineno">  916</span>&#160;    <span class="keywordflow">if</span> ( <a class="code" href="namespacemodd__param__lima.html#a7accc5c4a0a391c040a1de5e966eea04">nmom_r</a>.ge.2 ) &amp;</div>
<div class="line"><a name="l00917"></a><span class="lineno">  917</span>&#160;      <span class="keyword">call </span><a class="code" href="namespacemode__budget__phy.html#a9a2b3c894fd97b1caeef3dc8c7049411">budget_store_end_phy</a>(d, tbudgets(<a class="code" href="namespacemodd__budget.html#aab05ad1db5848733632fdbcefeb4a0a0">nbudget_sv1</a> - 1 + <a class="code" href="namespacemodd__nsv.html#a0f254b896adb763119f451ed055d2463">nsv_lima_nr</a>), <span class="stringliteral">&#39;SEDI&#39;</span>, zcrs(:, :, :) * prhodj(:, :, :) )</div>
<div class="line"><a name="l00918"></a><span class="lineno">  918</span>&#160;    <span class="keywordflow">if</span> ( <a class="code" href="namespacemodd__param__lima.html#a5ba3388c0be2ffe78c0b41f36f8002a9">lsedi</a> .and. <a class="code" href="namespacemodd__param__lima.html#ab11c5caa054b5039171a4f10908abea1">nmom_i</a>.ge.2 ) &amp;</div>
<div class="line"><a name="l00919"></a><span class="lineno">  919</span>&#160;      <span class="keyword">call </span><a class="code" href="namespacemode__budget__phy.html#a9a2b3c894fd97b1caeef3dc8c7049411">budget_store_end_phy</a>(d, tbudgets(<a class="code" href="namespacemodd__budget.html#aab05ad1db5848733632fdbcefeb4a0a0">nbudget_sv1</a> - 1 + <a class="code" href="namespacemodd__nsv.html#a42ef78d1d5be64b40c0969a07598e268">nsv_lima_ni</a>), <span class="stringliteral">&#39;SEDI&#39;</span>, zcis(:, :, :) * prhodj(:, :, :) )</div>
<div class="line"><a name="l00920"></a><span class="lineno">  920</span>&#160;    <span class="keywordflow">if</span> ( <a class="code" href="namespacemodd__param__lima.html#a63b4f80fe043e01602ef78b2caf0e487">nmom_s</a>.ge.2 ) &amp;</div>
<div class="line"><a name="l00921"></a><span class="lineno">  921</span>&#160;      <span class="keyword">call </span><a class="code" href="namespacemode__budget__phy.html#a9a2b3c894fd97b1caeef3dc8c7049411">budget_store_end_phy</a>(d, tbudgets(<a class="code" href="namespacemodd__budget.html#aab05ad1db5848733632fdbcefeb4a0a0">nbudget_sv1</a> - 1 + <a class="code" href="namespacemodd__nsv.html#a88f9a0bd54e36147cedeb35da2648aac">nsv_lima_ns</a>), <span class="stringliteral">&#39;SEDI&#39;</span>, zcss(:, :, :) * prhodj(:, :, :) )</div>
<div class="line"><a name="l00922"></a><span class="lineno">  922</span>&#160;    <span class="keywordflow">if</span> ( <a class="code" href="namespacemodd__param__lima.html#acd76d6876dec7668fc081a4380690182">nmom_g</a>.ge.2 ) &amp;</div>
<div class="line"><a name="l00923"></a><span class="lineno">  923</span>&#160;      <span class="keyword">call </span><a class="code" href="namespacemode__budget__phy.html#a9a2b3c894fd97b1caeef3dc8c7049411">budget_store_end_phy</a>(d, tbudgets(<a class="code" href="namespacemodd__budget.html#aab05ad1db5848733632fdbcefeb4a0a0">nbudget_sv1</a> - 1 + <a class="code" href="namespacemodd__nsv.html#a822424cae100267f4e55c551af04dae9">nsv_lima_ng</a>), <span class="stringliteral">&#39;SEDI&#39;</span>, zcgs(:, :, :) * prhodj(:, :, :) )</div>
<div class="line"><a name="l00924"></a><span class="lineno">  924</span>&#160;    <span class="keywordflow">if</span> ( <a class="code" href="namespacemodd__param__lima.html#a8a40a50a7778130438208e2974634384">nmom_h</a>.ge.2 ) &amp;</div>
<div class="line"><a name="l00925"></a><span class="lineno">  925</span>&#160;      <span class="keyword">call </span><a class="code" href="namespacemode__budget__phy.html#a9a2b3c894fd97b1caeef3dc8c7049411">budget_store_end_phy</a>(d, tbudgets(<a class="code" href="namespacemodd__budget.html#aab05ad1db5848733632fdbcefeb4a0a0">nbudget_sv1</a> - 1 + <a class="code" href="namespacemodd__nsv.html#aee0d9e88c097894c400536f6199a19c3">nsv_lima_nh</a>), <span class="stringliteral">&#39;SEDI&#39;</span>, zchs(:, :, :) * prhodj(:, :, :) )</div>
<div class="line"><a name="l00926"></a><span class="lineno">  926</span>&#160;<span class="comment">!</span></div>
<div class="line"><a name="l00927"></a><span class="lineno">  927</span>&#160;    <span class="keywordflow">if</span> (oelec) <span class="keywordflow">then</span></div>
<div class="line"><a name="l00928"></a><span class="lineno">  928</span>&#160;      <span class="keywordflow">if</span> ( <a class="code" href="namespacemodd__param__lima.html#a06ed3012b0f8fd4872b87c1b4207600b">lsedc</a> ) &amp;</div>
<div class="line"><a name="l00929"></a><span class="lineno">  929</span>&#160;        <span class="keyword">call </span><a class="code" href="namespacemode__budget__phy.html#a9a2b3c894fd97b1caeef3dc8c7049411">budget_store_end_phy</a>(d, tbudgets(<a class="code" href="namespacemodd__budget.html#aab05ad1db5848733632fdbcefeb4a0a0">nbudget_sv1</a> - 1 + <a class="code" href="namespacemodd__nsv.html#a864b10357f60be51dc3ecd1ffad90ccf">nsv_elecbeg</a> + 1), <span class="stringliteral">&#39;SEDI&#39;</span>, zqcs(:, :, :) * prhodj(:, :, :) )</div>
<div class="line"><a name="l00930"></a><span class="lineno">  930</span>&#160;      <span class="keyword">call </span><a class="code" href="namespacemode__budget__phy.html#a9a2b3c894fd97b1caeef3dc8c7049411">budget_store_end_phy</a>(d, tbudgets(<a class="code" href="namespacemodd__budget.html#aab05ad1db5848733632fdbcefeb4a0a0">nbudget_sv1</a> - 1 + <a class="code" href="namespacemodd__nsv.html#a864b10357f60be51dc3ecd1ffad90ccf">nsv_elecbeg</a> + 2), <span class="stringliteral">&#39;SEDI&#39;</span>, zqrs(:, :, :) * prhodj(:, :, :) )</div>
<div class="line"><a name="l00931"></a><span class="lineno">  931</span>&#160;      <span class="keywordflow">if</span> ( <a class="code" href="namespacemodd__param__lima.html#a5ba3388c0be2ffe78c0b41f36f8002a9">lsedi</a> ) &amp;</div>
<div class="line"><a name="l00932"></a><span class="lineno">  932</span>&#160;        <span class="keyword">call </span><a class="code" href="namespacemode__budget__phy.html#a9a2b3c894fd97b1caeef3dc8c7049411">budget_store_end_phy</a>(d, tbudgets(<a class="code" href="namespacemodd__budget.html#aab05ad1db5848733632fdbcefeb4a0a0">nbudget_sv1</a> - 1 + <a class="code" href="namespacemodd__nsv.html#a864b10357f60be51dc3ecd1ffad90ccf">nsv_elecbeg</a> + 3), <span class="stringliteral">&#39;SEDI&#39;</span>, zqis(:, :, :) * prhodj(:, :, :) )</div>
<div class="line"><a name="l00933"></a><span class="lineno">  933</span>&#160;      <span class="keyword">call </span><a class="code" href="namespacemode__budget__phy.html#a9a2b3c894fd97b1caeef3dc8c7049411">budget_store_end_phy</a>(d, tbudgets(<a class="code" href="namespacemodd__budget.html#aab05ad1db5848733632fdbcefeb4a0a0">nbudget_sv1</a> - 1 + <a class="code" href="namespacemodd__nsv.html#a864b10357f60be51dc3ecd1ffad90ccf">nsv_elecbeg</a> + 4), <span class="stringliteral">&#39;SEDI&#39;</span>, zqss(:, :, :) * prhodj(:, :, :) )</div>
<div class="line"><a name="l00934"></a><span class="lineno">  934</span>&#160;      <span class="keyword">call </span><a class="code" href="namespacemode__budget__phy.html#a9a2b3c894fd97b1caeef3dc8c7049411">budget_store_end_phy</a>(d, tbudgets(<a class="code" href="namespacemodd__budget.html#aab05ad1db5848733632fdbcefeb4a0a0">nbudget_sv1</a> - 1 + <a class="code" href="namespacemodd__nsv.html#a864b10357f60be51dc3ecd1ffad90ccf">nsv_elecbeg</a> + 5), <span class="stringliteral">&#39;SEDI&#39;</span>, zqgs(:, :, :) * prhodj(:, :, :) )</div>
<div class="line"><a name="l00935"></a><span class="lineno">  935</span>&#160;      <span class="keywordflow">if</span> (<a class="code" href="namespacemodd__param__lima.html#a8a40a50a7778130438208e2974634384">nmom_h</a> .ge. 1) &amp;</div>
<div class="line"><a name="l00936"></a><span class="lineno">  936</span>&#160;        <span class="keyword">call </span><a class="code" href="namespacemode__budget__phy.html#a9a2b3c894fd97b1caeef3dc8c7049411">budget_store_end_phy</a>(d, tbudgets(<a class="code" href="namespacemodd__budget.html#aab05ad1db5848733632fdbcefeb4a0a0">nbudget_sv1</a> - 1 + <a class="code" href="namespacemodd__nsv.html#a864b10357f60be51dc3ecd1ffad90ccf">nsv_elecbeg</a> + 6), <span class="stringliteral">&#39;SEDI&#39;</span>, zqhs(:, :, :) * prhodj(:, :, :) )</div>
<div class="line"><a name="l00937"></a><span class="lineno">  937</span>&#160;<span class="keywordflow">    end if</span></div>
<div class="line"><a name="l00938"></a><span class="lineno">  938</span>&#160;<span class="keywordflow">  end if</span></div>
<div class="line"><a name="l00939"></a><span class="lineno">  939</span>&#160;<span class="keywordflow">end if</span></div>
<div class="line"><a name="l00940"></a><span class="lineno">  940</span>&#160;<span class="comment">!</span></div>
<div class="line"><a name="l00941"></a><span class="lineno">  941</span>&#160;<span class="comment">! 1.bis Deposition at 1st level above ground</span></div>
<div class="line"><a name="l00942"></a><span class="lineno">  942</span>&#160;<span class="comment">!</span></div>
<div class="line"><a name="l00943"></a><span class="lineno">  943</span>&#160;<span class="keywordflow">IF</span> (<a class="code" href="namespacemodd__param__lima.html#ab0c8298b017b75cbd419d8b1980b0053">nmom_c</a>.GE.1 .AND. <a class="code" href="namespacemodd__param__lima.html#af6ffb8236514eaf51d5b82367c6dec79">ldepoc</a>) <span class="keywordflow">THEN</span></div>
<div class="line"><a name="l00944"></a><span class="lineno">  944</span>&#160;  <span class="keywordflow">if</span> ( buconf%lbudget_rc ) <span class="keyword">call </span><a class="code" href="namespacemode__budget__phy.html#a618f66dd5a60cc85cb7470daae98cc3e">budget_store_init_phy</a>(d, tbudgets(<a class="code" href="namespacemodd__budget.html#a685847647e25e21af43ab48da13b1797">nbudget_rc</a>), <span class="stringliteral">&#39;DEPO&#39;</span>, zrcs(:, :, :) * prhodj(:, :, :) )</div>
<div class="line"><a name="l00945"></a><span class="lineno">  945</span>&#160;  <span class="keywordflow">if</span> ( buconf%lbudget_sv .and. <a class="code" href="namespacemodd__param__lima.html#ab0c8298b017b75cbd419d8b1980b0053">nmom_c</a>.ge.2) &amp;</div>
<div class="line"><a name="l00946"></a><span class="lineno">  946</span>&#160;       <span class="keyword">call </span><a class="code" href="namespacemode__budget__phy.html#a618f66dd5a60cc85cb7470daae98cc3e">budget_store_init_phy</a>(d, tbudgets(<a class="code" href="namespacemodd__budget.html#aab05ad1db5848733632fdbcefeb4a0a0">nbudget_sv1</a> - 1 + <a class="code" href="namespacemodd__nsv.html#a40a6809489f33d2332c09e3cdf634f64">nsv_lima_nc</a>), <span class="stringliteral">&#39;DEPO&#39;</span>, zccs(:, :, :) * prhodj(:, :, :) )</div>
<div class="line"><a name="l00947"></a><span class="lineno">  947</span>&#160; </div>
<div class="line"><a name="l00948"></a><span class="lineno">  948</span>&#160;  pindep(:,:)=0.</div>
<div class="line"><a name="l00949"></a><span class="lineno">  949</span>&#160;  gdep(:,:) = .false.</div>
<div class="line"><a name="l00950"></a><span class="lineno">  950</span>&#160;  gdep(:,:) = zrcs(:,:,d%NKB) &gt;0 .AND. zccs(:,:,d%NKB) &gt;0 .AND. zrct(:,:,d%NKB) &gt;0 .AND. zcct(:,:,d%NKB) &gt;0</div>
<div class="line"><a name="l00951"></a><span class="lineno">  951</span>&#160;  <span class="keywordflow">WHERE</span> (gdep)</div>
<div class="line"><a name="l00952"></a><span class="lineno">  952</span>&#160;     zrcs(:,:,d%NKB) = zrcs(:,:,d%NKB) - <a class="code" href="namespacemodd__param__lima.html#a67bee94fe370e1412c94db0e58b0b06a">xvdepoc</a> * zrct(:,:,d%NKB) / pdzz(:,:,d%NKB)</div>
<div class="line"><a name="l00953"></a><span class="lineno">  953</span>&#160;     zccs(:,:,d%NKB) = zccs(:,:,d%NKB) - <a class="code" href="namespacemodd__param__lima.html#a67bee94fe370e1412c94db0e58b0b06a">xvdepoc</a> * zcct(:,:,d%NKB) / pdzz(:,:,d%NKB)</div>
<div class="line"><a name="l00954"></a><span class="lineno">  954</span>&#160;     pinprc(:,:) = pinprc(:,:) + <a class="code" href="namespacemodd__param__lima.html#a67bee94fe370e1412c94db0e58b0b06a">xvdepoc</a> * zrct(:,:,d%NKB) * prhodref(:,:,d%NKB) /cst%XRHOLW</div>
<div class="line"><a name="l00955"></a><span class="lineno">  955</span>&#160;     pindep(:,:) = <a class="code" href="namespacemodd__param__lima.html#a67bee94fe370e1412c94db0e58b0b06a">xvdepoc</a> * zrct(:,:,d%NKB) *  prhodref(:,:,d%NKB) /cst%XRHOLW</div>
<div class="line"><a name="l00956"></a><span class="lineno">  956</span>&#160;<span class="keywordflow">  END WHERE</span></div>
<div class="line"><a name="l00957"></a><span class="lineno">  957</span>&#160; </div>
<div class="line"><a name="l00958"></a><span class="lineno">  958</span>&#160;  <span class="keywordflow">if</span> ( buconf%lbudget_rc ) <span class="keyword">call </span><a class="code" href="namespacemode__budget__phy.html#a9a2b3c894fd97b1caeef3dc8c7049411">budget_store_end_phy</a>(d, tbudgets(<a class="code" href="namespacemodd__budget.html#a685847647e25e21af43ab48da13b1797">nbudget_rc</a>), <span class="stringliteral">&#39;DEPO&#39;</span>, zrcs(:, :, :) * prhodj(:, :, :) )</div>
<div class="line"><a name="l00959"></a><span class="lineno">  959</span>&#160;  <span class="keywordflow">if</span> ( buconf%lbudget_sv .and. <a class="code" href="namespacemodd__param__lima.html#ab0c8298b017b75cbd419d8b1980b0053">nmom_c</a>.ge.2) &amp;</div>
<div class="line"><a name="l00960"></a><span class="lineno">  960</span>&#160;       <span class="keyword">call </span><a class="code" href="namespacemode__budget__phy.html#a9a2b3c894fd97b1caeef3dc8c7049411">budget_store_end_phy</a>(d, tbudgets(<a class="code" href="namespacemodd__budget.html#aab05ad1db5848733632fdbcefeb4a0a0">nbudget_sv1</a> - 1 + <a class="code" href="namespacemodd__nsv.html#a40a6809489f33d2332c09e3cdf634f64">nsv_lima_nc</a>), <span class="stringliteral">&#39;DEPO&#39;</span>, zccs(:, :, :) * prhodj(:, :, :) )</div>
<div class="line"><a name="l00961"></a><span class="lineno">  961</span>&#160;<span class="keywordflow">END IF</span></div>
<div class="line"><a name="l00962"></a><span class="lineno">  962</span>&#160;<span class="comment">!</span></div>
<div class="line"><a name="l00963"></a><span class="lineno">  963</span>&#160;<span class="comment">!</span></div>
<div class="line"><a name="l00964"></a><span class="lineno">  964</span>&#160;<span class="comment">!!$Z_RR_CVRC(:,:,:) = 0.</span></div>
<div class="line"><a name="l00965"></a><span class="lineno">  965</span>&#160;<span class="comment">!!$Z_CR_CVRC(:,:,:) = 0.</span></div>
<div class="line"><a name="l00966"></a><span class="lineno">  966</span>&#160;<span class="comment">!!$IF (NMOM_R.GE.2) THEN</span></div>
<div class="line"><a name="l00967"></a><span class="lineno">  967</span>&#160;<span class="comment">!!$   if( BUCONF%lbu_enable ) then</span></div>
<div class="line"><a name="l00968"></a><span class="lineno">  968</span>&#160;<span class="comment">!!$    if ( BUCONF%lbudget_rc ) call BUDGET_STORE_INIT_PHY(D, TBUDGETS(NBUDGET_RC),                    &#39;R2C1&#39;, zrcs(:, :, :) * prhodj(:, :, :) )</span></div>
<div class="line"><a name="l00969"></a><span class="lineno">  969</span>&#160;<span class="comment">!!$    if ( BUCONF%lbudget_rr ) call BUDGET_STORE_INIT_PHY(D, TBUDGETS(NBUDGET_RR),                    &#39;R2C1&#39;, zrrs(:, :, :) * prhodj(:, :, :) )</span></div>
<div class="line"><a name="l00970"></a><span class="lineno">  970</span>&#160;<span class="comment">!!$    if ( BUCONF%lbudget_sv .and. nmom_c.ge.2) &amp;</span></div>
<div class="line"><a name="l00971"></a><span class="lineno">  971</span>&#160;<span class="comment">!!$         call BUDGET_STORE_INIT_PHY(D, TBUDGETS(NBUDGET_SV1 - 1 + nsv_lima_nc), &#39;R2C1&#39;, zccs(:, :, :) * prhodj(:, :, :) )</span></div>
<div class="line"><a name="l00972"></a><span class="lineno">  972</span>&#160;<span class="comment">!!$    if ( BUCONF%lbudget_sv .and. nmom_r.ge.2) &amp;</span></div>
<div class="line"><a name="l00973"></a><span class="lineno">  973</span>&#160;<span class="comment">!!$         call BUDGET_STORE_INIT_PHY(D, TBUDGETS(NBUDGET_SV1 - 1 + nsv_lima_nr), &#39;R2C1&#39;, zcrs(:, :, :) * prhodj(:, :, :) )</span></div>
<div class="line"><a name="l00974"></a><span class="lineno">  974</span>&#160;<span class="comment">!!$   end if</span></div>
<div class="line"><a name="l00975"></a><span class="lineno">  975</span>&#160;<span class="comment">!!$</span></div>
<div class="line"><a name="l00976"></a><span class="lineno">  976</span>&#160;<span class="comment">!!$   CALL LIMA_DROPS_TO_DROPLETS_CONV(PRHODREF, ZRCS*PTSTEP, ZRRS*PTSTEP, ZCCS*PTSTEP, ZCRS*PTSTEP, &amp;</span></div>
<div class="line"><a name="l00977"></a><span class="lineno">  977</span>&#160;<span class="comment">!!$                                    Z_RR_CVRC, Z_CR_CVRC)</span></div>
<div class="line"><a name="l00978"></a><span class="lineno">  978</span>&#160;<span class="comment">!!$   !</span></div>
<div class="line"><a name="l00979"></a><span class="lineno">  979</span>&#160;<span class="comment">!!$   ZRCS(:,:,:) = ZRCS(:,:,:) - Z_RR_CVRC(:,:,:)/PTSTEP</span></div>
<div class="line"><a name="l00980"></a><span class="lineno">  980</span>&#160;<span class="comment">!!$   ZRRS(:,:,:) = ZRRS(:,:,:) + Z_RR_CVRC(:,:,:)/PTSTEP</span></div>
<div class="line"><a name="l00981"></a><span class="lineno">  981</span>&#160;<span class="comment">!!$   ZCCS(:,:,:) = ZCCS(:,:,:) - Z_CR_CVRC(:,:,:)/PTSTEP</span></div>
<div class="line"><a name="l00982"></a><span class="lineno">  982</span>&#160;<span class="comment">!!$   ZCRS(:,:,:) = ZCRS(:,:,:) + Z_CR_CVRC(:,:,:)/PTSTEP</span></div>
<div class="line"><a name="l00983"></a><span class="lineno">  983</span>&#160;<span class="comment">!!$</span></div>
<div class="line"><a name="l00984"></a><span class="lineno">  984</span>&#160;<span class="comment">!!$   if( BUCONF%lbu_enable ) then</span></div>
<div class="line"><a name="l00985"></a><span class="lineno">  985</span>&#160;<span class="comment">!!$    if ( BUCONF%lbudget_rc ) call BUDGET_STORE_END_PHY(D, TBUDGETS(NBUDGET_RC),                    &#39;R2C1&#39;, zrcs(:, :, :) * prhodj(:, :, :) )</span></div>
<div class="line"><a name="l00986"></a><span class="lineno">  986</span>&#160;<span class="comment">!!$    if ( BUCONF%lbudget_rr ) call BUDGET_STORE_END_PHY(D, TBUDGETS(NBUDGET_RR),                    &#39;R2C1&#39;, zrrs(:, :, :) * prhodj(:, :, :) )</span></div>
<div class="line"><a name="l00987"></a><span class="lineno">  987</span>&#160;<span class="comment">!!$    if ( BUCONF%lbudget_sv .and. nmom_c.ge.2) &amp;</span></div>
<div class="line"><a name="l00988"></a><span class="lineno">  988</span>&#160;<span class="comment">!!$         call BUDGET_STORE_END_PHY(D, TBUDGETS(NBUDGET_SV1 - 1 + nsv_lima_nc), &#39;R2C1&#39;, zccs(:, :, :) * prhodj(:, :, :) )</span></div>
<div class="line"><a name="l00989"></a><span class="lineno">  989</span>&#160;<span class="comment">!!$    if ( BUCONF%lbudget_sv .and. nmom_r.ge.2) &amp;</span></div>
<div class="line"><a name="l00990"></a><span class="lineno">  990</span>&#160;<span class="comment">!!$         call BUDGET_STORE_END_PHY(D, TBUDGETS(NBUDGET_SV1 - 1 + nsv_lima_nr), &#39;R2C1&#39;, zcrs(:, :, :) * prhodj(:, :, :) )</span></div>
<div class="line"><a name="l00991"></a><span class="lineno">  991</span>&#160;<span class="comment">!!$   end if</span></div>
<div class="line"><a name="l00992"></a><span class="lineno">  992</span>&#160;<span class="comment">!!$END IF</span></div>
<div class="line"><a name="l00993"></a><span class="lineno">  993</span>&#160;<span class="comment">!</span></div>
<div class="line"><a name="l00994"></a><span class="lineno">  994</span>&#160;<span class="comment">! Update variables</span></div>
<div class="line"><a name="l00995"></a><span class="lineno">  995</span>&#160;<span class="comment">!</span></div>
<div class="line"><a name="l00996"></a><span class="lineno">  996</span>&#160;ztht(:,:,:) = zths(:,:,:) * ptstep</div>
<div class="line"><a name="l00997"></a><span class="lineno">  997</span>&#160;zt(:,:,:)   = ztht(:,:,:) * zexn(:,:,:)</div>
<div class="line"><a name="l00998"></a><span class="lineno">  998</span>&#160;<span class="comment">!</span></div>
<div class="line"><a name="l00999"></a><span class="lineno">  999</span>&#160;<span class="keywordflow">IF</span> ( krr .GE. 2 ) zrct(:,:,:) = zrcs(:,:,:) * ptstep</div>
<div class="line"><a name="l01000"></a><span class="lineno"> 1000</span>&#160;<span class="keywordflow">IF</span> ( krr .GE. 3 ) zrrt(:,:,:) = zrrs(:,:,:) * ptstep</div>
<div class="line"><a name="l01001"></a><span class="lineno"> 1001</span>&#160;<span class="keywordflow">IF</span> ( krr .GE. 4 ) zrit(:,:,:) = zris(:,:,:) * ptstep</div>
<div class="line"><a name="l01002"></a><span class="lineno"> 1002</span>&#160;<span class="keywordflow">IF</span> ( krr .GE. 5 ) zrst(:,:,:) = zrss(:,:,:) * ptstep</div>
<div class="line"><a name="l01003"></a><span class="lineno"> 1003</span>&#160;<span class="keywordflow">IF</span> ( krr .GE. 6 ) zrgt(:,:,:) = zrgs(:,:,:) * ptstep</div>
<div class="line"><a name="l01004"></a><span class="lineno"> 1004</span>&#160;<span class="keywordflow">IF</span> ( krr .GE. 7 ) zrht(:,:,:) = zrhs(:,:,:) * ptstep</div>
<div class="line"><a name="l01005"></a><span class="lineno"> 1005</span>&#160;<span class="comment">!</span></div>
<div class="line"><a name="l01006"></a><span class="lineno"> 1006</span>&#160;<span class="keywordflow">IF</span> ( <a class="code" href="namespacemodd__param__lima.html#ab0c8298b017b75cbd419d8b1980b0053">nmom_c</a>.GE.2 ) zcct(:,:,:) = zccs(:,:,:) * ptstep</div>
<div class="line"><a name="l01007"></a><span class="lineno"> 1007</span>&#160;<span class="keywordflow">IF</span> ( <a class="code" href="namespacemodd__param__lima.html#a7accc5c4a0a391c040a1de5e966eea04">nmom_r</a>.GE.2 ) zcrt(:,:,:) = zcrs(:,:,:) * ptstep</div>
<div class="line"><a name="l01008"></a><span class="lineno"> 1008</span>&#160;<span class="keywordflow">IF</span> ( <a class="code" href="namespacemodd__param__lima.html#ab11c5caa054b5039171a4f10908abea1">nmom_i</a>.GE.2 ) zcit(:,:,:) = zcis(:,:,:) * ptstep</div>
<div class="line"><a name="l01009"></a><span class="lineno"> 1009</span>&#160;<span class="keywordflow">IF</span> ( <a class="code" href="namespacemodd__param__lima.html#a63b4f80fe043e01602ef78b2caf0e487">nmom_s</a>.GE.2 ) zcst(:,:,:) = zcss(:,:,:) * ptstep</div>
<div class="line"><a name="l01010"></a><span class="lineno"> 1010</span>&#160;<span class="keywordflow">IF</span> ( <a class="code" href="namespacemodd__param__lima.html#acd76d6876dec7668fc081a4380690182">nmom_g</a>.GE.2 ) zcgt(:,:,:) = zcgs(:,:,:) * ptstep</div>
<div class="line"><a name="l01011"></a><span class="lineno"> 1011</span>&#160;<span class="keywordflow">IF</span> ( <a class="code" href="namespacemodd__param__lima.html#a8a40a50a7778130438208e2974634384">nmom_h</a>.GE.2 ) zcht(:,:,:) = zchs(:,:,:) * ptstep</div>
<div class="line"><a name="l01012"></a><span class="lineno"> 1012</span>&#160;<span class="comment">!</span></div>
<div class="line"><a name="l01013"></a><span class="lineno"> 1013</span>&#160;<span class="keywordflow">IF</span> (oelec) <span class="keywordflow">THEN</span></div>
<div class="line"><a name="l01014"></a><span class="lineno"> 1014</span>&#160;  zqct(:,:,:) = zqcs(:,:,:) * ptstep</div>
<div class="line"><a name="l01015"></a><span class="lineno"> 1015</span>&#160;  zqrt(:,:,:) = zqrs(:,:,:) * ptstep</div>
<div class="line"><a name="l01016"></a><span class="lineno"> 1016</span>&#160;  zqit(:,:,:) = zqis(:,:,:) * ptstep</div>
<div class="line"><a name="l01017"></a><span class="lineno"> 1017</span>&#160;  zqst(:,:,:) = zqss(:,:,:) * ptstep</div>
<div class="line"><a name="l01018"></a><span class="lineno"> 1018</span>&#160;  zqgt(:,:,:) = zqgs(:,:,:) * ptstep</div>
<div class="line"><a name="l01019"></a><span class="lineno"> 1019</span>&#160;  <span class="keywordflow">IF</span> (<a class="code" href="namespacemodd__param__lima.html#a8a40a50a7778130438208e2974634384">nmom_h</a> .GE. 1) zqht(:,:,:) = zqhs(:,:,:) * ptstep</div>
<div class="line"><a name="l01020"></a><span class="lineno"> 1020</span>&#160;<span class="keywordflow">END IF</span></div>
<div class="line"><a name="l01021"></a><span class="lineno"> 1021</span>&#160;<span class="comment">! </span></div>
<div class="line"><a name="l01022"></a><span class="lineno"> 1022</span>&#160;<span class="comment">!-------------------------------------------------------------------------------</span></div>
<div class="line"><a name="l01023"></a><span class="lineno"> 1023</span>&#160;<span class="comment">!</span></div>
<div class="line"><a name="l01024"></a><span class="lineno"> 1024</span>&#160;<span class="comment">!*       2.     Compute cloud, ice and precipitation fractions</span></div>
<div class="line"><a name="l01025"></a><span class="lineno"> 1025</span>&#160;<span class="comment">!               ----------------------------------------------</span></div>
<div class="line"><a name="l01026"></a><span class="lineno"> 1026</span>&#160;<span class="comment">!</span></div>
<div class="line"><a name="l01027"></a><span class="lineno"> 1027</span>&#160;<span class="keyword">CALL </span><a class="code" href="namespacemode__lima__compute__cloud__fractions.html#a9b4b0f198611ec0fcdb7ba57060bec04">lima_compute_cloud_fractions</a> (d,                                 &amp;</div>
<div class="line"><a name="l01028"></a><span class="lineno"> 1028</span>&#160;                                   zcct, zrct,                        &amp;</div>
<div class="line"><a name="l01029"></a><span class="lineno"> 1029</span>&#160;                                   zcrt, zrrt,                        &amp;</div>
<div class="line"><a name="l01030"></a><span class="lineno"> 1030</span>&#160;                                   zcit, zrit,                        &amp;</div>
<div class="line"><a name="l01031"></a><span class="lineno"> 1031</span>&#160;                                   zcst, zrst,                        &amp;</div>
<div class="line"><a name="l01032"></a><span class="lineno"> 1032</span>&#160;                                   zcgt, zrgt,                        &amp;</div>
<div class="line"><a name="l01033"></a><span class="lineno"> 1033</span>&#160;                                   zcht, zrht,                        &amp;</div>
<div class="line"><a name="l01034"></a><span class="lineno"> 1034</span>&#160;                                   pcldfr, picefr, pprcfr             )</div>
<div class="line"><a name="l01035"></a><span class="lineno"> 1035</span>&#160;<span class="comment">!</span></div>
<div class="line"><a name="l01036"></a><span class="lineno"> 1036</span>&#160;<span class="comment">!</span></div>
<div class="line"><a name="l01037"></a><span class="lineno"> 1037</span>&#160;<span class="comment">!-------------------------------------------------------------------------------</span></div>
<div class="line"><a name="l01038"></a><span class="lineno"> 1038</span>&#160;<span class="comment">!</span></div>
<div class="line"><a name="l01039"></a><span class="lineno"> 1039</span>&#160;<span class="comment">!*       2.     Nucleation processes</span></div>
<div class="line"><a name="l01040"></a><span class="lineno"> 1040</span>&#160;<span class="comment">!               --------------------</span></div>
<div class="line"><a name="l01041"></a><span class="lineno"> 1041</span>&#160;<span class="comment">!</span></div>
<div class="line"><a name="l01042"></a><span class="lineno"> 1042</span>&#160;<span class="keyword">CALL </span><a class="code" href="namespacemode__lima__nucleation__procs.html#a5b69aa75f91239168e58d5081abd4d7e">lima_nucleation_procs</a> (d, cst, buconf, tbudgets, kbudgets,                 &amp;</div>
<div class="line"><a name="l01043"></a><span class="lineno"> 1043</span>&#160;                            ptstep, prhodj,                                     &amp;</div>
<div class="line"><a name="l01044"></a><span class="lineno"> 1044</span>&#160;                            prhodref, zexn, ppabst, zt, pdthrad, pw_nu,         &amp;</div>
<div class="line"><a name="l01045"></a><span class="lineno"> 1045</span>&#160;                            ztht, zrvt, zrct, zrrt, zrit, zrst, zrgt, zrht,     &amp;</div>
<div class="line"><a name="l01046"></a><span class="lineno"> 1046</span>&#160;                            zcct, zcrt, zcit,                                   &amp;</div>
<div class="line"><a name="l01047"></a><span class="lineno"> 1047</span>&#160;                            zccnft, zccnat, zifnft, zifnnt, zimmnt, zhomft,     &amp;</div>
<div class="line"><a name="l01048"></a><span class="lineno"> 1048</span>&#160;                            pcldfr, picefr, pprcfr,                             &amp;</div>
<div class="line"><a name="l01049"></a><span class="lineno"> 1049</span>&#160;                            ztot_rv_henu, ztot_rc_hinc, ztot_ri_hind, ztot_rv_honh)</div>
<div class="line"><a name="l01050"></a><span class="lineno"> 1050</span>&#160;<span class="comment">!</span></div>
<div class="line"><a name="l01051"></a><span class="lineno"> 1051</span>&#160;<span class="comment">! Saving sources before microphysics time-splitting loop</span></div>
<div class="line"><a name="l01052"></a><span class="lineno"> 1052</span>&#160;<span class="comment">!</span></div>
<div class="line"><a name="l01053"></a><span class="lineno"> 1053</span>&#160;zrvs(:,:,:) = zrvt(:,:,:) *zinv_tstep</div>
<div class="line"><a name="l01054"></a><span class="lineno"> 1054</span>&#160;zrcs(:,:,:) = zrct(:,:,:) *zinv_tstep</div>
<div class="line"><a name="l01055"></a><span class="lineno"> 1055</span>&#160;zrrs(:,:,:) = zrrt(:,:,:) *zinv_tstep</div>
<div class="line"><a name="l01056"></a><span class="lineno"> 1056</span>&#160;zris(:,:,:) = zrit(:,:,:) *zinv_tstep</div>
<div class="line"><a name="l01057"></a><span class="lineno"> 1057</span>&#160;zrss(:,:,:) = zrst(:,:,:) *zinv_tstep</div>
<div class="line"><a name="l01058"></a><span class="lineno"> 1058</span>&#160;zrgs(:,:,:) = zrgt(:,:,:) *zinv_tstep</div>
<div class="line"><a name="l01059"></a><span class="lineno"> 1059</span>&#160;zrhs(:,:,:) = zrht(:,:,:) *zinv_tstep</div>
<div class="line"><a name="l01060"></a><span class="lineno"> 1060</span>&#160;<span class="comment">!</span></div>
<div class="line"><a name="l01061"></a><span class="lineno"> 1061</span>&#160;<span class="keywordflow">IF</span> (<a class="code" href="namespacemodd__param__lima.html#ab0c8298b017b75cbd419d8b1980b0053">nmom_c</a>.GE.2) zccs(:,:,:) = zcct(:,:,:) *zinv_tstep</div>
<div class="line"><a name="l01062"></a><span class="lineno"> 1062</span>&#160;<span class="keywordflow">IF</span> (<a class="code" href="namespacemodd__param__lima.html#a7accc5c4a0a391c040a1de5e966eea04">nmom_r</a>.GE.2) zcrs(:,:,:) = zcrt(:,:,:) *zinv_tstep</div>
<div class="line"><a name="l01063"></a><span class="lineno"> 1063</span>&#160;<span class="keywordflow">IF</span> (<a class="code" href="namespacemodd__param__lima.html#ab11c5caa054b5039171a4f10908abea1">nmom_i</a>.GE.2) zcis(:,:,:) = zcit(:,:,:) *zinv_tstep</div>
<div class="line"><a name="l01064"></a><span class="lineno"> 1064</span>&#160;<span class="keywordflow">IF</span> (<a class="code" href="namespacemodd__param__lima.html#a63b4f80fe043e01602ef78b2caf0e487">nmom_s</a>.GE.2) zcss(:,:,:) = zcst(:,:,:) *zinv_tstep</div>
<div class="line"><a name="l01065"></a><span class="lineno"> 1065</span>&#160;<span class="keywordflow">IF</span> (<a class="code" href="namespacemodd__param__lima.html#acd76d6876dec7668fc081a4380690182">nmom_g</a>.GE.2) zcgs(:,:,:) = zcgt(:,:,:) *zinv_tstep</div>
<div class="line"><a name="l01066"></a><span class="lineno"> 1066</span>&#160;<span class="keywordflow">IF</span> (<a class="code" href="namespacemodd__param__lima.html#a8a40a50a7778130438208e2974634384">nmom_h</a>.GE.2) zchs(:,:,:) = zcht(:,:,:) *zinv_tstep</div>
<div class="line"><a name="l01067"></a><span class="lineno"> 1067</span>&#160;<span class="comment">!</span></div>
<div class="line"><a name="l01068"></a><span class="lineno"> 1068</span>&#160;zccnfs(:,:,:,:) = zccnft(:,:,:,:) *zinv_tstep</div>
<div class="line"><a name="l01069"></a><span class="lineno"> 1069</span>&#160;zccnas(:,:,:,:) = zccnat(:,:,:,:) *zinv_tstep</div>
<div class="line"><a name="l01070"></a><span class="lineno"> 1070</span>&#160;zifnfs(:,:,:,:) = zifnft(:,:,:,:) *zinv_tstep</div>
<div class="line"><a name="l01071"></a><span class="lineno"> 1071</span>&#160;zifnns(:,:,:,:) = zifnnt(:,:,:,:) *zinv_tstep</div>
<div class="line"><a name="l01072"></a><span class="lineno"> 1072</span>&#160;zimmns(:,:,:,:) = zimmnt(:,:,:,:) *zinv_tstep</div>
<div class="line"><a name="l01073"></a><span class="lineno"> 1073</span>&#160;zhomfs(:,:,:)   = zhomft(:,:,:)   *zinv_tstep</div>
<div class="line"><a name="l01074"></a><span class="lineno"> 1074</span>&#160;<span class="comment">!</span></div>
<div class="line"><a name="l01075"></a><span class="lineno"> 1075</span>&#160;zths(:,:,:) = ztht(:,:,:) *zinv_tstep</div>
<div class="line"><a name="l01076"></a><span class="lineno"> 1076</span>&#160;zt(:,:,:)   = ztht(:,:,:) * zexn(:,:,:)</div>
<div class="line"><a name="l01077"></a><span class="lineno"> 1077</span>&#160;<span class="comment">!</span></div>
<div class="line"><a name="l01078"></a><span class="lineno"> 1078</span>&#160;<span class="keywordflow">IF</span> (oelec) <span class="keywordflow">THEN</span></div>
<div class="line"><a name="l01079"></a><span class="lineno"> 1079</span>&#160;  zrvt_elec(:,:,:) = zrvt(:,:,:)</div>
<div class="line"><a name="l01080"></a><span class="lineno"> 1080</span>&#160;  zrct_elec(:,:,:) = zrct(:,:,:)</div>
<div class="line"><a name="l01081"></a><span class="lineno"> 1081</span>&#160;  zrrt_elec(:,:,:) = zrrt(:,:,:)</div>
<div class="line"><a name="l01082"></a><span class="lineno"> 1082</span>&#160;  zrit_elec(:,:,:) = zrit(:,:,:)</div>
<div class="line"><a name="l01083"></a><span class="lineno"> 1083</span>&#160;  zrst_elec(:,:,:) = zrst(:,:,:)</div>
<div class="line"><a name="l01084"></a><span class="lineno"> 1084</span>&#160;  zrgt_elec(:,:,:) = zrgt(:,:,:)</div>
<div class="line"><a name="l01085"></a><span class="lineno"> 1085</span>&#160;  <span class="keywordflow">IF</span> (<a class="code" href="namespacemodd__param__lima.html#a8a40a50a7778130438208e2974634384">nmom_h</a> .GE. 1) zrht_elec(:,:,:) = zrht(:,:,:)</div>
<div class="line"><a name="l01086"></a><span class="lineno"> 1086</span>&#160;  <span class="keywordflow">IF</span> (<a class="code" href="namespacemodd__param__lima.html#ab0c8298b017b75cbd419d8b1980b0053">nmom_c</a> .GE. 2) zcct_elec(:,:,:) = zcct(:,:,:)</div>
<div class="line"><a name="l01087"></a><span class="lineno"> 1087</span>&#160;  <span class="keywordflow">IF</span> (<a class="code" href="namespacemodd__param__lima.html#a7accc5c4a0a391c040a1de5e966eea04">nmom_r</a> .GE. 2) zcrt_elec(:,:,:) = zcrt(:,:,:)</div>
<div class="line"><a name="l01088"></a><span class="lineno"> 1088</span>&#160;  <span class="keywordflow">IF</span> (<a class="code" href="namespacemodd__param__lima.html#ab11c5caa054b5039171a4f10908abea1">nmom_i</a> .GE. 2) zcit_elec(:,:,:) = zcit(:,:,:)</div>
<div class="line"><a name="l01089"></a><span class="lineno"> 1089</span>&#160;  <span class="keywordflow">IF</span> (<a class="code" href="namespacemodd__param__lima.html#a63b4f80fe043e01602ef78b2caf0e487">nmom_s</a> .GE. 2) zcst_elec(:,:,:) = zcst(:,:,:)</div>
<div class="line"><a name="l01090"></a><span class="lineno"> 1090</span>&#160;  <span class="keywordflow">IF</span> (<a class="code" href="namespacemodd__param__lima.html#acd76d6876dec7668fc081a4380690182">nmom_g</a> .GE. 2) zcgt_elec(:,:,:) = zcgt(:,:,:)</div>
<div class="line"><a name="l01091"></a><span class="lineno"> 1091</span>&#160;  <span class="keywordflow">IF</span> (<a class="code" href="namespacemodd__param__lima.html#a8a40a50a7778130438208e2974634384">nmom_h</a> .GE. 2) zcht_elec(:,:,:) = zcht(:,:,:)</div>
<div class="line"><a name="l01092"></a><span class="lineno"> 1092</span>&#160;<span class="keywordflow">END IF</span></div>
<div class="line"><a name="l01093"></a><span class="lineno"> 1093</span>&#160;<span class="comment">!</span></div>
<div class="line"><a name="l01094"></a><span class="lineno"> 1094</span>&#160;<span class="comment">!-------------------------------------------------------------------------------</span></div>
<div class="line"><a name="l01095"></a><span class="lineno"> 1095</span>&#160;<span class="comment">!</span></div>
<div class="line"><a name="l01096"></a><span class="lineno"> 1096</span>&#160;<span class="comment">!*       2.     LOOP</span></div>
<div class="line"><a name="l01097"></a><span class="lineno"> 1097</span>&#160;<span class="comment">!               ----</span></div>
<div class="line"><a name="l01098"></a><span class="lineno"> 1098</span>&#160;<span class="comment">!</span></div>
<div class="line"><a name="l01099"></a><span class="lineno"> 1099</span>&#160;<span class="comment">!</span></div>
<div class="line"><a name="l01100"></a><span class="lineno"> 1100</span>&#160;<span class="comment">! Maximum number of iterations</span></div>
<div class="line"><a name="l01101"></a><span class="lineno"> 1101</span>&#160;inb_iter_max=<a class="code" href="namespacemodd__param__lima.html#a95606fe7b31187a9c1e64d68309835b9">nmaxiter</a></div>
<div class="line"><a name="l01102"></a><span class="lineno"> 1102</span>&#160;<span class="keywordflow">IF</span>(<a class="code" href="namespacemodd__param__lima.html#aaad997be2c66fe3610699ba4c79f46f4">xtstep_ts</a>/=0.)<span class="keywordflow">THEN</span></div>
<div class="line"><a name="l01103"></a><span class="lineno"> 1103</span>&#160;  inb_iter_max=max(1, int(ptstep/<a class="code" href="namespacemodd__param__lima.html#aaad997be2c66fe3610699ba4c79f46f4">xtstep_ts</a>)) <span class="comment">!At least the number of iterations needed for the time-splitting</span></div>
<div class="line"><a name="l01104"></a><span class="lineno"> 1104</span>&#160;  ztstep=ptstep/inb_iter_max</div>
<div class="line"><a name="l01105"></a><span class="lineno"> 1105</span>&#160;  inb_iter_max=max(<a class="code" href="namespacemodd__param__lima.html#a95606fe7b31187a9c1e64d68309835b9">nmaxiter</a>, inb_iter_max) <span class="comment">!Fot the case XMRSTEP/=0. at the same time</span></div>
<div class="line"><a name="l01106"></a><span class="lineno"> 1106</span>&#160;<span class="keywordflow">ENDIF</span></div>
<div class="line"><a name="l01107"></a><span class="lineno"> 1107</span>&#160;iiter(:,:,:)=0</div>
<div class="line"><a name="l01108"></a><span class="lineno"> 1108</span>&#160;ztime(:,:,:)=0. <span class="comment">! Current integration time (all points may have a different integration time)</span></div>
<div class="line"><a name="l01109"></a><span class="lineno"> 1109</span>&#160;<span class="comment">!</span></div>
<div class="line"><a name="l01110"></a><span class="lineno"> 1110</span>&#160;<span class="comment">! Begin the huge time splitting loop</span></div>
<div class="line"><a name="l01111"></a><span class="lineno"> 1111</span>&#160;<span class="comment">!</span></div>
<div class="line"><a name="l01112"></a><span class="lineno"> 1112</span>&#160;zrt_sum(:,:,:) = zrct(:,:,:) + zrrt(:,:,:) + zrit(:,:,:) + zrst(:,:,:) + zrgt(:,:,:) + zrht(:,:,:)</div>
<div class="line"><a name="l01113"></a><span class="lineno"> 1113</span>&#160;<span class="keywordflow">WHERE</span> (zrt_sum(:,:,:)&lt;<a class="code" href="namespacemodd__param__lima.html#aefc493a9b25fa3023153181d64911a68">xrtmin</a>(2)) ztime(:,:,:)=ptstep <span class="comment">! no need to treat hydrometeor-free point</span></div>
<div class="line"><a name="l01114"></a><span class="lineno"> 1114</span>&#160;<span class="comment">!</span></div>
<div class="line"><a name="l01115"></a><span class="lineno"> 1115</span>&#160;<span class="keywordflow">DO</span> <span class="keywordflow">WHILE</span>(any(ztime(d%NIB:d%NIE,d%NJB:d%NJE,d%NKTB:d%NKTE)&lt;ptstep))</div>
<div class="line"><a name="l01116"></a><span class="lineno"> 1116</span>&#160;   <span class="comment">!</span></div>
<div class="line"><a name="l01117"></a><span class="lineno"> 1117</span>&#160;   <span class="keywordflow">IF</span>(<a class="code" href="namespacemodd__param__lima.html#ac8bffc7c7ac478bc8ec56c0d66c22ca6">xmrstep</a>/=0.) <span class="keywordflow">THEN</span></div>
<div class="line"><a name="l01118"></a><span class="lineno"> 1118</span>&#160;      <span class="comment">! In this case we need to remember the mixing ratios used to compute the tendencies</span></div>
<div class="line"><a name="l01119"></a><span class="lineno"> 1119</span>&#160;      <span class="comment">! because when mixing ratio has evolved more than a threshold, we must re-compute tendecies</span></div>
<div class="line"><a name="l01120"></a><span class="lineno"> 1120</span>&#160;      z0rvt(:,:,:)=zrvt(:,:,:)</div>
<div class="line"><a name="l01121"></a><span class="lineno"> 1121</span>&#160;      z0rct(:,:,:)=zrct(:,:,:)</div>
<div class="line"><a name="l01122"></a><span class="lineno"> 1122</span>&#160;      z0rrt(:,:,:)=zrrt(:,:,:)</div>
<div class="line"><a name="l01123"></a><span class="lineno"> 1123</span>&#160;      z0rit(:,:,:)=zrit(:,:,:)</div>
<div class="line"><a name="l01124"></a><span class="lineno"> 1124</span>&#160;      z0rst(:,:,:)=zrst(:,:,:)</div>
<div class="line"><a name="l01125"></a><span class="lineno"> 1125</span>&#160;      z0rgt(:,:,:)=zrgt(:,:,:)</div>
<div class="line"><a name="l01126"></a><span class="lineno"> 1126</span>&#160;      z0rht(:,:,:)=zrht(:,:,:)</div>
<div class="line"><a name="l01127"></a><span class="lineno"> 1127</span>&#160;<span class="keywordflow">   ENDIF</span></div>
<div class="line"><a name="l01128"></a><span class="lineno"> 1128</span>&#160;   <span class="comment">!</span></div>
<div class="line"><a name="l01129"></a><span class="lineno"> 1129</span>&#160;   <span class="keywordflow">IF</span>(<a class="code" href="namespacemodd__param__lima.html#aaad997be2c66fe3610699ba4c79f46f4">xtstep_ts</a>/=0.) <span class="keywordflow">THEN</span></div>
<div class="line"><a name="l01130"></a><span class="lineno"> 1130</span>&#160;      <span class="comment">! In this case we need to remember the time when tendencies were computed</span></div>
<div class="line"><a name="l01131"></a><span class="lineno"> 1131</span>&#160;      <span class="comment">! because when time has evolved more than a limit, we must re-compute tendecies</span></div>
<div class="line"><a name="l01132"></a><span class="lineno"> 1132</span>&#160;      ztime_lastcall(:,:,:)=ztime(:,:,:)</div>
<div class="line"><a name="l01133"></a><span class="lineno"> 1133</span>&#160;<span class="keywordflow">   ENDIF</span></div>
<div class="line"><a name="l01134"></a><span class="lineno"> 1134</span>&#160;   <span class="comment">!</span></div>
<div class="line"><a name="l01135"></a><span class="lineno"> 1135</span>&#160;   llcompute(:,:,:)=.false.</div>
<div class="line"><a name="l01136"></a><span class="lineno"> 1136</span>&#160;   llcompute(d%NIB:d%NIE,d%NJB:d%NJE,d%NKTB:d%NKTE) = ztime(d%NIB:d%NIE,d%NJB:d%NJE,d%NKTB:d%NKTE)&lt;ptstep <span class="comment">! Compuation only for points for which integration time has not reached the timestep</span></div>
<div class="line"><a name="l01137"></a><span class="lineno"> 1137</span>&#160;   <span class="keywordflow">WHERE</span>(llcompute(:,:,:))</div>
<div class="line"><a name="l01138"></a><span class="lineno"> 1138</span>&#160;      iiter(:,:,:)=iiter(:,:,:)+1</div>
<div class="line"><a name="l01139"></a><span class="lineno"> 1139</span>&#160;<span class="keywordflow">   END WHERE</span></div>
<div class="line"><a name="l01140"></a><span class="lineno"> 1140</span>&#160;   <span class="comment">! </span></div>
<div class="line"><a name="l01141"></a><span class="lineno"> 1141</span>&#160;   <span class="keywordflow">DO</span> <span class="keywordflow">WHILE</span>(any(llcompute(:,:,:))) <span class="comment">! Loop to adjust tendencies when we cross the 0°C or when a species disappears</span></div>
<div class="line"><a name="l01142"></a><span class="lineno"> 1142</span>&#160; </div>
<div class="line"><a name="l01143"></a><span class="lineno"> 1143</span>&#160;      <span class="comment">!</span></div>
<div class="line"><a name="l01144"></a><span class="lineno"> 1144</span>&#160;      <span class="comment">! Packing variables to run computations only where necessary</span></div>
<div class="line"><a name="l01145"></a><span class="lineno"> 1145</span>&#160;      <span class="comment">!</span></div>
<div class="line"><a name="l01146"></a><span class="lineno"> 1146</span>&#160;      ipack = count(llcompute)</div>
<div class="line"><a name="l01147"></a><span class="lineno"> 1147</span>&#160;      <span class="keyword">ALLOCATE</span>(i1(ipack))</div>
<div class="line"><a name="l01148"></a><span class="lineno"> 1148</span>&#160;      <span class="keyword">ALLOCATE</span>(i2(ipack))</div>
<div class="line"><a name="l01149"></a><span class="lineno"> 1149</span>&#160;      <span class="keyword">ALLOCATE</span>(i3(ipack))</div>
<div class="line"><a name="l01150"></a><span class="lineno"> 1150</span>&#160;      <span class="keyword">ALLOCATE</span>(zrhodref1d(ipack))</div>
<div class="line"><a name="l01151"></a><span class="lineno"> 1151</span>&#160;      <span class="keyword">ALLOCATE</span>(zexnref1d(ipack))</div>
<div class="line"><a name="l01152"></a><span class="lineno"> 1152</span>&#160;      <span class="keyword">ALLOCATE</span>(zexn1d(ipack))</div>
<div class="line"><a name="l01153"></a><span class="lineno"> 1153</span>&#160;      <span class="keyword">ALLOCATE</span>(zp1d(ipack))     </div>
<div class="line"><a name="l01154"></a><span class="lineno"> 1154</span>&#160;      <span class="keyword">ALLOCATE</span>(ztht1d(ipack))</div>
<div class="line"><a name="l01155"></a><span class="lineno"> 1155</span>&#160;      <span class="keyword">ALLOCATE</span>(zrvt1d(ipack))</div>
<div class="line"><a name="l01156"></a><span class="lineno"> 1156</span>&#160;      <span class="keyword">ALLOCATE</span>(zrct1d(ipack))</div>
<div class="line"><a name="l01157"></a><span class="lineno"> 1157</span>&#160;      <span class="keyword">ALLOCATE</span>(zrrt1d(ipack))</div>
<div class="line"><a name="l01158"></a><span class="lineno"> 1158</span>&#160;      <span class="keyword">ALLOCATE</span>(zrit1d(ipack))</div>
<div class="line"><a name="l01159"></a><span class="lineno"> 1159</span>&#160;      <span class="keyword">ALLOCATE</span>(zrst1d(ipack))</div>
<div class="line"><a name="l01160"></a><span class="lineno"> 1160</span>&#160;      <span class="keyword">ALLOCATE</span>(zrgt1d(ipack))</div>
<div class="line"><a name="l01161"></a><span class="lineno"> 1161</span>&#160;      <span class="keyword">ALLOCATE</span>(zrht1d(ipack))</div>
<div class="line"><a name="l01162"></a><span class="lineno"> 1162</span>&#160;      <span class="keyword">ALLOCATE</span>(zcct1d(ipack))</div>
<div class="line"><a name="l01163"></a><span class="lineno"> 1163</span>&#160;      <span class="keyword">ALLOCATE</span>(zcrt1d(ipack))</div>
<div class="line"><a name="l01164"></a><span class="lineno"> 1164</span>&#160;      <span class="keyword">ALLOCATE</span>(zcit1d(ipack))</div>
<div class="line"><a name="l01165"></a><span class="lineno"> 1165</span>&#160;      <span class="keyword">ALLOCATE</span>(zcst1d(ipack))</div>
<div class="line"><a name="l01166"></a><span class="lineno"> 1166</span>&#160;      <span class="keyword">ALLOCATE</span>(zcgt1d(ipack))</div>
<div class="line"><a name="l01167"></a><span class="lineno"> 1167</span>&#160;      <span class="keyword">ALLOCATE</span>(zcht1d(ipack))</div>
<div class="line"><a name="l01168"></a><span class="lineno"> 1168</span>&#160;      <span class="keyword">ALLOCATE</span>(zifnn1d(ipack,<a class="code" href="namespacemodd__param__lima.html#a2b98a3f23053acfd971d523a0778f209">nmod_ifn</a>))</div>
<div class="line"><a name="l01169"></a><span class="lineno"> 1169</span>&#160;      <span class="keyword">ALLOCATE</span>(zevap1d(ipack))</div>
<div class="line"><a name="l01170"></a><span class="lineno"> 1170</span>&#160;      <span class="keyword">ALLOCATE</span>(ztime1d(ipack))</div>
<div class="line"><a name="l01171"></a><span class="lineno"> 1171</span>&#160;      <span class="keyword">ALLOCATE</span>(llcompute1d(ipack))</div>
<div class="line"><a name="l01172"></a><span class="lineno"> 1172</span>&#160;      <span class="keyword">ALLOCATE</span>(iiter1d(ipack))</div>
<div class="line"><a name="l01173"></a><span class="lineno"> 1173</span>&#160;      <span class="keyword">ALLOCATE</span>(ztime_lastcall1d(ipack))</div>
<div class="line"><a name="l01174"></a><span class="lineno"> 1174</span>&#160;      <span class="keyword">ALLOCATE</span>(z0rvt1d(ipack))</div>
<div class="line"><a name="l01175"></a><span class="lineno"> 1175</span>&#160;      <span class="keyword">ALLOCATE</span>(z0rct1d(ipack))</div>
<div class="line"><a name="l01176"></a><span class="lineno"> 1176</span>&#160;      <span class="keyword">ALLOCATE</span>(z0rrt1d(ipack))</div>
<div class="line"><a name="l01177"></a><span class="lineno"> 1177</span>&#160;      <span class="keyword">ALLOCATE</span>(z0rit1d(ipack))</div>
<div class="line"><a name="l01178"></a><span class="lineno"> 1178</span>&#160;      <span class="keyword">ALLOCATE</span>(z0rst1d(ipack))</div>
<div class="line"><a name="l01179"></a><span class="lineno"> 1179</span>&#160;      <span class="keyword">ALLOCATE</span>(z0rgt1d(ipack))</div>
<div class="line"><a name="l01180"></a><span class="lineno"> 1180</span>&#160;      <span class="keyword">ALLOCATE</span>(z0rht1d(ipack))</div>
<div class="line"><a name="l01181"></a><span class="lineno"> 1181</span>&#160;      <span class="keyword">ALLOCATE</span>(zcf1d(ipack))</div>
<div class="line"><a name="l01182"></a><span class="lineno"> 1182</span>&#160;      <span class="keyword">ALLOCATE</span>(zif1d(ipack))</div>
<div class="line"><a name="l01183"></a><span class="lineno"> 1183</span>&#160;      <span class="keyword">ALLOCATE</span>(zpf1d(ipack))</div>
<div class="line"><a name="l01184"></a><span class="lineno"> 1184</span>&#160;      <span class="keyword">ALLOCATE</span>(zlatham_iaggs(ipack))</div>
<div class="line"><a name="l01185"></a><span class="lineno"> 1185</span>&#160;      ipack = countjv(llcompute,i1,i2,i3)</div>
<div class="line"><a name="l01186"></a><span class="lineno"> 1186</span>&#160;      <span class="keywordflow">DO</span> ii=1,ipack</div>
<div class="line"><a name="l01187"></a><span class="lineno"> 1187</span>&#160;         zrhodref1d(ii)       = prhodref(i1(ii),i2(ii),i3(ii))</div>
<div class="line"><a name="l01188"></a><span class="lineno"> 1188</span>&#160;         zexnref1d(ii)        = pexnref(i1(ii),i2(ii),i3(ii))</div>
<div class="line"><a name="l01189"></a><span class="lineno"> 1189</span>&#160;         zexn1d(ii)           = zexn(i1(ii),i2(ii),i3(ii))</div>
<div class="line"><a name="l01190"></a><span class="lineno"> 1190</span>&#160;         zp1d(ii)             = ppabst(i1(ii),i2(ii),i3(ii))</div>
<div class="line"><a name="l01191"></a><span class="lineno"> 1191</span>&#160;         ztht1d(ii)           = ztht(i1(ii),i2(ii),i3(ii))</div>
<div class="line"><a name="l01192"></a><span class="lineno"> 1192</span>&#160;         zrvt1d(ii)           = zrvt(i1(ii),i2(ii),i3(ii))</div>
<div class="line"><a name="l01193"></a><span class="lineno"> 1193</span>&#160;         zrct1d(ii)           = zrct(i1(ii),i2(ii),i3(ii))</div>
<div class="line"><a name="l01194"></a><span class="lineno"> 1194</span>&#160;         zrrt1d(ii)           = zrrt(i1(ii),i2(ii),i3(ii))</div>
<div class="line"><a name="l01195"></a><span class="lineno"> 1195</span>&#160;         zrit1d(ii)           = zrit(i1(ii),i2(ii),i3(ii))</div>
<div class="line"><a name="l01196"></a><span class="lineno"> 1196</span>&#160;         zrst1d(ii)           = zrst(i1(ii),i2(ii),i3(ii))</div>
<div class="line"><a name="l01197"></a><span class="lineno"> 1197</span>&#160;         zrgt1d(ii)           = zrgt(i1(ii),i2(ii),i3(ii))</div>
<div class="line"><a name="l01198"></a><span class="lineno"> 1198</span>&#160;         zrht1d(ii)           = zrht(i1(ii),i2(ii),i3(ii))</div>
<div class="line"><a name="l01199"></a><span class="lineno"> 1199</span>&#160;         zcct1d(ii)           = zcct(i1(ii),i2(ii),i3(ii))</div>
<div class="line"><a name="l01200"></a><span class="lineno"> 1200</span>&#160;         zcrt1d(ii)           = zcrt(i1(ii),i2(ii),i3(ii))</div>
<div class="line"><a name="l01201"></a><span class="lineno"> 1201</span>&#160;         zcit1d(ii)           = zcit(i1(ii),i2(ii),i3(ii))</div>
<div class="line"><a name="l01202"></a><span class="lineno"> 1202</span>&#160;         zcst1d(ii)           = zcst(i1(ii),i2(ii),i3(ii))</div>
<div class="line"><a name="l01203"></a><span class="lineno"> 1203</span>&#160;         zcgt1d(ii)           = zcgt(i1(ii),i2(ii),i3(ii))</div>
<div class="line"><a name="l01204"></a><span class="lineno"> 1204</span>&#160;         zcht1d(ii)           = zcht(i1(ii),i2(ii),i3(ii))</div>
<div class="line"><a name="l01205"></a><span class="lineno"> 1205</span>&#160;         zifnn1d(ii,:)        = zifnnt(i1(ii),i2(ii),i3(ii),:)</div>
<div class="line"><a name="l01206"></a><span class="lineno"> 1206</span>&#160;         zevap1d(ii)          = pevap3d(i1(ii),i2(ii),i3(ii))</div>
<div class="line"><a name="l01207"></a><span class="lineno"> 1207</span>&#160;         ztime1d(ii)          = ztime(i1(ii),i2(ii),i3(ii))         </div>
<div class="line"><a name="l01208"></a><span class="lineno"> 1208</span>&#160;         llcompute1d(ii)      = llcompute(i1(ii),i2(ii),i3(ii))         </div>
<div class="line"><a name="l01209"></a><span class="lineno"> 1209</span>&#160;         iiter1d(ii)          = iiter(i1(ii),i2(ii),i3(ii))         </div>
<div class="line"><a name="l01210"></a><span class="lineno"> 1210</span>&#160;         ztime_lastcall1d(ii) = ztime_lastcall(i1(ii),i2(ii),i3(ii))         </div>
<div class="line"><a name="l01211"></a><span class="lineno"> 1211</span>&#160;         z0rvt1d(ii)          = z0rvt(i1(ii),i2(ii),i3(ii))</div>
<div class="line"><a name="l01212"></a><span class="lineno"> 1212</span>&#160;         z0rct1d(ii)          = z0rct(i1(ii),i2(ii),i3(ii))</div>
<div class="line"><a name="l01213"></a><span class="lineno"> 1213</span>&#160;         z0rrt1d(ii)          = z0rrt(i1(ii),i2(ii),i3(ii))</div>
<div class="line"><a name="l01214"></a><span class="lineno"> 1214</span>&#160;         z0rit1d(ii)          = z0rit(i1(ii),i2(ii),i3(ii))</div>
<div class="line"><a name="l01215"></a><span class="lineno"> 1215</span>&#160;         z0rst1d(ii)          = z0rst(i1(ii),i2(ii),i3(ii))</div>
<div class="line"><a name="l01216"></a><span class="lineno"> 1216</span>&#160;         z0rgt1d(ii)          = z0rgt(i1(ii),i2(ii),i3(ii))</div>
<div class="line"><a name="l01217"></a><span class="lineno"> 1217</span>&#160;         z0rht1d(ii)          = z0rht(i1(ii),i2(ii),i3(ii))</div>
<div class="line"><a name="l01218"></a><span class="lineno"> 1218</span>&#160;         zcf1d(ii)            = pcldfr(i1(ii),i2(ii),i3(ii))</div>
<div class="line"><a name="l01219"></a><span class="lineno"> 1219</span>&#160;         zif1d(ii)            = picefr(i1(ii),i2(ii),i3(ii))</div>
<div class="line"><a name="l01220"></a><span class="lineno"> 1220</span>&#160;         zpf1d(ii)            = pprcfr(i1(ii),i2(ii),i3(ii))</div>
<div class="line"><a name="l01221"></a><span class="lineno"> 1221</span>&#160;         <span class="keywordflow">IF</span> (oelec) <span class="keywordflow">THEN</span></div>
<div class="line"><a name="l01222"></a><span class="lineno"> 1222</span>&#160;           zlatham_iaggs(ii) = platham_iaggs(i1(ii),i2(ii),i3(ii))</div>
<div class="line"><a name="l01223"></a><span class="lineno"> 1223</span>&#160;         <span class="keywordflow">ELSE</span></div>
<div class="line"><a name="l01224"></a><span class="lineno"> 1224</span>&#160;           zlatham_iaggs(ii) = 1.0 </div>
<div class="line"><a name="l01225"></a><span class="lineno"> 1225</span>&#160;<span class="keywordflow">         END IF</span></div>
<div class="line"><a name="l01226"></a><span class="lineno"> 1226</span>&#160;<span class="keywordflow">      END DO</span></div>
<div class="line"><a name="l01227"></a><span class="lineno"> 1227</span>&#160;      <span class="comment">!</span></div>
<div class="line"><a name="l01228"></a><span class="lineno"> 1228</span>&#160;      <span class="keywordflow">WHERE</span>(zcf1d(:)&lt;1.e-10 .AND. zrct1d(:)&gt;<a class="code" href="namespacemodd__param__lima.html#aefc493a9b25fa3023153181d64911a68">xrtmin</a>(2) .AND. zcct1d(:)&gt;<a class="code" href="namespacemodd__param__lima.html#a4c82daf9a772a83a3f85b392b0ec8ca1">xctmin</a>(2)) zcf1d(:)=1.</div>
<div class="line"><a name="l01229"></a><span class="lineno"> 1229</span>&#160;      <span class="keywordflow">WHERE</span>(zif1d(:)&lt;1.e-10 .AND. zrit1d(:)&gt;<a class="code" href="namespacemodd__param__lima.html#aefc493a9b25fa3023153181d64911a68">xrtmin</a>(4) .AND. zcit1d(:)&gt;<a class="code" href="namespacemodd__param__lima.html#a4c82daf9a772a83a3f85b392b0ec8ca1">xctmin</a>(4)) zif1d(:)=1.</div>
<div class="line"><a name="l01230"></a><span class="lineno"> 1230</span>&#160;      <span class="keywordflow">WHERE</span>(zpf1d(:)&lt;1.e-10 .AND. zrrt1d(:)&gt;<a class="code" href="namespacemodd__param__lima.html#aefc493a9b25fa3023153181d64911a68">xrtmin</a>(3) .AND. zcrt1d(:)&gt;<a class="code" href="namespacemodd__param__lima.html#a4c82daf9a772a83a3f85b392b0ec8ca1">xctmin</a>(3)) zpf1d(:)=1.</div>
<div class="line"><a name="l01231"></a><span class="lineno"> 1231</span>&#160;      <span class="keywordflow">WHERE</span>(zpf1d(:)&lt;1.e-10 .AND. zrst1d(:)&gt;<a class="code" href="namespacemodd__param__lima.html#aefc493a9b25fa3023153181d64911a68">xrtmin</a>(5) .AND. zcst1d(:)&gt;<a class="code" href="namespacemodd__param__lima.html#a4c82daf9a772a83a3f85b392b0ec8ca1">xctmin</a>(5)) zpf1d(:)=1.</div>
<div class="line"><a name="l01232"></a><span class="lineno"> 1232</span>&#160;      <span class="keywordflow">WHERE</span>(zpf1d(:)&lt;1.e-10 .AND. zrgt1d(:)&gt;<a class="code" href="namespacemodd__param__lima.html#aefc493a9b25fa3023153181d64911a68">xrtmin</a>(6) .AND. zcgt1d(:)&gt;<a class="code" href="namespacemodd__param__lima.html#a4c82daf9a772a83a3f85b392b0ec8ca1">xctmin</a>(6)) zpf1d(:)=1.</div>
<div class="line"><a name="l01233"></a><span class="lineno"> 1233</span>&#160;      <span class="keywordflow">WHERE</span>(zpf1d(:)&lt;1.e-10 .AND. zrht1d(:)&gt;<a class="code" href="namespacemodd__param__lima.html#aefc493a9b25fa3023153181d64911a68">xrtmin</a>(7) .AND. zcht1d(:)&gt;<a class="code" href="namespacemodd__param__lima.html#a4c82daf9a772a83a3f85b392b0ec8ca1">xctmin</a>(7)) zpf1d(:)=1.</div>
<div class="line"><a name="l01234"></a><span class="lineno"> 1234</span>&#160;      <span class="comment">!</span></div>
<div class="line"><a name="l01235"></a><span class="lineno"> 1235</span>&#160;      <span class="comment">! Allocating 1D variables</span></div>
<div class="line"><a name="l01236"></a><span class="lineno"> 1236</span>&#160;      <span class="comment">!</span></div>
<div class="line"><a name="l01237"></a><span class="lineno"> 1237</span>&#160;      <span class="keyword">ALLOCATE</span>(zmaxtime(ipack))           ;  zmaxtime(:) = 0.</div>
<div class="line"><a name="l01238"></a><span class="lineno"> 1238</span>&#160;      <span class="keyword">ALLOCATE</span>(ztime_threshold(ipack))    ;  ztime_threshold(:) = 0.</div>
<div class="line"><a name="l01239"></a><span class="lineno"> 1239</span>&#160;      <span class="comment">!</span></div>
<div class="line"><a name="l01240"></a><span class="lineno"> 1240</span>&#160;      <span class="keyword">ALLOCATE</span>(za_th(ipack))              ;  za_th(:) = 0.</div>
<div class="line"><a name="l01241"></a><span class="lineno"> 1241</span>&#160;      <span class="keyword">ALLOCATE</span>(za_rv(ipack))              ;  za_rv(:) = 0.</div>
<div class="line"><a name="l01242"></a><span class="lineno"> 1242</span>&#160;      <span class="keyword">ALLOCATE</span>(za_rc(ipack))              ;  za_rc(:) = 0.</div>
<div class="line"><a name="l01243"></a><span class="lineno"> 1243</span>&#160;      <span class="keyword">ALLOCATE</span>(za_rr(ipack))              ;  za_rr(:) = 0.</div>
<div class="line"><a name="l01244"></a><span class="lineno"> 1244</span>&#160;      <span class="keyword">ALLOCATE</span>(za_ri(ipack))              ;  za_ri(:) = 0.</div>
<div class="line"><a name="l01245"></a><span class="lineno"> 1245</span>&#160;      <span class="keyword">ALLOCATE</span>(za_rs(ipack))              ;  za_rs(:) = 0.</div>
<div class="line"><a name="l01246"></a><span class="lineno"> 1246</span>&#160;      <span class="keyword">ALLOCATE</span>(za_rg(ipack))              ;  za_rg(:) = 0.</div>
<div class="line"><a name="l01247"></a><span class="lineno"> 1247</span>&#160;      <span class="keyword">ALLOCATE</span>(za_rh(ipack))              ;  za_rh(:) = 0.</div>
<div class="line"><a name="l01248"></a><span class="lineno"> 1248</span>&#160;      <span class="keyword">ALLOCATE</span>(za_cc(ipack))              ;  za_cc(:) = 0.</div>
<div class="line"><a name="l01249"></a><span class="lineno"> 1249</span>&#160;      <span class="keyword">ALLOCATE</span>(za_cr(ipack))              ;  za_cr(:) = 0.</div>
<div class="line"><a name="l01250"></a><span class="lineno"> 1250</span>&#160;      <span class="keyword">ALLOCATE</span>(za_ci(ipack))              ;  za_ci(:) = 0.</div>
<div class="line"><a name="l01251"></a><span class="lineno"> 1251</span>&#160;      <span class="keyword">ALLOCATE</span>(za_cs(ipack))              ;  za_cs(:) = 0.</div>
<div class="line"><a name="l01252"></a><span class="lineno"> 1252</span>&#160;      <span class="keyword">ALLOCATE</span>(za_cg(ipack))              ;  za_cg(:) = 0.</div>
<div class="line"><a name="l01253"></a><span class="lineno"> 1253</span>&#160;      <span class="keyword">ALLOCATE</span>(za_ch(ipack))              ;  za_ch(:) = 0.</div>
<div class="line"><a name="l01254"></a><span class="lineno"> 1254</span>&#160;      <span class="comment">!</span></div>
<div class="line"><a name="l01255"></a><span class="lineno"> 1255</span>&#160;      <span class="keyword">ALLOCATE</span>(zb_th(ipack))              ;  zb_th(:) = 0.</div>
<div class="line"><a name="l01256"></a><span class="lineno"> 1256</span>&#160;      <span class="keyword">ALLOCATE</span>(zb_rv(ipack))              ;  zb_rv(:) = 0.</div>
<div class="line"><a name="l01257"></a><span class="lineno"> 1257</span>&#160;      <span class="keyword">ALLOCATE</span>(zb_rc(ipack))              ;  zb_rc(:) = 0.</div>
<div class="line"><a name="l01258"></a><span class="lineno"> 1258</span>&#160;      <span class="keyword">ALLOCATE</span>(zb_rr(ipack))              ;  zb_rr(:) = 0.</div>
<div class="line"><a name="l01259"></a><span class="lineno"> 1259</span>&#160;      <span class="keyword">ALLOCATE</span>(zb_ri(ipack))              ;  zb_ri(:) = 0.</div>
<div class="line"><a name="l01260"></a><span class="lineno"> 1260</span>&#160;      <span class="keyword">ALLOCATE</span>(zb_rs(ipack))              ;  zb_rs(:) = 0.</div>
<div class="line"><a name="l01261"></a><span class="lineno"> 1261</span>&#160;      <span class="keyword">ALLOCATE</span>(zb_rg(ipack))              ;  zb_rg(:) = 0.</div>
<div class="line"><a name="l01262"></a><span class="lineno"> 1262</span>&#160;      <span class="keyword">ALLOCATE</span>(zb_rh(ipack))              ;  zb_rh(:) = 0.</div>
<div class="line"><a name="l01263"></a><span class="lineno"> 1263</span>&#160;      <span class="keyword">ALLOCATE</span>(zb_cc(ipack))              ;  zb_cc(:) = 0.</div>
<div class="line"><a name="l01264"></a><span class="lineno"> 1264</span>&#160;      <span class="keyword">ALLOCATE</span>(zb_cr(ipack))              ;  zb_cr(:) = 0.</div>
<div class="line"><a name="l01265"></a><span class="lineno"> 1265</span>&#160;      <span class="keyword">ALLOCATE</span>(zb_ci(ipack))              ;  zb_ci(:) = 0.</div>
<div class="line"><a name="l01266"></a><span class="lineno"> 1266</span>&#160;      <span class="keyword">ALLOCATE</span>(zb_cs(ipack))              ;  zb_cs(:) = 0.</div>
<div class="line"><a name="l01267"></a><span class="lineno"> 1267</span>&#160;      <span class="keyword">ALLOCATE</span>(zb_cg(ipack))              ;  zb_cg(:) = 0.</div>
<div class="line"><a name="l01268"></a><span class="lineno"> 1268</span>&#160;      <span class="keyword">ALLOCATE</span>(zb_ch(ipack))              ;  zb_ch(:) = 0.</div>
<div class="line"><a name="l01269"></a><span class="lineno"> 1269</span>&#160;      <span class="keyword">ALLOCATE</span>(zb_ifnn(ipack,<a class="code" href="namespacemodd__param__lima.html#a2b98a3f23053acfd971d523a0778f209">nmod_ifn</a>))   ;  zb_ifnn(:,:) = 0.</div>
<div class="line"><a name="l01270"></a><span class="lineno"> 1270</span>&#160;      <span class="comment">!</span></div>
<div class="line"><a name="l01271"></a><span class="lineno"> 1271</span>&#160;      <span class="keyword">ALLOCATE</span>(z_cr_brku(ipack))          ; z_cr_brku(:) = 0.</div>
<div class="line"><a name="l01272"></a><span class="lineno"> 1272</span>&#160;      <span class="keyword">ALLOCATE</span>(z_th_honr(ipack))          ; z_th_honr(:) = 0.</div>
<div class="line"><a name="l01273"></a><span class="lineno"> 1273</span>&#160;      <span class="keyword">ALLOCATE</span>(z_rr_honr(ipack))          ; z_rr_honr(:) = 0.</div>
<div class="line"><a name="l01274"></a><span class="lineno"> 1274</span>&#160;      <span class="keyword">ALLOCATE</span>(z_cr_honr(ipack))          ; z_cr_honr(:) = 0.</div>
<div class="line"><a name="l01275"></a><span class="lineno"> 1275</span>&#160;      <span class="keyword">ALLOCATE</span>(z_th_imlt(ipack))          ; z_th_imlt(:) = 0.</div>
<div class="line"><a name="l01276"></a><span class="lineno"> 1276</span>&#160;      <span class="keyword">ALLOCATE</span>(z_rc_imlt(ipack))          ; z_rc_imlt(:) = 0.</div>
<div class="line"><a name="l01277"></a><span class="lineno"> 1277</span>&#160;      <span class="keyword">ALLOCATE</span>(z_cc_imlt(ipack))          ; z_cc_imlt(:) = 0.</div>
<div class="line"><a name="l01278"></a><span class="lineno"> 1278</span>&#160;      <span class="keyword">ALLOCATE</span>(z_th_honc(ipack))          ; z_th_honc(:) = 0.</div>
<div class="line"><a name="l01279"></a><span class="lineno"> 1279</span>&#160;      <span class="keyword">ALLOCATE</span>(z_rc_honc(ipack))          ; z_rc_honc(:) = 0.</div>
<div class="line"><a name="l01280"></a><span class="lineno"> 1280</span>&#160;      <span class="keyword">ALLOCATE</span>(z_cc_honc(ipack))          ; z_cc_honc(:) = 0.</div>
<div class="line"><a name="l01281"></a><span class="lineno"> 1281</span>&#160;      <span class="keyword">ALLOCATE</span>(z_cc_self(ipack))          ; z_cc_self(:) = 0.</div>
<div class="line"><a name="l01282"></a><span class="lineno"> 1282</span>&#160;      <span class="keyword">ALLOCATE</span>(z_rc_auto(ipack))          ; z_rc_auto(:) = 0.</div>
<div class="line"><a name="l01283"></a><span class="lineno"> 1283</span>&#160;      <span class="keyword">ALLOCATE</span>(z_cc_auto(ipack))          ; z_cc_auto(:) = 0.</div>
<div class="line"><a name="l01284"></a><span class="lineno"> 1284</span>&#160;      <span class="keyword">ALLOCATE</span>(z_cr_auto(ipack))          ; z_cr_auto(:) = 0.</div>
<div class="line"><a name="l01285"></a><span class="lineno"> 1285</span>&#160;      <span class="keyword">ALLOCATE</span>(z_rc_accr(ipack))          ; z_rc_accr(:) = 0.</div>
<div class="line"><a name="l01286"></a><span class="lineno"> 1286</span>&#160;      <span class="keyword">ALLOCATE</span>(z_cc_accr(ipack))          ; z_cc_accr(:) = 0.</div>
<div class="line"><a name="l01287"></a><span class="lineno"> 1287</span>&#160;      <span class="keyword">ALLOCATE</span>(z_cr_scbu(ipack))          ; z_cr_scbu(:) = 0.</div>
<div class="line"><a name="l01288"></a><span class="lineno"> 1288</span>&#160;      <span class="keyword">ALLOCATE</span>(z_th_evap(ipack))          ; z_th_evap(:) = 0.</div>
<div class="line"><a name="l01289"></a><span class="lineno"> 1289</span>&#160;      <span class="keyword">ALLOCATE</span>(z_rr_evap(ipack))          ; z_rr_evap(:) = 0.</div>
<div class="line"><a name="l01290"></a><span class="lineno"> 1290</span>&#160;      <span class="keyword">ALLOCATE</span>(z_cr_evap(ipack))          ; z_cr_evap(:) = 0.</div>
<div class="line"><a name="l01291"></a><span class="lineno"> 1291</span>&#160;      <span class="keyword">ALLOCATE</span>(z_ri_cnvi(ipack))          ; z_ri_cnvi(:) = 0.</div>
<div class="line"><a name="l01292"></a><span class="lineno"> 1292</span>&#160;      <span class="keyword">ALLOCATE</span>(z_ci_cnvi(ipack))          ; z_ci_cnvi(:) = 0.</div>
<div class="line"><a name="l01293"></a><span class="lineno"> 1293</span>&#160;      <span class="keyword">ALLOCATE</span>(z_th_deps(ipack))          ; z_th_deps(:) = 0.</div>
<div class="line"><a name="l01294"></a><span class="lineno"> 1294</span>&#160;      <span class="keyword">ALLOCATE</span>(z_rs_deps(ipack))          ; z_rs_deps(:) = 0.</div>
<div class="line"><a name="l01295"></a><span class="lineno"> 1295</span>&#160;      <span class="keyword">ALLOCATE</span>(z_th_depi(ipack))          ; z_th_depi(:) = 0.</div>
<div class="line"><a name="l01296"></a><span class="lineno"> 1296</span>&#160;      <span class="keyword">ALLOCATE</span>(z_ri_depi(ipack))          ; z_ri_depi(:) = 0.</div>
<div class="line"><a name="l01297"></a><span class="lineno"> 1297</span>&#160;      <span class="keyword">ALLOCATE</span>(z_ri_cnvs(ipack))          ; z_ri_cnvs(:) = 0.</div>
<div class="line"><a name="l01298"></a><span class="lineno"> 1298</span>&#160;      <span class="keyword">ALLOCATE</span>(z_ci_cnvs(ipack))          ; z_ci_cnvs(:) = 0.</div>
<div class="line"><a name="l01299"></a><span class="lineno"> 1299</span>&#160;      <span class="keyword">ALLOCATE</span>(z_cs_ssc(ipack))           ; z_cs_ssc(:) = 0.</div>
<div class="line"><a name="l01300"></a><span class="lineno"> 1300</span>&#160;      <span class="keyword">ALLOCATE</span>(z_ri_aggs(ipack))          ; z_ri_aggs(:) = 0.</div>
<div class="line"><a name="l01301"></a><span class="lineno"> 1301</span>&#160;      <span class="keyword">ALLOCATE</span>(z_ci_aggs(ipack))          ; z_ci_aggs(:) = 0.</div>
<div class="line"><a name="l01302"></a><span class="lineno"> 1302</span>&#160;      <span class="keyword">ALLOCATE</span>(z_th_depg(ipack))          ; z_th_depg(:) = 0.</div>
<div class="line"><a name="l01303"></a><span class="lineno"> 1303</span>&#160;      <span class="keyword">ALLOCATE</span>(z_rg_depg(ipack))          ; z_rg_depg(:) = 0.</div>
<div class="line"><a name="l01304"></a><span class="lineno"> 1304</span>&#160;      <span class="keyword">ALLOCATE</span>(z_th_berfi(ipack))         ; z_th_berfi(:) = 0.</div>
<div class="line"><a name="l01305"></a><span class="lineno"> 1305</span>&#160;      <span class="keyword">ALLOCATE</span>(z_rc_berfi(ipack))         ; z_rc_berfi(:) = 0.</div>
<div class="line"><a name="l01306"></a><span class="lineno"> 1306</span>&#160;<span class="comment">!++cb++</span></div>
<div class="line"><a name="l01307"></a><span class="lineno"> 1307</span>&#160;      <span class="keyword">ALLOCATE</span>(z_th_rim(ipack))           ; z_th_rim(:) = 0.</div>
<div class="line"><a name="l01308"></a><span class="lineno"> 1308</span>&#160;<span class="comment">!      ALLOCATE(Z_RC_RIM(IPACK))           ; Z_RC_RIM(:) = 0.</span></div>
<div class="line"><a name="l01309"></a><span class="lineno"> 1309</span>&#160;      <span class="keyword">ALLOCATE</span>(z_cc_rim(ipack))           ; z_cc_rim(:) = 0.</div>
<div class="line"><a name="l01310"></a><span class="lineno"> 1310</span>&#160;<span class="comment">!      ALLOCATE(Z_RS_RIM(IPACK))           ; Z_RS_RIM(:) = 0.</span></div>
<div class="line"><a name="l01311"></a><span class="lineno"> 1311</span>&#160;      <span class="keyword">ALLOCATE</span>(z_cs_rim(ipack))           ; z_cs_rim(:) = 0.</div>
<div class="line"><a name="l01312"></a><span class="lineno"> 1312</span>&#160;<span class="comment">!      ALLOCATE(Z_RG_RIM(IPACK))           ; Z_RG_RIM(:) = 0.</span></div>
<div class="line"><a name="l01313"></a><span class="lineno"> 1313</span>&#160;      <span class="keyword">ALLOCATE</span>(z_rc_rimss(ipack))         ; z_rc_rimss = 0.</div>
<div class="line"><a name="l01314"></a><span class="lineno"> 1314</span>&#160;      <span class="keyword">ALLOCATE</span>(z_rc_rimsg(ipack))         ; z_rc_rimsg = 0.</div>
<div class="line"><a name="l01315"></a><span class="lineno"> 1315</span>&#160;      <span class="keyword">ALLOCATE</span>(z_rs_rimcg(ipack))         ; z_rs_rimcg = 0.</div>
<div class="line"><a name="l01316"></a><span class="lineno"> 1316</span>&#160;<span class="comment">!--cb--</span></div>
<div class="line"><a name="l01317"></a><span class="lineno"> 1317</span>&#160;      <span class="keyword">ALLOCATE</span>(z_ri_hms(ipack))           ; z_ri_hms(:) = 0.</div>
<div class="line"><a name="l01318"></a><span class="lineno"> 1318</span>&#160;      <span class="keyword">ALLOCATE</span>(z_ci_hms(ipack))           ; z_ci_hms(:) = 0.</div>
<div class="line"><a name="l01319"></a><span class="lineno"> 1319</span>&#160;      <span class="keyword">ALLOCATE</span>(z_rs_hms(ipack))           ; z_rs_hms(:) = 0.</div>
<div class="line"><a name="l01320"></a><span class="lineno"> 1320</span>&#160;<span class="comment">!++cb++</span></div>
<div class="line"><a name="l01321"></a><span class="lineno"> 1321</span>&#160;      <span class="keyword">ALLOCATE</span>(z_th_acc(ipack))           ; z_th_acc(:) = 0.</div>
<div class="line"><a name="l01322"></a><span class="lineno"> 1322</span>&#160;<span class="comment">!      ALLOCATE(Z_RR_ACC(IPACK))           ; Z_RR_ACC(:) = 0.</span></div>
<div class="line"><a name="l01323"></a><span class="lineno"> 1323</span>&#160;      <span class="keyword">ALLOCATE</span>(z_cr_acc(ipack))           ; z_cr_acc(:) = 0.</div>
<div class="line"><a name="l01324"></a><span class="lineno"> 1324</span>&#160;<span class="comment">!      ALLOCATE(Z_RS_ACC(IPACK))           ; Z_RS_ACC(:) = 0.</span></div>
<div class="line"><a name="l01325"></a><span class="lineno"> 1325</span>&#160;      <span class="keyword">ALLOCATE</span>(z_cs_acc(ipack))           ; z_cs_acc(:) = 0.</div>
<div class="line"><a name="l01326"></a><span class="lineno"> 1326</span>&#160;<span class="comment">!      ALLOCATE(Z_RG_ACC(IPACK))           ; Z_RG_ACC(:) = 0.</span></div>
<div class="line"><a name="l01327"></a><span class="lineno"> 1327</span>&#160;      <span class="keyword">ALLOCATE</span>(z_rr_accss(ipack))         ; z_rr_accss = 0.</div>
<div class="line"><a name="l01328"></a><span class="lineno"> 1328</span>&#160;      <span class="keyword">ALLOCATE</span>(z_rr_accsg(ipack))         ; z_rr_accsg = 0.</div>
<div class="line"><a name="l01329"></a><span class="lineno"> 1329</span>&#160;      <span class="keyword">ALLOCATE</span>(z_rs_accrg(ipack))         ; z_rs_accrg = 0.</div>
<div class="line"><a name="l01330"></a><span class="lineno"> 1330</span>&#160;<span class="comment">!--cb--</span></div>
<div class="line"><a name="l01331"></a><span class="lineno"> 1331</span>&#160;      <span class="keyword">ALLOCATE</span>(z_rs_cmel(ipack))          ; z_rs_cmel(:) = 0.</div>
<div class="line"><a name="l01332"></a><span class="lineno"> 1332</span>&#160;      <span class="keyword">ALLOCATE</span>(z_cs_cmel(ipack))          ; z_cs_cmel(:) = 0.</div>
<div class="line"><a name="l01333"></a><span class="lineno"> 1333</span>&#160;      <span class="keyword">ALLOCATE</span>(z_th_cfrz(ipack))          ; z_th_cfrz(:) = 0.</div>
<div class="line"><a name="l01334"></a><span class="lineno"> 1334</span>&#160;      <span class="keyword">ALLOCATE</span>(z_rr_cfrz(ipack))          ; z_rr_cfrz(:) = 0.</div>
<div class="line"><a name="l01335"></a><span class="lineno"> 1335</span>&#160;      <span class="keyword">ALLOCATE</span>(z_cr_cfrz(ipack))          ; z_cr_cfrz(:) = 0.</div>
<div class="line"><a name="l01336"></a><span class="lineno"> 1336</span>&#160;      <span class="keyword">ALLOCATE</span>(z_ri_cfrz(ipack))          ; z_ri_cfrz(:) = 0.</div>
<div class="line"><a name="l01337"></a><span class="lineno"> 1337</span>&#160;      <span class="keyword">ALLOCATE</span>(z_ci_cfrz(ipack))          ; z_ci_cfrz(:) = 0.</div>
<div class="line"><a name="l01338"></a><span class="lineno"> 1338</span>&#160;      <span class="keyword">ALLOCATE</span>(z_ri_cibu(ipack))          ; z_ri_cibu(:) = 0.</div>
<div class="line"><a name="l01339"></a><span class="lineno"> 1339</span>&#160;      <span class="keyword">ALLOCATE</span>(z_ci_cibu(ipack))          ; z_ci_cibu(:) = 0.</div>
<div class="line"><a name="l01340"></a><span class="lineno"> 1340</span>&#160;      <span class="keyword">ALLOCATE</span>(z_ri_rdsf(ipack))          ; z_ri_rdsf(:) = 0.</div>
<div class="line"><a name="l01341"></a><span class="lineno"> 1341</span>&#160;      <span class="keyword">ALLOCATE</span>(z_ci_rdsf(ipack))          ; z_ci_rdsf(:) = 0.</div>
<div class="line"><a name="l01342"></a><span class="lineno"> 1342</span>&#160;      <span class="keyword">ALLOCATE</span>(z_th_wetg(ipack))          ; z_th_wetg(:) = 0.</div>
<div class="line"><a name="l01343"></a><span class="lineno"> 1343</span>&#160;      <span class="keyword">ALLOCATE</span>(z_rc_wetg(ipack))          ; z_rc_wetg(:) = 0.</div>
<div class="line"><a name="l01344"></a><span class="lineno"> 1344</span>&#160;      <span class="keyword">ALLOCATE</span>(z_cc_wetg(ipack))          ; z_cc_wetg(:) = 0.</div>
<div class="line"><a name="l01345"></a><span class="lineno"> 1345</span>&#160;      <span class="keyword">ALLOCATE</span>(z_rr_wetg(ipack))          ; z_rr_wetg(:) = 0.</div>
<div class="line"><a name="l01346"></a><span class="lineno"> 1346</span>&#160;      <span class="keyword">ALLOCATE</span>(z_cr_wetg(ipack))          ; z_cr_wetg(:) = 0.</div>
<div class="line"><a name="l01347"></a><span class="lineno"> 1347</span>&#160;      <span class="keyword">ALLOCATE</span>(z_ri_wetg(ipack))          ; z_ri_wetg(:) = 0.</div>
<div class="line"><a name="l01348"></a><span class="lineno"> 1348</span>&#160;      <span class="keyword">ALLOCATE</span>(z_ci_wetg(ipack))          ; z_ci_wetg(:) = 0.</div>
<div class="line"><a name="l01349"></a><span class="lineno"> 1349</span>&#160;      <span class="keyword">ALLOCATE</span>(z_rs_wetg(ipack))          ; z_rs_wetg(:) = 0.</div>
<div class="line"><a name="l01350"></a><span class="lineno"> 1350</span>&#160;      <span class="keyword">ALLOCATE</span>(z_cs_wetg(ipack))          ; z_cs_wetg(:) = 0.</div>
<div class="line"><a name="l01351"></a><span class="lineno"> 1351</span>&#160;      <span class="keyword">ALLOCATE</span>(z_rg_wetg(ipack))          ; z_rg_wetg(:) = 0.</div>
<div class="line"><a name="l01352"></a><span class="lineno"> 1352</span>&#160;      <span class="keyword">ALLOCATE</span>(z_cg_wetg(ipack))          ; z_cg_wetg(:) = 0.</div>
<div class="line"><a name="l01353"></a><span class="lineno"> 1353</span>&#160;      <span class="keyword">ALLOCATE</span>(z_rh_wetg(ipack))          ; z_rh_wetg(:) = 0.</div>
<div class="line"><a name="l01354"></a><span class="lineno"> 1354</span>&#160;      <span class="keyword">ALLOCATE</span>(z_th_dryg(ipack))          ; z_th_dryg(:) = 0.</div>
<div class="line"><a name="l01355"></a><span class="lineno"> 1355</span>&#160;      <span class="keyword">ALLOCATE</span>(z_rc_dryg(ipack))          ; z_rc_dryg(:) = 0.</div>
<div class="line"><a name="l01356"></a><span class="lineno"> 1356</span>&#160;      <span class="keyword">ALLOCATE</span>(z_cc_dryg(ipack))          ; z_cc_dryg(:) = 0.</div>
<div class="line"><a name="l01357"></a><span class="lineno"> 1357</span>&#160;      <span class="keyword">ALLOCATE</span>(z_rr_dryg(ipack))          ; z_rr_dryg(:) = 0.</div>
<div class="line"><a name="l01358"></a><span class="lineno"> 1358</span>&#160;      <span class="keyword">ALLOCATE</span>(z_cr_dryg(ipack))          ; z_cr_dryg(:) = 0.</div>
<div class="line"><a name="l01359"></a><span class="lineno"> 1359</span>&#160;      <span class="keyword">ALLOCATE</span>(z_ri_dryg(ipack))          ; z_ri_dryg(:) = 0.</div>
<div class="line"><a name="l01360"></a><span class="lineno"> 1360</span>&#160;      <span class="keyword">ALLOCATE</span>(z_ci_dryg(ipack))          ; z_ci_dryg(:) = 0.</div>
<div class="line"><a name="l01361"></a><span class="lineno"> 1361</span>&#160;      <span class="keyword">ALLOCATE</span>(z_rs_dryg(ipack))          ; z_rs_dryg(:) = 0.</div>
<div class="line"><a name="l01362"></a><span class="lineno"> 1362</span>&#160;      <span class="keyword">ALLOCATE</span>(z_cs_dryg(ipack))          ; z_cs_dryg(:) = 0.</div>
<div class="line"><a name="l01363"></a><span class="lineno"> 1363</span>&#160;      <span class="keyword">ALLOCATE</span>(z_rg_dryg(ipack))          ; z_rg_dryg(:) = 0.</div>
<div class="line"><a name="l01364"></a><span class="lineno"> 1364</span>&#160;      <span class="keyword">ALLOCATE</span>(z_ri_hmg(ipack))           ; z_ri_hmg(:) = 0.</div>
<div class="line"><a name="l01365"></a><span class="lineno"> 1365</span>&#160;      <span class="keyword">ALLOCATE</span>(z_ci_hmg(ipack))           ; z_ci_hmg(:) = 0.</div>
<div class="line"><a name="l01366"></a><span class="lineno"> 1366</span>&#160;      <span class="keyword">ALLOCATE</span>(z_rg_hmg(ipack))           ; z_rg_hmg(:) = 0.</div>
<div class="line"><a name="l01367"></a><span class="lineno"> 1367</span>&#160;      <span class="keyword">ALLOCATE</span>(z_th_gmlt(ipack))          ; z_th_gmlt(:) = 0.</div>
<div class="line"><a name="l01368"></a><span class="lineno"> 1368</span>&#160;      <span class="keyword">ALLOCATE</span>(z_rr_gmlt(ipack))          ; z_rr_gmlt(:) = 0.</div>
<div class="line"><a name="l01369"></a><span class="lineno"> 1369</span>&#160;      <span class="keyword">ALLOCATE</span>(z_cr_gmlt(ipack))          ; z_cr_gmlt(:) = 0.</div>
<div class="line"><a name="l01370"></a><span class="lineno"> 1370</span>&#160;      <span class="keyword">ALLOCATE</span>(z_cg_gmlt(ipack))          ; z_cg_gmlt(:) = 0.</div>
<div class="line"><a name="l01371"></a><span class="lineno"> 1371</span>&#160;      <span class="keyword">ALLOCATE</span>(z_th_deph(ipack))          ; z_th_deph(:) = 0.</div>
<div class="line"><a name="l01372"></a><span class="lineno"> 1372</span>&#160;      <span class="keyword">ALLOCATE</span>(z_rh_deph(ipack))          ; z_rh_deph(:) = 0.</div>
<div class="line"><a name="l01373"></a><span class="lineno"> 1373</span>&#160;      <span class="keyword">ALLOCATE</span>(z_th_weth(ipack))          ; z_th_weth(:) = 0.</div>
<div class="line"><a name="l01374"></a><span class="lineno"> 1374</span>&#160;      <span class="keyword">ALLOCATE</span>(z_rc_weth(ipack))          ; z_rc_weth(:) = 0.</div>
<div class="line"><a name="l01375"></a><span class="lineno"> 1375</span>&#160;      <span class="keyword">ALLOCATE</span>(z_cc_weth(ipack))          ; z_cc_weth(:) = 0.</div>
<div class="line"><a name="l01376"></a><span class="lineno"> 1376</span>&#160;      <span class="keyword">ALLOCATE</span>(z_rr_weth(ipack))          ; z_rr_weth(:) = 0.</div>
<div class="line"><a name="l01377"></a><span class="lineno"> 1377</span>&#160;      <span class="keyword">ALLOCATE</span>(z_cr_weth(ipack))          ; z_cr_weth(:) = 0.</div>
<div class="line"><a name="l01378"></a><span class="lineno"> 1378</span>&#160;      <span class="keyword">ALLOCATE</span>(z_ri_weth(ipack))          ; z_ri_weth(:) = 0.</div>
<div class="line"><a name="l01379"></a><span class="lineno"> 1379</span>&#160;      <span class="keyword">ALLOCATE</span>(z_ci_weth(ipack))          ; z_ci_weth(:) = 0.</div>
<div class="line"><a name="l01380"></a><span class="lineno"> 1380</span>&#160;      <span class="keyword">ALLOCATE</span>(z_rs_weth(ipack))          ; z_rs_weth(:) = 0.</div>
<div class="line"><a name="l01381"></a><span class="lineno"> 1381</span>&#160;      <span class="keyword">ALLOCATE</span>(z_cs_weth(ipack))          ; z_cs_weth(:) = 0.</div>
<div class="line"><a name="l01382"></a><span class="lineno"> 1382</span>&#160;      <span class="keyword">ALLOCATE</span>(z_rg_weth(ipack))          ; z_rg_weth(:) = 0.</div>
<div class="line"><a name="l01383"></a><span class="lineno"> 1383</span>&#160;      <span class="keyword">ALLOCATE</span>(z_cg_weth(ipack))          ; z_cg_weth(:) = 0.</div>
<div class="line"><a name="l01384"></a><span class="lineno"> 1384</span>&#160;      <span class="keyword">ALLOCATE</span>(z_rh_weth(ipack))          ; z_rh_weth(:) = 0.</div>
<div class="line"><a name="l01385"></a><span class="lineno"> 1385</span>&#160;      <span class="keyword">ALLOCATE</span>(z_rg_cohg(ipack))          ; z_rg_cohg(:) = 0.</div>
<div class="line"><a name="l01386"></a><span class="lineno"> 1386</span>&#160;      <span class="keyword">ALLOCATE</span>(z_cg_cohg(ipack))          ; z_cg_cohg(:) = 0.</div>
<div class="line"><a name="l01387"></a><span class="lineno"> 1387</span>&#160;      <span class="keyword">ALLOCATE</span>(z_th_hmlt(ipack))          ; z_th_hmlt(:) = 0.</div>
<div class="line"><a name="l01388"></a><span class="lineno"> 1388</span>&#160;      <span class="keyword">ALLOCATE</span>(z_rr_hmlt(ipack))          ; z_rr_hmlt(:) = 0.</div>
<div class="line"><a name="l01389"></a><span class="lineno"> 1389</span>&#160;      <span class="keyword">ALLOCATE</span>(z_cr_hmlt(ipack))          ; z_cr_hmlt(:) = 0.</div>
<div class="line"><a name="l01390"></a><span class="lineno"> 1390</span>&#160;      <span class="keyword">ALLOCATE</span>(z_ch_hmlt(ipack))          ; z_ch_hmlt(:) = 0.</div>
<div class="line"><a name="l01391"></a><span class="lineno"> 1391</span>&#160; </div>
<div class="line"><a name="l01392"></a><span class="lineno"> 1392</span>&#160;      <span class="keyword">ALLOCATE</span>(z_rv_corr2(ipack))         ; z_rv_corr2(:) = 0.</div>
<div class="line"><a name="l01393"></a><span class="lineno"> 1393</span>&#160;      <span class="keyword">ALLOCATE</span>(z_rc_corr2(ipack))         ; z_rc_corr2(:) = 0.</div>
<div class="line"><a name="l01394"></a><span class="lineno"> 1394</span>&#160;      <span class="keyword">ALLOCATE</span>(z_rr_corr2(ipack))         ; z_rr_corr2(:) = 0.</div>
<div class="line"><a name="l01395"></a><span class="lineno"> 1395</span>&#160;      <span class="keyword">ALLOCATE</span>(z_ri_corr2(ipack))         ; z_ri_corr2(:) = 0.</div>
<div class="line"><a name="l01396"></a><span class="lineno"> 1396</span>&#160;      <span class="keyword">ALLOCATE</span>(z_cc_corr2(ipack))         ; z_cc_corr2(:) = 0.</div>
<div class="line"><a name="l01397"></a><span class="lineno"> 1397</span>&#160;      <span class="keyword">ALLOCATE</span>(z_cr_corr2(ipack))         ; z_cr_corr2(:) = 0.</div>
<div class="line"><a name="l01398"></a><span class="lineno"> 1398</span>&#160;      <span class="keyword">ALLOCATE</span>(z_ci_corr2(ipack))         ; z_ci_corr2(:) = 0.</div>
<div class="line"><a name="l01399"></a><span class="lineno"> 1399</span>&#160;      <span class="comment">!</span></div>
<div class="line"><a name="l01400"></a><span class="lineno"> 1400</span>&#160;      <span class="comment">!***       4.1 Tendencies computation</span></div>
<div class="line"><a name="l01401"></a><span class="lineno"> 1401</span>&#160;      <span class="comment">!</span></div>
<div class="line"><a name="l01402"></a><span class="lineno"> 1402</span>&#160;      <span class="keyword">CALL </span><a class="code" href="namespacemode__lima__inst__procs.html#ad1cb4d142928d7af0554b9d16b3bf80a">lima_inst_procs</a> (ptstep, llcompute1d,                                &amp;</div>
<div class="line"><a name="l01403"></a><span class="lineno"> 1403</span>&#160;                            zexnref1d, zp1d,                                    &amp;</div>
<div class="line"><a name="l01404"></a><span class="lineno"> 1404</span>&#160;                            ztht1d, zrvt1d, zrct1d, zrrt1d, zrit1d, zrst1d, zrgt1d, &amp;</div>
<div class="line"><a name="l01405"></a><span class="lineno"> 1405</span>&#160;                            zcct1d, zcrt1d, zcit1d,                             &amp;</div>
<div class="line"><a name="l01406"></a><span class="lineno"> 1406</span>&#160;                            zifnn1d,                                            &amp;</div>
<div class="line"><a name="l01407"></a><span class="lineno"> 1407</span>&#160;                            z_cr_brku,                                          &amp; <span class="comment">! spontaneous break up of drops (BRKU) : Nr</span></div>
<div class="line"><a name="l01408"></a><span class="lineno"> 1408</span>&#160;                            z_th_honr, z_rr_honr, z_cr_honr,                    &amp; <span class="comment">! rain drops homogeneous freezing (HONR) : rr, Nr, rg=-rr, th</span></div>
<div class="line"><a name="l01409"></a><span class="lineno"> 1409</span>&#160;                            z_th_imlt, z_rc_imlt, z_cc_imlt,                    &amp; <span class="comment">! ice melting (IMLT) : rc, Nc, ri=-rc, Ni=-Nc, th, IFNF, IFNA</span></div>
<div class="line"><a name="l01410"></a><span class="lineno"> 1410</span>&#160;                            zb_th, zb_rv, zb_rc, zb_rr, zb_ri, zb_rg,           &amp;</div>
<div class="line"><a name="l01411"></a><span class="lineno"> 1411</span>&#160;                            zb_cc, zb_cr, zb_ci,                                &amp;</div>
<div class="line"><a name="l01412"></a><span class="lineno"> 1412</span>&#160;                            zb_ifnn,                                            &amp;</div>
<div class="line"><a name="l01413"></a><span class="lineno"> 1413</span>&#160;                            zcf1d, zif1d, zpf1d                                 )</div>
<div class="line"><a name="l01414"></a><span class="lineno"> 1414</span>&#160;      </div>
<div class="line"><a name="l01415"></a><span class="lineno"> 1415</span>&#160;      <span class="keyword">CALL </span><a class="code" href="namespacemode__lima__tendencies.html#ad5cd63b41ca201209913ffcf730450f6">lima_tendencies</a> (ptstep, llcompute1d,                                    &amp;</div>
<div class="line"><a name="l01416"></a><span class="lineno"> 1416</span>&#160;                            zexnref1d, zrhodref1d, zp1d, ztht1d,                    &amp;</div>
<div class="line"><a name="l01417"></a><span class="lineno"> 1417</span>&#160;                            zrvt1d, zrct1d, zrrt1d, zrit1d, zrst1d, zrgt1d, zrht1d, &amp;</div>
<div class="line"><a name="l01418"></a><span class="lineno"> 1418</span>&#160;                            zcct1d, zcrt1d, zcit1d, zcst1d, zcgt1d, zcht1d,         &amp;</div>
<div class="line"><a name="l01419"></a><span class="lineno"> 1419</span>&#160;                            z_th_honc, z_rc_honc, z_cc_honc,                        &amp; </div>
<div class="line"><a name="l01420"></a><span class="lineno"> 1420</span>&#160;                            z_cc_self,                                              &amp; </div>
<div class="line"><a name="l01421"></a><span class="lineno"> 1421</span>&#160;                            z_rc_auto, z_cc_auto, z_cr_auto,                        &amp; </div>
<div class="line"><a name="l01422"></a><span class="lineno"> 1422</span>&#160;                            z_rc_accr, z_cc_accr,                                   &amp; </div>
<div class="line"><a name="l01423"></a><span class="lineno"> 1423</span>&#160;                            z_cr_scbu,                                              &amp; </div>
<div class="line"><a name="l01424"></a><span class="lineno"> 1424</span>&#160;                            z_th_evap, z_rr_evap, z_cr_evap,                        &amp; </div>
<div class="line"><a name="l01425"></a><span class="lineno"> 1425</span>&#160;                            z_ri_cnvi, z_ci_cnvi,                                   &amp; </div>
<div class="line"><a name="l01426"></a><span class="lineno"> 1426</span>&#160;                            z_th_deps, z_rs_deps,                                   &amp; </div>
<div class="line"><a name="l01427"></a><span class="lineno"> 1427</span>&#160;                            z_th_depi, z_ri_depi,                                   &amp; </div>
<div class="line"><a name="l01428"></a><span class="lineno"> 1428</span>&#160;                            z_ri_cnvs, z_ci_cnvs,                                   &amp; </div>
<div class="line"><a name="l01429"></a><span class="lineno"> 1429</span>&#160;                            z_cs_ssc,                                               &amp; </div>
<div class="line"><a name="l01430"></a><span class="lineno"> 1430</span>&#160;                            z_ri_aggs, z_ci_aggs,                                   &amp; </div>
<div class="line"><a name="l01431"></a><span class="lineno"> 1431</span>&#160;                            z_th_depg, z_rg_depg,                                   &amp; </div>
<div class="line"><a name="l01432"></a><span class="lineno"> 1432</span>&#160;                            z_th_berfi, z_rc_berfi,                                 &amp; </div>
<div class="line"><a name="l01433"></a><span class="lineno"> 1433</span>&#160;<span class="comment">!++cb++</span></div>
<div class="line"><a name="l01434"></a><span class="lineno"> 1434</span>&#160;<span class="comment">!                            Z_TH_RIM, Z_RC_RIM, Z_CC_RIM, Z_RS_RIM, Z_CS_RIM, Z_RG_RIM,       &amp; </span></div>
<div class="line"><a name="l01435"></a><span class="lineno"> 1435</span>&#160;                            z_th_rim, z_cc_rim, z_cs_rim, z_rc_rimss, z_rc_rimsg, z_rs_rimcg, &amp;</div>
<div class="line"><a name="l01436"></a><span class="lineno"> 1436</span>&#160;<span class="comment">!--cb--</span></div>
<div class="line"><a name="l01437"></a><span class="lineno"> 1437</span>&#160;                            z_ri_hms, z_ci_hms, z_rs_hms,                           &amp; </div>
<div class="line"><a name="l01438"></a><span class="lineno"> 1438</span>&#160;<span class="comment">!++cb++</span></div>
<div class="line"><a name="l01439"></a><span class="lineno"> 1439</span>&#160;<span class="comment">!                            Z_TH_ACC, Z_RR_ACC, Z_CR_ACC, Z_RS_ACC, Z_CS_ACC, Z_RG_ACC,       &amp; </span></div>
<div class="line"><a name="l01440"></a><span class="lineno"> 1440</span>&#160;                            z_th_acc, z_cr_acc, z_cs_acc, z_rr_accss, z_rr_accsg, z_rs_accrg, &amp;</div>
<div class="line"><a name="l01441"></a><span class="lineno"> 1441</span>&#160;<span class="comment">!--cb--</span></div>
<div class="line"><a name="l01442"></a><span class="lineno"> 1442</span>&#160;                            z_rs_cmel, z_cs_cmel,                                   &amp; </div>
<div class="line"><a name="l01443"></a><span class="lineno"> 1443</span>&#160;                            z_th_cfrz, z_rr_cfrz, z_cr_cfrz, z_ri_cfrz, z_ci_cfrz,  &amp; </div>
<div class="line"><a name="l01444"></a><span class="lineno"> 1444</span>&#160;                            z_ri_cibu, z_ci_cibu,                                   &amp; </div>
<div class="line"><a name="l01445"></a><span class="lineno"> 1445</span>&#160;                            z_ri_rdsf, z_ci_rdsf,                                   &amp; </div>
<div class="line"><a name="l01446"></a><span class="lineno"> 1446</span>&#160;                            z_th_wetg, z_rc_wetg, z_cc_wetg, z_rr_wetg, z_cr_wetg,  &amp; </div>
<div class="line"><a name="l01447"></a><span class="lineno"> 1447</span>&#160;                            z_ri_wetg, z_ci_wetg, z_rs_wetg, z_cs_wetg, z_rg_wetg, z_cg_wetg, z_rh_wetg,  &amp; </div>
<div class="line"><a name="l01448"></a><span class="lineno"> 1448</span>&#160;                            z_th_dryg, z_rc_dryg, z_cc_dryg, z_rr_dryg, z_cr_dryg,  &amp; </div>
<div class="line"><a name="l01449"></a><span class="lineno"> 1449</span>&#160;                            z_ri_dryg, z_ci_dryg, z_rs_dryg, z_cs_dryg, z_rg_dryg,  &amp; </div>
<div class="line"><a name="l01450"></a><span class="lineno"> 1450</span>&#160;                            z_ri_hmg, z_ci_hmg, z_rg_hmg,                           &amp; </div>
<div class="line"><a name="l01451"></a><span class="lineno"> 1451</span>&#160;                            z_th_gmlt, z_rr_gmlt, z_cr_gmlt, z_cg_gmlt,             &amp;</div>
<div class="line"><a name="l01452"></a><span class="lineno"> 1452</span>&#160;                            z_th_deph, z_rh_deph,                                   &amp;</div>
<div class="line"><a name="l01453"></a><span class="lineno"> 1453</span>&#160;                            z_th_weth, z_rc_weth, z_cc_weth, z_rr_weth, z_cr_weth,  &amp;</div>
<div class="line"><a name="l01454"></a><span class="lineno"> 1454</span>&#160;                            z_ri_weth, z_ci_weth, z_rs_weth, z_cs_weth, z_rg_weth, z_cg_weth, z_rh_weth, &amp;</div>
<div class="line"><a name="l01455"></a><span class="lineno"> 1455</span>&#160;                            z_rg_cohg, z_cg_cohg,                                   &amp;</div>
<div class="line"><a name="l01456"></a><span class="lineno"> 1456</span>&#160;                            z_th_hmlt, z_rr_hmlt, z_cr_hmlt, z_ch_hmlt,             &amp;</div>
<div class="line"><a name="l01457"></a><span class="lineno"> 1457</span>&#160;                            za_th, za_rv, za_rc, za_cc, za_rr, za_cr,               &amp;</div>
<div class="line"><a name="l01458"></a><span class="lineno"> 1458</span>&#160;                            za_ri, za_ci, za_rs, za_cs, za_rg, za_cg, za_rh, za_ch, &amp;</div>
<div class="line"><a name="l01459"></a><span class="lineno"> 1459</span>&#160;                            zevap1d,                                                &amp;</div>
<div class="line"><a name="l01460"></a><span class="lineno"> 1460</span>&#160;                            zcf1d, zif1d, zpf1d,                                    &amp;</div>
<div class="line"><a name="l01461"></a><span class="lineno"> 1461</span>&#160;                            zlatham_iaggs                                           )</div>
<div class="line"><a name="l01462"></a><span class="lineno"> 1462</span>&#160; </div>
<div class="line"><a name="l01463"></a><span class="lineno"> 1463</span>&#160;      <span class="comment">!</span></div>
<div class="line"><a name="l01464"></a><span class="lineno"> 1464</span>&#160;      <span class="comment">!***       4.2 Integration time</span></div>
<div class="line"><a name="l01465"></a><span class="lineno"> 1465</span>&#160;      <span class="comment">!</span></div>
<div class="line"><a name="l01466"></a><span class="lineno"> 1466</span>&#160;      <span class="comment">! If we can, we will use these tendecies until the end of the timestep</span></div>
<div class="line"><a name="l01467"></a><span class="lineno"> 1467</span>&#160;      zmaxtime(:)=ptstep-ztime1d(:) <span class="comment">! Remaining time until the end of the timestep</span></div>
<div class="line"><a name="l01468"></a><span class="lineno"> 1468</span>&#160; </div>
<div class="line"><a name="l01469"></a><span class="lineno"> 1469</span>&#160;      <span class="comment">! We need to adjust tendencies when temperature reaches 0</span></div>
<div class="line"><a name="l01470"></a><span class="lineno"> 1470</span>&#160;      <span class="keywordflow">IF</span>(<a class="code" href="namespacemodd__param__lima.html#a26311f544ad0754b05441ca002035b5e">lfeedbackt</a>) <span class="keywordflow">THEN</span></div>
<div class="line"><a name="l01471"></a><span class="lineno"> 1471</span>&#160;         <span class="comment">!Is ZB_TH enough to change temperature sign?</span></div>
<div class="line"><a name="l01472"></a><span class="lineno"> 1472</span>&#160;         <span class="keywordflow">WHERE</span>( ((ztht1d(:) - cst%XTT/zexn1d(:)) * (ztht1d(:) + zb_th(:) - cst%XTT/zexn1d(:))) &lt; 0. )</div>
<div class="line"><a name="l01473"></a><span class="lineno"> 1473</span>&#160;            zmaxtime(:)=0.</div>
<div class="line"><a name="l01474"></a><span class="lineno"> 1474</span>&#160;<span class="keywordflow">         ENDWHERE</span></div>
<div class="line"><a name="l01475"></a><span class="lineno"> 1475</span>&#160;         <span class="comment">!Can ZA_TH make temperature change of sign?</span></div>
<div class="line"><a name="l01476"></a><span class="lineno"> 1476</span>&#160;         ztime_threshold(:)=-1.</div>
<div class="line"><a name="l01477"></a><span class="lineno"> 1477</span>&#160;         <span class="keywordflow">WHERE</span>(abs(za_th(:))&gt;1.e-20)</div>
<div class="line"><a name="l01478"></a><span class="lineno"> 1478</span>&#160;            ztime_threshold(:)=(cst%XTT/zexn1d(:) - zb_th(:) - ztht1d(:))/za_th(:)</div>
<div class="line"><a name="l01479"></a><span class="lineno"> 1479</span>&#160;<span class="keywordflow">         ENDWHERE</span></div>
<div class="line"><a name="l01480"></a><span class="lineno"> 1480</span>&#160;         <span class="keywordflow">WHERE</span>(ztime_threshold(:)&gt;0.)</div>
<div class="line"><a name="l01481"></a><span class="lineno"> 1481</span>&#160;            zmaxtime(:)=min(zmaxtime(:), ztime_threshold(:))</div>
<div class="line"><a name="l01482"></a><span class="lineno"> 1482</span>&#160;<span class="keywordflow">         ENDWHERE</span></div>
<div class="line"><a name="l01483"></a><span class="lineno"> 1483</span>&#160;<span class="keywordflow">      ENDIF</span></div>
<div class="line"><a name="l01484"></a><span class="lineno"> 1484</span>&#160; </div>
<div class="line"><a name="l01485"></a><span class="lineno"> 1485</span>&#160;      <span class="comment">! We need to adjust tendencies when a species disappears</span></div>
<div class="line"><a name="l01486"></a><span class="lineno"> 1486</span>&#160;      <span class="comment">! When a species is missing, only the external tendencies can be negative (and we must keep track of it)</span></div>
<div class="line"><a name="l01487"></a><span class="lineno"> 1487</span>&#160;      <span class="keywordflow">WHERE</span>(za_rv(:)&lt;-1.e-20 .AND. zrvt1d(:)&gt;<a class="code" href="namespacemodd__param__lima.html#aefc493a9b25fa3023153181d64911a68">xrtmin</a>(1))</div>
<div class="line"><a name="l01488"></a><span class="lineno"> 1488</span>&#160;         zmaxtime(:)=min(zmaxtime(:), -(zb_rv(:)+zrvt1d(:))/za_rv(:))</div>
<div class="line"><a name="l01489"></a><span class="lineno"> 1489</span>&#160;<span class="keywordflow">      END WHERE</span></div>
<div class="line"><a name="l01490"></a><span class="lineno"> 1490</span>&#160;      <span class="keywordflow">WHERE</span>(za_rc(:)&lt;-1.e-20 .AND. zrct1d(:)&gt;<a class="code" href="namespacemodd__param__lima.html#aefc493a9b25fa3023153181d64911a68">xrtmin</a>(2))</div>
<div class="line"><a name="l01491"></a><span class="lineno"> 1491</span>&#160;         zmaxtime(:)=min(zmaxtime(:), -(zb_rc(:)+zrct1d(:))/za_rc(:))</div>
<div class="line"><a name="l01492"></a><span class="lineno"> 1492</span>&#160;<span class="keywordflow">      END WHERE</span></div>
<div class="line"><a name="l01493"></a><span class="lineno"> 1493</span>&#160;      <span class="keywordflow">WHERE</span>(za_rr(:)&lt;-1.e-20 .AND. zrrt1d(:)&gt;<a class="code" href="namespacemodd__param__lima.html#aefc493a9b25fa3023153181d64911a68">xrtmin</a>(3))</div>
<div class="line"><a name="l01494"></a><span class="lineno"> 1494</span>&#160;         zmaxtime(:)=min(zmaxtime(:), -(zb_rr(:)+zrrt1d(:))/za_rr(:))</div>
<div class="line"><a name="l01495"></a><span class="lineno"> 1495</span>&#160;<span class="keywordflow">      END WHERE</span></div>
<div class="line"><a name="l01496"></a><span class="lineno"> 1496</span>&#160;      <span class="keywordflow">WHERE</span>(za_ri(:)&lt;-1.e-20 .AND. zrit1d(:)&gt;<a class="code" href="namespacemodd__param__lima.html#aefc493a9b25fa3023153181d64911a68">xrtmin</a>(4))</div>
<div class="line"><a name="l01497"></a><span class="lineno"> 1497</span>&#160;         zmaxtime(:)=min(zmaxtime(:), -(zb_ri(:)+zrit1d(:))/za_ri(:))</div>
<div class="line"><a name="l01498"></a><span class="lineno"> 1498</span>&#160;<span class="keywordflow">      END WHERE</span></div>
<div class="line"><a name="l01499"></a><span class="lineno"> 1499</span>&#160;      <span class="keywordflow">WHERE</span>(za_rs(:)&lt;-1.e-20 .AND. zrst1d(:)&gt;<a class="code" href="namespacemodd__param__lima.html#aefc493a9b25fa3023153181d64911a68">xrtmin</a>(5))</div>
<div class="line"><a name="l01500"></a><span class="lineno"> 1500</span>&#160;         zmaxtime(:)=min(zmaxtime(:), -(zb_rs(:)+zrst1d(:))/za_rs(:))</div>
<div class="line"><a name="l01501"></a><span class="lineno"> 1501</span>&#160;<span class="keywordflow">      END WHERE</span></div>
<div class="line"><a name="l01502"></a><span class="lineno"> 1502</span>&#160;      <span class="keywordflow">WHERE</span>(za_rg(:)&lt;-1.e-20 .AND. zrgt1d(:)&gt;<a class="code" href="namespacemodd__param__lima.html#aefc493a9b25fa3023153181d64911a68">xrtmin</a>(6))</div>
<div class="line"><a name="l01503"></a><span class="lineno"> 1503</span>&#160;         zmaxtime(:)=min(zmaxtime(:), -(zb_rg(:)+zrgt1d(:))/za_rg(:))</div>
<div class="line"><a name="l01504"></a><span class="lineno"> 1504</span>&#160;<span class="keywordflow">      END WHERE</span></div>
<div class="line"><a name="l01505"></a><span class="lineno"> 1505</span>&#160;      <span class="keywordflow">WHERE</span>(za_rh(:)&lt;-1.e-20 .AND. zrht1d(:)&gt;<a class="code" href="namespacemodd__param__lima.html#aefc493a9b25fa3023153181d64911a68">xrtmin</a>(7))</div>
<div class="line"><a name="l01506"></a><span class="lineno"> 1506</span>&#160;         zmaxtime(:)=min(zmaxtime(:), -(zb_rh(:)+zrht1d(:))/za_rh(:))</div>
<div class="line"><a name="l01507"></a><span class="lineno"> 1507</span>&#160;<span class="keywordflow">      END WHERE</span></div>
<div class="line"><a name="l01508"></a><span class="lineno"> 1508</span>&#160; </div>
<div class="line"><a name="l01509"></a><span class="lineno"> 1509</span>&#160;      <span class="comment">! We stop when the end of the timestep is reached</span></div>
<div class="line"><a name="l01510"></a><span class="lineno"> 1510</span>&#160;      <span class="keywordflow">WHERE</span>(ptstep-ztime1d(:)-zmaxtime(:)&lt;=0.)</div>
<div class="line"><a name="l01511"></a><span class="lineno"> 1511</span>&#160;         llcompute1d(:)=.false.</div>
<div class="line"><a name="l01512"></a><span class="lineno"> 1512</span>&#160;<span class="keywordflow">      ENDWHERE</span></div>
<div class="line"><a name="l01513"></a><span class="lineno"> 1513</span>&#160; </div>
<div class="line"><a name="l01514"></a><span class="lineno"> 1514</span>&#160;      <span class="comment">! We must recompute tendencies when the end of the sub-timestep is reached</span></div>
<div class="line"><a name="l01515"></a><span class="lineno"> 1515</span>&#160;      <span class="keywordflow">IF</span>(<a class="code" href="namespacemodd__param__lima.html#aaad997be2c66fe3610699ba4c79f46f4">xtstep_ts</a>/=0.) <span class="keywordflow">THEN</span></div>
<div class="line"><a name="l01516"></a><span class="lineno"> 1516</span>&#160;         <span class="keywordflow">WHERE</span>(iiter1d(:)&lt;inb_iter_max .AND. ztime1d(:)+zmaxtime(:)&gt;ztime_lastcall1d(:)+ztstep)</div>
<div class="line"><a name="l01517"></a><span class="lineno"> 1517</span>&#160;            zmaxtime(:)=ztime_lastcall1d(:)-ztime1d(:)+ztstep</div>
<div class="line"><a name="l01518"></a><span class="lineno"> 1518</span>&#160;            llcompute1d(:)=.false.</div>
<div class="line"><a name="l01519"></a><span class="lineno"> 1519</span>&#160;<span class="keywordflow">         ENDWHERE</span></div>
<div class="line"><a name="l01520"></a><span class="lineno"> 1520</span>&#160;<span class="keywordflow">      ENDIF</span></div>
<div class="line"><a name="l01521"></a><span class="lineno"> 1521</span>&#160; </div>
<div class="line"><a name="l01522"></a><span class="lineno"> 1522</span>&#160;      <span class="comment">! We must recompute tendencies when the maximum allowed change is reached</span></div>
<div class="line"><a name="l01523"></a><span class="lineno"> 1523</span>&#160;      <span class="comment">! When a species is missing, only the external tendencies can be active and we do not want to recompute</span></div>
<div class="line"><a name="l01524"></a><span class="lineno"> 1524</span>&#160;      <span class="comment">! the microphysical tendencies when external tendencies are negative (results won&#39;t change because species was already missing)</span></div>
<div class="line"><a name="l01525"></a><span class="lineno"> 1525</span>&#160;      <span class="keywordflow">IF</span>(<a class="code" href="namespacemodd__param__lima.html#ac8bffc7c7ac478bc8ec56c0d66c22ca6">xmrstep</a>/=0.) <span class="keywordflow">THEN</span></div>
<div class="line"><a name="l01526"></a><span class="lineno"> 1526</span>&#160;         ztime_threshold(:)=-1.</div>
<div class="line"><a name="l01527"></a><span class="lineno"> 1527</span>&#160;         <span class="keywordflow">WHERE</span>(iiter1d(:)&lt;inb_iter_max .AND. abs(za_rv(:))&gt;1.e-20)</div>
<div class="line"><a name="l01528"></a><span class="lineno"> 1528</span>&#160;            ztime_threshold(:)=(sign(1., za_rv(:))*<a class="code" href="namespacemodd__param__lima.html#ac8bffc7c7ac478bc8ec56c0d66c22ca6">xmrstep</a>+z0rvt1d(:)-zrvt1d(:)-zb_rv(:))/za_rv(:)</div>
<div class="line"><a name="l01529"></a><span class="lineno"> 1529</span>&#160;<span class="keywordflow">         ENDWHERE</span></div>
<div class="line"><a name="l01530"></a><span class="lineno"> 1530</span>&#160;         <span class="keywordflow">WHERE</span>(ztime_threshold(:)&gt;=0. .AND. ztime_threshold(:)&lt;zmaxtime(:) .AND. &amp;</div>
<div class="line"><a name="l01531"></a><span class="lineno"> 1531</span>&#160;              &amp;(zrvt1d(:)&gt;<a class="code" href="namespacemodd__param__lima.html#aefc493a9b25fa3023153181d64911a68">xrtmin</a>(1) .OR. za_rv(:)&gt;0.))</div>
<div class="line"><a name="l01532"></a><span class="lineno"> 1532</span>&#160;            zmaxtime(:)=min(zmaxtime(:), ztime_threshold(:))</div>
<div class="line"><a name="l01533"></a><span class="lineno"> 1533</span>&#160;            llcompute1d(:)=.false.</div>
<div class="line"><a name="l01534"></a><span class="lineno"> 1534</span>&#160;<span class="keywordflow">         ENDWHERE</span></div>
<div class="line"><a name="l01535"></a><span class="lineno"> 1535</span>&#160; </div>
<div class="line"><a name="l01536"></a><span class="lineno"> 1536</span>&#160;         ztime_threshold(:)=-1.</div>
<div class="line"><a name="l01537"></a><span class="lineno"> 1537</span>&#160;         <span class="keywordflow">WHERE</span>(iiter1d(:)&lt;inb_iter_max .AND. abs(za_rc(:))&gt;1.e-20)</div>
<div class="line"><a name="l01538"></a><span class="lineno"> 1538</span>&#160;            ztime_threshold(:)=(sign(1., za_rc(:))*<a class="code" href="namespacemodd__param__lima.html#ac8bffc7c7ac478bc8ec56c0d66c22ca6">xmrstep</a>+z0rct1d(:)-zrct1d(:)-zb_rc(:))/za_rc(:)</div>
<div class="line"><a name="l01539"></a><span class="lineno"> 1539</span>&#160;<span class="keywordflow">         ENDWHERE</span></div>
<div class="line"><a name="l01540"></a><span class="lineno"> 1540</span>&#160;         <span class="keywordflow">WHERE</span>(ztime_threshold(:)&gt;=0. .AND. ztime_threshold(:)&lt;zmaxtime(:) .AND. &amp;</div>
<div class="line"><a name="l01541"></a><span class="lineno"> 1541</span>&#160;              &amp;(zrct1d(:)&gt;<a class="code" href="namespacemodd__param__lima.html#aefc493a9b25fa3023153181d64911a68">xrtmin</a>(2) .OR. za_rc(:)&gt;0.))</div>
<div class="line"><a name="l01542"></a><span class="lineno"> 1542</span>&#160;            zmaxtime(:)=min(zmaxtime(:), ztime_threshold(:))</div>
<div class="line"><a name="l01543"></a><span class="lineno"> 1543</span>&#160;            llcompute1d(:)=.false.</div>
<div class="line"><a name="l01544"></a><span class="lineno"> 1544</span>&#160;<span class="keywordflow">         ENDWHERE</span></div>
<div class="line"><a name="l01545"></a><span class="lineno"> 1545</span>&#160; </div>
<div class="line"><a name="l01546"></a><span class="lineno"> 1546</span>&#160;         ztime_threshold(:)=-1.</div>
<div class="line"><a name="l01547"></a><span class="lineno"> 1547</span>&#160;         <span class="keywordflow">WHERE</span>(iiter1d(:)&lt;inb_iter_max .AND. abs(za_rr(:))&gt;1.e-20)</div>
<div class="line"><a name="l01548"></a><span class="lineno"> 1548</span>&#160;            ztime_threshold(:)=(sign(1., za_rr(:))*<a class="code" href="namespacemodd__param__lima.html#ac8bffc7c7ac478bc8ec56c0d66c22ca6">xmrstep</a>+z0rrt1d(:)-zrrt1d(:)-zb_rr(:))/za_rr(:)</div>
<div class="line"><a name="l01549"></a><span class="lineno"> 1549</span>&#160;<span class="keywordflow">         ENDWHERE</span></div>
<div class="line"><a name="l01550"></a><span class="lineno"> 1550</span>&#160;         <span class="keywordflow">WHERE</span>(ztime_threshold(:)&gt;=0. .AND. ztime_threshold(:)&lt;zmaxtime(:) .AND. &amp;</div>
<div class="line"><a name="l01551"></a><span class="lineno"> 1551</span>&#160;              &amp;(zrrt1d(:)&gt;<a class="code" href="namespacemodd__param__lima.html#aefc493a9b25fa3023153181d64911a68">xrtmin</a>(3) .OR. za_rr(:)&gt;0.))</div>
<div class="line"><a name="l01552"></a><span class="lineno"> 1552</span>&#160;            zmaxtime(:)=min(zmaxtime(:), ztime_threshold(:))</div>
<div class="line"><a name="l01553"></a><span class="lineno"> 1553</span>&#160;            llcompute1d(:)=.false.</div>
<div class="line"><a name="l01554"></a><span class="lineno"> 1554</span>&#160;<span class="keywordflow">         ENDWHERE</span></div>
<div class="line"><a name="l01555"></a><span class="lineno"> 1555</span>&#160; </div>
<div class="line"><a name="l01556"></a><span class="lineno"> 1556</span>&#160;         ztime_threshold(:)=-1.</div>
<div class="line"><a name="l01557"></a><span class="lineno"> 1557</span>&#160;         <span class="keywordflow">WHERE</span>(iiter1d(:)&lt;inb_iter_max .AND. abs(za_ri(:))&gt;1.e-20)</div>
<div class="line"><a name="l01558"></a><span class="lineno"> 1558</span>&#160;            ztime_threshold(:)=(sign(1., za_ri(:))*<a class="code" href="namespacemodd__param__lima.html#ac8bffc7c7ac478bc8ec56c0d66c22ca6">xmrstep</a>+z0rit1d(:)-zrit1d(:)-zb_ri(:))/za_ri(:)</div>
<div class="line"><a name="l01559"></a><span class="lineno"> 1559</span>&#160;<span class="keywordflow">         ENDWHERE</span></div>
<div class="line"><a name="l01560"></a><span class="lineno"> 1560</span>&#160;         <span class="keywordflow">WHERE</span>(ztime_threshold(:)&gt;=0. .AND. ztime_threshold(:)&lt;zmaxtime(:) .AND. &amp;</div>
<div class="line"><a name="l01561"></a><span class="lineno"> 1561</span>&#160;              &amp;(zrit1d(:)&gt;<a class="code" href="namespacemodd__param__lima.html#aefc493a9b25fa3023153181d64911a68">xrtmin</a>(4) .OR. za_ri(:)&gt;0.))</div>
<div class="line"><a name="l01562"></a><span class="lineno"> 1562</span>&#160;            zmaxtime(:)=min(zmaxtime(:), ztime_threshold(:))</div>
<div class="line"><a name="l01563"></a><span class="lineno"> 1563</span>&#160;            llcompute1d(:)=.false.</div>
<div class="line"><a name="l01564"></a><span class="lineno"> 1564</span>&#160;<span class="keywordflow">         ENDWHERE</span></div>
<div class="line"><a name="l01565"></a><span class="lineno"> 1565</span>&#160; </div>
<div class="line"><a name="l01566"></a><span class="lineno"> 1566</span>&#160;         ztime_threshold(:)=-1.</div>
<div class="line"><a name="l01567"></a><span class="lineno"> 1567</span>&#160;         <span class="keywordflow">WHERE</span>(iiter1d(:)&lt;inb_iter_max .AND. abs(za_rs(:))&gt;1.e-20)</div>
<div class="line"><a name="l01568"></a><span class="lineno"> 1568</span>&#160;            ztime_threshold(:)=(sign(1., za_rs(:))*<a class="code" href="namespacemodd__param__lima.html#ac8bffc7c7ac478bc8ec56c0d66c22ca6">xmrstep</a>+z0rst1d(:)-zrst1d(:)-zb_rs(:))/za_rs(:)</div>
<div class="line"><a name="l01569"></a><span class="lineno"> 1569</span>&#160;<span class="keywordflow">         ENDWHERE</span></div>
<div class="line"><a name="l01570"></a><span class="lineno"> 1570</span>&#160;         <span class="keywordflow">WHERE</span>(ztime_threshold(:)&gt;=0. .AND. ztime_threshold(:)&lt;zmaxtime(:) .AND. &amp;</div>
<div class="line"><a name="l01571"></a><span class="lineno"> 1571</span>&#160;              &amp;(zrst1d(:)&gt;<a class="code" href="namespacemodd__param__lima.html#aefc493a9b25fa3023153181d64911a68">xrtmin</a>(5) .OR. za_rs(:)&gt;0.))</div>
<div class="line"><a name="l01572"></a><span class="lineno"> 1572</span>&#160;            zmaxtime(:)=min(zmaxtime(:), ztime_threshold(:))</div>
<div class="line"><a name="l01573"></a><span class="lineno"> 1573</span>&#160;            llcompute1d(:)=.false.</div>
<div class="line"><a name="l01574"></a><span class="lineno"> 1574</span>&#160;<span class="keywordflow">         ENDWHERE</span></div>
<div class="line"><a name="l01575"></a><span class="lineno"> 1575</span>&#160; </div>
<div class="line"><a name="l01576"></a><span class="lineno"> 1576</span>&#160;         ztime_threshold(:)=-1.</div>
<div class="line"><a name="l01577"></a><span class="lineno"> 1577</span>&#160;         <span class="keywordflow">WHERE</span>(iiter1d(:)&lt;inb_iter_max .AND. abs(za_rg(:))&gt;1.e-20)</div>
<div class="line"><a name="l01578"></a><span class="lineno"> 1578</span>&#160;            ztime_threshold(:)=(sign(1., za_rg(:))*<a class="code" href="namespacemodd__param__lima.html#ac8bffc7c7ac478bc8ec56c0d66c22ca6">xmrstep</a>+z0rgt1d(:)-zrgt1d(:)-zb_rg(:))/za_rg(:)</div>
<div class="line"><a name="l01579"></a><span class="lineno"> 1579</span>&#160;<span class="keywordflow">         ENDWHERE</span></div>
<div class="line"><a name="l01580"></a><span class="lineno"> 1580</span>&#160;         <span class="keywordflow">WHERE</span>(ztime_threshold(:)&gt;=0. .AND. ztime_threshold(:)&lt;zmaxtime(:) .AND. &amp;</div>
<div class="line"><a name="l01581"></a><span class="lineno"> 1581</span>&#160;              &amp;(zrgt1d(:)&gt;<a class="code" href="namespacemodd__param__lima.html#aefc493a9b25fa3023153181d64911a68">xrtmin</a>(6) .OR. za_rg(:)&gt;0.))</div>
<div class="line"><a name="l01582"></a><span class="lineno"> 1582</span>&#160;            zmaxtime(:)=min(zmaxtime(:), ztime_threshold(:))</div>
<div class="line"><a name="l01583"></a><span class="lineno"> 1583</span>&#160;            llcompute1d(:)=.false.</div>
<div class="line"><a name="l01584"></a><span class="lineno"> 1584</span>&#160;<span class="keywordflow">         ENDWHERE</span></div>
<div class="line"><a name="l01585"></a><span class="lineno"> 1585</span>&#160; </div>
<div class="line"><a name="l01586"></a><span class="lineno"> 1586</span>&#160;         ztime_threshold(:)=-1.</div>
<div class="line"><a name="l01587"></a><span class="lineno"> 1587</span>&#160;         <span class="keywordflow">WHERE</span>(iiter1d(:)&lt;inb_iter_max .AND. abs(za_rh(:))&gt;1.e-20)</div>
<div class="line"><a name="l01588"></a><span class="lineno"> 1588</span>&#160;            ztime_threshold(:)=(sign(1., za_rh(:))*<a class="code" href="namespacemodd__param__lima.html#ac8bffc7c7ac478bc8ec56c0d66c22ca6">xmrstep</a>+z0rht1d(:)-zrht1d(:)-zb_rh(:))/za_rh(:)</div>
<div class="line"><a name="l01589"></a><span class="lineno"> 1589</span>&#160;<span class="keywordflow">         ENDWHERE</span></div>
<div class="line"><a name="l01590"></a><span class="lineno"> 1590</span>&#160;         <span class="keywordflow">WHERE</span>(ztime_threshold(:)&gt;=0. .AND. ztime_threshold(:)&lt;zmaxtime(:) .AND. &amp;</div>
<div class="line"><a name="l01591"></a><span class="lineno"> 1591</span>&#160;              &amp;(zrht1d(:)&gt;<a class="code" href="namespacemodd__param__lima.html#aefc493a9b25fa3023153181d64911a68">xrtmin</a>(7) .OR. za_rh(:)&gt;0.))</div>
<div class="line"><a name="l01592"></a><span class="lineno"> 1592</span>&#160;            zmaxtime(:)=min(zmaxtime(:), ztime_threshold(:))</div>
<div class="line"><a name="l01593"></a><span class="lineno"> 1593</span>&#160;            llcompute1d(:)=.false.</div>
<div class="line"><a name="l01594"></a><span class="lineno"> 1594</span>&#160;<span class="keywordflow">         ENDWHERE</span></div>
<div class="line"><a name="l01595"></a><span class="lineno"> 1595</span>&#160; </div>
<div class="line"><a name="l01596"></a><span class="lineno"> 1596</span>&#160;         <span class="keywordflow">WHERE</span>(iiter1d(:)&lt;inb_iter_max .AND. max(abs(zb_rv(:)),  &amp;</div>
<div class="line"><a name="l01597"></a><span class="lineno"> 1597</span>&#160;              abs(zb_rc(:)), abs(zb_rr(:)), abs(zb_ri(:)), &amp;</div>
<div class="line"><a name="l01598"></a><span class="lineno"> 1598</span>&#160;              abs(zb_rs(:)), abs(zb_rg(:)), abs(zb_rh(:)))&gt;<a class="code" href="namespacemodd__param__lima.html#ac8bffc7c7ac478bc8ec56c0d66c22ca6">xmrstep</a>)</div>
<div class="line"><a name="l01599"></a><span class="lineno"> 1599</span>&#160;            zmaxtime(:)=0.</div>
<div class="line"><a name="l01600"></a><span class="lineno"> 1600</span>&#160;            llcompute1d(:)=.false.</div>
<div class="line"><a name="l01601"></a><span class="lineno"> 1601</span>&#160;<span class="keywordflow">         ENDWHERE</span></div>
<div class="line"><a name="l01602"></a><span class="lineno"> 1602</span>&#160;<span class="keywordflow">      ENDIF</span></div>
<div class="line"><a name="l01603"></a><span class="lineno"> 1603</span>&#160;      <span class="comment">!</span></div>
<div class="line"><a name="l01604"></a><span class="lineno"> 1604</span>&#160;      <span class="comment">!***       4.3 New values of variables for next iteration</span></div>
<div class="line"><a name="l01605"></a><span class="lineno"> 1605</span>&#160;      <span class="comment">!</span></div>
<div class="line"><a name="l01606"></a><span class="lineno"> 1606</span>&#160;      ztht1d = ztht1d + za_th(:) * zmaxtime(:) + zb_th(:)</div>
<div class="line"><a name="l01607"></a><span class="lineno"> 1607</span>&#160;      zrvt1d = zrvt1d + za_rv(:) * zmaxtime(:) + zb_rv(:)</div>
<div class="line"><a name="l01608"></a><span class="lineno"> 1608</span>&#160;      zrct1d = zrct1d + za_rc(:) * zmaxtime(:) + zb_rc(:)</div>
<div class="line"><a name="l01609"></a><span class="lineno"> 1609</span>&#160;      <span class="keywordflow">IF</span> (<a class="code" href="namespacemodd__param__lima.html#ab0c8298b017b75cbd419d8b1980b0053">nmom_c</a>.GE.2) zcct1d = zcct1d + za_cc(:) * zmaxtime(:) + zb_cc(:)</div>
<div class="line"><a name="l01610"></a><span class="lineno"> 1610</span>&#160;      zrrt1d = zrrt1d + za_rr(:) * zmaxtime(:) + zb_rr(:)</div>
<div class="line"><a name="l01611"></a><span class="lineno"> 1611</span>&#160;      <span class="keywordflow">IF</span> (<a class="code" href="namespacemodd__param__lima.html#a7accc5c4a0a391c040a1de5e966eea04">nmom_r</a>.GE.2) zcrt1d = zcrt1d + za_cr(:) * zmaxtime(:) + zb_cr(:)</div>
<div class="line"><a name="l01612"></a><span class="lineno"> 1612</span>&#160;      zrit1d = zrit1d + za_ri(:) * zmaxtime(:) + zb_ri(:)</div>
<div class="line"><a name="l01613"></a><span class="lineno"> 1613</span>&#160;      <span class="keywordflow">IF</span> (<a class="code" href="namespacemodd__param__lima.html#ab11c5caa054b5039171a4f10908abea1">nmom_i</a>.GE.2) zcit1d = zcit1d + za_ci(:) * zmaxtime(:) + zb_ci(:)</div>
<div class="line"><a name="l01614"></a><span class="lineno"> 1614</span>&#160;      zrst1d = zrst1d + za_rs(:) * zmaxtime(:) + zb_rs(:)</div>
<div class="line"><a name="l01615"></a><span class="lineno"> 1615</span>&#160;      <span class="keywordflow">IF</span> (<a class="code" href="namespacemodd__param__lima.html#a63b4f80fe043e01602ef78b2caf0e487">nmom_s</a>.GE.2) zcst1d = zcst1d + za_cs(:) * zmaxtime(:) + zb_cs(:)</div>
<div class="line"><a name="l01616"></a><span class="lineno"> 1616</span>&#160;      zrgt1d = zrgt1d + za_rg(:) * zmaxtime(:) + zb_rg(:)</div>
<div class="line"><a name="l01617"></a><span class="lineno"> 1617</span>&#160;      <span class="keywordflow">IF</span> (<a class="code" href="namespacemodd__param__lima.html#acd76d6876dec7668fc081a4380690182">nmom_g</a>.GE.2) zcgt1d = zcgt1d + za_cg(:) * zmaxtime(:) + zb_cg(:)</div>
<div class="line"><a name="l01618"></a><span class="lineno"> 1618</span>&#160;      zrht1d = zrht1d + za_rh(:) * zmaxtime(:) + zb_rh(:)</div>
<div class="line"><a name="l01619"></a><span class="lineno"> 1619</span>&#160;      <span class="keywordflow">IF</span> (<a class="code" href="namespacemodd__param__lima.html#a8a40a50a7778130438208e2974634384">nmom_h</a>.GE.2) zcht1d = zcht1d + za_ch(:) * zmaxtime(:) + zb_ch(:)</div>
<div class="line"><a name="l01620"></a><span class="lineno"> 1620</span>&#160;      <span class="comment">!</span></div>
<div class="line"><a name="l01621"></a><span class="lineno"> 1621</span>&#160;      <span class="keywordflow">DO</span> ii=1,<a class="code" href="namespacemodd__param__lima.html#a2b98a3f23053acfd971d523a0778f209">nmod_ifn</a></div>
<div class="line"><a name="l01622"></a><span class="lineno"> 1622</span>&#160;         zifnn1d(:,ii) = zifnn1d(:,ii) + zb_ifnn(:,ii)</div>
<div class="line"><a name="l01623"></a><span class="lineno"> 1623</span>&#160;<span class="keywordflow">      END DO</span></div>
<div class="line"><a name="l01624"></a><span class="lineno"> 1624</span>&#160;      <span class="comment">!</span></div>
<div class="line"><a name="l01625"></a><span class="lineno"> 1625</span>&#160;      <span class="comment">!***       4.5 </span></div>
<div class="line"><a name="l01626"></a><span class="lineno"> 1626</span>&#160;      <span class="comment">!</span></div>
<div class="line"><a name="l01627"></a><span class="lineno"> 1627</span>&#160;      <span class="keywordflow">WHERE</span> (zrct1d .LE. <a class="code" href="namespacemodd__param__lima.html#aefc493a9b25fa3023153181d64911a68">xrtmin</a>(2))</div>
<div class="line"><a name="l01628"></a><span class="lineno"> 1628</span>&#160;         z_rv_corr2(:) = zrct1d(:)</div>
<div class="line"><a name="l01629"></a><span class="lineno"> 1629</span>&#160;         z_rc_corr2(:) = -zrct1d(:)</div>
<div class="line"><a name="l01630"></a><span class="lineno"> 1630</span>&#160;         z_cc_corr2(:) = -zcct1d(:)</div>
<div class="line"><a name="l01631"></a><span class="lineno"> 1631</span>&#160; </div>
<div class="line"><a name="l01632"></a><span class="lineno"> 1632</span>&#160;         zrvt1d = zrvt1d + zrct1d</div>
<div class="line"><a name="l01633"></a><span class="lineno"> 1633</span>&#160;         zrct1d = 0.</div>
<div class="line"><a name="l01634"></a><span class="lineno"> 1634</span>&#160;         zcct1d = 0.</div>
<div class="line"><a name="l01635"></a><span class="lineno"> 1635</span>&#160;<span class="keywordflow">      END WHERE</span></div>
<div class="line"><a name="l01636"></a><span class="lineno"> 1636</span>&#160;      <span class="keywordflow">WHERE</span> (zrrt1d .LE. <a class="code" href="namespacemodd__param__lima.html#aefc493a9b25fa3023153181d64911a68">xrtmin</a>(3))</div>
<div class="line"><a name="l01637"></a><span class="lineno"> 1637</span>&#160;         z_rv_corr2(:) = z_rv_corr2(:) + zrrt1d(:)</div>
<div class="line"><a name="l01638"></a><span class="lineno"> 1638</span>&#160;         z_rr_corr2(:) = -zrrt1d(:)</div>
<div class="line"><a name="l01639"></a><span class="lineno"> 1639</span>&#160;         z_cr_corr2(:) = -zcrt1d(:)</div>
<div class="line"><a name="l01640"></a><span class="lineno"> 1640</span>&#160; </div>
<div class="line"><a name="l01641"></a><span class="lineno"> 1641</span>&#160;         zrvt1d = zrvt1d + zrrt1d</div>
<div class="line"><a name="l01642"></a><span class="lineno"> 1642</span>&#160;         zrrt1d = 0.</div>
<div class="line"><a name="l01643"></a><span class="lineno"> 1643</span>&#160;         zcrt1d = 0.</div>
<div class="line"><a name="l01644"></a><span class="lineno"> 1644</span>&#160;<span class="keywordflow">      END WHERE</span></div>
<div class="line"><a name="l01645"></a><span class="lineno"> 1645</span>&#160;      <span class="keywordflow">WHERE</span> (zrit1d .LE. <a class="code" href="namespacemodd__param__lima.html#aefc493a9b25fa3023153181d64911a68">xrtmin</a>(4))</div>
<div class="line"><a name="l01646"></a><span class="lineno"> 1646</span>&#160;         z_rv_corr2(:) = z_rv_corr2(:) + zrit1d(:)</div>
<div class="line"><a name="l01647"></a><span class="lineno"> 1647</span>&#160;         z_ri_corr2(:) = -zrit1d(:)</div>
<div class="line"><a name="l01648"></a><span class="lineno"> 1648</span>&#160;         z_ci_corr2(:) = -zcit1d(:)</div>
<div class="line"><a name="l01649"></a><span class="lineno"> 1649</span>&#160; </div>
<div class="line"><a name="l01650"></a><span class="lineno"> 1650</span>&#160;         zrvt1d = zrvt1d + zrit1d</div>
<div class="line"><a name="l01651"></a><span class="lineno"> 1651</span>&#160;         zrit1d = 0.</div>
<div class="line"><a name="l01652"></a><span class="lineno"> 1652</span>&#160;         zcit1d = 0.</div>
<div class="line"><a name="l01653"></a><span class="lineno"> 1653</span>&#160;<span class="keywordflow">      END WHERE</span>      </div>
<div class="line"><a name="l01654"></a><span class="lineno"> 1654</span>&#160;      <span class="comment">!</span></div>
<div class="line"><a name="l01655"></a><span class="lineno"> 1655</span>&#160;      <span class="comment">!***       4.5 Next loop</span></div>
<div class="line"><a name="l01656"></a><span class="lineno"> 1656</span>&#160;      <span class="comment">!</span></div>
<div class="line"><a name="l01657"></a><span class="lineno"> 1657</span>&#160;      ztime1d(:)=ztime1d(:)+zmaxtime(:)</div>
<div class="line"><a name="l01658"></a><span class="lineno"> 1658</span>&#160;      <span class="comment">!</span></div>
<div class="line"><a name="l01659"></a><span class="lineno"> 1659</span>&#160;      <span class="comment">!***       4.4 Unpacking</span></div>
<div class="line"><a name="l01660"></a><span class="lineno"> 1660</span>&#160;      <span class="comment">!</span></div>
<div class="line"><a name="l01661"></a><span class="lineno"> 1661</span>&#160;      <span class="keywordflow">DO</span> ii=1,ipack</div>
<div class="line"><a name="l01662"></a><span class="lineno"> 1662</span>&#160;         ztht(i1(ii),i2(ii),i3(ii))      = ztht1d(ii)</div>
<div class="line"><a name="l01663"></a><span class="lineno"> 1663</span>&#160;         zrvt(i1(ii),i2(ii),i3(ii))      = zrvt1d(ii)</div>
<div class="line"><a name="l01664"></a><span class="lineno"> 1664</span>&#160;         zrct(i1(ii),i2(ii),i3(ii))      = zrct1d(ii)</div>
<div class="line"><a name="l01665"></a><span class="lineno"> 1665</span>&#160;         zrrt(i1(ii),i2(ii),i3(ii))      = zrrt1d(ii)</div>
<div class="line"><a name="l01666"></a><span class="lineno"> 1666</span>&#160;         zrit(i1(ii),i2(ii),i3(ii))      = zrit1d(ii)</div>
<div class="line"><a name="l01667"></a><span class="lineno"> 1667</span>&#160;         zrst(i1(ii),i2(ii),i3(ii))      = zrst1d(ii)</div>
<div class="line"><a name="l01668"></a><span class="lineno"> 1668</span>&#160;         zrgt(i1(ii),i2(ii),i3(ii))      = zrgt1d(ii)</div>
<div class="line"><a name="l01669"></a><span class="lineno"> 1669</span>&#160;         zrht(i1(ii),i2(ii),i3(ii))      = zrht1d(ii)</div>
<div class="line"><a name="l01670"></a><span class="lineno"> 1670</span>&#160;         <span class="keywordflow">IF</span> (<a class="code" href="namespacemodd__param__lima.html#ab0c8298b017b75cbd419d8b1980b0053">nmom_c</a>.GE.2) zcct(i1(ii),i2(ii),i3(ii))      = zcct1d(ii)</div>
<div class="line"><a name="l01671"></a><span class="lineno"> 1671</span>&#160;         <span class="keywordflow">IF</span> (<a class="code" href="namespacemodd__param__lima.html#a7accc5c4a0a391c040a1de5e966eea04">nmom_r</a>.GE.2) zcrt(i1(ii),i2(ii),i3(ii))      = zcrt1d(ii)</div>
<div class="line"><a name="l01672"></a><span class="lineno"> 1672</span>&#160;         <span class="keywordflow">IF</span> (<a class="code" href="namespacemodd__param__lima.html#ab11c5caa054b5039171a4f10908abea1">nmom_i</a>.GE.2) zcit(i1(ii),i2(ii),i3(ii))      = zcit1d(ii)</div>
<div class="line"><a name="l01673"></a><span class="lineno"> 1673</span>&#160;         <span class="keywordflow">IF</span> (<a class="code" href="namespacemodd__param__lima.html#a63b4f80fe043e01602ef78b2caf0e487">nmom_s</a>.GE.2) zcst(i1(ii),i2(ii),i3(ii))      = zcst1d(ii)</div>
<div class="line"><a name="l01674"></a><span class="lineno"> 1674</span>&#160;         <span class="keywordflow">IF</span> (<a class="code" href="namespacemodd__param__lima.html#acd76d6876dec7668fc081a4380690182">nmom_g</a>.GE.2) zcgt(i1(ii),i2(ii),i3(ii))      = zcgt1d(ii)</div>
<div class="line"><a name="l01675"></a><span class="lineno"> 1675</span>&#160;         <span class="keywordflow">IF</span> (<a class="code" href="namespacemodd__param__lima.html#a8a40a50a7778130438208e2974634384">nmom_h</a>.GE.2) zcht(i1(ii),i2(ii),i3(ii))      = zcht1d(ii)</div>
<div class="line"><a name="l01676"></a><span class="lineno"> 1676</span>&#160;         zifnnt(i1(ii),i2(ii),i3(ii),:)  = zifnn1d(ii,:)</div>
<div class="line"><a name="l01677"></a><span class="lineno"> 1677</span>&#160;         pevap3d(i1(ii),i2(ii),i3(ii))   = zevap1d(ii)</div>
<div class="line"><a name="l01678"></a><span class="lineno"> 1678</span>&#160;         ztime(i1(ii),i2(ii),i3(ii))     = ztime1d(ii)</div>
<div class="line"><a name="l01679"></a><span class="lineno"> 1679</span>&#160;         llcompute(i1(ii),i2(ii),i3(ii)) = llcompute1d(ii)</div>
<div class="line"><a name="l01680"></a><span class="lineno"> 1680</span>&#160;         iiter(i1(ii),i2(ii),i3(ii))     = iiter1d(ii)</div>
<div class="line"><a name="l01681"></a><span class="lineno"> 1681</span>&#160;<span class="keywordflow">      END DO</span></div>
<div class="line"><a name="l01682"></a><span class="lineno"> 1682</span>&#160;      <span class="comment">!</span></div>
<div class="line"><a name="l01683"></a><span class="lineno"> 1683</span>&#160;<span class="comment">!!$      IF (NMOM_C.GE.2 .AND. NMOM_R.GE.2) THEN</span></div>
<div class="line"><a name="l01684"></a><span class="lineno"> 1684</span>&#160;<span class="comment">!!$         CALL LIMA_DROPS_TO_DROPLETS_CONV(PRHODREF, ZRCT, ZRRT, ZCCT, ZCRT, &amp;</span></div>
<div class="line"><a name="l01685"></a><span class="lineno"> 1685</span>&#160;<span class="comment">!!$              Z_RR_CVRC, Z_CR_CVRC    )</span></div>
<div class="line"><a name="l01686"></a><span class="lineno"> 1686</span>&#160;<span class="comment">!!$         ZRCT(:,:,:) = ZRCT(:,:,:) - Z_RR_CVRC(:,:,:)</span></div>
<div class="line"><a name="l01687"></a><span class="lineno"> 1687</span>&#160;<span class="comment">!!$         ZRRT(:,:,:) = ZRRT(:,:,:) + Z_RR_CVRC(:,:,:)</span></div>
<div class="line"><a name="l01688"></a><span class="lineno"> 1688</span>&#160;<span class="comment">!!$         ZCCT(:,:,:) = ZCCT(:,:,:) - Z_CR_CVRC(:,:,:)</span></div>
<div class="line"><a name="l01689"></a><span class="lineno"> 1689</span>&#160;<span class="comment">!!$         ZCRT(:,:,:) = ZCRT(:,:,:) + Z_CR_CVRC(:,:,:)</span></div>
<div class="line"><a name="l01690"></a><span class="lineno"> 1690</span>&#160;<span class="comment">!!$      END IF</span></div>
<div class="line"><a name="l01691"></a><span class="lineno"> 1691</span>&#160;      <span class="comment">!</span></div>
<div class="line"><a name="l01692"></a><span class="lineno"> 1692</span>&#160;      <span class="comment">!***       4.4 Unpacking for budgets</span></div>
<div class="line"><a name="l01693"></a><span class="lineno"> 1693</span>&#160;      <span class="comment">!</span></div>
<div class="line"><a name="l01694"></a><span class="lineno"> 1694</span>&#160;      <span class="keywordflow">IF</span>(buconf%LBU_ENABLE .OR. oelec) <span class="keywordflow">THEN</span></div>
<div class="line"><a name="l01695"></a><span class="lineno"> 1695</span>&#160;        ztot_rr_cvrc(:,:,:) = ztot_rr_cvrc(:,:,:) + z_rr_cvrc(:,:,:)</div>
<div class="line"><a name="l01696"></a><span class="lineno"> 1696</span>&#160;        ztot_cr_cvrc(:,:,:) = ztot_cr_cvrc(:,:,:) + z_cr_cvrc(:,:,:)</div>
<div class="line"><a name="l01697"></a><span class="lineno"> 1697</span>&#160; </div>
<div class="line"><a name="l01698"></a><span class="lineno"> 1698</span>&#160;         <span class="keywordflow">DO</span> ii=1,ipack</div>
<div class="line"><a name="l01699"></a><span class="lineno"> 1699</span>&#160;            <span class="comment">! Instantaneous processes</span></div>
<div class="line"><a name="l01700"></a><span class="lineno"> 1700</span>&#160;            ztot_cr_brku(i1(ii),i2(ii),i3(ii)) =   ztot_cr_brku(i1(ii),i2(ii),i3(ii))   + z_cr_brku(ii)</div>
<div class="line"><a name="l01701"></a><span class="lineno"> 1701</span>&#160;            ztot_th_honr(i1(ii),i2(ii),i3(ii)) =   ztot_th_honr(i1(ii),i2(ii),i3(ii))   + z_th_honr(ii)</div>
<div class="line"><a name="l01702"></a><span class="lineno"> 1702</span>&#160;            ztot_rr_honr(i1(ii),i2(ii),i3(ii)) =   ztot_rr_honr(i1(ii),i2(ii),i3(ii))   + z_rr_honr(ii)</div>
<div class="line"><a name="l01703"></a><span class="lineno"> 1703</span>&#160;            ztot_cr_honr(i1(ii),i2(ii),i3(ii)) =   ztot_cr_honr(i1(ii),i2(ii),i3(ii))   + z_cr_honr(ii)</div>
<div class="line"><a name="l01704"></a><span class="lineno"> 1704</span>&#160;            ztot_th_imlt(i1(ii),i2(ii),i3(ii)) =   ztot_th_imlt(i1(ii),i2(ii),i3(ii))   + z_th_imlt(ii)</div>
<div class="line"><a name="l01705"></a><span class="lineno"> 1705</span>&#160;            ztot_rc_imlt(i1(ii),i2(ii),i3(ii)) =   ztot_rc_imlt(i1(ii),i2(ii),i3(ii))   + z_rc_imlt(ii)</div>
<div class="line"><a name="l01706"></a><span class="lineno"> 1706</span>&#160;            ztot_cc_imlt(i1(ii),i2(ii),i3(ii)) =   ztot_cc_imlt(i1(ii),i2(ii),i3(ii))   + z_cc_imlt(ii)</div>
<div class="line"><a name="l01707"></a><span class="lineno"> 1707</span>&#160;            <span class="keywordflow">DO</span> jn = 1, <a class="code" href="namespacemodd__param__lima.html#a2b98a3f23053acfd971d523a0778f209">nmod_ifn</a></div>
<div class="line"><a name="l01708"></a><span class="lineno"> 1708</span>&#160;              ztot_ifnn_imlt(i1(ii),i2(ii),i3(ii),jn) = ztot_ifnn_imlt(i1(ii),i2(ii),i3(ii),jn) + zb_ifnn(ii,jn)</div>
<div class="line"><a name="l01709"></a><span class="lineno"> 1709</span>&#160;<span class="keywordflow">            END DO</span></div>
<div class="line"><a name="l01710"></a><span class="lineno"> 1710</span>&#160; </div>
<div class="line"><a name="l01711"></a><span class="lineno"> 1711</span>&#160;            <span class="comment">! Tendencies</span></div>
<div class="line"><a name="l01712"></a><span class="lineno"> 1712</span>&#160;            ztot_th_honc(i1(ii),i2(ii),i3(ii)) =   ztot_th_honc(i1(ii),i2(ii),i3(ii))   + z_th_honc(ii)  * zmaxtime(ii)</div>
<div class="line"><a name="l01713"></a><span class="lineno"> 1713</span>&#160;            ztot_rc_honc(i1(ii),i2(ii),i3(ii)) =   ztot_rc_honc(i1(ii),i2(ii),i3(ii))   + z_rc_honc(ii)  * zmaxtime(ii)</div>
<div class="line"><a name="l01714"></a><span class="lineno"> 1714</span>&#160;            ztot_cc_honc(i1(ii),i2(ii),i3(ii)) =   ztot_cc_honc(i1(ii),i2(ii),i3(ii))   + z_cc_honc(ii)  * zmaxtime(ii)</div>
<div class="line"><a name="l01715"></a><span class="lineno"> 1715</span>&#160;            ztot_cc_self(i1(ii),i2(ii),i3(ii)) =   ztot_cc_self(i1(ii),i2(ii),i3(ii))   + z_cc_self(ii)  * zmaxtime(ii)</div>
<div class="line"><a name="l01716"></a><span class="lineno"> 1716</span>&#160;            ztot_rc_auto(i1(ii),i2(ii),i3(ii)) =   ztot_rc_auto(i1(ii),i2(ii),i3(ii))   + z_rc_auto(ii)  * zmaxtime(ii)</div>
<div class="line"><a name="l01717"></a><span class="lineno"> 1717</span>&#160;            ztot_cc_auto(i1(ii),i2(ii),i3(ii)) =   ztot_cc_auto(i1(ii),i2(ii),i3(ii))   + z_cc_auto(ii)  * zmaxtime(ii)</div>
<div class="line"><a name="l01718"></a><span class="lineno"> 1718</span>&#160;            ztot_cr_auto(i1(ii),i2(ii),i3(ii)) =   ztot_cr_auto(i1(ii),i2(ii),i3(ii))   + z_cr_auto(ii)  * zmaxtime(ii)</div>
<div class="line"><a name="l01719"></a><span class="lineno"> 1719</span>&#160;            ztot_rc_accr(i1(ii),i2(ii),i3(ii)) =   ztot_rc_accr(i1(ii),i2(ii),i3(ii))   + z_rc_accr(ii)  * zmaxtime(ii)</div>
<div class="line"><a name="l01720"></a><span class="lineno"> 1720</span>&#160;            ztot_cc_accr(i1(ii),i2(ii),i3(ii)) =   ztot_cc_accr(i1(ii),i2(ii),i3(ii))   + z_cc_accr(ii)  * zmaxtime(ii)</div>
<div class="line"><a name="l01721"></a><span class="lineno"> 1721</span>&#160;            ztot_cr_scbu(i1(ii),i2(ii),i3(ii)) =   ztot_cr_scbu(i1(ii),i2(ii),i3(ii))   + z_cr_scbu(ii)  * zmaxtime(ii)</div>
<div class="line"><a name="l01722"></a><span class="lineno"> 1722</span>&#160;            ztot_th_evap(i1(ii),i2(ii),i3(ii)) =   ztot_th_evap(i1(ii),i2(ii),i3(ii))   + z_th_evap(ii)  * zmaxtime(ii)</div>
<div class="line"><a name="l01723"></a><span class="lineno"> 1723</span>&#160;<span class="comment">!!$            ZTOT_RC_EVAP(I1(II),I2(II),I3(II)) =   ZTOT_RC_EVAP(I1(II),I2(II),I3(II))   + Z_RC_EVAP(II)  * ZMAXTIME(II)</span></div>
<div class="line"><a name="l01724"></a><span class="lineno"> 1724</span>&#160;<span class="comment">!!$            ZTOT_CC_EVAP(I1(II),I2(II),I3(II)) =   ZTOT_CC_EVAP(I1(II),I2(II),I3(II))   + Z_CC_EVAP(II)  * ZMAXTIME(II)</span></div>
<div class="line"><a name="l01725"></a><span class="lineno"> 1725</span>&#160;            ztot_rr_evap(i1(ii),i2(ii),i3(ii)) =   ztot_rr_evap(i1(ii),i2(ii),i3(ii))   + z_rr_evap(ii)  * zmaxtime(ii)</div>
<div class="line"><a name="l01726"></a><span class="lineno"> 1726</span>&#160;            ztot_cr_evap(i1(ii),i2(ii),i3(ii)) =   ztot_cr_evap(i1(ii),i2(ii),i3(ii))   + z_cr_evap(ii)  * zmaxtime(ii)</div>
<div class="line"><a name="l01727"></a><span class="lineno"> 1727</span>&#160;            ztot_ri_cnvi(i1(ii),i2(ii),i3(ii)) =   ztot_ri_cnvi(i1(ii),i2(ii),i3(ii))   + z_ri_cnvi(ii)  * zmaxtime(ii)</div>
<div class="line"><a name="l01728"></a><span class="lineno"> 1728</span>&#160;            ztot_ci_cnvi(i1(ii),i2(ii),i3(ii)) =   ztot_ci_cnvi(i1(ii),i2(ii),i3(ii))   + z_ci_cnvi(ii)  * zmaxtime(ii)</div>
<div class="line"><a name="l01729"></a><span class="lineno"> 1729</span>&#160;            ztot_th_deps(i1(ii),i2(ii),i3(ii)) =   ztot_th_deps(i1(ii),i2(ii),i3(ii))   + z_th_deps(ii)  * zmaxtime(ii)</div>
<div class="line"><a name="l01730"></a><span class="lineno"> 1730</span>&#160;            ztot_rs_deps(i1(ii),i2(ii),i3(ii)) =   ztot_rs_deps(i1(ii),i2(ii),i3(ii))   + z_rs_deps(ii)  * zmaxtime(ii)</div>
<div class="line"><a name="l01731"></a><span class="lineno"> 1731</span>&#160;            ztot_th_depi(i1(ii),i2(ii),i3(ii)) =   ztot_th_depi(i1(ii),i2(ii),i3(ii))   + z_th_depi(ii)  * zmaxtime(ii)</div>
<div class="line"><a name="l01732"></a><span class="lineno"> 1732</span>&#160;            ztot_ri_depi(i1(ii),i2(ii),i3(ii)) =   ztot_ri_depi(i1(ii),i2(ii),i3(ii))   + z_ri_depi(ii)  * zmaxtime(ii)</div>
<div class="line"><a name="l01733"></a><span class="lineno"> 1733</span>&#160;            ztot_ri_cnvs(i1(ii),i2(ii),i3(ii)) =   ztot_ri_cnvs(i1(ii),i2(ii),i3(ii))   + z_ri_cnvs(ii)  * zmaxtime(ii)</div>
<div class="line"><a name="l01734"></a><span class="lineno"> 1734</span>&#160;            ztot_ci_cnvs(i1(ii),i2(ii),i3(ii)) =   ztot_ci_cnvs(i1(ii),i2(ii),i3(ii))   + z_ci_cnvs(ii)  * zmaxtime(ii)</div>
<div class="line"><a name="l01735"></a><span class="lineno"> 1735</span>&#160;            ztot_cs_ssc(i1(ii),i2(ii),i3(ii))  =   ztot_cs_ssc(i1(ii),i2(ii),i3(ii))    + z_cs_ssc(ii)   * zmaxtime(ii)</div>
<div class="line"><a name="l01736"></a><span class="lineno"> 1736</span>&#160;            ztot_ri_aggs(i1(ii),i2(ii),i3(ii)) =   ztot_ri_aggs(i1(ii),i2(ii),i3(ii))   + z_ri_aggs(ii)  * zmaxtime(ii)</div>
<div class="line"><a name="l01737"></a><span class="lineno"> 1737</span>&#160;            ztot_ci_aggs(i1(ii),i2(ii),i3(ii)) =   ztot_ci_aggs(i1(ii),i2(ii),i3(ii))   + z_ci_aggs(ii)  * zmaxtime(ii)</div>
<div class="line"><a name="l01738"></a><span class="lineno"> 1738</span>&#160;            ztot_th_depg(i1(ii),i2(ii),i3(ii)) =   ztot_th_depg(i1(ii),i2(ii),i3(ii))   + z_th_depg(ii)  * zmaxtime(ii)</div>
<div class="line"><a name="l01739"></a><span class="lineno"> 1739</span>&#160;            ztot_rg_depg(i1(ii),i2(ii),i3(ii)) =   ztot_rg_depg(i1(ii),i2(ii),i3(ii))   + z_rg_depg(ii)  * zmaxtime(ii)</div>
<div class="line"><a name="l01740"></a><span class="lineno"> 1740</span>&#160;            ztot_th_berfi(i1(ii),i2(ii),i3(ii))=   ztot_th_berfi(i1(ii),i2(ii),i3(ii))  + z_th_berfi(ii) * zmaxtime(ii)</div>
<div class="line"><a name="l01741"></a><span class="lineno"> 1741</span>&#160;            ztot_rc_berfi(i1(ii),i2(ii),i3(ii))=   ztot_rc_berfi(i1(ii),i2(ii),i3(ii))  + z_rc_berfi(ii) * zmaxtime(ii)</div>
<div class="line"><a name="l01742"></a><span class="lineno"> 1742</span>&#160;            ztot_th_rim(i1(ii),i2(ii),i3(ii))  =   ztot_th_rim(i1(ii),i2(ii),i3(ii))    + z_th_rim(ii)   * zmaxtime(ii)</div>
<div class="line"><a name="l01743"></a><span class="lineno"> 1743</span>&#160;            ztot_cc_rim(i1(ii),i2(ii),i3(ii))  =   ztot_cc_rim(i1(ii),i2(ii),i3(ii))    + z_cc_rim(ii)   * zmaxtime(ii)</div>
<div class="line"><a name="l01744"></a><span class="lineno"> 1744</span>&#160;            ztot_cs_rim(i1(ii),i2(ii),i3(ii))  =   ztot_cs_rim(i1(ii),i2(ii),i3(ii))    + z_cs_rim(ii)   * zmaxtime(ii)</div>
<div class="line"><a name="l01745"></a><span class="lineno"> 1745</span>&#160;            ztot_rc_rimss(i1(ii),i2(ii),i3(ii))=   ztot_rc_rimss(i1(ii),i2(ii),i3(ii))  + z_rc_rimss(ii) * zmaxtime(ii)</div>
<div class="line"><a name="l01746"></a><span class="lineno"> 1746</span>&#160;            ztot_rc_rimsg(i1(ii),i2(ii),i3(ii))=   ztot_rc_rimsg(i1(ii),i2(ii),i3(ii))  + z_rc_rimsg(ii) * zmaxtime(ii)</div>
<div class="line"><a name="l01747"></a><span class="lineno"> 1747</span>&#160;            ztot_rs_rimcg(i1(ii),i2(ii),i3(ii))=   ztot_rs_rimcg(i1(ii),i2(ii),i3(ii))  + z_rs_rimcg(ii) * zmaxtime(ii)</div>
<div class="line"><a name="l01748"></a><span class="lineno"> 1748</span>&#160;            ztot_ri_hms(i1(ii),i2(ii),i3(ii))  =   ztot_ri_hms(i1(ii),i2(ii),i3(ii))    + z_ri_hms(ii)   * zmaxtime(ii)</div>
<div class="line"><a name="l01749"></a><span class="lineno"> 1749</span>&#160;            ztot_ci_hms(i1(ii),i2(ii),i3(ii))  =   ztot_ci_hms(i1(ii),i2(ii),i3(ii))    + z_ci_hms(ii)   * zmaxtime(ii)</div>
<div class="line"><a name="l01750"></a><span class="lineno"> 1750</span>&#160;            ztot_rs_hms(i1(ii),i2(ii),i3(ii))  =   ztot_rs_hms(i1(ii),i2(ii),i3(ii))    + z_rs_hms(ii)   * zmaxtime(ii)</div>
<div class="line"><a name="l01751"></a><span class="lineno"> 1751</span>&#160;            ztot_th_acc(i1(ii),i2(ii),i3(ii))  =   ztot_th_acc(i1(ii),i2(ii),i3(ii))    + z_th_acc(ii)   * zmaxtime(ii)</div>
<div class="line"><a name="l01752"></a><span class="lineno"> 1752</span>&#160;            ztot_cr_acc(i1(ii),i2(ii),i3(ii))  =   ztot_cr_acc(i1(ii),i2(ii),i3(ii))    + z_cr_acc(ii)   * zmaxtime(ii)</div>
<div class="line"><a name="l01753"></a><span class="lineno"> 1753</span>&#160;            ztot_cs_acc(i1(ii),i2(ii),i3(ii))  =   ztot_cs_acc(i1(ii),i2(ii),i3(ii))    + z_cs_acc(ii)   * zmaxtime(ii)</div>
<div class="line"><a name="l01754"></a><span class="lineno"> 1754</span>&#160;            ztot_rr_accss(i1(ii),i2(ii),i3(ii))=   ztot_rr_accss(i1(ii),i2(ii),i3(ii))  + z_rr_accss(ii) * zmaxtime(ii)</div>
<div class="line"><a name="l01755"></a><span class="lineno"> 1755</span>&#160;            ztot_rr_accsg(i1(ii),i2(ii),i3(ii))=   ztot_rr_accsg(i1(ii),i2(ii),i3(ii))  + z_rr_accsg(ii) * zmaxtime(ii)</div>
<div class="line"><a name="l01756"></a><span class="lineno"> 1756</span>&#160;            ztot_rs_accrg(i1(ii),i2(ii),i3(ii))=   ztot_rs_accrg(i1(ii),i2(ii),i3(ii))  + z_rs_accrg(ii) * zmaxtime(ii)</div>
<div class="line"><a name="l01757"></a><span class="lineno"> 1757</span>&#160;            ztot_cs_cmel(i1(ii),i2(ii),i3(ii)) =   ztot_cs_cmel(i1(ii),i2(ii),i3(ii))   + z_cs_cmel(ii)  * zmaxtime(ii)</div>
<div class="line"><a name="l01758"></a><span class="lineno"> 1758</span>&#160;            ztot_rs_cmel(i1(ii),i2(ii),i3(ii)) =   ztot_rs_cmel(i1(ii),i2(ii),i3(ii))   + z_rs_cmel(ii)  * zmaxtime(ii)</div>
<div class="line"><a name="l01759"></a><span class="lineno"> 1759</span>&#160;            ztot_th_cfrz(i1(ii),i2(ii),i3(ii)) =   ztot_th_cfrz(i1(ii),i2(ii),i3(ii))   + z_th_cfrz(ii)  * zmaxtime(ii)</div>
<div class="line"><a name="l01760"></a><span class="lineno"> 1760</span>&#160;            ztot_rr_cfrz(i1(ii),i2(ii),i3(ii)) =   ztot_rr_cfrz(i1(ii),i2(ii),i3(ii))   + z_rr_cfrz(ii)  * zmaxtime(ii)</div>
<div class="line"><a name="l01761"></a><span class="lineno"> 1761</span>&#160;            ztot_cr_cfrz(i1(ii),i2(ii),i3(ii)) =   ztot_cr_cfrz(i1(ii),i2(ii),i3(ii))   + z_cr_cfrz(ii)  * zmaxtime(ii)</div>
<div class="line"><a name="l01762"></a><span class="lineno"> 1762</span>&#160;            ztot_ri_cfrz(i1(ii),i2(ii),i3(ii)) =   ztot_ri_cfrz(i1(ii),i2(ii),i3(ii))   + z_ri_cfrz(ii)  * zmaxtime(ii)</div>
<div class="line"><a name="l01763"></a><span class="lineno"> 1763</span>&#160;            ztot_ci_cfrz(i1(ii),i2(ii),i3(ii)) =   ztot_ci_cfrz(i1(ii),i2(ii),i3(ii))   + z_ci_cfrz(ii)  * zmaxtime(ii)</div>
<div class="line"><a name="l01764"></a><span class="lineno"> 1764</span>&#160;            ztot_ri_cibu(i1(ii),i2(ii),i3(ii)) =   ztot_ri_cibu(i1(ii),i2(ii),i3(ii))   + z_ri_cibu(ii)  * zmaxtime(ii)</div>
<div class="line"><a name="l01765"></a><span class="lineno"> 1765</span>&#160;            ztot_ci_cibu(i1(ii),i2(ii),i3(ii)) =   ztot_ci_cibu(i1(ii),i2(ii),i3(ii))   + z_ci_cibu(ii)  * zmaxtime(ii)</div>
<div class="line"><a name="l01766"></a><span class="lineno"> 1766</span>&#160;            ztot_ri_rdsf(i1(ii),i2(ii),i3(ii)) =   ztot_ri_rdsf(i1(ii),i2(ii),i3(ii))   + z_ri_rdsf(ii)  * zmaxtime(ii)</div>
<div class="line"><a name="l01767"></a><span class="lineno"> 1767</span>&#160;            ztot_ci_rdsf(i1(ii),i2(ii),i3(ii)) =   ztot_ci_rdsf(i1(ii),i2(ii),i3(ii))   + z_ci_rdsf(ii)  * zmaxtime(ii)</div>
<div class="line"><a name="l01768"></a><span class="lineno"> 1768</span>&#160;            ztot_th_wetg(i1(ii),i2(ii),i3(ii)) =   ztot_th_wetg(i1(ii),i2(ii),i3(ii))   + z_th_wetg(ii)  * zmaxtime(ii)</div>
<div class="line"><a name="l01769"></a><span class="lineno"> 1769</span>&#160;            ztot_rc_wetg(i1(ii),i2(ii),i3(ii)) =   ztot_rc_wetg(i1(ii),i2(ii),i3(ii))   + z_rc_wetg(ii)  * zmaxtime(ii)</div>
<div class="line"><a name="l01770"></a><span class="lineno"> 1770</span>&#160;            ztot_cc_wetg(i1(ii),i2(ii),i3(ii)) =   ztot_cc_wetg(i1(ii),i2(ii),i3(ii))   + z_cc_wetg(ii)  * zmaxtime(ii)</div>
<div class="line"><a name="l01771"></a><span class="lineno"> 1771</span>&#160;            ztot_rr_wetg(i1(ii),i2(ii),i3(ii)) =   ztot_rr_wetg(i1(ii),i2(ii),i3(ii))   + z_rr_wetg(ii)  * zmaxtime(ii)</div>
<div class="line"><a name="l01772"></a><span class="lineno"> 1772</span>&#160;            ztot_cr_wetg(i1(ii),i2(ii),i3(ii)) =   ztot_cr_wetg(i1(ii),i2(ii),i3(ii))   + z_cr_wetg(ii)  * zmaxtime(ii)</div>
<div class="line"><a name="l01773"></a><span class="lineno"> 1773</span>&#160;            ztot_ri_wetg(i1(ii),i2(ii),i3(ii)) =   ztot_ri_wetg(i1(ii),i2(ii),i3(ii))   + z_ri_wetg(ii)  * zmaxtime(ii)</div>
<div class="line"><a name="l01774"></a><span class="lineno"> 1774</span>&#160;            ztot_ci_wetg(i1(ii),i2(ii),i3(ii)) =   ztot_ci_wetg(i1(ii),i2(ii),i3(ii))   + z_ci_wetg(ii)  * zmaxtime(ii)</div>
<div class="line"><a name="l01775"></a><span class="lineno"> 1775</span>&#160;            ztot_rs_wetg(i1(ii),i2(ii),i3(ii)) =   ztot_rs_wetg(i1(ii),i2(ii),i3(ii))   + z_rs_wetg(ii)  * zmaxtime(ii)</div>
<div class="line"><a name="l01776"></a><span class="lineno"> 1776</span>&#160;            ztot_cs_wetg(i1(ii),i2(ii),i3(ii)) =   ztot_cs_wetg(i1(ii),i2(ii),i3(ii))   + z_cs_wetg(ii)  * zmaxtime(ii)</div>
<div class="line"><a name="l01777"></a><span class="lineno"> 1777</span>&#160;            ztot_rg_wetg(i1(ii),i2(ii),i3(ii)) =   ztot_rg_wetg(i1(ii),i2(ii),i3(ii))   + z_rg_wetg(ii)  * zmaxtime(ii)</div>
<div class="line"><a name="l01778"></a><span class="lineno"> 1778</span>&#160;            ztot_cg_wetg(i1(ii),i2(ii),i3(ii)) =   ztot_cg_wetg(i1(ii),i2(ii),i3(ii))   + z_cg_wetg(ii)  * zmaxtime(ii)</div>
<div class="line"><a name="l01779"></a><span class="lineno"> 1779</span>&#160;            ztot_rh_wetg(i1(ii),i2(ii),i3(ii)) =   ztot_rh_wetg(i1(ii),i2(ii),i3(ii))   + z_rh_wetg(ii)  * zmaxtime(ii)</div>
<div class="line"><a name="l01780"></a><span class="lineno"> 1780</span>&#160;            ztot_th_dryg(i1(ii),i2(ii),i3(ii)) =   ztot_th_dryg(i1(ii),i2(ii),i3(ii))   + z_th_dryg(ii)  * zmaxtime(ii)</div>
<div class="line"><a name="l01781"></a><span class="lineno"> 1781</span>&#160;            ztot_rc_dryg(i1(ii),i2(ii),i3(ii)) =   ztot_rc_dryg(i1(ii),i2(ii),i3(ii))   + z_rc_dryg(ii)  * zmaxtime(ii)</div>
<div class="line"><a name="l01782"></a><span class="lineno"> 1782</span>&#160;            ztot_cc_dryg(i1(ii),i2(ii),i3(ii)) =   ztot_cc_dryg(i1(ii),i2(ii),i3(ii))   + z_cc_dryg(ii)  * zmaxtime(ii)</div>
<div class="line"><a name="l01783"></a><span class="lineno"> 1783</span>&#160;            ztot_rr_dryg(i1(ii),i2(ii),i3(ii)) =   ztot_rr_dryg(i1(ii),i2(ii),i3(ii))   + z_rr_dryg(ii)  * zmaxtime(ii)</div>
<div class="line"><a name="l01784"></a><span class="lineno"> 1784</span>&#160;            ztot_cr_dryg(i1(ii),i2(ii),i3(ii)) =   ztot_cr_dryg(i1(ii),i2(ii),i3(ii))   + z_cr_dryg(ii)  * zmaxtime(ii)</div>
<div class="line"><a name="l01785"></a><span class="lineno"> 1785</span>&#160;            ztot_ri_dryg(i1(ii),i2(ii),i3(ii)) =   ztot_ri_dryg(i1(ii),i2(ii),i3(ii))   + z_ri_dryg(ii)  * zmaxtime(ii)</div>
<div class="line"><a name="l01786"></a><span class="lineno"> 1786</span>&#160;            ztot_ci_dryg(i1(ii),i2(ii),i3(ii)) =   ztot_ci_dryg(i1(ii),i2(ii),i3(ii))   + z_ci_dryg(ii)  * zmaxtime(ii)</div>
<div class="line"><a name="l01787"></a><span class="lineno"> 1787</span>&#160;            ztot_rs_dryg(i1(ii),i2(ii),i3(ii)) =   ztot_rs_dryg(i1(ii),i2(ii),i3(ii))   + z_rs_dryg(ii)  * zmaxtime(ii)</div>
<div class="line"><a name="l01788"></a><span class="lineno"> 1788</span>&#160;            ztot_cs_dryg(i1(ii),i2(ii),i3(ii)) =   ztot_cs_dryg(i1(ii),i2(ii),i3(ii))   + z_cs_dryg(ii)  * zmaxtime(ii)</div>
<div class="line"><a name="l01789"></a><span class="lineno"> 1789</span>&#160;            ztot_rg_dryg(i1(ii),i2(ii),i3(ii)) =   ztot_rg_dryg(i1(ii),i2(ii),i3(ii))   + z_rg_dryg(ii)  * zmaxtime(ii)</div>
<div class="line"><a name="l01790"></a><span class="lineno"> 1790</span>&#160;            ztot_ri_hmg(i1(ii),i2(ii),i3(ii))  =   ztot_ri_hmg(i1(ii),i2(ii),i3(ii))    + z_ri_hmg(ii)   * zmaxtime(ii)</div>
<div class="line"><a name="l01791"></a><span class="lineno"> 1791</span>&#160;            ztot_ci_hmg(i1(ii),i2(ii),i3(ii))  =   ztot_ci_hmg(i1(ii),i2(ii),i3(ii))    + z_ci_hmg(ii)   * zmaxtime(ii)</div>
<div class="line"><a name="l01792"></a><span class="lineno"> 1792</span>&#160;            ztot_rg_hmg(i1(ii),i2(ii),i3(ii))  =   ztot_rg_hmg(i1(ii),i2(ii),i3(ii))    + z_rg_hmg(ii)   * zmaxtime(ii)</div>
<div class="line"><a name="l01793"></a><span class="lineno"> 1793</span>&#160;            ztot_th_gmlt(i1(ii),i2(ii),i3(ii)) =   ztot_th_gmlt(i1(ii),i2(ii),i3(ii))   + z_th_gmlt(ii)  * zmaxtime(ii)</div>
<div class="line"><a name="l01794"></a><span class="lineno"> 1794</span>&#160;            ztot_rr_gmlt(i1(ii),i2(ii),i3(ii)) =   ztot_rr_gmlt(i1(ii),i2(ii),i3(ii))   + z_rr_gmlt(ii)  * zmaxtime(ii)</div>
<div class="line"><a name="l01795"></a><span class="lineno"> 1795</span>&#160;            ztot_cr_gmlt(i1(ii),i2(ii),i3(ii)) =   ztot_cr_gmlt(i1(ii),i2(ii),i3(ii))   + z_cr_gmlt(ii)  * zmaxtime(ii)</div>
<div class="line"><a name="l01796"></a><span class="lineno"> 1796</span>&#160;            ztot_cg_gmlt(i1(ii),i2(ii),i3(ii)) =   ztot_cg_gmlt(i1(ii),i2(ii),i3(ii))   + z_cg_gmlt(ii)  * zmaxtime(ii)</div>
<div class="line"><a name="l01797"></a><span class="lineno"> 1797</span>&#160;            ztot_th_deph(i1(ii),i2(ii),i3(ii)) =   ztot_th_deph(i1(ii),i2(ii),i3(ii))   + z_th_deph(ii)  * zmaxtime(ii)</div>
<div class="line"><a name="l01798"></a><span class="lineno"> 1798</span>&#160;            ztot_rh_deph(i1(ii),i2(ii),i3(ii)) =   ztot_rh_deph(i1(ii),i2(ii),i3(ii))   + z_rh_deph(ii)  * zmaxtime(ii)</div>
<div class="line"><a name="l01799"></a><span class="lineno"> 1799</span>&#160;            ztot_th_weth(i1(ii),i2(ii),i3(ii)) =   ztot_th_weth(i1(ii),i2(ii),i3(ii))   + z_th_weth(ii)  * zmaxtime(ii)</div>
<div class="line"><a name="l01800"></a><span class="lineno"> 1800</span>&#160;            ztot_rc_weth(i1(ii),i2(ii),i3(ii)) =   ztot_rc_weth(i1(ii),i2(ii),i3(ii))   + z_rc_weth(ii)  * zmaxtime(ii)</div>
<div class="line"><a name="l01801"></a><span class="lineno"> 1801</span>&#160;            ztot_cc_weth(i1(ii),i2(ii),i3(ii)) =   ztot_cc_weth(i1(ii),i2(ii),i3(ii))   + z_cc_weth(ii)  * zmaxtime(ii)</div>
<div class="line"><a name="l01802"></a><span class="lineno"> 1802</span>&#160;            ztot_rr_weth(i1(ii),i2(ii),i3(ii)) =   ztot_rr_weth(i1(ii),i2(ii),i3(ii))   + z_rr_weth(ii)  * zmaxtime(ii)</div>
<div class="line"><a name="l01803"></a><span class="lineno"> 1803</span>&#160;            ztot_cr_weth(i1(ii),i2(ii),i3(ii)) =   ztot_cr_weth(i1(ii),i2(ii),i3(ii))   + z_cr_weth(ii)  * zmaxtime(ii)</div>
<div class="line"><a name="l01804"></a><span class="lineno"> 1804</span>&#160;            ztot_ri_weth(i1(ii),i2(ii),i3(ii)) =   ztot_ri_weth(i1(ii),i2(ii),i3(ii))   + z_ri_weth(ii)  * zmaxtime(ii)</div>
<div class="line"><a name="l01805"></a><span class="lineno"> 1805</span>&#160;            ztot_ci_weth(i1(ii),i2(ii),i3(ii)) =   ztot_ci_weth(i1(ii),i2(ii),i3(ii))   + z_ci_weth(ii)  * zmaxtime(ii)</div>
<div class="line"><a name="l01806"></a><span class="lineno"> 1806</span>&#160;            ztot_rs_weth(i1(ii),i2(ii),i3(ii)) =   ztot_rs_weth(i1(ii),i2(ii),i3(ii))   + z_rs_weth(ii)  * zmaxtime(ii)</div>
<div class="line"><a name="l01807"></a><span class="lineno"> 1807</span>&#160;            ztot_cs_weth(i1(ii),i2(ii),i3(ii)) =   ztot_cs_weth(i1(ii),i2(ii),i3(ii))   + z_cs_weth(ii)  * zmaxtime(ii)</div>
<div class="line"><a name="l01808"></a><span class="lineno"> 1808</span>&#160;            ztot_rg_weth(i1(ii),i2(ii),i3(ii)) =   ztot_rg_weth(i1(ii),i2(ii),i3(ii))   + z_rg_weth(ii)  * zmaxtime(ii)</div>
<div class="line"><a name="l01809"></a><span class="lineno"> 1809</span>&#160;            ztot_cg_weth(i1(ii),i2(ii),i3(ii)) =   ztot_cg_weth(i1(ii),i2(ii),i3(ii))   + z_cg_weth(ii)  * zmaxtime(ii)</div>
<div class="line"><a name="l01810"></a><span class="lineno"> 1810</span>&#160;            ztot_rh_weth(i1(ii),i2(ii),i3(ii)) =   ztot_rh_weth(i1(ii),i2(ii),i3(ii))   + z_rh_weth(ii)  * zmaxtime(ii)</div>
<div class="line"><a name="l01811"></a><span class="lineno"> 1811</span>&#160;            ztot_rg_cohg(i1(ii),i2(ii),i3(ii)) =   ztot_rg_cohg(i1(ii),i2(ii),i3(ii))   + z_rg_cohg(ii)  * zmaxtime(ii)</div>
<div class="line"><a name="l01812"></a><span class="lineno"> 1812</span>&#160;            ztot_cg_cohg(i1(ii),i2(ii),i3(ii)) =   ztot_cg_cohg(i1(ii),i2(ii),i3(ii))   + z_cg_cohg(ii)  * zmaxtime(ii)</div>
<div class="line"><a name="l01813"></a><span class="lineno"> 1813</span>&#160;            ztot_th_hmlt(i1(ii),i2(ii),i3(ii)) =   ztot_rr_hmlt(i1(ii),i2(ii),i3(ii))   + z_rr_hmlt(ii)  * zmaxtime(ii)</div>
<div class="line"><a name="l01814"></a><span class="lineno"> 1814</span>&#160;            ztot_rr_hmlt(i1(ii),i2(ii),i3(ii)) =   ztot_rr_hmlt(i1(ii),i2(ii),i3(ii))   + z_rr_hmlt(ii)  * zmaxtime(ii)</div>
<div class="line"><a name="l01815"></a><span class="lineno"> 1815</span>&#160;            ztot_cr_hmlt(i1(ii),i2(ii),i3(ii)) =   ztot_cr_hmlt(i1(ii),i2(ii),i3(ii))   + z_cr_hmlt(ii)  * zmaxtime(ii)</div>
<div class="line"><a name="l01816"></a><span class="lineno"> 1816</span>&#160;            ztot_ch_hmlt(i1(ii),i2(ii),i3(ii)) =   ztot_ch_hmlt(i1(ii),i2(ii),i3(ii))   + z_ch_hmlt(ii)  * zmaxtime(ii)</div>
<div class="line"><a name="l01817"></a><span class="lineno"> 1817</span>&#160; </div>
<div class="line"><a name="l01818"></a><span class="lineno"> 1818</span>&#160;            <span class="comment">! Correction term</span></div>
<div class="line"><a name="l01819"></a><span class="lineno"> 1819</span>&#160;            ztot_rv_corr2(i1(ii),i2(ii),i3(ii)) =   ztot_rv_corr2(i1(ii),i2(ii),i3(ii)) + z_rv_corr2(ii)</div>
<div class="line"><a name="l01820"></a><span class="lineno"> 1820</span>&#160;            ztot_rc_corr2(i1(ii),i2(ii),i3(ii)) =   ztot_rc_corr2(i1(ii),i2(ii),i3(ii)) + z_rc_corr2(ii)</div>
<div class="line"><a name="l01821"></a><span class="lineno"> 1821</span>&#160;            ztot_rr_corr2(i1(ii),i2(ii),i3(ii)) =   ztot_rr_corr2(i1(ii),i2(ii),i3(ii)) + z_rr_corr2(ii)</div>
<div class="line"><a name="l01822"></a><span class="lineno"> 1822</span>&#160;            ztot_ri_corr2(i1(ii),i2(ii),i3(ii)) =   ztot_ri_corr2(i1(ii),i2(ii),i3(ii)) + z_ri_corr2(ii)</div>
<div class="line"><a name="l01823"></a><span class="lineno"> 1823</span>&#160;            ztot_cc_corr2(i1(ii),i2(ii),i3(ii)) =   ztot_cc_corr2(i1(ii),i2(ii),i3(ii)) + z_cc_corr2(ii)</div>
<div class="line"><a name="l01824"></a><span class="lineno"> 1824</span>&#160;            ztot_cr_corr2(i1(ii),i2(ii),i3(ii)) =   ztot_cr_corr2(i1(ii),i2(ii),i3(ii)) + z_cr_corr2(ii)</div>
<div class="line"><a name="l01825"></a><span class="lineno"> 1825</span>&#160;            ztot_ci_corr2(i1(ii),i2(ii),i3(ii)) =   ztot_ci_corr2(i1(ii),i2(ii),i3(ii)) + z_ci_corr2(ii)</div>
<div class="line"><a name="l01826"></a><span class="lineno"> 1826</span>&#160;<span class="keywordflow">         END DO</span></div>
<div class="line"><a name="l01827"></a><span class="lineno"> 1827</span>&#160;<span class="keywordflow">      ENDIF</span></div>
<div class="line"><a name="l01828"></a><span class="lineno"> 1828</span>&#160;      <span class="comment">!</span></div>
<div class="line"><a name="l01829"></a><span class="lineno"> 1829</span>&#160;      <span class="comment">! Deallocating variables</span></div>
<div class="line"><a name="l01830"></a><span class="lineno"> 1830</span>&#160;      <span class="comment">!</span></div>
<div class="line"><a name="l01831"></a><span class="lineno"> 1831</span>&#160;      <span class="keyword">DEALLOCATE</span>(i1)</div>
<div class="line"><a name="l01832"></a><span class="lineno"> 1832</span>&#160;      <span class="keyword">DEALLOCATE</span>(i2)</div>
<div class="line"><a name="l01833"></a><span class="lineno"> 1833</span>&#160;      <span class="keyword">DEALLOCATE</span>(i3)</div>
<div class="line"><a name="l01834"></a><span class="lineno"> 1834</span>&#160;      <span class="keyword">DEALLOCATE</span>(zrhodref1d)</div>
<div class="line"><a name="l01835"></a><span class="lineno"> 1835</span>&#160;      <span class="keyword">DEALLOCATE</span>(zexnref1d)</div>
<div class="line"><a name="l01836"></a><span class="lineno"> 1836</span>&#160;      <span class="keyword">DEALLOCATE</span>(zexn1d)</div>
<div class="line"><a name="l01837"></a><span class="lineno"> 1837</span>&#160;      <span class="keyword">DEALLOCATE</span>(zp1d)     </div>
<div class="line"><a name="l01838"></a><span class="lineno"> 1838</span>&#160;      <span class="keyword">DEALLOCATE</span>(ztht1d)</div>
<div class="line"><a name="l01839"></a><span class="lineno"> 1839</span>&#160;      <span class="keyword">DEALLOCATE</span>(zrvt1d)</div>
<div class="line"><a name="l01840"></a><span class="lineno"> 1840</span>&#160;      <span class="keyword">DEALLOCATE</span>(zrct1d)</div>
<div class="line"><a name="l01841"></a><span class="lineno"> 1841</span>&#160;      <span class="keyword">DEALLOCATE</span>(zrrt1d)</div>
<div class="line"><a name="l01842"></a><span class="lineno"> 1842</span>&#160;      <span class="keyword">DEALLOCATE</span>(zrit1d)</div>
<div class="line"><a name="l01843"></a><span class="lineno"> 1843</span>&#160;      <span class="keyword">DEALLOCATE</span>(zrst1d)</div>
<div class="line"><a name="l01844"></a><span class="lineno"> 1844</span>&#160;      <span class="keyword">DEALLOCATE</span>(zrgt1d)</div>
<div class="line"><a name="l01845"></a><span class="lineno"> 1845</span>&#160;      <span class="keyword">DEALLOCATE</span>(zrht1d)</div>
<div class="line"><a name="l01846"></a><span class="lineno"> 1846</span>&#160;      <span class="keyword">DEALLOCATE</span>(zcct1d)</div>
<div class="line"><a name="l01847"></a><span class="lineno"> 1847</span>&#160;      <span class="keyword">DEALLOCATE</span>(zcrt1d)</div>
<div class="line"><a name="l01848"></a><span class="lineno"> 1848</span>&#160;      <span class="keyword">DEALLOCATE</span>(zcit1d)</div>
<div class="line"><a name="l01849"></a><span class="lineno"> 1849</span>&#160;      <span class="keyword">DEALLOCATE</span>(zcst1d)</div>
<div class="line"><a name="l01850"></a><span class="lineno"> 1850</span>&#160;      <span class="keyword">DEALLOCATE</span>(zcgt1d)</div>
<div class="line"><a name="l01851"></a><span class="lineno"> 1851</span>&#160;      <span class="keyword">DEALLOCATE</span>(zcht1d)</div>
<div class="line"><a name="l01852"></a><span class="lineno"> 1852</span>&#160;      <span class="keyword">DEALLOCATE</span>(zifnn1d)</div>
<div class="line"><a name="l01853"></a><span class="lineno"> 1853</span>&#160;      <span class="keyword">DEALLOCATE</span>(zevap1d)</div>
<div class="line"><a name="l01854"></a><span class="lineno"> 1854</span>&#160;      <span class="keyword">DEALLOCATE</span>(ztime1d)</div>
<div class="line"><a name="l01855"></a><span class="lineno"> 1855</span>&#160;      <span class="keyword">DEALLOCATE</span>(llcompute1d)</div>
<div class="line"><a name="l01856"></a><span class="lineno"> 1856</span>&#160;      <span class="keyword">DEALLOCATE</span>(iiter1d)</div>
<div class="line"><a name="l01857"></a><span class="lineno"> 1857</span>&#160;      <span class="keyword">DEALLOCATE</span>(ztime_lastcall1d)</div>
<div class="line"><a name="l01858"></a><span class="lineno"> 1858</span>&#160;      <span class="keyword">DEALLOCATE</span>(z0rvt1d)</div>
<div class="line"><a name="l01859"></a><span class="lineno"> 1859</span>&#160;      <span class="keyword">DEALLOCATE</span>(z0rct1d)</div>
<div class="line"><a name="l01860"></a><span class="lineno"> 1860</span>&#160;      <span class="keyword">DEALLOCATE</span>(z0rrt1d)</div>
<div class="line"><a name="l01861"></a><span class="lineno"> 1861</span>&#160;      <span class="keyword">DEALLOCATE</span>(z0rit1d)</div>
<div class="line"><a name="l01862"></a><span class="lineno"> 1862</span>&#160;      <span class="keyword">DEALLOCATE</span>(z0rst1d)</div>
<div class="line"><a name="l01863"></a><span class="lineno"> 1863</span>&#160;      <span class="keyword">DEALLOCATE</span>(z0rgt1d)</div>
<div class="line"><a name="l01864"></a><span class="lineno"> 1864</span>&#160;      <span class="keyword">DEALLOCATE</span>(z0rht1d)</div>
<div class="line"><a name="l01865"></a><span class="lineno"> 1865</span>&#160;      <span class="keyword">DEALLOCATE</span>(zcf1d)</div>
<div class="line"><a name="l01866"></a><span class="lineno"> 1866</span>&#160;      <span class="keyword">DEALLOCATE</span>(zif1d)</div>
<div class="line"><a name="l01867"></a><span class="lineno"> 1867</span>&#160;      <span class="keyword">DEALLOCATE</span>(zpf1d)</div>
<div class="line"><a name="l01868"></a><span class="lineno"> 1868</span>&#160;      <span class="keyword">DEALLOCATE</span>(zlatham_iaggs)</div>
<div class="line"><a name="l01869"></a><span class="lineno"> 1869</span>&#160;      <span class="comment">!</span></div>
<div class="line"><a name="l01870"></a><span class="lineno"> 1870</span>&#160;      <span class="keyword">DEALLOCATE</span>(zmaxtime)</div>
<div class="line"><a name="l01871"></a><span class="lineno"> 1871</span>&#160;      <span class="keyword">DEALLOCATE</span>(ztime_threshold)</div>
<div class="line"><a name="l01872"></a><span class="lineno"> 1872</span>&#160;      <span class="comment">!</span></div>
<div class="line"><a name="l01873"></a><span class="lineno"> 1873</span>&#160;      <span class="keyword">DEALLOCATE</span>(za_th)</div>
<div class="line"><a name="l01874"></a><span class="lineno"> 1874</span>&#160;      <span class="keyword">DEALLOCATE</span>(za_rv)</div>
<div class="line"><a name="l01875"></a><span class="lineno"> 1875</span>&#160;      <span class="keyword">DEALLOCATE</span>(za_rc)</div>
<div class="line"><a name="l01876"></a><span class="lineno"> 1876</span>&#160;      <span class="keyword">DEALLOCATE</span>(za_rr)</div>
<div class="line"><a name="l01877"></a><span class="lineno"> 1877</span>&#160;      <span class="keyword">DEALLOCATE</span>(za_ri)</div>
<div class="line"><a name="l01878"></a><span class="lineno"> 1878</span>&#160;      <span class="keyword">DEALLOCATE</span>(za_rs)</div>
<div class="line"><a name="l01879"></a><span class="lineno"> 1879</span>&#160;      <span class="keyword">DEALLOCATE</span>(za_rg)</div>
<div class="line"><a name="l01880"></a><span class="lineno"> 1880</span>&#160;      <span class="keyword">DEALLOCATE</span>(za_rh)</div>
<div class="line"><a name="l01881"></a><span class="lineno"> 1881</span>&#160;      <span class="keyword">DEALLOCATE</span>(za_cc)</div>
<div class="line"><a name="l01882"></a><span class="lineno"> 1882</span>&#160;      <span class="keyword">DEALLOCATE</span>(za_cr)</div>
<div class="line"><a name="l01883"></a><span class="lineno"> 1883</span>&#160;      <span class="keyword">DEALLOCATE</span>(za_ci)</div>
<div class="line"><a name="l01884"></a><span class="lineno"> 1884</span>&#160;      <span class="keyword">DEALLOCATE</span>(za_cs)</div>
<div class="line"><a name="l01885"></a><span class="lineno"> 1885</span>&#160;      <span class="keyword">DEALLOCATE</span>(za_cg)</div>
<div class="line"><a name="l01886"></a><span class="lineno"> 1886</span>&#160;      <span class="keyword">DEALLOCATE</span>(za_ch)</div>
<div class="line"><a name="l01887"></a><span class="lineno"> 1887</span>&#160;      <span class="comment">!</span></div>
<div class="line"><a name="l01888"></a><span class="lineno"> 1888</span>&#160;      <span class="keyword">DEALLOCATE</span>(zb_th)</div>
<div class="line"><a name="l01889"></a><span class="lineno"> 1889</span>&#160;      <span class="keyword">DEALLOCATE</span>(zb_rv)   </div>
<div class="line"><a name="l01890"></a><span class="lineno"> 1890</span>&#160;      <span class="keyword">DEALLOCATE</span>(zb_rc)   </div>
<div class="line"><a name="l01891"></a><span class="lineno"> 1891</span>&#160;      <span class="keyword">DEALLOCATE</span>(zb_rr)   </div>
<div class="line"><a name="l01892"></a><span class="lineno"> 1892</span>&#160;      <span class="keyword">DEALLOCATE</span>(zb_ri)   </div>
<div class="line"><a name="l01893"></a><span class="lineno"> 1893</span>&#160;      <span class="keyword">DEALLOCATE</span>(zb_rs)   </div>
<div class="line"><a name="l01894"></a><span class="lineno"> 1894</span>&#160;      <span class="keyword">DEALLOCATE</span>(zb_rg)   </div>
<div class="line"><a name="l01895"></a><span class="lineno"> 1895</span>&#160;      <span class="keyword">DEALLOCATE</span>(zb_rh)   </div>
<div class="line"><a name="l01896"></a><span class="lineno"> 1896</span>&#160;      <span class="keyword">DEALLOCATE</span>(zb_cc)   </div>
<div class="line"><a name="l01897"></a><span class="lineno"> 1897</span>&#160;      <span class="keyword">DEALLOCATE</span>(zb_cr)  </div>
<div class="line"><a name="l01898"></a><span class="lineno"> 1898</span>&#160;      <span class="keyword">DEALLOCATE</span>(zb_ci)  </div>
<div class="line"><a name="l01899"></a><span class="lineno"> 1899</span>&#160;      <span class="keyword">DEALLOCATE</span>(zb_cs)  </div>
<div class="line"><a name="l01900"></a><span class="lineno"> 1900</span>&#160;      <span class="keyword">DEALLOCATE</span>(zb_cg)  </div>
<div class="line"><a name="l01901"></a><span class="lineno"> 1901</span>&#160;      <span class="keyword">DEALLOCATE</span>(zb_ch)  </div>
<div class="line"><a name="l01902"></a><span class="lineno"> 1902</span>&#160;      <span class="keyword">DEALLOCATE</span>(zb_ifnn)</div>
<div class="line"><a name="l01903"></a><span class="lineno"> 1903</span>&#160;      <span class="comment">!</span></div>
<div class="line"><a name="l01904"></a><span class="lineno"> 1904</span>&#160;      <span class="keyword">DEALLOCATE</span>(z_cr_brku)</div>
<div class="line"><a name="l01905"></a><span class="lineno"> 1905</span>&#160;      <span class="keyword">DEALLOCATE</span>(z_th_honr)</div>
<div class="line"><a name="l01906"></a><span class="lineno"> 1906</span>&#160;      <span class="keyword">DEALLOCATE</span>(z_rr_honr)</div>
<div class="line"><a name="l01907"></a><span class="lineno"> 1907</span>&#160;      <span class="keyword">DEALLOCATE</span>(z_cr_honr)</div>
<div class="line"><a name="l01908"></a><span class="lineno"> 1908</span>&#160;      <span class="keyword">DEALLOCATE</span>(z_th_imlt)</div>
<div class="line"><a name="l01909"></a><span class="lineno"> 1909</span>&#160;      <span class="keyword">DEALLOCATE</span>(z_rc_imlt)</div>
<div class="line"><a name="l01910"></a><span class="lineno"> 1910</span>&#160;      <span class="keyword">DEALLOCATE</span>(z_cc_imlt)</div>
<div class="line"><a name="l01911"></a><span class="lineno"> 1911</span>&#160;      <span class="keyword">DEALLOCATE</span>(z_th_honc)</div>
<div class="line"><a name="l01912"></a><span class="lineno"> 1912</span>&#160;      <span class="keyword">DEALLOCATE</span>(z_rc_honc)</div>
<div class="line"><a name="l01913"></a><span class="lineno"> 1913</span>&#160;      <span class="keyword">DEALLOCATE</span>(z_cc_honc)</div>
<div class="line"><a name="l01914"></a><span class="lineno"> 1914</span>&#160;      <span class="keyword">DEALLOCATE</span>(z_cc_self) </div>
<div class="line"><a name="l01915"></a><span class="lineno"> 1915</span>&#160;      <span class="keyword">DEALLOCATE</span>(z_rc_auto) </div>
<div class="line"><a name="l01916"></a><span class="lineno"> 1916</span>&#160;      <span class="keyword">DEALLOCATE</span>(z_cc_auto)</div>
<div class="line"><a name="l01917"></a><span class="lineno"> 1917</span>&#160;      <span class="keyword">DEALLOCATE</span>(z_cr_auto) </div>
<div class="line"><a name="l01918"></a><span class="lineno"> 1918</span>&#160;      <span class="keyword">DEALLOCATE</span>(z_rc_accr) </div>
<div class="line"><a name="l01919"></a><span class="lineno"> 1919</span>&#160;      <span class="keyword">DEALLOCATE</span>(z_cc_accr) </div>
<div class="line"><a name="l01920"></a><span class="lineno"> 1920</span>&#160;      <span class="keyword">DEALLOCATE</span>(z_cr_scbu)</div>
<div class="line"><a name="l01921"></a><span class="lineno"> 1921</span>&#160;      <span class="keyword">DEALLOCATE</span>(z_th_evap) </div>
<div class="line"><a name="l01922"></a><span class="lineno"> 1922</span>&#160;      <span class="keyword">DEALLOCATE</span>(z_rr_evap) </div>
<div class="line"><a name="l01923"></a><span class="lineno"> 1923</span>&#160;      <span class="keyword">DEALLOCATE</span>(z_cr_evap) </div>
<div class="line"><a name="l01924"></a><span class="lineno"> 1924</span>&#160;      <span class="keyword">DEALLOCATE</span>(z_ri_cnvi)</div>
<div class="line"><a name="l01925"></a><span class="lineno"> 1925</span>&#160;      <span class="keyword">DEALLOCATE</span>(z_ci_cnvi)</div>
<div class="line"><a name="l01926"></a><span class="lineno"> 1926</span>&#160;      <span class="keyword">DEALLOCATE</span>(z_th_deps)</div>
<div class="line"><a name="l01927"></a><span class="lineno"> 1927</span>&#160;      <span class="keyword">DEALLOCATE</span>(z_rs_deps)</div>
<div class="line"><a name="l01928"></a><span class="lineno"> 1928</span>&#160;      <span class="keyword">DEALLOCATE</span>(z_th_depi)</div>
<div class="line"><a name="l01929"></a><span class="lineno"> 1929</span>&#160;      <span class="keyword">DEALLOCATE</span>(z_ri_depi)</div>
<div class="line"><a name="l01930"></a><span class="lineno"> 1930</span>&#160;      <span class="keyword">DEALLOCATE</span>(z_ri_cnvs)</div>
<div class="line"><a name="l01931"></a><span class="lineno"> 1931</span>&#160;      <span class="keyword">DEALLOCATE</span>(z_ci_cnvs)</div>
<div class="line"><a name="l01932"></a><span class="lineno"> 1932</span>&#160;      <span class="keyword">DEALLOCATE</span>(z_cs_ssc) </div>
<div class="line"><a name="l01933"></a><span class="lineno"> 1933</span>&#160;      <span class="keyword">DEALLOCATE</span>(z_ri_aggs) </div>
<div class="line"><a name="l01934"></a><span class="lineno"> 1934</span>&#160;      <span class="keyword">DEALLOCATE</span>(z_ci_aggs) </div>
<div class="line"><a name="l01935"></a><span class="lineno"> 1935</span>&#160;      <span class="keyword">DEALLOCATE</span>(z_th_depg) </div>
<div class="line"><a name="l01936"></a><span class="lineno"> 1936</span>&#160;      <span class="keyword">DEALLOCATE</span>(z_rg_depg) </div>
<div class="line"><a name="l01937"></a><span class="lineno"> 1937</span>&#160;      <span class="keyword">DEALLOCATE</span>(z_th_berfi)</div>
<div class="line"><a name="l01938"></a><span class="lineno"> 1938</span>&#160;      <span class="keyword">DEALLOCATE</span>(z_rc_berfi)</div>
<div class="line"><a name="l01939"></a><span class="lineno"> 1939</span>&#160;      <span class="keyword">DEALLOCATE</span>(z_th_rim) </div>
<div class="line"><a name="l01940"></a><span class="lineno"> 1940</span>&#160;      <span class="keyword">DEALLOCATE</span>(z_cc_rim)  </div>
<div class="line"><a name="l01941"></a><span class="lineno"> 1941</span>&#160;      <span class="keyword">DEALLOCATE</span>(z_cs_rim) </div>
<div class="line"><a name="l01942"></a><span class="lineno"> 1942</span>&#160;      <span class="keyword">DEALLOCATE</span>(z_rc_rimss)</div>
<div class="line"><a name="l01943"></a><span class="lineno"> 1943</span>&#160;      <span class="keyword">DEALLOCATE</span>(z_rc_rimsg)</div>
<div class="line"><a name="l01944"></a><span class="lineno"> 1944</span>&#160;      <span class="keyword">DEALLOCATE</span>(z_rs_rimcg)    </div>
<div class="line"><a name="l01945"></a><span class="lineno"> 1945</span>&#160;      <span class="keyword">DEALLOCATE</span>(z_ri_hms) </div>
<div class="line"><a name="l01946"></a><span class="lineno"> 1946</span>&#160;      <span class="keyword">DEALLOCATE</span>(z_ci_hms) </div>
<div class="line"><a name="l01947"></a><span class="lineno"> 1947</span>&#160;      <span class="keyword">DEALLOCATE</span>(z_rs_hms)</div>
<div class="line"><a name="l01948"></a><span class="lineno"> 1948</span>&#160;      <span class="keyword">DEALLOCATE</span>(z_th_acc) </div>
<div class="line"><a name="l01949"></a><span class="lineno"> 1949</span>&#160;      <span class="keyword">DEALLOCATE</span>(z_cr_acc) </div>
<div class="line"><a name="l01950"></a><span class="lineno"> 1950</span>&#160;      <span class="keyword">DEALLOCATE</span>(z_cs_acc) </div>
<div class="line"><a name="l01951"></a><span class="lineno"> 1951</span>&#160;      <span class="keyword">DEALLOCATE</span>(z_rr_accss)</div>
<div class="line"><a name="l01952"></a><span class="lineno"> 1952</span>&#160;      <span class="keyword">DEALLOCATE</span>(z_rr_accsg)</div>
<div class="line"><a name="l01953"></a><span class="lineno"> 1953</span>&#160;      <span class="keyword">DEALLOCATE</span>(z_rs_accrg)</div>
<div class="line"><a name="l01954"></a><span class="lineno"> 1954</span>&#160;      <span class="keyword">DEALLOCATE</span>(z_cs_cmel) </div>
<div class="line"><a name="l01955"></a><span class="lineno"> 1955</span>&#160;      <span class="keyword">DEALLOCATE</span>(z_rs_cmel) </div>
<div class="line"><a name="l01956"></a><span class="lineno"> 1956</span>&#160;      <span class="keyword">DEALLOCATE</span>(z_th_cfrz)</div>
<div class="line"><a name="l01957"></a><span class="lineno"> 1957</span>&#160;      <span class="keyword">DEALLOCATE</span>(z_rr_cfrz)</div>
<div class="line"><a name="l01958"></a><span class="lineno"> 1958</span>&#160;      <span class="keyword">DEALLOCATE</span>(z_cr_cfrz)</div>
<div class="line"><a name="l01959"></a><span class="lineno"> 1959</span>&#160;      <span class="keyword">DEALLOCATE</span>(z_ri_cfrz)</div>
<div class="line"><a name="l01960"></a><span class="lineno"> 1960</span>&#160;      <span class="keyword">DEALLOCATE</span>(z_ci_cfrz)</div>
<div class="line"><a name="l01961"></a><span class="lineno"> 1961</span>&#160;      <span class="keyword">DEALLOCATE</span>(z_ri_cibu) </div>
<div class="line"><a name="l01962"></a><span class="lineno"> 1962</span>&#160;      <span class="keyword">DEALLOCATE</span>(z_ci_cibu) </div>
<div class="line"><a name="l01963"></a><span class="lineno"> 1963</span>&#160;      <span class="keyword">DEALLOCATE</span>(z_ri_rdsf) </div>
<div class="line"><a name="l01964"></a><span class="lineno"> 1964</span>&#160;      <span class="keyword">DEALLOCATE</span>(z_ci_rdsf) </div>
<div class="line"><a name="l01965"></a><span class="lineno"> 1965</span>&#160;      <span class="keyword">DEALLOCATE</span>(z_th_wetg)</div>
<div class="line"><a name="l01966"></a><span class="lineno"> 1966</span>&#160;      <span class="keyword">DEALLOCATE</span>(z_rc_wetg)</div>
<div class="line"><a name="l01967"></a><span class="lineno"> 1967</span>&#160;      <span class="keyword">DEALLOCATE</span>(z_cc_wetg)</div>
<div class="line"><a name="l01968"></a><span class="lineno"> 1968</span>&#160;      <span class="keyword">DEALLOCATE</span>(z_rr_wetg) </div>
<div class="line"><a name="l01969"></a><span class="lineno"> 1969</span>&#160;      <span class="keyword">DEALLOCATE</span>(z_cr_wetg) </div>
<div class="line"><a name="l01970"></a><span class="lineno"> 1970</span>&#160;      <span class="keyword">DEALLOCATE</span>(z_ri_wetg)</div>
<div class="line"><a name="l01971"></a><span class="lineno"> 1971</span>&#160;      <span class="keyword">DEALLOCATE</span>(z_ci_wetg)</div>
<div class="line"><a name="l01972"></a><span class="lineno"> 1972</span>&#160;      <span class="keyword">DEALLOCATE</span>(z_rs_wetg)</div>
<div class="line"><a name="l01973"></a><span class="lineno"> 1973</span>&#160;      <span class="keyword">DEALLOCATE</span>(z_cs_wetg)</div>
<div class="line"><a name="l01974"></a><span class="lineno"> 1974</span>&#160;      <span class="keyword">DEALLOCATE</span>(z_rg_wetg)</div>
<div class="line"><a name="l01975"></a><span class="lineno"> 1975</span>&#160;      <span class="keyword">DEALLOCATE</span>(z_cg_wetg)</div>
<div class="line"><a name="l01976"></a><span class="lineno"> 1976</span>&#160;      <span class="keyword">DEALLOCATE</span>(z_rh_wetg) </div>
<div class="line"><a name="l01977"></a><span class="lineno"> 1977</span>&#160;      <span class="keyword">DEALLOCATE</span>(z_th_dryg) </div>
<div class="line"><a name="l01978"></a><span class="lineno"> 1978</span>&#160;      <span class="keyword">DEALLOCATE</span>(z_rc_dryg) </div>
<div class="line"><a name="l01979"></a><span class="lineno"> 1979</span>&#160;      <span class="keyword">DEALLOCATE</span>(z_cc_dryg)</div>
<div class="line"><a name="l01980"></a><span class="lineno"> 1980</span>&#160;      <span class="keyword">DEALLOCATE</span>(z_rr_dryg)</div>
<div class="line"><a name="l01981"></a><span class="lineno"> 1981</span>&#160;      <span class="keyword">DEALLOCATE</span>(z_cr_dryg)</div>
<div class="line"><a name="l01982"></a><span class="lineno"> 1982</span>&#160;      <span class="keyword">DEALLOCATE</span>(z_ri_dryg)</div>
<div class="line"><a name="l01983"></a><span class="lineno"> 1983</span>&#160;      <span class="keyword">DEALLOCATE</span>(z_ci_dryg)</div>
<div class="line"><a name="l01984"></a><span class="lineno"> 1984</span>&#160;      <span class="keyword">DEALLOCATE</span>(z_rs_dryg) </div>
<div class="line"><a name="l01985"></a><span class="lineno"> 1985</span>&#160;      <span class="keyword">DEALLOCATE</span>(z_cs_dryg) </div>
<div class="line"><a name="l01986"></a><span class="lineno"> 1986</span>&#160;      <span class="keyword">DEALLOCATE</span>(z_rg_dryg)</div>
<div class="line"><a name="l01987"></a><span class="lineno"> 1987</span>&#160;      <span class="keyword">DEALLOCATE</span>(z_ri_hmg) </div>
<div class="line"><a name="l01988"></a><span class="lineno"> 1988</span>&#160;      <span class="keyword">DEALLOCATE</span>(z_ci_hmg) </div>
<div class="line"><a name="l01989"></a><span class="lineno"> 1989</span>&#160;      <span class="keyword">DEALLOCATE</span>(z_rg_hmg) </div>
<div class="line"><a name="l01990"></a><span class="lineno"> 1990</span>&#160;      <span class="keyword">DEALLOCATE</span>(z_th_gmlt)</div>
<div class="line"><a name="l01991"></a><span class="lineno"> 1991</span>&#160;      <span class="keyword">DEALLOCATE</span>(z_rr_gmlt)</div>
<div class="line"><a name="l01992"></a><span class="lineno"> 1992</span>&#160;      <span class="keyword">DEALLOCATE</span>(z_cr_gmlt)</div>
<div class="line"><a name="l01993"></a><span class="lineno"> 1993</span>&#160;      <span class="keyword">DEALLOCATE</span>(z_cg_gmlt)</div>
<div class="line"><a name="l01994"></a><span class="lineno"> 1994</span>&#160;      <span class="keyword">DEALLOCATE</span>(z_th_deph) </div>
<div class="line"><a name="l01995"></a><span class="lineno"> 1995</span>&#160;      <span class="keyword">DEALLOCATE</span>(z_rh_deph) </div>
<div class="line"><a name="l01996"></a><span class="lineno"> 1996</span>&#160;      <span class="keyword">DEALLOCATE</span>(z_th_weth)</div>
<div class="line"><a name="l01997"></a><span class="lineno"> 1997</span>&#160;      <span class="keyword">DEALLOCATE</span>(z_rc_weth)</div>
<div class="line"><a name="l01998"></a><span class="lineno"> 1998</span>&#160;      <span class="keyword">DEALLOCATE</span>(z_cc_weth)</div>
<div class="line"><a name="l01999"></a><span class="lineno"> 1999</span>&#160;      <span class="keyword">DEALLOCATE</span>(z_rr_weth) </div>
<div class="line"><a name="l02000"></a><span class="lineno"> 2000</span>&#160;      <span class="keyword">DEALLOCATE</span>(z_cr_weth) </div>
<div class="line"><a name="l02001"></a><span class="lineno"> 2001</span>&#160;      <span class="keyword">DEALLOCATE</span>(z_ri_weth)</div>
<div class="line"><a name="l02002"></a><span class="lineno"> 2002</span>&#160;      <span class="keyword">DEALLOCATE</span>(z_ci_weth)</div>
<div class="line"><a name="l02003"></a><span class="lineno"> 2003</span>&#160;      <span class="keyword">DEALLOCATE</span>(z_rs_weth)</div>
<div class="line"><a name="l02004"></a><span class="lineno"> 2004</span>&#160;      <span class="keyword">DEALLOCATE</span>(z_cs_weth)</div>
<div class="line"><a name="l02005"></a><span class="lineno"> 2005</span>&#160;      <span class="keyword">DEALLOCATE</span>(z_rg_weth)</div>
<div class="line"><a name="l02006"></a><span class="lineno"> 2006</span>&#160;      <span class="keyword">DEALLOCATE</span>(z_cg_weth)</div>
<div class="line"><a name="l02007"></a><span class="lineno"> 2007</span>&#160;      <span class="keyword">DEALLOCATE</span>(z_rh_weth) </div>
<div class="line"><a name="l02008"></a><span class="lineno"> 2008</span>&#160;      <span class="keyword">DEALLOCATE</span>(z_rg_cohg)</div>
<div class="line"><a name="l02009"></a><span class="lineno"> 2009</span>&#160;      <span class="keyword">DEALLOCATE</span>(z_cg_cohg)</div>
<div class="line"><a name="l02010"></a><span class="lineno"> 2010</span>&#160;      <span class="keyword">DEALLOCATE</span>(z_th_hmlt) </div>
<div class="line"><a name="l02011"></a><span class="lineno"> 2011</span>&#160;      <span class="keyword">DEALLOCATE</span>(z_rr_hmlt) </div>
<div class="line"><a name="l02012"></a><span class="lineno"> 2012</span>&#160;      <span class="keyword">DEALLOCATE</span>(z_cr_hmlt) </div>
<div class="line"><a name="l02013"></a><span class="lineno"> 2013</span>&#160;      <span class="keyword">DEALLOCATE</span>(z_ch_hmlt) </div>
<div class="line"><a name="l02014"></a><span class="lineno"> 2014</span>&#160; </div>
<div class="line"><a name="l02015"></a><span class="lineno"> 2015</span>&#160;      <span class="keyword">DEALLOCATE</span>(z_rv_corr2)</div>
<div class="line"><a name="l02016"></a><span class="lineno"> 2016</span>&#160;      <span class="keyword">DEALLOCATE</span>(z_rc_corr2)</div>
<div class="line"><a name="l02017"></a><span class="lineno"> 2017</span>&#160;      <span class="keyword">DEALLOCATE</span>(z_rr_corr2)</div>
<div class="line"><a name="l02018"></a><span class="lineno"> 2018</span>&#160;      <span class="keyword">DEALLOCATE</span>(z_ri_corr2)</div>
<div class="line"><a name="l02019"></a><span class="lineno"> 2019</span>&#160;      <span class="keyword">DEALLOCATE</span>(z_cc_corr2)</div>
<div class="line"><a name="l02020"></a><span class="lineno"> 2020</span>&#160;      <span class="keyword">DEALLOCATE</span>(z_cr_corr2)</div>
<div class="line"><a name="l02021"></a><span class="lineno"> 2021</span>&#160;      <span class="keyword">DEALLOCATE</span>(z_ci_corr2)</div>
<div class="line"><a name="l02022"></a><span class="lineno"> 2022</span>&#160;      <span class="comment">!</span></div>
<div class="line"><a name="l02023"></a><span class="lineno"> 2023</span>&#160;<span class="keywordflow">   ENDDO</span></div>
<div class="line"><a name="l02024"></a><span class="lineno"> 2024</span>&#160;<span class="keywordflow">ENDDO</span></div>
<div class="line"><a name="l02025"></a><span class="lineno"> 2025</span>&#160;<span class="comment">!</span></div>
<div class="line"><a name="l02026"></a><span class="lineno"> 2026</span>&#160;<span class="comment">!-------------------------------------------------------------------------------</span></div>
<div class="line"><a name="l02027"></a><span class="lineno"> 2027</span>&#160;<span class="comment">!</span></div>
<div class="line"><a name="l02028"></a><span class="lineno"> 2028</span>&#160;<span class="comment">!*       7.     CLOUD ELECTRIFICATION</span></div>
<div class="line"><a name="l02029"></a><span class="lineno"> 2029</span>&#160;<span class="comment">!               ---------------------</span></div>
<div class="line"><a name="l02030"></a><span class="lineno"> 2030</span>&#160;<span class="comment">!</span></div>
<div class="line"><a name="l02031"></a><span class="lineno"> 2031</span>&#160;<span class="comment">!*       7.1    Packing variables</span></div>
<div class="line"><a name="l02032"></a><span class="lineno"> 2032</span>&#160;<span class="comment">!               -----------------</span></div>
<div class="line"><a name="l02033"></a><span class="lineno"> 2033</span>&#160;<span class="comment">!</span></div>
<div class="line"><a name="l02034"></a><span class="lineno"> 2034</span>&#160;<span class="keywordflow">IF</span> (oelec) <span class="keywordflow">THEN</span></div>
<div class="line"><a name="l02035"></a><span class="lineno"> 2035</span>&#160;  <span class="keyword">ALLOCATE</span>(gmask_elec(<span class="keyword">SIZE</span>(prt,1),<span class="keyword">SIZE</span>(prt,2),<span class="keyword">SIZE</span>(prt,3)))</div>
<div class="line"><a name="l02036"></a><span class="lineno"> 2036</span>&#160;  gmask_elec(:,:,:) = .false.</div>
<div class="line"><a name="l02037"></a><span class="lineno"> 2037</span>&#160;  gmask_elec(:,:,:) = ztot_ri_hind(:,:,:)  .NE. 0. .OR. ztot_rr_honr(:,:,:)  .NE. 0. .OR. &amp;</div>
<div class="line"><a name="l02038"></a><span class="lineno"> 2038</span>&#160;                      ztot_rc_imlt(:,:,:)  .NE. 0. .OR. ztot_rc_honc(:,:,:)  .NE. 0. .OR. &amp;</div>
<div class="line"><a name="l02039"></a><span class="lineno"> 2039</span>&#160;                      ztot_rs_deps(:,:,:)  .NE. 0. .OR. ztot_ri_aggs(:,:,:)  .NE. 0. .OR. &amp;</div>
<div class="line"><a name="l02040"></a><span class="lineno"> 2040</span>&#160;                      ztot_ri_cnvs(:,:,:)  .NE. 0. .OR. ztot_rg_depg(:,:,:)  .NE. 0. .OR. &amp;</div>
<div class="line"><a name="l02041"></a><span class="lineno"> 2041</span>&#160;                      ztot_rc_auto(:,:,:)  .NE. 0. .OR. ztot_rc_accr(:,:,:)  .NE. 0. .OR. &amp;</div>
<div class="line"><a name="l02042"></a><span class="lineno"> 2042</span>&#160;                      ztot_rr_evap(:,:,:)  .NE. 0. .OR. ztot_rc_rimss(:,:,:) .NE. 0. .OR. &amp;</div>
<div class="line"><a name="l02043"></a><span class="lineno"> 2043</span>&#160;                      ztot_rc_rimsg(:,:,:) .NE. 0. .OR. ztot_rs_rimcg(:,:,:) .NE. 0. .OR. &amp;</div>
<div class="line"><a name="l02044"></a><span class="lineno"> 2044</span>&#160;                      ztot_rr_accss(:,:,:) .NE. 0. .OR. ztot_rr_accsg(:,:,:) .NE. 0. .OR. &amp;</div>
<div class="line"><a name="l02045"></a><span class="lineno"> 2045</span>&#160;                      ztot_rs_accrg(:,:,:) .NE. 0. .OR. ztot_rs_cmel(:,:,:)  .NE. 0. .OR. &amp;</div>
<div class="line"><a name="l02046"></a><span class="lineno"> 2046</span>&#160;                      ztot_rr_cfrz(:,:,:)  .NE. 0. .OR. ztot_ri_cfrz(:,:,:)  .NE. 0. .OR. &amp;</div>
<div class="line"><a name="l02047"></a><span class="lineno"> 2047</span>&#160;                      ztot_ri_cibu(:,:,:)  .NE. 0. .OR. ztot_ri_rdsf(:,:,:)  .NE. 0. .OR. &amp;</div>
<div class="line"><a name="l02048"></a><span class="lineno"> 2048</span>&#160;                      ztot_rc_wetg(:,:,:)  .NE. 0. .OR. ztot_ri_wetg(:,:,:)  .NE. 0. .OR. &amp;</div>
<div class="line"><a name="l02049"></a><span class="lineno"> 2049</span>&#160;                      ztot_rr_wetg(:,:,:)  .NE. 0. .OR. ztot_rs_wetg(:,:,:)  .NE. 0. .OR. &amp;</div>
<div class="line"><a name="l02050"></a><span class="lineno"> 2050</span>&#160;                      ztot_rc_dryg(:,:,:)  .NE. 0. .OR. ztot_ri_dryg(:,:,:)  .NE. 0. .OR. &amp;</div>
<div class="line"><a name="l02051"></a><span class="lineno"> 2051</span>&#160;                      ztot_rr_dryg(:,:,:)  .NE. 0. .OR. ztot_rs_dryg(:,:,:)  .NE. 0. .OR. &amp;</div>
<div class="line"><a name="l02052"></a><span class="lineno"> 2052</span>&#160;                      ztot_rh_wetg(:,:,:)  .NE. 0. .OR. ztot_rr_gmlt(:,:,:)  .NE. 0. .OR. &amp;</div>
<div class="line"><a name="l02053"></a><span class="lineno"> 2053</span>&#160;                      ztot_rc_berfi(:,:,:) .NE. 0. .OR. ztot_rv_henu(:,:,:)  .NE. 0. .OR. &amp;</div>
<div class="line"><a name="l02054"></a><span class="lineno"> 2054</span>&#160;                      ztot_rc_hinc(:,:,:)  .NE. 0. .OR. ztot_rv_honh(:,:,:)  .NE. 0. .OR. &amp;</div>
<div class="line"><a name="l02055"></a><span class="lineno"> 2055</span>&#160;                      ztot_rr_cvrc(:,:,:)  .NE. 0. .OR. ztot_ri_cnvi(:,:,:)  .NE. 0. .OR. &amp;</div>
<div class="line"><a name="l02056"></a><span class="lineno"> 2056</span>&#160;                      ztot_ri_depi(:,:,:)  .NE. 0. .OR. ztot_ri_hms(:,:,:)   .NE. 0. .OR. &amp;</div>
<div class="line"><a name="l02057"></a><span class="lineno"> 2057</span>&#160;                      ztot_ri_hmg(:,:,:)   .NE. 0. .OR. ztot_rc_corr2(:,:,:) .NE. 0. .OR. &amp;</div>
<div class="line"><a name="l02058"></a><span class="lineno"> 2058</span>&#160;                      ztot_rr_corr2(:,:,:) .NE. 0. .OR. ztot_ri_corr2(:,:,:) .NE. 0.</div>
<div class="line"><a name="l02059"></a><span class="lineno"> 2059</span>&#160;  <span class="keywordflow">IF</span> (<a class="code" href="namespacemodd__param__lima.html#a8a40a50a7778130438208e2974634384">nmom_h</a> .GE. 1) &amp;</div>
<div class="line"><a name="l02060"></a><span class="lineno"> 2060</span>&#160;    gmask_elec(:,:,:) = gmask_elec(:,:,:)           .OR.                                  &amp;</div>
<div class="line"><a name="l02061"></a><span class="lineno"> 2061</span>&#160;                        ztot_rc_weth(:,:,:) .NE. 0. .OR. ztot_ri_weth(:,:,:) .NE. 0. .OR. &amp;</div>
<div class="line"><a name="l02062"></a><span class="lineno"> 2062</span>&#160;                        ztot_rs_weth(:,:,:) .NE. 0. .OR. ztot_rg_weth(:,:,:) .NE. 0. .OR. &amp;</div>
<div class="line"><a name="l02063"></a><span class="lineno"> 2063</span>&#160;                        ztot_rr_weth(:,:,:) .NE. 0. .OR.                                  &amp;</div>
<div class="line"><a name="l02064"></a><span class="lineno"> 2064</span>&#160;                        <span class="comment">!ZTOT_RC_DRYH(:,:,:) .NE. 0. .OR. ZTOT_RI_DRYH(:,:,:) .NE. 0. .OR. &amp;</span></div>
<div class="line"><a name="l02065"></a><span class="lineno"> 2065</span>&#160;                        <span class="comment">!ZTOT_RS_DRYH(:,:,:) .NE. 0. .OR. ZTOT_RR_DRYH(:,:,:) .NE. 0. .OR. &amp;</span></div>
<div class="line"><a name="l02066"></a><span class="lineno"> 2066</span>&#160;                        <span class="comment">!ZTOT_RG_DRYH(:,:,:) .NE. 0. .OR.                                  &amp;</span></div>
<div class="line"><a name="l02067"></a><span class="lineno"> 2067</span>&#160;                        ztot_rg_cohg(:,:,:) .NE. 0. .OR. ztot_rr_hmlt(:,:,:) .NE. 0.</div>
<div class="line"><a name="l02068"></a><span class="lineno"> 2068</span>&#160;  <span class="comment">!</span></div>
<div class="line"><a name="l02069"></a><span class="lineno"> 2069</span>&#160;  ielec = count(gmask_elec)</div>
<div class="line"><a name="l02070"></a><span class="lineno"> 2070</span>&#160;  <span class="comment">!</span></div>
<div class="line"><a name="l02071"></a><span class="lineno"> 2071</span>&#160;<span class="comment">!</span></div>
<div class="line"><a name="l02072"></a><span class="lineno"> 2072</span>&#160;<span class="comment">!*       7.2    Cloud electrification:</span></div>
<div class="line"><a name="l02073"></a><span class="lineno"> 2073</span>&#160;<span class="comment">!               ---------------------</span></div>
<div class="line"><a name="l02074"></a><span class="lineno"> 2074</span>&#160;<span class="comment">!</span></div>
<div class="line"><a name="l02075"></a><span class="lineno"> 2075</span>&#160;<span class="comment">! Attention, les signes des tendances ne sont pas traites de la meme facon dans ice3 et lima</span></div>
<div class="line"><a name="l02076"></a><span class="lineno"> 2076</span>&#160;<span class="comment">! On se cale sur la facon de faire dans ice3 =&gt; on fait en sorte que les tendances soient positives</span></div>
<div class="line"><a name="l02077"></a><span class="lineno"> 2077</span>&#160;  <span class="keywordflow">IF</span> (<a class="code" href="namespacemodd__param__lima.html#a8a40a50a7778130438208e2974634384">nmom_h</a> .GE. 1) <span class="keywordflow">THEN</span></div>
<div class="line"><a name="l02078"></a><span class="lineno"> 2078</span>&#160;    <span class="keyword">CALL </span><a class="code" href="namespacemode__elec__tendencies.html#a7b9c94cea6e8bcbfca43adef1031fb44">elec_tendencies</a>(d, cst, iced, icep, elecd, elecp,                                              &amp;</div>
<div class="line"><a name="l02079"></a><span class="lineno"> 2079</span>&#160;                         krr, ielec, ptstep, gmask_elec,                                                &amp;</div>
<div class="line"><a name="l02080"></a><span class="lineno"> 2080</span>&#160;                         buconf, tbudgets, kbudgets,                                                    &amp;</div>
<div class="line"><a name="l02081"></a><span class="lineno"> 2081</span>&#160;                         <span class="stringliteral">&#39;LIMA&#39;</span>, pthvrefzikb,                                                           &amp;</div>
<div class="line"><a name="l02082"></a><span class="lineno"> 2082</span>&#160;                         prhodref,  prhodj, zt, zcit_elec,                                              &amp;</div>
<div class="line"><a name="l02083"></a><span class="lineno"> 2083</span>&#160;                         zrvt_elec, zrct_elec, zrrt_elec, zrit_elec, zrst_elec, zrgt_elec,              &amp;</div>
<div class="line"><a name="l02084"></a><span class="lineno"> 2084</span>&#160;                         zqpit, zqct, zqrt, zqit, zqst, zqgt, zqnit,                                    &amp;</div>
<div class="line"><a name="l02085"></a><span class="lineno"> 2085</span>&#160;                         zqpis, zqcs, zqrs, zqis, zqss, zqgs, zqnis,                                    &amp;</div>
<div class="line"><a name="l02086"></a><span class="lineno"> 2086</span>&#160;                         ztot_ri_hind*zinv_tstep,  -ztot_rr_honr*zinv_tstep,   ztot_rc_imlt*zinv_tstep, &amp;</div>
<div class="line"><a name="l02087"></a><span class="lineno"> 2087</span>&#160;                        -ztot_rc_honc*zinv_tstep,   ztot_rs_deps*zinv_tstep,  -ztot_ri_aggs*zinv_tstep, &amp;</div>
<div class="line"><a name="l02088"></a><span class="lineno"> 2088</span>&#160;                        -ztot_ri_cnvs*zinv_tstep,   ztot_rg_depg*zinv_tstep,  -ztot_rc_auto*zinv_tstep, &amp;</div>
<div class="line"><a name="l02089"></a><span class="lineno"> 2089</span>&#160;                        -ztot_rc_accr*zinv_tstep,  -ztot_rr_evap*zinv_tstep,                            &amp;</div>
<div class="line"><a name="l02090"></a><span class="lineno"> 2090</span>&#160;                         ztot_rc_rimss*zinv_tstep,  ztot_rc_rimsg*zinv_tstep,  ztot_rs_rimcg*zinv_tstep,&amp;</div>
<div class="line"><a name="l02091"></a><span class="lineno"> 2091</span>&#160;                         ztot_rr_accss*zinv_tstep,  ztot_rr_accsg*zinv_tstep,  ztot_rs_accrg*zinv_tstep,&amp;</div>
<div class="line"><a name="l02092"></a><span class="lineno"> 2092</span>&#160;                        -ztot_rs_cmel*zinv_tstep,  -ztot_ri_cfrz*zinv_tstep,  -ztot_rr_cfrz*zinv_tstep, &amp;</div>
<div class="line"><a name="l02093"></a><span class="lineno"> 2093</span>&#160;                        -ztot_rc_wetg*zinv_tstep,  -ztot_ri_wetg*zinv_tstep,  -ztot_rr_wetg*zinv_tstep, &amp;</div>
<div class="line"><a name="l02094"></a><span class="lineno"> 2094</span>&#160;                        -ztot_rs_wetg*zinv_tstep,                                                       &amp;</div>
<div class="line"><a name="l02095"></a><span class="lineno"> 2095</span>&#160;                        -ztot_rc_dryg*zinv_tstep,  -ztot_ri_dryg*zinv_tstep,  -ztot_rr_dryg*zinv_tstep, &amp;</div>
<div class="line"><a name="l02096"></a><span class="lineno"> 2096</span>&#160;                        -ztot_rs_dryg*zinv_tstep,                                                       &amp;</div>
<div class="line"><a name="l02097"></a><span class="lineno"> 2097</span>&#160;                         ztot_rr_gmlt*zinv_tstep,  -ztot_rc_berfi*zinv_tstep,                           &amp;</div>
<div class="line"><a name="l02098"></a><span class="lineno"> 2098</span>&#160;<span class="comment">! variables et processus optionnels propres a la grele : pas encore teste</span></div>
<div class="line"><a name="l02099"></a><span class="lineno"> 2099</span>&#160;                         prwetgh=ztot_rh_wetg*zinv_tstep,                                               &amp;</div>
<div class="line"><a name="l02100"></a><span class="lineno"> 2100</span>&#160;                         prcweth=ztot_rc_weth, priweth=ztot_ri_weth, prsweth=ztot_rs_weth,              &amp;</div>
<div class="line"><a name="l02101"></a><span class="lineno"> 2101</span>&#160;                         prgweth=ztot_rg_weth, prrweth=ztot_rr_weth,                                    &amp;</div>
<div class="line"><a name="l02102"></a><span class="lineno"> 2102</span>&#160;<span class="comment">!                         PRCDRYH=ZTOT_RC_DRYH, PRIDRYH=ZTOT_RI_DRYH, PRSDRYH=ZTOT_RS_DRYH,              &amp;</span></div>
<div class="line"><a name="l02103"></a><span class="lineno"> 2103</span>&#160;<span class="comment">!                         PRRDRYH=ZTOT_RR_DRYH, PRGDRYH=ZTOT_RG_DRYH,                                    &amp;</span></div>
<div class="line"><a name="l02104"></a><span class="lineno"> 2104</span>&#160;                         prdryhg=ztot_rg_cohg, prhmltr=ztot_rr_hmlt,                                    &amp;</div>
<div class="line"><a name="l02105"></a><span class="lineno"> 2105</span>&#160;                         prht=zrht, prhs=zrhs, pqht=zqht, pqhs=zqhs, pcht=zcht,                         &amp;</div>
<div class="line"><a name="l02106"></a><span class="lineno"> 2106</span>&#160;<span class="comment">! variables et processus optionnels propres a lima</span></div>
<div class="line"><a name="l02107"></a><span class="lineno"> 2107</span>&#160;                         pcct=zcct_elec, pcrt=zcrt_elec, pcst=zcst_elec, pcgt=zcgt_elec,                &amp;</div>
<div class="line"><a name="l02108"></a><span class="lineno"> 2108</span>&#160;                         prvhenc=ztot_rv_henu*zinv_tstep,    prchinc=-ztot_rc_hinc*zinv_tstep,          &amp;</div>
<div class="line"><a name="l02109"></a><span class="lineno"> 2109</span>&#160;                         prvhonh=-ztot_rv_honh*zinv_tstep,   prrcvrc=-ztot_rr_cvrc*zinv_tstep,          &amp;</div>
<div class="line"><a name="l02110"></a><span class="lineno"> 2110</span>&#160;                         pricnvi=ztot_ri_cnvi*zinv_tstep,    prvdepi=ztot_ri_depi*zinv_tstep,           &amp;</div>
<div class="line"><a name="l02111"></a><span class="lineno"> 2111</span>&#160;                         prshmsi=ztot_ri_hms*zinv_tstep,     prghmgi=ztot_ri_hmg*zinv_tstep,            &amp;</div>
<div class="line"><a name="l02112"></a><span class="lineno"> 2112</span>&#160;                         pricibu=ztot_ri_cibu*zinv_tstep,    prirdsf=ztot_ri_rdsf*zinv_tstep,           &amp;</div>
<div class="line"><a name="l02113"></a><span class="lineno"> 2113</span>&#160;                         prccorr2=-ztot_rc_corr2*zinv_tstep, prrcorr2=-ztot_rr_corr2*zinv_tstep,        &amp;</div>
<div class="line"><a name="l02114"></a><span class="lineno"> 2114</span>&#160;                         pricorr2=-ztot_ri_corr2*zinv_tstep)</div>
<div class="line"><a name="l02115"></a><span class="lineno"> 2115</span>&#160;  <span class="keywordflow">ELSE</span></div>
<div class="line"><a name="l02116"></a><span class="lineno"> 2116</span>&#160;    <span class="keyword">CALL </span><a class="code" href="namespacemode__elec__tendencies.html#a7b9c94cea6e8bcbfca43adef1031fb44">elec_tendencies</a>(d, cst, iced, icep, elecd, elecp,                                              &amp;</div>
<div class="line"><a name="l02117"></a><span class="lineno"> 2117</span>&#160;                         krr, ielec, ptstep, gmask_elec,                                                &amp;</div>
<div class="line"><a name="l02118"></a><span class="lineno"> 2118</span>&#160;                         buconf, tbudgets, kbudgets,                                                    &amp;</div>
<div class="line"><a name="l02119"></a><span class="lineno"> 2119</span>&#160;                         <span class="stringliteral">&#39;LIMA&#39;</span>, pthvrefzikb,                                                           &amp;</div>
<div class="line"><a name="l02120"></a><span class="lineno"> 2120</span>&#160;                         prhodref, prhodj, zt, zcit_elec,                                               &amp;</div>
<div class="line"><a name="l02121"></a><span class="lineno"> 2121</span>&#160;                         zrvt_elec, zrct_elec, zrrt_elec, zrit_elec, zrst_elec, zrgt_elec,              &amp;</div>
<div class="line"><a name="l02122"></a><span class="lineno"> 2122</span>&#160;                         zqpit, zqct, zqrt, zqit, zqst, zqgt, zqnit,                                    &amp;</div>
<div class="line"><a name="l02123"></a><span class="lineno"> 2123</span>&#160;                         zqpis, zqcs, zqrs, zqis, zqss, zqgs, zqnis,                                    &amp;</div>
<div class="line"><a name="l02124"></a><span class="lineno"> 2124</span>&#160;                         ztot_ri_hind*zinv_tstep,  -ztot_rr_honr*zinv_tstep,   ztot_rc_imlt*zinv_tstep, &amp;</div>
<div class="line"><a name="l02125"></a><span class="lineno"> 2125</span>&#160;                        -ztot_rc_honc*zinv_tstep,   ztot_rs_deps*zinv_tstep,  -ztot_ri_aggs*zinv_tstep, &amp;</div>
<div class="line"><a name="l02126"></a><span class="lineno"> 2126</span>&#160;                        -ztot_ri_cnvs*zinv_tstep,   ztot_rg_depg*zinv_tstep,  -ztot_rc_auto*zinv_tstep, &amp;</div>
<div class="line"><a name="l02127"></a><span class="lineno"> 2127</span>&#160;                        -ztot_rc_accr*zinv_tstep,  -ztot_rr_evap*zinv_tstep,                            &amp;</div>
<div class="line"><a name="l02128"></a><span class="lineno"> 2128</span>&#160;                         ztot_rc_rimss*zinv_tstep,  ztot_rc_rimsg*zinv_tstep,  ztot_rs_rimcg*zinv_tstep,&amp;</div>
<div class="line"><a name="l02129"></a><span class="lineno"> 2129</span>&#160;                         ztot_rr_accss*zinv_tstep,  ztot_rr_accsg*zinv_tstep,  ztot_rs_accrg*zinv_tstep,&amp;</div>
<div class="line"><a name="l02130"></a><span class="lineno"> 2130</span>&#160;                        -ztot_rs_cmel*zinv_tstep,  -ztot_ri_cfrz*zinv_tstep,  -ztot_rr_cfrz*zinv_tstep, &amp;</div>
<div class="line"><a name="l02131"></a><span class="lineno"> 2131</span>&#160;                        -ztot_rc_wetg*zinv_tstep,  -ztot_ri_wetg*zinv_tstep,  -ztot_rr_wetg*zinv_tstep, &amp;</div>
<div class="line"><a name="l02132"></a><span class="lineno"> 2132</span>&#160;                        -ztot_rs_wetg*zinv_tstep,                                                       &amp;</div>
<div class="line"><a name="l02133"></a><span class="lineno"> 2133</span>&#160;                        -ztot_rc_dryg*zinv_tstep,  -ztot_ri_dryg*zinv_tstep,  -ztot_rr_dryg*zinv_tstep, &amp;</div>
<div class="line"><a name="l02134"></a><span class="lineno"> 2134</span>&#160;                        -ztot_rs_dryg*zinv_tstep,                                                       &amp;</div>
<div class="line"><a name="l02135"></a><span class="lineno"> 2135</span>&#160;                         ztot_rr_gmlt*zinv_tstep,  -ztot_rc_berfi*zinv_tstep,                           &amp;</div>
<div class="line"><a name="l02136"></a><span class="lineno"> 2136</span>&#160;<span class="comment">! variables et processus optionnels propres a lima</span></div>
<div class="line"><a name="l02137"></a><span class="lineno"> 2137</span>&#160;                         pcct=zcct, pcrt=zcrt, pcst=zcst, pcgt=zcgt,                                    &amp;</div>
<div class="line"><a name="l02138"></a><span class="lineno"> 2138</span>&#160;                         prvhenc=ztot_rv_henu*zinv_tstep,    prchinc=-ztot_rc_hinc*zinv_tstep,          &amp;</div>
<div class="line"><a name="l02139"></a><span class="lineno"> 2139</span>&#160;                         prvhonh=-ztot_rv_honh*zinv_tstep,   prrcvrc=-ztot_rr_cvrc*zinv_tstep,          &amp;</div>
<div class="line"><a name="l02140"></a><span class="lineno"> 2140</span>&#160;                         pricnvi=ztot_ri_cnvi*zinv_tstep,    prvdepi=ztot_ri_depi*zinv_tstep,           &amp;</div>
<div class="line"><a name="l02141"></a><span class="lineno"> 2141</span>&#160;                         prshmsi=ztot_ri_hms*zinv_tstep,     prghmgi=ztot_ri_hmg*zinv_tstep,            &amp;</div>
<div class="line"><a name="l02142"></a><span class="lineno"> 2142</span>&#160;                         pricibu=ztot_ri_cibu*zinv_tstep,    prirdsf=ztot_ri_rdsf*zinv_tstep,           &amp;</div>
<div class="line"><a name="l02143"></a><span class="lineno"> 2143</span>&#160;                         prccorr2=-ztot_rc_corr2*zinv_tstep, prrcorr2=-ztot_rr_corr2*zinv_tstep,        &amp;</div>
<div class="line"><a name="l02144"></a><span class="lineno"> 2144</span>&#160;                         pricorr2=-ztot_ri_corr2*zinv_tstep)            </div>
<div class="line"><a name="l02145"></a><span class="lineno"> 2145</span>&#160;<span class="keywordflow">  END IF</span></div>
<div class="line"><a name="l02146"></a><span class="lineno"> 2146</span>&#160;  <span class="comment">!</span></div>
<div class="line"><a name="l02147"></a><span class="lineno"> 2147</span>&#160;  <span class="comment">! update the source variables</span></div>
<div class="line"><a name="l02148"></a><span class="lineno"> 2148</span>&#160;  psv_elec_s(:,:,:,1) = zqpis(:,:,:)</div>
<div class="line"><a name="l02149"></a><span class="lineno"> 2149</span>&#160;  psv_elec_s(:,:,:,2) = zqcs(:,:,:)</div>
<div class="line"><a name="l02150"></a><span class="lineno"> 2150</span>&#160;  psv_elec_s(:,:,:,3) = zqrs(:,:,:)</div>
<div class="line"><a name="l02151"></a><span class="lineno"> 2151</span>&#160;  psv_elec_s(:,:,:,4) = zqis(:,:,:)</div>
<div class="line"><a name="l02152"></a><span class="lineno"> 2152</span>&#160;  psv_elec_s(:,:,:,5) = zqss(:,:,:)</div>
<div class="line"><a name="l02153"></a><span class="lineno"> 2153</span>&#160;  psv_elec_s(:,:,:,6) = zqgs(:,:,:)</div>
<div class="line"><a name="l02154"></a><span class="lineno"> 2154</span>&#160;  <span class="keywordflow">IF</span> (krr == 6) <span class="keywordflow">THEN</span></div>
<div class="line"><a name="l02155"></a><span class="lineno"> 2155</span>&#160;    psv_elec_s(:,:,:,7) = zqnis(:,:,:)</div>
<div class="line"><a name="l02156"></a><span class="lineno"> 2156</span>&#160;  <span class="keywordflow">ELSE</span> <span class="keywordflow">IF</span> (krr == 7) <span class="keywordflow">THEN</span></div>
<div class="line"><a name="l02157"></a><span class="lineno"> 2157</span>&#160;    psv_elec_s(:,:,:,7) = zqhs(:,:,:)</div>
<div class="line"><a name="l02158"></a><span class="lineno"> 2158</span>&#160;    psv_elec_s(:,:,:,8) = zqnis(:,:,:)</div>
<div class="line"><a name="l02159"></a><span class="lineno"> 2159</span>&#160;<span class="keywordflow">  END IF</span></div>
<div class="line"><a name="l02160"></a><span class="lineno"> 2160</span>&#160;  <span class="comment">!</span></div>
<div class="line"><a name="l02161"></a><span class="lineno"> 2161</span>&#160;  <span class="keyword">DEALLOCATE</span>(gmask_elec)</div>
<div class="line"><a name="l02162"></a><span class="lineno"> 2162</span>&#160;  <span class="comment">!</span></div>
<div class="line"><a name="l02163"></a><span class="lineno"> 2163</span>&#160;  <span class="keyword">DEALLOCATE</span>(zqpit)</div>
<div class="line"><a name="l02164"></a><span class="lineno"> 2164</span>&#160;  <span class="keyword">DEALLOCATE</span>(zqnit)</div>
<div class="line"><a name="l02165"></a><span class="lineno"> 2165</span>&#160;  <span class="keyword">DEALLOCATE</span>(zqct)</div>
<div class="line"><a name="l02166"></a><span class="lineno"> 2166</span>&#160;  <span class="keyword">DEALLOCATE</span>(zqrt)</div>
<div class="line"><a name="l02167"></a><span class="lineno"> 2167</span>&#160;  <span class="keyword">DEALLOCATE</span>(zqit)</div>
<div class="line"><a name="l02168"></a><span class="lineno"> 2168</span>&#160;  <span class="keyword">DEALLOCATE</span>(zqst)</div>
<div class="line"><a name="l02169"></a><span class="lineno"> 2169</span>&#160;  <span class="keyword">DEALLOCATE</span>(zqgt)</div>
<div class="line"><a name="l02170"></a><span class="lineno"> 2170</span>&#160;  <span class="keywordflow">IF</span> (<span class="keyword">ALLOCATED</span>(zqht)) <span class="keyword">DEALLOCATE</span>(zqht)</div>
<div class="line"><a name="l02171"></a><span class="lineno"> 2171</span>&#160;  <span class="keyword">DEALLOCATE</span>(zqpis)</div>
<div class="line"><a name="l02172"></a><span class="lineno"> 2172</span>&#160;  <span class="keyword">DEALLOCATE</span>(zqnis)</div>
<div class="line"><a name="l02173"></a><span class="lineno"> 2173</span>&#160;  <span class="keyword">DEALLOCATE</span>(zqcs)</div>
<div class="line"><a name="l02174"></a><span class="lineno"> 2174</span>&#160;  <span class="keyword">DEALLOCATE</span>(zqrs)</div>
<div class="line"><a name="l02175"></a><span class="lineno"> 2175</span>&#160;  <span class="keyword">DEALLOCATE</span>(zqis)</div>
<div class="line"><a name="l02176"></a><span class="lineno"> 2176</span>&#160;  <span class="keyword">DEALLOCATE</span>(zqss)</div>
<div class="line"><a name="l02177"></a><span class="lineno"> 2177</span>&#160;  <span class="keyword">DEALLOCATE</span>(zqgs)</div>
<div class="line"><a name="l02178"></a><span class="lineno"> 2178</span>&#160;  <span class="keywordflow">IF</span> (<span class="keyword">ALLOCATED</span>(zqhs)) <span class="keyword">DEALLOCATE</span>(zqhs)</div>
<div class="line"><a name="l02179"></a><span class="lineno"> 2179</span>&#160;  <span class="comment">!</span></div>
<div class="line"><a name="l02180"></a><span class="lineno"> 2180</span>&#160;  <span class="keyword">DEALLOCATE</span>(zrvt_elec)</div>
<div class="line"><a name="l02181"></a><span class="lineno"> 2181</span>&#160;  <span class="keyword">DEALLOCATE</span>(zrct_elec)</div>
<div class="line"><a name="l02182"></a><span class="lineno"> 2182</span>&#160;  <span class="keyword">DEALLOCATE</span>(zrrt_elec)</div>
<div class="line"><a name="l02183"></a><span class="lineno"> 2183</span>&#160;  <span class="keyword">DEALLOCATE</span>(zrit_elec)</div>
<div class="line"><a name="l02184"></a><span class="lineno"> 2184</span>&#160;  <span class="keyword">DEALLOCATE</span>(zrst_elec)</div>
<div class="line"><a name="l02185"></a><span class="lineno"> 2185</span>&#160;  <span class="keyword">DEALLOCATE</span>(zrgt_elec)</div>
<div class="line"><a name="l02186"></a><span class="lineno"> 2186</span>&#160;  <span class="keywordflow">IF</span> (<span class="keyword">ALLOCATED</span>(zrht_elec)) <span class="keyword">DEALLOCATE</span>(zrht_elec)</div>
<div class="line"><a name="l02187"></a><span class="lineno"> 2187</span>&#160;  <span class="keywordflow">IF</span> (<span class="keyword">ALLOCATED</span>(zcct_elec)) <span class="keyword">DEALLOCATE</span>(zcct_elec)</div>
<div class="line"><a name="l02188"></a><span class="lineno"> 2188</span>&#160;  <span class="keywordflow">IF</span> (<span class="keyword">ALLOCATED</span>(zcrt_elec)) <span class="keyword">DEALLOCATE</span>(zcrt_elec)</div>
<div class="line"><a name="l02189"></a><span class="lineno"> 2189</span>&#160;  <span class="keywordflow">IF</span> (<span class="keyword">ALLOCATED</span>(zcit_elec)) <span class="keyword">DEALLOCATE</span>(zcit_elec)</div>
<div class="line"><a name="l02190"></a><span class="lineno"> 2190</span>&#160;  <span class="keywordflow">IF</span> (<span class="keyword">ALLOCATED</span>(zcst_elec)) <span class="keyword">DEALLOCATE</span>(zcst_elec)</div>
<div class="line"><a name="l02191"></a><span class="lineno"> 2191</span>&#160;  <span class="keywordflow">IF</span> (<span class="keyword">ALLOCATED</span>(zcgt_elec)) <span class="keyword">DEALLOCATE</span>(zcgt_elec)</div>
<div class="line"><a name="l02192"></a><span class="lineno"> 2192</span>&#160;  <span class="keywordflow">IF</span> (<span class="keyword">ALLOCATED</span>(zcht_elec)) <span class="keyword">DEALLOCATE</span>(zcht_elec)</div>
<div class="line"><a name="l02193"></a><span class="lineno"> 2193</span>&#160;  <span class="comment">!</span></div>
<div class="line"><a name="l02194"></a><span class="lineno"> 2194</span>&#160;<span class="keywordflow">END IF</span></div>
<div class="line"><a name="l02195"></a><span class="lineno"> 2195</span>&#160;<span class="comment">!</span></div>
<div class="line"><a name="l02196"></a><span class="lineno"> 2196</span>&#160;<span class="keyword">DEALLOCATE</span>(ztot_ri_hind)</div>
<div class="line"><a name="l02197"></a><span class="lineno"> 2197</span>&#160;<span class="keyword">DEALLOCATE</span>(ztot_rc_hinc)</div>
<div class="line"><a name="l02198"></a><span class="lineno"> 2198</span>&#160;<span class="keyword">DEALLOCATE</span>(ztot_rv_henu)</div>
<div class="line"><a name="l02199"></a><span class="lineno"> 2199</span>&#160;<span class="keyword">DEALLOCATE</span>(ztot_rv_honh)</div>
<div class="line"><a name="l02200"></a><span class="lineno"> 2200</span>&#160;<span class="comment">!</span></div>
<div class="line"><a name="l02201"></a><span class="lineno"> 2201</span>&#160;<span class="comment">!</span></div>
<div class="line"><a name="l02202"></a><span class="lineno"> 2202</span>&#160;<span class="comment">!*       7.3    Unpacking variables</span></div>
<div class="line"><a name="l02203"></a><span class="lineno"> 2203</span>&#160;<span class="comment">!               -------------------</span></div>
<div class="line"><a name="l02204"></a><span class="lineno"> 2204</span>&#160;<span class="comment">!</span></div>
<div class="line"><a name="l02205"></a><span class="lineno"> 2205</span>&#160;<span class="comment">! not necessary! the only variables needed in the following (PQxS) are already 3D</span></div>
<div class="line"><a name="l02206"></a><span class="lineno"> 2206</span>&#160;<span class="comment">!</span></div>
<div class="line"><a name="l02207"></a><span class="lineno"> 2207</span>&#160;<span class="comment">!</span></div>
<div class="line"><a name="l02208"></a><span class="lineno"> 2208</span>&#160;<span class="comment">!-------------------------------------------------------------------------------</span></div>
<div class="line"><a name="l02209"></a><span class="lineno"> 2209</span>&#160;<span class="comment">!</span></div>
<div class="line"><a name="l02210"></a><span class="lineno"> 2210</span>&#160;<span class="comment">!*       7.     TOTAL TENDENCIES</span></div>
<div class="line"><a name="l02211"></a><span class="lineno"> 2211</span>&#160;<span class="comment">!               ----------------</span></div>
<div class="line"><a name="l02212"></a><span class="lineno"> 2212</span>&#160;<span class="comment">!</span></div>
<div class="line"><a name="l02213"></a><span class="lineno"> 2213</span>&#160;<span class="comment">! Source at the end of microphysics = new state / PTSTEP</span></div>
<div class="line"><a name="l02214"></a><span class="lineno"> 2214</span>&#160;<span class="comment">!</span></div>
<div class="line"><a name="l02215"></a><span class="lineno"> 2215</span>&#160;pths(:,:,:) = ztht(:,:,:) * zinv_tstep</div>
<div class="line"><a name="l02216"></a><span class="lineno"> 2216</span>&#160;<span class="comment">!</span></div>
<div class="line"><a name="l02217"></a><span class="lineno"> 2217</span>&#160;prs(:,:,:,1) = zrvt(:,:,:) *zinv_tstep</div>
<div class="line"><a name="l02218"></a><span class="lineno"> 2218</span>&#160;<span class="keywordflow">IF</span> ( krr .GE. 2 ) prs(:,:,:,2) = zrct(:,:,:) *zinv_tstep</div>
<div class="line"><a name="l02219"></a><span class="lineno"> 2219</span>&#160;<span class="keywordflow">IF</span> ( krr .GE. 3 ) prs(:,:,:,3) = zrrt(:,:,:) *zinv_tstep</div>
<div class="line"><a name="l02220"></a><span class="lineno"> 2220</span>&#160;<span class="keywordflow">IF</span> ( krr .GE. 4 ) prs(:,:,:,4) = zrit(:,:,:) *zinv_tstep</div>
<div class="line"><a name="l02221"></a><span class="lineno"> 2221</span>&#160;<span class="keywordflow">IF</span> ( krr .GE. 5 ) prs(:,:,:,5) = zrst(:,:,:) *zinv_tstep</div>
<div class="line"><a name="l02222"></a><span class="lineno"> 2222</span>&#160;<span class="keywordflow">IF</span> ( krr .GE. 6 ) prs(:,:,:,6) = zrgt(:,:,:) *zinv_tstep</div>
<div class="line"><a name="l02223"></a><span class="lineno"> 2223</span>&#160;<span class="keywordflow">IF</span> ( krr .GE. 7 ) prs(:,:,:,7) = zrht(:,:,:) *zinv_tstep</div>
<div class="line"><a name="l02224"></a><span class="lineno"> 2224</span>&#160;<span class="comment">!</span></div>
<div class="line"><a name="l02225"></a><span class="lineno"> 2225</span>&#160;<span class="keywordflow">IF</span> ( <a class="code" href="namespacemodd__param__lima.html#ab0c8298b017b75cbd419d8b1980b0053">nmom_c</a>.GE.2 ) psvs(:,:,:,isv_lima_nc) = zcct(:,:,:) *zinv_tstep</div>
<div class="line"><a name="l02226"></a><span class="lineno"> 2226</span>&#160;<span class="keywordflow">IF</span> ( <a class="code" href="namespacemodd__param__lima.html#a7accc5c4a0a391c040a1de5e966eea04">nmom_r</a>.GE.2 ) psvs(:,:,:,isv_lima_nr) = zcrt(:,:,:) *zinv_tstep</div>
<div class="line"><a name="l02227"></a><span class="lineno"> 2227</span>&#160;<span class="keywordflow">IF</span> ( <a class="code" href="namespacemodd__param__lima.html#ab11c5caa054b5039171a4f10908abea1">nmom_i</a>.GE.2 ) psvs(:,:,:,isv_lima_ni) = zcit(:,:,:) *zinv_tstep</div>
<div class="line"><a name="l02228"></a><span class="lineno"> 2228</span>&#160;<span class="keywordflow">IF</span> ( <a class="code" href="namespacemodd__param__lima.html#a63b4f80fe043e01602ef78b2caf0e487">nmom_s</a>.GE.2 ) psvs(:,:,:,isv_lima_ns) = zcst(:,:,:) *zinv_tstep</div>
<div class="line"><a name="l02229"></a><span class="lineno"> 2229</span>&#160;<span class="keywordflow">IF</span> ( <a class="code" href="namespacemodd__param__lima.html#acd76d6876dec7668fc081a4380690182">nmom_g</a>.GE.2 ) psvs(:,:,:,isv_lima_ng) = zcgt(:,:,:) *zinv_tstep</div>
<div class="line"><a name="l02230"></a><span class="lineno"> 2230</span>&#160;<span class="keywordflow">IF</span> ( <a class="code" href="namespacemodd__param__lima.html#a8a40a50a7778130438208e2974634384">nmom_h</a>.GE.2 ) psvs(:,:,:,isv_lima_nh) = zcht(:,:,:) *zinv_tstep</div>
<div class="line"><a name="l02231"></a><span class="lineno"> 2231</span>&#160;<span class="comment">!</span></div>
<div class="line"><a name="l02232"></a><span class="lineno"> 2232</span>&#160;<span class="keywordflow">IF</span> ( <a class="code" href="namespacemodd__param__lima.html#a19683462cda57db522fcb0b8988b8d27">nmod_ccn</a> .GE. 1 )   psvs(:,:,:,isv_lima_ccn_free:isv_lima_ccn_free+<a class="code" href="namespacemodd__param__lima.html#a19683462cda57db522fcb0b8988b8d27">nmod_ccn</a>-1) = zccnft(:,:,:,:) *zinv_tstep</div>
<div class="line"><a name="l02233"></a><span class="lineno"> 2233</span>&#160;<span class="keywordflow">IF</span> ( <a class="code" href="namespacemodd__param__lima.html#a19683462cda57db522fcb0b8988b8d27">nmod_ccn</a> .GE. 1 )   psvs(:,:,:,isv_lima_ccn_acti:isv_lima_ccn_acti+<a class="code" href="namespacemodd__param__lima.html#a19683462cda57db522fcb0b8988b8d27">nmod_ccn</a>-1) = zccnat(:,:,:,:) *zinv_tstep</div>
<div class="line"><a name="l02234"></a><span class="lineno"> 2234</span>&#160;<span class="keywordflow">IF</span> ( <a class="code" href="namespacemodd__param__lima.html#a2b98a3f23053acfd971d523a0778f209">nmod_ifn</a> .GE. 1 )   psvs(:,:,:,isv_lima_ifn_free:isv_lima_ifn_free+<a class="code" href="namespacemodd__param__lima.html#a2b98a3f23053acfd971d523a0778f209">nmod_ifn</a>-1) = zifnft(:,:,:,:) *zinv_tstep</div>
<div class="line"><a name="l02235"></a><span class="lineno"> 2235</span>&#160;<span class="keywordflow">IF</span> ( <a class="code" href="namespacemodd__param__lima.html#a2b98a3f23053acfd971d523a0778f209">nmod_ifn</a> .GE. 1 )   psvs(:,:,:,isv_lima_ifn_nucl:isv_lima_ifn_nucl+<a class="code" href="namespacemodd__param__lima.html#a2b98a3f23053acfd971d523a0778f209">nmod_ifn</a>-1) = zifnnt(:,:,:,:) *zinv_tstep</div>
<div class="line"><a name="l02236"></a><span class="lineno"> 2236</span>&#160;<span class="keywordflow">IF</span> ( <a class="code" href="namespacemodd__param__lima.html#a773a34608ac83913168a35ea1a39332a">nmod_imm</a> .GE. 1 )   psvs(:,:,:,isv_lima_imm_nucl:isv_lima_imm_nucl+<a class="code" href="namespacemodd__param__lima.html#a773a34608ac83913168a35ea1a39332a">nmod_imm</a>-1) = zimmnt(:,:,:,:) *zinv_tstep</div>
<div class="line"><a name="l02237"></a><span class="lineno"> 2237</span>&#160;<span class="keywordflow">IF</span> ( <a class="code" href="namespacemodd__param__lima.html#a0b11d7560a8fc0aa79bb054ab51fea88">lhhoni</a>) psvs(:,:,:,isv_lima_hom_haze) = zhomft(:,:,:) *zinv_tstep</div>
<div class="line"><a name="l02238"></a><span class="lineno"> 2238</span>&#160;<span class="comment">!</span></div>
<div class="line"><a name="l02239"></a><span class="lineno"> 2239</span>&#160;<span class="comment">!</span></div>
<div class="line"><a name="l02240"></a><span class="lineno"> 2240</span>&#160;<span class="comment">!</span></div>
<div class="line"><a name="l02241"></a><span class="lineno"> 2241</span>&#160;<span class="comment">! Call budgets</span></div>
<div class="line"><a name="l02242"></a><span class="lineno"> 2242</span>&#160;<span class="comment">!</span></div>
<div class="line"><a name="l02243"></a><span class="lineno"> 2243</span>&#160;<span class="keywordflow">if</span> ( buconf%lbu_enable ) <span class="keywordflow">then</span></div>
<div class="line"><a name="l02244"></a><span class="lineno"> 2244</span>&#160;  <span class="keyword">allocate</span>( zrhodjontstep(<span class="keyword">size</span>( prhodj, 1), <span class="keyword">size</span>( prhodj, 2), <span class="keyword">size</span>( prhodj, 3) ) )</div>
<div class="line"><a name="l02245"></a><span class="lineno"> 2245</span>&#160;  zrhodjontstep(:, :, :) = zinv_tstep * prhodj(:, :, :)</div>
<div class="line"><a name="l02246"></a><span class="lineno"> 2246</span>&#160; </div>
<div class="line"><a name="l02247"></a><span class="lineno"> 2247</span>&#160;  <span class="keywordflow">if</span> ( buconf%lbudget_th ) <span class="keywordflow">then</span></div>
<div class="line"><a name="l02248"></a><span class="lineno"> 2248</span>&#160;    <span class="keyword">call </span><a class="code" href="namespacemode__budget__phy.html#a865df6090077e33576dd3b4866709b87">budget_store_add_phy</a>(d, tbudgets(<a class="code" href="namespacemodd__budget.html#a0d120a8b4c8fb6af560c814c1d3c2c19">nbudget_th</a>), <span class="stringliteral">&#39;REVA&#39;</span>,  ztot_th_evap(:, :, :) * zrhodjontstep(:, :, :) )</div>
<div class="line"><a name="l02249"></a><span class="lineno"> 2249</span>&#160;    <span class="keyword">call </span><a class="code" href="namespacemode__budget__phy.html#a865df6090077e33576dd3b4866709b87">budget_store_add_phy</a>(d, tbudgets(<a class="code" href="namespacemodd__budget.html#a0d120a8b4c8fb6af560c814c1d3c2c19">nbudget_th</a>), <span class="stringliteral">&#39;HONC&#39;</span>,  ztot_th_honc(:, :, :) * zrhodjontstep(:, :, :) )</div>
<div class="line"><a name="l02250"></a><span class="lineno"> 2250</span>&#160;    <span class="keyword">call </span><a class="code" href="namespacemode__budget__phy.html#a865df6090077e33576dd3b4866709b87">budget_store_add_phy</a>(d, tbudgets(<a class="code" href="namespacemodd__budget.html#a0d120a8b4c8fb6af560c814c1d3c2c19">nbudget_th</a>), <span class="stringliteral">&#39;HONR&#39;</span>,  ztot_th_honr(:, :, :) * zrhodjontstep(:, :, :) )</div>
<div class="line"><a name="l02251"></a><span class="lineno"> 2251</span>&#160;    <span class="keyword">call </span><a class="code" href="namespacemode__budget__phy.html#a865df6090077e33576dd3b4866709b87">budget_store_add_phy</a>(d, tbudgets(<a class="code" href="namespacemodd__budget.html#a0d120a8b4c8fb6af560c814c1d3c2c19">nbudget_th</a>), <span class="stringliteral">&#39;DEPS&#39;</span>,  ztot_th_deps(:, :, :) * zrhodjontstep(:, :, :) )</div>
<div class="line"><a name="l02252"></a><span class="lineno"> 2252</span>&#160;    <span class="keyword">call </span><a class="code" href="namespacemode__budget__phy.html#a865df6090077e33576dd3b4866709b87">budget_store_add_phy</a>(d, tbudgets(<a class="code" href="namespacemodd__budget.html#a0d120a8b4c8fb6af560c814c1d3c2c19">nbudget_th</a>), <span class="stringliteral">&#39;DEPI&#39;</span>,  ztot_th_depi(:, :, :) * zrhodjontstep(:, :, :) )</div>
<div class="line"><a name="l02253"></a><span class="lineno"> 2253</span>&#160;    <span class="keyword">call </span><a class="code" href="namespacemode__budget__phy.html#a865df6090077e33576dd3b4866709b87">budget_store_add_phy</a>(d, tbudgets(<a class="code" href="namespacemodd__budget.html#a0d120a8b4c8fb6af560c814c1d3c2c19">nbudget_th</a>), <span class="stringliteral">&#39;DEPG&#39;</span>,  ztot_th_depg(:, :, :) * zrhodjontstep(:, :, :) )</div>
<div class="line"><a name="l02254"></a><span class="lineno"> 2254</span>&#160;    <span class="keyword">call </span><a class="code" href="namespacemode__budget__phy.html#a865df6090077e33576dd3b4866709b87">budget_store_add_phy</a>(d, tbudgets(<a class="code" href="namespacemodd__budget.html#a0d120a8b4c8fb6af560c814c1d3c2c19">nbudget_th</a>), <span class="stringliteral">&#39;IMLT&#39;</span>,  ztot_th_imlt(:, :, :) * zrhodjontstep(:, :, :) )</div>
<div class="line"><a name="l02255"></a><span class="lineno"> 2255</span>&#160;    <span class="keyword">call </span><a class="code" href="namespacemode__budget__phy.html#a865df6090077e33576dd3b4866709b87">budget_store_add_phy</a>(d, tbudgets(<a class="code" href="namespacemodd__budget.html#a0d120a8b4c8fb6af560c814c1d3c2c19">nbudget_th</a>), <span class="stringliteral">&#39;BERFI&#39;</span>, ztot_th_berfi(:, :, :) * zrhodjontstep(:, :, :) )</div>
<div class="line"><a name="l02256"></a><span class="lineno"> 2256</span>&#160;    <span class="keyword">call </span><a class="code" href="namespacemode__budget__phy.html#a865df6090077e33576dd3b4866709b87">budget_store_add_phy</a>(d, tbudgets(<a class="code" href="namespacemodd__budget.html#a0d120a8b4c8fb6af560c814c1d3c2c19">nbudget_th</a>), <span class="stringliteral">&#39;RIM&#39;</span>,   ztot_th_rim(:, :, :) * zrhodjontstep(:, :, :) )</div>
<div class="line"><a name="l02257"></a><span class="lineno"> 2257</span>&#160;    <span class="keyword">call </span><a class="code" href="namespacemode__budget__phy.html#a865df6090077e33576dd3b4866709b87">budget_store_add_phy</a>(d, tbudgets(<a class="code" href="namespacemodd__budget.html#a0d120a8b4c8fb6af560c814c1d3c2c19">nbudget_th</a>), <span class="stringliteral">&#39;ACC&#39;</span>,   ztot_th_acc(:, :, :) * zrhodjontstep(:, :, :) )</div>
<div class="line"><a name="l02258"></a><span class="lineno"> 2258</span>&#160;    <span class="keyword">call </span><a class="code" href="namespacemode__budget__phy.html#a865df6090077e33576dd3b4866709b87">budget_store_add_phy</a>(d, tbudgets(<a class="code" href="namespacemodd__budget.html#a0d120a8b4c8fb6af560c814c1d3c2c19">nbudget_th</a>), <span class="stringliteral">&#39;CFRZ&#39;</span>,  ztot_th_cfrz(:, :, :) * zrhodjontstep(:, :, :) )</div>
<div class="line"><a name="l02259"></a><span class="lineno"> 2259</span>&#160;    <span class="keyword">call </span><a class="code" href="namespacemode__budget__phy.html#a865df6090077e33576dd3b4866709b87">budget_store_add_phy</a>(d, tbudgets(<a class="code" href="namespacemodd__budget.html#a0d120a8b4c8fb6af560c814c1d3c2c19">nbudget_th</a>), <span class="stringliteral">&#39;WETG&#39;</span>,  ztot_th_wetg(:, :, :) * zrhodjontstep(:, :, :) )</div>
<div class="line"><a name="l02260"></a><span class="lineno"> 2260</span>&#160;    <span class="keyword">call </span><a class="code" href="namespacemode__budget__phy.html#a865df6090077e33576dd3b4866709b87">budget_store_add_phy</a>(d, tbudgets(<a class="code" href="namespacemodd__budget.html#a0d120a8b4c8fb6af560c814c1d3c2c19">nbudget_th</a>), <span class="stringliteral">&#39;DRYG&#39;</span>,  ztot_th_dryg(:, :, :) * zrhodjontstep(:, :, :) )</div>
<div class="line"><a name="l02261"></a><span class="lineno"> 2261</span>&#160;    <span class="keyword">call </span><a class="code" href="namespacemode__budget__phy.html#a865df6090077e33576dd3b4866709b87">budget_store_add_phy</a>(d, tbudgets(<a class="code" href="namespacemodd__budget.html#a0d120a8b4c8fb6af560c814c1d3c2c19">nbudget_th</a>), <span class="stringliteral">&#39;GMLT&#39;</span>,  ztot_th_gmlt(:, :, :) * zrhodjontstep(:, :, :) )</div>
<div class="line"><a name="l02262"></a><span class="lineno"> 2262</span>&#160;    <span class="keyword">call </span><a class="code" href="namespacemode__budget__phy.html#a865df6090077e33576dd3b4866709b87">budget_store_add_phy</a>(d, tbudgets(<a class="code" href="namespacemodd__budget.html#a0d120a8b4c8fb6af560c814c1d3c2c19">nbudget_th</a>), <span class="stringliteral">&#39;DEPH&#39;</span>,  ztot_th_deph(:, :, :) * zrhodjontstep(:, :, :) )</div>
<div class="line"><a name="l02263"></a><span class="lineno"> 2263</span>&#160;    <span class="keyword">call </span><a class="code" href="namespacemode__budget__phy.html#a865df6090077e33576dd3b4866709b87">budget_store_add_phy</a>(d, tbudgets(<a class="code" href="namespacemodd__budget.html#a0d120a8b4c8fb6af560c814c1d3c2c19">nbudget_th</a>), <span class="stringliteral">&#39;WETH&#39;</span>,  ztot_th_weth(:, :, :) * zrhodjontstep(:, :, :) )</div>
<div class="line"><a name="l02264"></a><span class="lineno"> 2264</span>&#160;    <span class="keyword">call </span><a class="code" href="namespacemode__budget__phy.html#a865df6090077e33576dd3b4866709b87">budget_store_add_phy</a>(d, tbudgets(<a class="code" href="namespacemodd__budget.html#a0d120a8b4c8fb6af560c814c1d3c2c19">nbudget_th</a>), <span class="stringliteral">&#39;HMLT&#39;</span>,  ztot_th_hmlt(:, :, :) * zrhodjontstep(:, :, :) )</div>
<div class="line"><a name="l02265"></a><span class="lineno"> 2265</span>&#160;<span class="keywordflow">  end if</span></div>
<div class="line"><a name="l02266"></a><span class="lineno"> 2266</span>&#160; </div>
<div class="line"><a name="l02267"></a><span class="lineno"> 2267</span>&#160;  <span class="keywordflow">if</span> ( buconf%lbudget_rv ) <span class="keywordflow">then</span></div>
<div class="line"><a name="l02268"></a><span class="lineno"> 2268</span>&#160;    <span class="keyword">call </span><a class="code" href="namespacemode__budget__phy.html#a865df6090077e33576dd3b4866709b87">budget_store_add_phy</a>(d, tbudgets(<a class="code" href="namespacemodd__budget.html#a032a9fef7c9e0c47fa34eae42fc05279">nbudget_rv</a>), <span class="stringliteral">&#39;REVA&#39;</span>, -ztot_rr_evap(:, :, :) * zrhodjontstep(:, :, :) )</div>
<div class="line"><a name="l02269"></a><span class="lineno"> 2269</span>&#160;    <span class="keyword">call </span><a class="code" href="namespacemode__budget__phy.html#a865df6090077e33576dd3b4866709b87">budget_store_add_phy</a>(d, tbudgets(<a class="code" href="namespacemodd__budget.html#a032a9fef7c9e0c47fa34eae42fc05279">nbudget_rv</a>), <span class="stringliteral">&#39;DEPS&#39;</span>, -ztot_rs_deps(:, :, :) * zrhodjontstep(:, :, :) )</div>
<div class="line"><a name="l02270"></a><span class="lineno"> 2270</span>&#160;    <span class="keyword">call </span><a class="code" href="namespacemode__budget__phy.html#a865df6090077e33576dd3b4866709b87">budget_store_add_phy</a>(d, tbudgets(<a class="code" href="namespacemodd__budget.html#a032a9fef7c9e0c47fa34eae42fc05279">nbudget_rv</a>), <span class="stringliteral">&#39;DEPI&#39;</span>, -ztot_ri_depi(:, :, :) * zrhodjontstep(:, :, :) )</div>
<div class="line"><a name="l02271"></a><span class="lineno"> 2271</span>&#160;    <span class="keyword">call </span><a class="code" href="namespacemode__budget__phy.html#a865df6090077e33576dd3b4866709b87">budget_store_add_phy</a>(d, tbudgets(<a class="code" href="namespacemodd__budget.html#a032a9fef7c9e0c47fa34eae42fc05279">nbudget_rv</a>), <span class="stringliteral">&#39;DEPG&#39;</span>, -ztot_rg_depg(:, :, :) * zrhodjontstep(:, :, :) )</div>
<div class="line"><a name="l02272"></a><span class="lineno"> 2272</span>&#160;    <span class="keyword">call </span><a class="code" href="namespacemode__budget__phy.html#a865df6090077e33576dd3b4866709b87">budget_store_add_phy</a>(d, tbudgets(<a class="code" href="namespacemodd__budget.html#a032a9fef7c9e0c47fa34eae42fc05279">nbudget_rv</a>), <span class="stringliteral">&#39;CORR2&#39;</span>, ztot_rv_corr2(:, :, :) * zrhodjontstep(:, :, :) )</div>
<div class="line"><a name="l02273"></a><span class="lineno"> 2273</span>&#160;    <span class="keyword">call </span><a class="code" href="namespacemode__budget__phy.html#a865df6090077e33576dd3b4866709b87">budget_store_add_phy</a>(d, tbudgets(<a class="code" href="namespacemodd__budget.html#a032a9fef7c9e0c47fa34eae42fc05279">nbudget_rv</a>), <span class="stringliteral">&#39;DEPH&#39;</span>, -ztot_rh_deph(:, :, :) * zrhodjontstep(:, :, :) )</div>
<div class="line"><a name="l02274"></a><span class="lineno"> 2274</span>&#160;<span class="keywordflow">  end if</span></div>
<div class="line"><a name="l02275"></a><span class="lineno"> 2275</span>&#160; </div>
<div class="line"><a name="l02276"></a><span class="lineno"> 2276</span>&#160;  <span class="keywordflow">if</span> ( buconf%lbudget_rc ) <span class="keywordflow">then</span></div>
<div class="line"><a name="l02277"></a><span class="lineno"> 2277</span>&#160;    <span class="keyword">call </span><a class="code" href="namespacemode__budget__phy.html#a865df6090077e33576dd3b4866709b87">budget_store_add_phy</a>(d, tbudgets(<a class="code" href="namespacemodd__budget.html#a685847647e25e21af43ab48da13b1797">nbudget_rc</a>), <span class="stringliteral">&#39;AUTO&#39;</span>,  ztot_rc_auto(:, :, :) * zrhodjontstep(:, :, :) )</div>
<div class="line"><a name="l02278"></a><span class="lineno"> 2278</span>&#160;    <span class="keyword">call </span><a class="code" href="namespacemode__budget__phy.html#a865df6090077e33576dd3b4866709b87">budget_store_add_phy</a>(d, tbudgets(<a class="code" href="namespacemodd__budget.html#a685847647e25e21af43ab48da13b1797">nbudget_rc</a>), <span class="stringliteral">&#39;ACCR&#39;</span>,  ztot_rc_accr(:, :, :) * zrhodjontstep(:, :, :) )</div>
<div class="line"><a name="l02279"></a><span class="lineno"> 2279</span>&#160;    <span class="comment">!call BUDGET_STORE_ADD_PHY(D, TBUDGETS(NBUDGET_RC), &#39;REVA&#39;,  0. )</span></div>
<div class="line"><a name="l02280"></a><span class="lineno"> 2280</span>&#160;    <span class="keyword">call </span><a class="code" href="namespacemode__budget__phy.html#a865df6090077e33576dd3b4866709b87">budget_store_add_phy</a>(d, tbudgets(<a class="code" href="namespacemodd__budget.html#a685847647e25e21af43ab48da13b1797">nbudget_rc</a>), <span class="stringliteral">&#39;HONC&#39;</span>,  ztot_rc_honc(:, :, :) * zrhodjontstep(:, :, :) )</div>
<div class="line"><a name="l02281"></a><span class="lineno"> 2281</span>&#160;    <span class="keyword">call </span><a class="code" href="namespacemode__budget__phy.html#a865df6090077e33576dd3b4866709b87">budget_store_add_phy</a>(d, tbudgets(<a class="code" href="namespacemodd__budget.html#a685847647e25e21af43ab48da13b1797">nbudget_rc</a>), <span class="stringliteral">&#39;IMLT&#39;</span>,  ztot_rc_imlt(:, :, :) * zrhodjontstep(:, :, :) )</div>
<div class="line"><a name="l02282"></a><span class="lineno"> 2282</span>&#160;    <span class="keyword">call </span><a class="code" href="namespacemode__budget__phy.html#a865df6090077e33576dd3b4866709b87">budget_store_add_phy</a>(d, tbudgets(<a class="code" href="namespacemodd__budget.html#a685847647e25e21af43ab48da13b1797">nbudget_rc</a>), <span class="stringliteral">&#39;BERFI&#39;</span>, ztot_rc_berfi(:, :, :) * zrhodjontstep(:, :, :) )</div>
<div class="line"><a name="l02283"></a><span class="lineno"> 2283</span>&#160;<span class="comment">!    call BUDGET_STORE_ADD_PHY(D, TBUDGETS(NBUDGET_RC), &#39;RIM&#39;,   ztot_rc_rim  (:, :, :) * zrhodjontstep(:, :, :) )</span></div>
<div class="line"><a name="l02284"></a><span class="lineno"> 2284</span>&#160;    <span class="keyword">call </span><a class="code" href="namespacemode__budget__phy.html#a865df6090077e33576dd3b4866709b87">budget_store_add_phy</a>(d, tbudgets(<a class="code" href="namespacemodd__budget.html#a685847647e25e21af43ab48da13b1797">nbudget_rc</a>), <span class="stringliteral">&#39;RIM&#39;</span>,  (ztot_rc_rimss(:, :, :) + ztot_rc_rimsg(:, :, :)) &amp;</div>
<div class="line"><a name="l02285"></a><span class="lineno"> 2285</span>&#160;                                                          * zrhodjontstep(:, :, :) )</div>
<div class="line"><a name="l02286"></a><span class="lineno"> 2286</span>&#160;    <span class="keyword">call </span><a class="code" href="namespacemode__budget__phy.html#a865df6090077e33576dd3b4866709b87">budget_store_add_phy</a>(d, tbudgets(<a class="code" href="namespacemodd__budget.html#a685847647e25e21af43ab48da13b1797">nbudget_rc</a>), <span class="stringliteral">&#39;WETG&#39;</span>,  ztot_rc_wetg(:, :, :) * zrhodjontstep(:, :, :) )</div>
<div class="line"><a name="l02287"></a><span class="lineno"> 2287</span>&#160;    <span class="keyword">call </span><a class="code" href="namespacemode__budget__phy.html#a865df6090077e33576dd3b4866709b87">budget_store_add_phy</a>(d, tbudgets(<a class="code" href="namespacemodd__budget.html#a685847647e25e21af43ab48da13b1797">nbudget_rc</a>), <span class="stringliteral">&#39;DRYG&#39;</span>,  ztot_rc_dryg(:, :, :) * zrhodjontstep(:, :, :) )</div>
<div class="line"><a name="l02288"></a><span class="lineno"> 2288</span>&#160;    <span class="keyword">call </span><a class="code" href="namespacemode__budget__phy.html#a865df6090077e33576dd3b4866709b87">budget_store_add_phy</a>(d, tbudgets(<a class="code" href="namespacemodd__budget.html#a685847647e25e21af43ab48da13b1797">nbudget_rc</a>), <span class="stringliteral">&#39;CVRC&#39;</span>, -ztot_rr_cvrc(:, :, :) * zrhodjontstep(:, :, :) )</div>
<div class="line"><a name="l02289"></a><span class="lineno"> 2289</span>&#160;    <span class="keyword">call </span><a class="code" href="namespacemode__budget__phy.html#a865df6090077e33576dd3b4866709b87">budget_store_add_phy</a>(d, tbudgets(<a class="code" href="namespacemodd__budget.html#a685847647e25e21af43ab48da13b1797">nbudget_rc</a>), <span class="stringliteral">&#39;CORR2&#39;</span>, ztot_rc_corr2(:, :, :) * zrhodjontstep(:, :, :) )</div>
<div class="line"><a name="l02290"></a><span class="lineno"> 2290</span>&#160;    <span class="keyword">call </span><a class="code" href="namespacemode__budget__phy.html#a865df6090077e33576dd3b4866709b87">budget_store_add_phy</a>(d, tbudgets(<a class="code" href="namespacemodd__budget.html#a685847647e25e21af43ab48da13b1797">nbudget_rc</a>), <span class="stringliteral">&#39;WETH&#39;</span>,  ztot_rc_weth(:, :, :)  * zrhodjontstep(:, :, :) )</div>
<div class="line"><a name="l02291"></a><span class="lineno"> 2291</span>&#160;<span class="keywordflow">  end if</span></div>
<div class="line"><a name="l02292"></a><span class="lineno"> 2292</span>&#160; </div>
<div class="line"><a name="l02293"></a><span class="lineno"> 2293</span>&#160;  <span class="keywordflow">if</span> ( buconf%lbudget_rr ) <span class="keywordflow">then</span></div>
<div class="line"><a name="l02294"></a><span class="lineno"> 2294</span>&#160;    <span class="keyword">call </span><a class="code" href="namespacemode__budget__phy.html#a865df6090077e33576dd3b4866709b87">budget_store_add_phy</a>(d, tbudgets(<a class="code" href="namespacemodd__budget.html#aac4cd9c30fac3b66cb3078dad55fb1e2">nbudget_rr</a>), <span class="stringliteral">&#39;AUTO&#39;</span>, -ztot_rc_auto(:, :, :) * zrhodjontstep(:, :, :) )</div>
<div class="line"><a name="l02295"></a><span class="lineno"> 2295</span>&#160;    <span class="keyword">call </span><a class="code" href="namespacemode__budget__phy.html#a865df6090077e33576dd3b4866709b87">budget_store_add_phy</a>(d, tbudgets(<a class="code" href="namespacemodd__budget.html#aac4cd9c30fac3b66cb3078dad55fb1e2">nbudget_rr</a>), <span class="stringliteral">&#39;ACCR&#39;</span>, -ztot_rc_accr(:, :, :) * zrhodjontstep(:, :, :) )</div>
<div class="line"><a name="l02296"></a><span class="lineno"> 2296</span>&#160;    <span class="keyword">call </span><a class="code" href="namespacemode__budget__phy.html#a865df6090077e33576dd3b4866709b87">budget_store_add_phy</a>(d, tbudgets(<a class="code" href="namespacemodd__budget.html#aac4cd9c30fac3b66cb3078dad55fb1e2">nbudget_rr</a>), <span class="stringliteral">&#39;REVA&#39;</span>,  ztot_rr_evap(:, :, :) * zrhodjontstep(:, :, :) )</div>
<div class="line"><a name="l02297"></a><span class="lineno"> 2297</span>&#160;    <span class="keyword">call </span><a class="code" href="namespacemode__budget__phy.html#a865df6090077e33576dd3b4866709b87">budget_store_add_phy</a>(d, tbudgets(<a class="code" href="namespacemodd__budget.html#aac4cd9c30fac3b66cb3078dad55fb1e2">nbudget_rr</a>), <span class="stringliteral">&#39;HONR&#39;</span>,  ztot_rr_honr(:, :, :) * zrhodjontstep(:, :, :) )</div>
<div class="line"><a name="l02298"></a><span class="lineno"> 2298</span>&#160;<span class="comment">!    call BUDGET_STORE_ADD_PHY(D, TBUDGETS(NBUDGET_RR), &#39;ACC&#39;,   ztot_rr_acc (:, :, :) * zrhodjontstep(:, :, :) )</span></div>
<div class="line"><a name="l02299"></a><span class="lineno"> 2299</span>&#160;    <span class="keyword">call </span><a class="code" href="namespacemode__budget__phy.html#a865df6090077e33576dd3b4866709b87">budget_store_add_phy</a>(d, tbudgets(<a class="code" href="namespacemodd__budget.html#aac4cd9c30fac3b66cb3078dad55fb1e2">nbudget_rr</a>), <span class="stringliteral">&#39;ACC&#39;</span>,  (ztot_rc_rimss(:, :, :) + ztot_rc_rimsg(:, :, :)) &amp;</div>
<div class="line"><a name="l02300"></a><span class="lineno"> 2300</span>&#160;                                                          * zrhodjontstep(:, :, :) )</div>
<div class="line"><a name="l02301"></a><span class="lineno"> 2301</span>&#160;    <span class="keyword">call </span><a class="code" href="namespacemode__budget__phy.html#a865df6090077e33576dd3b4866709b87">budget_store_add_phy</a>(d, tbudgets(<a class="code" href="namespacemodd__budget.html#aac4cd9c30fac3b66cb3078dad55fb1e2">nbudget_rr</a>), <span class="stringliteral">&#39;CFRZ&#39;</span>,  ztot_rr_cfrz(:, :, :) * zrhodjontstep(:, :, :) )</div>
<div class="line"><a name="l02302"></a><span class="lineno"> 2302</span>&#160;    <span class="keyword">call </span><a class="code" href="namespacemode__budget__phy.html#a865df6090077e33576dd3b4866709b87">budget_store_add_phy</a>(d, tbudgets(<a class="code" href="namespacemodd__budget.html#aac4cd9c30fac3b66cb3078dad55fb1e2">nbudget_rr</a>), <span class="stringliteral">&#39;WETG&#39;</span>,  ztot_rr_wetg(:, :, :) * zrhodjontstep(:, :, :) )</div>
<div class="line"><a name="l02303"></a><span class="lineno"> 2303</span>&#160;    <span class="keyword">call </span><a class="code" href="namespacemode__budget__phy.html#a865df6090077e33576dd3b4866709b87">budget_store_add_phy</a>(d, tbudgets(<a class="code" href="namespacemodd__budget.html#aac4cd9c30fac3b66cb3078dad55fb1e2">nbudget_rr</a>), <span class="stringliteral">&#39;DRYG&#39;</span>,  ztot_rr_dryg(:, :, :) * zrhodjontstep(:, :, :) )</div>
<div class="line"><a name="l02304"></a><span class="lineno"> 2304</span>&#160;    <span class="keyword">call </span><a class="code" href="namespacemode__budget__phy.html#a865df6090077e33576dd3b4866709b87">budget_store_add_phy</a>(d, tbudgets(<a class="code" href="namespacemodd__budget.html#aac4cd9c30fac3b66cb3078dad55fb1e2">nbudget_rr</a>), <span class="stringliteral">&#39;GMLT&#39;</span>,  ztot_rr_gmlt(:, :, :) * zrhodjontstep(:, :, :) )</div>
<div class="line"><a name="l02305"></a><span class="lineno"> 2305</span>&#160;    <span class="keyword">call </span><a class="code" href="namespacemode__budget__phy.html#a865df6090077e33576dd3b4866709b87">budget_store_add_phy</a>(d, tbudgets(<a class="code" href="namespacemodd__budget.html#aac4cd9c30fac3b66cb3078dad55fb1e2">nbudget_rr</a>), <span class="stringliteral">&#39;CVRC&#39;</span>,  ztot_rr_cvrc(:, :, :) * zrhodjontstep(:, :, :) )</div>
<div class="line"><a name="l02306"></a><span class="lineno"> 2306</span>&#160;    <span class="keyword">call </span><a class="code" href="namespacemode__budget__phy.html#a865df6090077e33576dd3b4866709b87">budget_store_add_phy</a>(d, tbudgets(<a class="code" href="namespacemodd__budget.html#aac4cd9c30fac3b66cb3078dad55fb1e2">nbudget_rr</a>), <span class="stringliteral">&#39;CORR2&#39;</span>, ztot_rr_corr2(:, :, :)* zrhodjontstep(:, :, :) )</div>
<div class="line"><a name="l02307"></a><span class="lineno"> 2307</span>&#160;    <span class="keyword">call </span><a class="code" href="namespacemode__budget__phy.html#a865df6090077e33576dd3b4866709b87">budget_store_add_phy</a>(d, tbudgets(<a class="code" href="namespacemodd__budget.html#aac4cd9c30fac3b66cb3078dad55fb1e2">nbudget_rr</a>), <span class="stringliteral">&#39;WETH&#39;</span>,  ztot_rr_weth(:, :, :) * zrhodjontstep(:, :, :) )</div>
<div class="line"><a name="l02308"></a><span class="lineno"> 2308</span>&#160;    <span class="keyword">call </span><a class="code" href="namespacemode__budget__phy.html#a865df6090077e33576dd3b4866709b87">budget_store_add_phy</a>(d, tbudgets(<a class="code" href="namespacemodd__budget.html#aac4cd9c30fac3b66cb3078dad55fb1e2">nbudget_rr</a>), <span class="stringliteral">&#39;HMLT&#39;</span>,  ztot_rr_hmlt(:, :, :) * zrhodjontstep(:, :, :) )</div>
<div class="line"><a name="l02309"></a><span class="lineno"> 2309</span>&#160;<span class="keywordflow">  end if</span></div>
<div class="line"><a name="l02310"></a><span class="lineno"> 2310</span>&#160; </div>
<div class="line"><a name="l02311"></a><span class="lineno"> 2311</span>&#160;  <span class="keywordflow">if</span> ( buconf%lbudget_ri ) <span class="keywordflow">then</span></div>
<div class="line"><a name="l02312"></a><span class="lineno"> 2312</span>&#160;    <span class="keyword">call </span><a class="code" href="namespacemode__budget__phy.html#a865df6090077e33576dd3b4866709b87">budget_store_add_phy</a>(d, tbudgets(<a class="code" href="namespacemodd__budget.html#a4ea4532bcfa769b5ed97e4d1e68a8113">nbudget_ri</a>), <span class="stringliteral">&#39;HONC&#39;</span>,  -ztot_rc_honc(:, :, :) * zrhodjontstep(:, :, :) )</div>
<div class="line"><a name="l02313"></a><span class="lineno"> 2313</span>&#160;    <span class="keyword">call </span><a class="code" href="namespacemode__budget__phy.html#a865df6090077e33576dd3b4866709b87">budget_store_add_phy</a>(d, tbudgets(<a class="code" href="namespacemodd__budget.html#a4ea4532bcfa769b5ed97e4d1e68a8113">nbudget_ri</a>), <span class="stringliteral">&#39;CNVI&#39;</span>,   ztot_ri_cnvi(:, :, :) * zrhodjontstep(:, :, :) )</div>
<div class="line"><a name="l02314"></a><span class="lineno"> 2314</span>&#160;    <span class="keyword">call </span><a class="code" href="namespacemode__budget__phy.html#a865df6090077e33576dd3b4866709b87">budget_store_add_phy</a>(d, tbudgets(<a class="code" href="namespacemodd__budget.html#a4ea4532bcfa769b5ed97e4d1e68a8113">nbudget_ri</a>), <span class="stringliteral">&#39;CNVS&#39;</span>,   ztot_ri_cnvs(:, :, :) * zrhodjontstep(:, :, :) )</div>
<div class="line"><a name="l02315"></a><span class="lineno"> 2315</span>&#160;    <span class="keyword">call </span><a class="code" href="namespacemode__budget__phy.html#a865df6090077e33576dd3b4866709b87">budget_store_add_phy</a>(d, tbudgets(<a class="code" href="namespacemodd__budget.html#a4ea4532bcfa769b5ed97e4d1e68a8113">nbudget_ri</a>), <span class="stringliteral">&#39;AGGS&#39;</span>,   ztot_ri_aggs(:, :, :) * zrhodjontstep(:, :, :) )</div>
<div class="line"><a name="l02316"></a><span class="lineno"> 2316</span>&#160;    <span class="keyword">call </span><a class="code" href="namespacemode__budget__phy.html#a865df6090077e33576dd3b4866709b87">budget_store_add_phy</a>(d, tbudgets(<a class="code" href="namespacemodd__budget.html#a4ea4532bcfa769b5ed97e4d1e68a8113">nbudget_ri</a>), <span class="stringliteral">&#39;IMLT&#39;</span>,  -ztot_rc_imlt(:, :, :) * zrhodjontstep(:, :, :) )</div>
<div class="line"><a name="l02317"></a><span class="lineno"> 2317</span>&#160;    <span class="keyword">call </span><a class="code" href="namespacemode__budget__phy.html#a865df6090077e33576dd3b4866709b87">budget_store_add_phy</a>(d, tbudgets(<a class="code" href="namespacemodd__budget.html#a4ea4532bcfa769b5ed97e4d1e68a8113">nbudget_ri</a>), <span class="stringliteral">&#39;BERFI&#39;</span>, -ztot_rc_berfi(:, :, :) * zrhodjontstep(:, :, :) )</div>
<div class="line"><a name="l02318"></a><span class="lineno"> 2318</span>&#160;    <span class="keyword">call </span><a class="code" href="namespacemode__budget__phy.html#a865df6090077e33576dd3b4866709b87">budget_store_add_phy</a>(d, tbudgets(<a class="code" href="namespacemodd__budget.html#a4ea4532bcfa769b5ed97e4d1e68a8113">nbudget_ri</a>), <span class="stringliteral">&#39;HMS&#39;</span>,    ztot_ri_hms(:, :, :) * zrhodjontstep(:, :, :) )</div>
<div class="line"><a name="l02319"></a><span class="lineno"> 2319</span>&#160;    <span class="keyword">call </span><a class="code" href="namespacemode__budget__phy.html#a865df6090077e33576dd3b4866709b87">budget_store_add_phy</a>(d, tbudgets(<a class="code" href="namespacemodd__budget.html#a4ea4532bcfa769b5ed97e4d1e68a8113">nbudget_ri</a>), <span class="stringliteral">&#39;CFRZ&#39;</span>,   ztot_ri_cfrz(:, :, :) * zrhodjontstep(:, :, :) )</div>
<div class="line"><a name="l02320"></a><span class="lineno"> 2320</span>&#160;    <span class="keyword">call </span><a class="code" href="namespacemode__budget__phy.html#a865df6090077e33576dd3b4866709b87">budget_store_add_phy</a>(d, tbudgets(<a class="code" href="namespacemodd__budget.html#a4ea4532bcfa769b5ed97e4d1e68a8113">nbudget_ri</a>), <span class="stringliteral">&#39;DEPI&#39;</span>,   ztot_ri_depi(:, :, :) * zrhodjontstep(:, :, :) )</div>
<div class="line"><a name="l02321"></a><span class="lineno"> 2321</span>&#160;    <span class="keyword">call </span><a class="code" href="namespacemode__budget__phy.html#a865df6090077e33576dd3b4866709b87">budget_store_add_phy</a>(d, tbudgets(<a class="code" href="namespacemodd__budget.html#a4ea4532bcfa769b5ed97e4d1e68a8113">nbudget_ri</a>), <span class="stringliteral">&#39;CIBU&#39;</span>,   ztot_ri_cibu(:, :, :) * zrhodjontstep(:, :, :) )</div>
<div class="line"><a name="l02322"></a><span class="lineno"> 2322</span>&#160;    <span class="keyword">call </span><a class="code" href="namespacemode__budget__phy.html#a865df6090077e33576dd3b4866709b87">budget_store_add_phy</a>(d, tbudgets(<a class="code" href="namespacemodd__budget.html#a4ea4532bcfa769b5ed97e4d1e68a8113">nbudget_ri</a>), <span class="stringliteral">&#39;RDSF&#39;</span>,   ztot_ri_rdsf(:, :, :) * zrhodjontstep(:, :, :) )</div>
<div class="line"><a name="l02323"></a><span class="lineno"> 2323</span>&#160;    <span class="keyword">call </span><a class="code" href="namespacemode__budget__phy.html#a865df6090077e33576dd3b4866709b87">budget_store_add_phy</a>(d, tbudgets(<a class="code" href="namespacemodd__budget.html#a4ea4532bcfa769b5ed97e4d1e68a8113">nbudget_ri</a>), <span class="stringliteral">&#39;WETG&#39;</span>,   ztot_ri_wetg(:, :, :) * zrhodjontstep(:, :, :) )</div>
<div class="line"><a name="l02324"></a><span class="lineno"> 2324</span>&#160;    <span class="keyword">call </span><a class="code" href="namespacemode__budget__phy.html#a865df6090077e33576dd3b4866709b87">budget_store_add_phy</a>(d, tbudgets(<a class="code" href="namespacemodd__budget.html#a4ea4532bcfa769b5ed97e4d1e68a8113">nbudget_ri</a>), <span class="stringliteral">&#39;DRYG&#39;</span>,   ztot_ri_dryg(:, :, :) * zrhodjontstep(:, :, :) )</div>
<div class="line"><a name="l02325"></a><span class="lineno"> 2325</span>&#160;    <span class="keyword">call </span><a class="code" href="namespacemode__budget__phy.html#a865df6090077e33576dd3b4866709b87">budget_store_add_phy</a>(d, tbudgets(<a class="code" href="namespacemodd__budget.html#a4ea4532bcfa769b5ed97e4d1e68a8113">nbudget_ri</a>), <span class="stringliteral">&#39;HMG&#39;</span>,    ztot_ri_hmg(:, :, :) * zrhodjontstep(:, :, :) )</div>
<div class="line"><a name="l02326"></a><span class="lineno"> 2326</span>&#160;    <span class="keyword">call </span><a class="code" href="namespacemode__budget__phy.html#a865df6090077e33576dd3b4866709b87">budget_store_add_phy</a>(d, tbudgets(<a class="code" href="namespacemodd__budget.html#a4ea4532bcfa769b5ed97e4d1e68a8113">nbudget_ri</a>), <span class="stringliteral">&#39;CORR2&#39;</span>,  ztot_ri_corr2(:, :, :) * zrhodjontstep(:, :, :) )</div>
<div class="line"><a name="l02327"></a><span class="lineno"> 2327</span>&#160;    <span class="keyword">call </span><a class="code" href="namespacemode__budget__phy.html#a865df6090077e33576dd3b4866709b87">budget_store_add_phy</a>(d, tbudgets(<a class="code" href="namespacemodd__budget.html#a4ea4532bcfa769b5ed97e4d1e68a8113">nbudget_ri</a>), <span class="stringliteral">&#39;WETH&#39;</span>,   ztot_ri_weth(:, :, :) * zrhodjontstep(:, :, :) )</div>
<div class="line"><a name="l02328"></a><span class="lineno"> 2328</span>&#160;<span class="keywordflow">  end if</span></div>
<div class="line"><a name="l02329"></a><span class="lineno"> 2329</span>&#160; </div>
<div class="line"><a name="l02330"></a><span class="lineno"> 2330</span>&#160;  <span class="keywordflow">if</span> ( buconf%lbudget_rs ) <span class="keywordflow">then</span></div>
<div class="line"><a name="l02331"></a><span class="lineno"> 2331</span>&#160;    <span class="keyword">call </span><a class="code" href="namespacemode__budget__phy.html#a865df6090077e33576dd3b4866709b87">budget_store_add_phy</a>(d, tbudgets(<a class="code" href="namespacemodd__budget.html#a4e4985c2c538a46dd511258704757086">nbudget_rs</a>), <span class="stringliteral">&#39;CNVI&#39;</span>, -ztot_ri_cnvi(:, :, :) * zrhodjontstep(:, :, :) )</div>
<div class="line"><a name="l02332"></a><span class="lineno"> 2332</span>&#160;    <span class="keyword">call </span><a class="code" href="namespacemode__budget__phy.html#a865df6090077e33576dd3b4866709b87">budget_store_add_phy</a>(d, tbudgets(<a class="code" href="namespacemodd__budget.html#a4e4985c2c538a46dd511258704757086">nbudget_rs</a>), <span class="stringliteral">&#39;DEPS&#39;</span>,  ztot_rs_deps(:, :, :) * zrhodjontstep(:, :, :) )</div>
<div class="line"><a name="l02333"></a><span class="lineno"> 2333</span>&#160;    <span class="keyword">call </span><a class="code" href="namespacemode__budget__phy.html#a865df6090077e33576dd3b4866709b87">budget_store_add_phy</a>(d, tbudgets(<a class="code" href="namespacemodd__budget.html#a4e4985c2c538a46dd511258704757086">nbudget_rs</a>), <span class="stringliteral">&#39;CNVS&#39;</span>, -ztot_ri_cnvs(:, :, :) * zrhodjontstep(:, :, :) )</div>
<div class="line"><a name="l02334"></a><span class="lineno"> 2334</span>&#160;    <span class="keyword">call </span><a class="code" href="namespacemode__budget__phy.html#a865df6090077e33576dd3b4866709b87">budget_store_add_phy</a>(d, tbudgets(<a class="code" href="namespacemodd__budget.html#a4e4985c2c538a46dd511258704757086">nbudget_rs</a>), <span class="stringliteral">&#39;AGGS&#39;</span>, -ztot_ri_aggs(:, :, :) * zrhodjontstep(:, :, :) )</div>
<div class="line"><a name="l02335"></a><span class="lineno"> 2335</span>&#160;<span class="comment">!    call BUDGET_STORE_ADD_PHY(D, TBUDGETS(NBUDGET_RS), &#39;RIM&#39;,   ztot_rs_rim (:, :, :) * zrhodjontstep(:, :, :) )</span></div>
<div class="line"><a name="l02336"></a><span class="lineno"> 2336</span>&#160;    <span class="keyword">call </span><a class="code" href="namespacemode__budget__phy.html#a865df6090077e33576dd3b4866709b87">budget_store_add_phy</a>(d, tbudgets(<a class="code" href="namespacemodd__budget.html#a4e4985c2c538a46dd511258704757086">nbudget_rs</a>), <span class="stringliteral">&#39;RIM&#39;</span>, (-ztot_rc_rimss(:, :, :) -  ztot_rs_rimcg(:, :, :)) &amp; </div>
<div class="line"><a name="l02337"></a><span class="lineno"> 2337</span>&#160;                                                          * zrhodjontstep(:, :, :) )</div>
<div class="line"><a name="l02338"></a><span class="lineno"> 2338</span>&#160;    <span class="keyword">call </span><a class="code" href="namespacemode__budget__phy.html#a865df6090077e33576dd3b4866709b87">budget_store_add_phy</a>(d, tbudgets(<a class="code" href="namespacemodd__budget.html#a4e4985c2c538a46dd511258704757086">nbudget_rs</a>), <span class="stringliteral">&#39;HMS&#39;</span>,   ztot_rs_hms(:, :, :) * zrhodjontstep(:, :, :) )</div>
<div class="line"><a name="l02339"></a><span class="lineno"> 2339</span>&#160;<span class="comment">!    call BUDGET_STORE_ADD_PHY(D, TBUDGETS(NBUDGET_RS), &#39;ACC&#39;,   ztot_rs_acc (:, :, :) * zrhodjontstep(:, :, :) )</span></div>
<div class="line"><a name="l02340"></a><span class="lineno"> 2340</span>&#160;    <span class="keyword">call </span><a class="code" href="namespacemode__budget__phy.html#a865df6090077e33576dd3b4866709b87">budget_store_add_phy</a>(d, tbudgets(<a class="code" href="namespacemodd__budget.html#a4e4985c2c538a46dd511258704757086">nbudget_rs</a>), <span class="stringliteral">&#39;ACC&#39;</span>,  (ztot_rr_accss(:, :, :) - ztot_rs_accrg(:, :, :)) &amp;</div>
<div class="line"><a name="l02341"></a><span class="lineno"> 2341</span>&#160;                                                          * zrhodjontstep(:, :, :) )</div>
<div class="line"><a name="l02342"></a><span class="lineno"> 2342</span>&#160;    <span class="keyword">call </span><a class="code" href="namespacemode__budget__phy.html#a865df6090077e33576dd3b4866709b87">budget_store_add_phy</a>(d, tbudgets(<a class="code" href="namespacemodd__budget.html#a4e4985c2c538a46dd511258704757086">nbudget_rs</a>), <span class="stringliteral">&#39;CMEL&#39;</span>,  ztot_rs_cmel(:, :, :) * zrhodjontstep(:, :, :) )</div>
<div class="line"><a name="l02343"></a><span class="lineno"> 2343</span>&#160;    <span class="keyword">call </span><a class="code" href="namespacemode__budget__phy.html#a865df6090077e33576dd3b4866709b87">budget_store_add_phy</a>(d, tbudgets(<a class="code" href="namespacemodd__budget.html#a4e4985c2c538a46dd511258704757086">nbudget_rs</a>), <span class="stringliteral">&#39;CIBU&#39;</span>, -ztot_ri_cibu(:, :, :) * zrhodjontstep(:, :, :) )</div>
<div class="line"><a name="l02344"></a><span class="lineno"> 2344</span>&#160;    <span class="keyword">call </span><a class="code" href="namespacemode__budget__phy.html#a865df6090077e33576dd3b4866709b87">budget_store_add_phy</a>(d, tbudgets(<a class="code" href="namespacemodd__budget.html#a4e4985c2c538a46dd511258704757086">nbudget_rs</a>), <span class="stringliteral">&#39;WETG&#39;</span>,  ztot_rs_wetg(:, :, :) * zrhodjontstep(:, :, :) )</div>
<div class="line"><a name="l02345"></a><span class="lineno"> 2345</span>&#160;    <span class="keyword">call </span><a class="code" href="namespacemode__budget__phy.html#a865df6090077e33576dd3b4866709b87">budget_store_add_phy</a>(d, tbudgets(<a class="code" href="namespacemodd__budget.html#a4e4985c2c538a46dd511258704757086">nbudget_rs</a>), <span class="stringliteral">&#39;DRYG&#39;</span>,  ztot_rs_dryg(:, :, :) * zrhodjontstep(:, :, :) )</div>
<div class="line"><a name="l02346"></a><span class="lineno"> 2346</span>&#160;    <span class="keyword">call </span><a class="code" href="namespacemode__budget__phy.html#a865df6090077e33576dd3b4866709b87">budget_store_add_phy</a>(d, tbudgets(<a class="code" href="namespacemodd__budget.html#a4e4985c2c538a46dd511258704757086">nbudget_rs</a>), <span class="stringliteral">&#39;WETH&#39;</span>,  ztot_rs_weth(:, :, :) * zrhodjontstep(:, :, :) )</div>
<div class="line"><a name="l02347"></a><span class="lineno"> 2347</span>&#160;<span class="keywordflow">  end if</span></div>
<div class="line"><a name="l02348"></a><span class="lineno"> 2348</span>&#160; </div>
<div class="line"><a name="l02349"></a><span class="lineno"> 2349</span>&#160;  <span class="keywordflow">if</span> ( buconf%lbudget_rg ) <span class="keywordflow">then</span></div>
<div class="line"><a name="l02350"></a><span class="lineno"> 2350</span>&#160;    <span class="keyword">call </span><a class="code" href="namespacemode__budget__phy.html#a865df6090077e33576dd3b4866709b87">budget_store_add_phy</a>(d, tbudgets(<a class="code" href="namespacemodd__budget.html#aef76ce44ca163871fcb14427eae825a9">nbudget_rg</a>), <span class="stringliteral">&#39;HONR&#39;</span>, -ztot_rr_honr(:, :, :) * zrhodjontstep(:, :, :) )</div>
<div class="line"><a name="l02351"></a><span class="lineno"> 2351</span>&#160;    <span class="keyword">call </span><a class="code" href="namespacemode__budget__phy.html#a865df6090077e33576dd3b4866709b87">budget_store_add_phy</a>(d, tbudgets(<a class="code" href="namespacemodd__budget.html#aef76ce44ca163871fcb14427eae825a9">nbudget_rg</a>), <span class="stringliteral">&#39;DEPG&#39;</span>,  ztot_rg_depg(:, :, :) * zrhodjontstep(:, :, :) )</div>
<div class="line"><a name="l02352"></a><span class="lineno"> 2352</span>&#160;<span class="comment">!    call BUDGET_STORE_ADD_PHY(D, TBUDGETS(NBUDGET_RG), &#39;RIM&#39;,   ztot_rg_rim (:, :, :) * zrhodjontstep(:, :, :) )</span></div>
<div class="line"><a name="l02353"></a><span class="lineno"> 2353</span>&#160;    <span class="keyword">call </span><a class="code" href="namespacemode__budget__phy.html#a865df6090077e33576dd3b4866709b87">budget_store_add_phy</a>(d, tbudgets(<a class="code" href="namespacemodd__budget.html#aef76ce44ca163871fcb14427eae825a9">nbudget_rg</a>), <span class="stringliteral">&#39;RIM&#39;</span>,  (-ztot_rc_rimsg(:, :, :) +  ztot_rs_rimcg(:, :, :) ) &amp;</div>
<div class="line"><a name="l02354"></a><span class="lineno"> 2354</span>&#160;                                                          * zrhodjontstep(:, :, :) )</div>
<div class="line"><a name="l02355"></a><span class="lineno"> 2355</span>&#160;<span class="comment">!    call BUDGET_STORE_ADD_PHY(D, TBUDGETS(NBUDGET_RG), &#39;ACC&#39;,   ztot_rg_acc (:, :, :) * zrhodjontstep(:, :, :) )</span></div>
<div class="line"><a name="l02356"></a><span class="lineno"> 2356</span>&#160;    <span class="keyword">call </span><a class="code" href="namespacemode__budget__phy.html#a865df6090077e33576dd3b4866709b87">budget_store_add_phy</a>(d, tbudgets(<a class="code" href="namespacemodd__budget.html#aef76ce44ca163871fcb14427eae825a9">nbudget_rg</a>), <span class="stringliteral">&#39;ACC&#39;</span>,  (ztot_rr_accsg(:, :, :) + ztot_rs_accrg(:, :, :)) &amp; </div>
<div class="line"><a name="l02357"></a><span class="lineno"> 2357</span>&#160;                                                          * zrhodjontstep(:, :, :) )</div>
<div class="line"><a name="l02358"></a><span class="lineno"> 2358</span>&#160;    <span class="keyword">call </span><a class="code" href="namespacemode__budget__phy.html#a865df6090077e33576dd3b4866709b87">budget_store_add_phy</a>(d, tbudgets(<a class="code" href="namespacemodd__budget.html#aef76ce44ca163871fcb14427eae825a9">nbudget_rg</a>), <span class="stringliteral">&#39;CMEL&#39;</span>, -ztot_rs_cmel(:, :, :) * zrhodjontstep(:, :, :) )</div>
<div class="line"><a name="l02359"></a><span class="lineno"> 2359</span>&#160;    <span class="keyword">call </span><a class="code" href="namespacemode__budget__phy.html#a865df6090077e33576dd3b4866709b87">budget_store_add_phy</a>(d, tbudgets(<a class="code" href="namespacemodd__budget.html#aef76ce44ca163871fcb14427eae825a9">nbudget_rg</a>), <span class="stringliteral">&#39;CFRZ&#39;</span>, ( -ztot_rr_cfrz(:, :, :) - ztot_ri_cfrz(:, :, :) ) &amp;</div>
<div class="line"><a name="l02360"></a><span class="lineno"> 2360</span>&#160;                                                         * zrhodjontstep(:, :, :) )</div>
<div class="line"><a name="l02361"></a><span class="lineno"> 2361</span>&#160;    <span class="keyword">call </span><a class="code" href="namespacemode__budget__phy.html#a865df6090077e33576dd3b4866709b87">budget_store_add_phy</a>(d, tbudgets(<a class="code" href="namespacemodd__budget.html#aef76ce44ca163871fcb14427eae825a9">nbudget_rg</a>), <span class="stringliteral">&#39;RDSF&#39;</span>, -ztot_ri_rdsf(:, :, :) * zrhodjontstep(:, :, :) )</div>
<div class="line"><a name="l02362"></a><span class="lineno"> 2362</span>&#160;    <span class="keyword">call </span><a class="code" href="namespacemode__budget__phy.html#a865df6090077e33576dd3b4866709b87">budget_store_add_phy</a>(d, tbudgets(<a class="code" href="namespacemodd__budget.html#aef76ce44ca163871fcb14427eae825a9">nbudget_rg</a>), <span class="stringliteral">&#39;WETG&#39;</span>,  ztot_rg_wetg(:, :, :) * zrhodjontstep(:, :, :) )</div>
<div class="line"><a name="l02363"></a><span class="lineno"> 2363</span>&#160;    <span class="keyword">call </span><a class="code" href="namespacemode__budget__phy.html#a865df6090077e33576dd3b4866709b87">budget_store_add_phy</a>(d, tbudgets(<a class="code" href="namespacemodd__budget.html#aef76ce44ca163871fcb14427eae825a9">nbudget_rg</a>), <span class="stringliteral">&#39;DRYG&#39;</span>,  ztot_rg_dryg(:, :, :) * zrhodjontstep(:, :, :) )</div>
<div class="line"><a name="l02364"></a><span class="lineno"> 2364</span>&#160;    <span class="keyword">call </span><a class="code" href="namespacemode__budget__phy.html#a865df6090077e33576dd3b4866709b87">budget_store_add_phy</a>(d, tbudgets(<a class="code" href="namespacemodd__budget.html#aef76ce44ca163871fcb14427eae825a9">nbudget_rg</a>), <span class="stringliteral">&#39;HMG&#39;</span>,   ztot_rg_hmg(:, :, :) * zrhodjontstep(:, :, :) )</div>
<div class="line"><a name="l02365"></a><span class="lineno"> 2365</span>&#160;    <span class="keyword">call </span><a class="code" href="namespacemode__budget__phy.html#a865df6090077e33576dd3b4866709b87">budget_store_add_phy</a>(d, tbudgets(<a class="code" href="namespacemodd__budget.html#aef76ce44ca163871fcb14427eae825a9">nbudget_rg</a>), <span class="stringliteral">&#39;GMLT&#39;</span>, -ztot_rr_gmlt(:, :, :) * zrhodjontstep(:, :, :) )</div>
<div class="line"><a name="l02366"></a><span class="lineno"> 2366</span>&#160;    <span class="keyword">call </span><a class="code" href="namespacemode__budget__phy.html#a865df6090077e33576dd3b4866709b87">budget_store_add_phy</a>(d, tbudgets(<a class="code" href="namespacemodd__budget.html#aef76ce44ca163871fcb14427eae825a9">nbudget_rg</a>), <span class="stringliteral">&#39;WETH&#39;</span>,  ztot_rg_weth(:, :, :) * zrhodjontstep(:, :, :) )</div>
<div class="line"><a name="l02367"></a><span class="lineno"> 2367</span>&#160;    <span class="keyword">call </span><a class="code" href="namespacemode__budget__phy.html#a865df6090077e33576dd3b4866709b87">budget_store_add_phy</a>(d, tbudgets(<a class="code" href="namespacemodd__budget.html#aef76ce44ca163871fcb14427eae825a9">nbudget_rg</a>), <span class="stringliteral">&#39;COHG&#39;</span>,  ztot_rg_cohg(:, :, :) * zrhodjontstep(:, :, :) )</div>
<div class="line"><a name="l02368"></a><span class="lineno"> 2368</span>&#160;<span class="keywordflow">  end if</span></div>
<div class="line"><a name="l02369"></a><span class="lineno"> 2369</span>&#160; </div>
<div class="line"><a name="l02370"></a><span class="lineno"> 2370</span>&#160;  <span class="keywordflow">if</span> ( buconf%lbudget_rh ) <span class="keywordflow">then</span></div>
<div class="line"><a name="l02371"></a><span class="lineno"> 2371</span>&#160;    <span class="keyword">call </span><a class="code" href="namespacemode__budget__phy.html#a865df6090077e33576dd3b4866709b87">budget_store_add_phy</a>(d, tbudgets(<a class="code" href="namespacemodd__budget.html#a07dc15edaf8cd68c1036451fc7b536b9">nbudget_rh</a>), <span class="stringliteral">&#39;WETG&#39;</span>,  ztot_rh_wetg(:, :, :) * zrhodjontstep(:, :, :) )</div>
<div class="line"><a name="l02372"></a><span class="lineno"> 2372</span>&#160;    <span class="keyword">call </span><a class="code" href="namespacemode__budget__phy.html#a865df6090077e33576dd3b4866709b87">budget_store_add_phy</a>(d, tbudgets(<a class="code" href="namespacemodd__budget.html#a07dc15edaf8cd68c1036451fc7b536b9">nbudget_rh</a>), <span class="stringliteral">&#39;DEPH&#39;</span>,  ztot_rh_deph(:, :, :) * zrhodjontstep(:, :, :) )</div>
<div class="line"><a name="l02373"></a><span class="lineno"> 2373</span>&#160;    <span class="keyword">call </span><a class="code" href="namespacemode__budget__phy.html#a865df6090077e33576dd3b4866709b87">budget_store_add_phy</a>(d, tbudgets(<a class="code" href="namespacemodd__budget.html#a07dc15edaf8cd68c1036451fc7b536b9">nbudget_rh</a>), <span class="stringliteral">&#39;WETH&#39;</span>,  ztot_rh_weth(:, :, :) * zrhodjontstep(:, :, :) )</div>
<div class="line"><a name="l02374"></a><span class="lineno"> 2374</span>&#160;    <span class="keyword">call </span><a class="code" href="namespacemode__budget__phy.html#a865df6090077e33576dd3b4866709b87">budget_store_add_phy</a>(d, tbudgets(<a class="code" href="namespacemodd__budget.html#a07dc15edaf8cd68c1036451fc7b536b9">nbudget_rh</a>), <span class="stringliteral">&#39;COHG&#39;</span>, -ztot_rg_cohg(:, :, :) * zrhodjontstep(:, :, :) )</div>
<div class="line"><a name="l02375"></a><span class="lineno"> 2375</span>&#160;    <span class="keyword">call </span><a class="code" href="namespacemode__budget__phy.html#a865df6090077e33576dd3b4866709b87">budget_store_add_phy</a>(d, tbudgets(<a class="code" href="namespacemodd__budget.html#a07dc15edaf8cd68c1036451fc7b536b9">nbudget_rh</a>), <span class="stringliteral">&#39;HMLT&#39;</span>, -ztot_rr_hmlt(:, :, :) * zrhodjontstep(:, :, :) )</div>
<div class="line"><a name="l02376"></a><span class="lineno"> 2376</span>&#160;<span class="keywordflow">  end if</span></div>
<div class="line"><a name="l02377"></a><span class="lineno"> 2377</span>&#160; </div>
<div class="line"><a name="l02378"></a><span class="lineno"> 2378</span>&#160;  <span class="keywordflow">if</span> ( buconf%lbudget_sv ) <span class="keywordflow">then</span></div>
<div class="line"><a name="l02379"></a><span class="lineno"> 2379</span>&#160;    <span class="comment">!</span></div>
<div class="line"><a name="l02380"></a><span class="lineno"> 2380</span>&#160;    <span class="comment">! Cloud droplets</span></div>
<div class="line"><a name="l02381"></a><span class="lineno"> 2381</span>&#160;    <span class="comment">!</span></div>
<div class="line"><a name="l02382"></a><span class="lineno"> 2382</span>&#160;    <span class="keywordflow">if</span> (<a class="code" href="namespacemodd__param__lima.html#ab0c8298b017b75cbd419d8b1980b0053">nmom_c</a>.ge.2) <span class="keywordflow">then</span> </div>
<div class="line"><a name="l02383"></a><span class="lineno"> 2383</span>&#160;       idx = <a class="code" href="namespacemodd__budget.html#aab05ad1db5848733632fdbcefeb4a0a0">nbudget_sv1</a> - 1 + <a class="code" href="namespacemodd__nsv.html#a40a6809489f33d2332c09e3cdf634f64">nsv_lima_nc</a></div>
<div class="line"><a name="l02384"></a><span class="lineno"> 2384</span>&#160;       <span class="keyword">call </span><a class="code" href="namespacemode__budget__phy.html#a865df6090077e33576dd3b4866709b87">budget_store_add_phy</a>(d, tbudgets(idx), <span class="stringliteral">&#39;SELF&#39;</span>,  ztot_cc_self(:, :, :) * zrhodjontstep(:, :, :) )</div>
<div class="line"><a name="l02385"></a><span class="lineno"> 2385</span>&#160;       <span class="keyword">call </span><a class="code" href="namespacemode__budget__phy.html#a865df6090077e33576dd3b4866709b87">budget_store_add_phy</a>(d, tbudgets(idx), <span class="stringliteral">&#39;AUTO&#39;</span>,  ztot_cc_auto(:, :, :) * zrhodjontstep(:, :, :) )</div>
<div class="line"><a name="l02386"></a><span class="lineno"> 2386</span>&#160;       <span class="keyword">call </span><a class="code" href="namespacemode__budget__phy.html#a865df6090077e33576dd3b4866709b87">budget_store_add_phy</a>(d, tbudgets(idx), <span class="stringliteral">&#39;ACCR&#39;</span>,  ztot_cc_accr(:, :, :) * zrhodjontstep(:, :, :) )</div>
<div class="line"><a name="l02387"></a><span class="lineno"> 2387</span>&#160;       <span class="comment">!call BUDGET_STORE_ADD_PHY(D, TBUDGETS(idx), &#39;REVA&#39;,  0. )</span></div>
<div class="line"><a name="l02388"></a><span class="lineno"> 2388</span>&#160;       <span class="keyword">call </span><a class="code" href="namespacemode__budget__phy.html#a865df6090077e33576dd3b4866709b87">budget_store_add_phy</a>(d, tbudgets(idx), <span class="stringliteral">&#39;HONC&#39;</span>,  ztot_cc_honc(:, :, :) * zrhodjontstep(:, :, :) )</div>
<div class="line"><a name="l02389"></a><span class="lineno"> 2389</span>&#160;       <span class="keyword">call </span><a class="code" href="namespacemode__budget__phy.html#a865df6090077e33576dd3b4866709b87">budget_store_add_phy</a>(d, tbudgets(idx), <span class="stringliteral">&#39;IMLT&#39;</span>,  ztot_cc_imlt(:, :, :) * zrhodjontstep(:, :, :) )</div>
<div class="line"><a name="l02390"></a><span class="lineno"> 2390</span>&#160;       <span class="keyword">call </span><a class="code" href="namespacemode__budget__phy.html#a865df6090077e33576dd3b4866709b87">budget_store_add_phy</a>(d, tbudgets(idx), <span class="stringliteral">&#39;RIM&#39;</span>,   ztot_cc_rim(:, :, :) * zrhodjontstep(:, :, :) )</div>
<div class="line"><a name="l02391"></a><span class="lineno"> 2391</span>&#160;       <span class="keyword">call </span><a class="code" href="namespacemode__budget__phy.html#a865df6090077e33576dd3b4866709b87">budget_store_add_phy</a>(d, tbudgets(idx), <span class="stringliteral">&#39;WETG&#39;</span>,  ztot_cc_wetg(:, :, :) * zrhodjontstep(:, :, :) )</div>
<div class="line"><a name="l02392"></a><span class="lineno"> 2392</span>&#160;       <span class="keyword">call </span><a class="code" href="namespacemode__budget__phy.html#a865df6090077e33576dd3b4866709b87">budget_store_add_phy</a>(d, tbudgets(idx), <span class="stringliteral">&#39;DRYG&#39;</span>,  ztot_cc_dryg(:, :, :) * zrhodjontstep(:, :, :) )</div>
<div class="line"><a name="l02393"></a><span class="lineno"> 2393</span>&#160;       <span class="keyword">call </span><a class="code" href="namespacemode__budget__phy.html#a865df6090077e33576dd3b4866709b87">budget_store_add_phy</a>(d, tbudgets(idx), <span class="stringliteral">&#39;CVRC&#39;</span>, -ztot_cr_cvrc(:, :, :) * zrhodjontstep(:, :, :) )</div>
<div class="line"><a name="l02394"></a><span class="lineno"> 2394</span>&#160;       <span class="keyword">call </span><a class="code" href="namespacemode__budget__phy.html#a865df6090077e33576dd3b4866709b87">budget_store_add_phy</a>(d, tbudgets(idx), <span class="stringliteral">&#39;CORR2&#39;</span>, ztot_cc_corr2(:, :, :) * zrhodjontstep(:, :, :) )</div>
<div class="line"><a name="l02395"></a><span class="lineno"> 2395</span>&#160;       <span class="keyword">call </span><a class="code" href="namespacemode__budget__phy.html#a865df6090077e33576dd3b4866709b87">budget_store_add_phy</a>(d, tbudgets(idx), <span class="stringliteral">&#39;WETH&#39;</span>,  ztot_cc_weth(:, :, :) * zrhodjontstep(:, :, :) )</div>
<div class="line"><a name="l02396"></a><span class="lineno"> 2396</span>&#160;<span class="keywordflow">    end if</span></div>
<div class="line"><a name="l02397"></a><span class="lineno"> 2397</span>&#160;    <span class="comment">!</span></div>
<div class="line"><a name="l02398"></a><span class="lineno"> 2398</span>&#160;    <span class="comment">! Rain drops</span></div>
<div class="line"><a name="l02399"></a><span class="lineno"> 2399</span>&#160;    <span class="comment">!</span></div>
<div class="line"><a name="l02400"></a><span class="lineno"> 2400</span>&#160;    <span class="keywordflow">if</span> (<a class="code" href="namespacemodd__param__lima.html#a7accc5c4a0a391c040a1de5e966eea04">nmom_r</a>.ge.2) <span class="keywordflow">then</span></div>
<div class="line"><a name="l02401"></a><span class="lineno"> 2401</span>&#160;       idx = <a class="code" href="namespacemodd__budget.html#aab05ad1db5848733632fdbcefeb4a0a0">nbudget_sv1</a> - 1 + <a class="code" href="namespacemodd__nsv.html#a0f254b896adb763119f451ed055d2463">nsv_lima_nr</a></div>
<div class="line"><a name="l02402"></a><span class="lineno"> 2402</span>&#160;       <span class="keyword">call </span><a class="code" href="namespacemode__budget__phy.html#a865df6090077e33576dd3b4866709b87">budget_store_add_phy</a>(d, tbudgets(idx), <span class="stringliteral">&#39;AUTO&#39;</span>,  ztot_cr_auto(:, :, :) * zrhodjontstep(:, :, :) )</div>
<div class="line"><a name="l02403"></a><span class="lineno"> 2403</span>&#160;       <span class="keyword">call </span><a class="code" href="namespacemode__budget__phy.html#a865df6090077e33576dd3b4866709b87">budget_store_add_phy</a>(d, tbudgets(idx), <span class="stringliteral">&#39;SCBU&#39;</span>,  ztot_cr_scbu(:, :, :) * zrhodjontstep(:, :, :) )</div>
<div class="line"><a name="l02404"></a><span class="lineno"> 2404</span>&#160;       <span class="keyword">call </span><a class="code" href="namespacemode__budget__phy.html#a865df6090077e33576dd3b4866709b87">budget_store_add_phy</a>(d, tbudgets(idx), <span class="stringliteral">&#39;REVA&#39;</span>,  ztot_cr_evap(:, :, :) * zrhodjontstep(:, :, :) )</div>
<div class="line"><a name="l02405"></a><span class="lineno"> 2405</span>&#160;       <span class="keyword">call </span><a class="code" href="namespacemode__budget__phy.html#a865df6090077e33576dd3b4866709b87">budget_store_add_phy</a>(d, tbudgets(idx), <span class="stringliteral">&#39;BRKU&#39;</span>,  ztot_cr_brku(:, :, :) * zrhodjontstep(:, :, :) )</div>
<div class="line"><a name="l02406"></a><span class="lineno"> 2406</span>&#160;       <span class="keyword">call </span><a class="code" href="namespacemode__budget__phy.html#a865df6090077e33576dd3b4866709b87">budget_store_add_phy</a>(d, tbudgets(idx), <span class="stringliteral">&#39;HONR&#39;</span>,  ztot_cr_honr(:, :, :) * zrhodjontstep(:, :, :) )</div>
<div class="line"><a name="l02407"></a><span class="lineno"> 2407</span>&#160;       <span class="keyword">call </span><a class="code" href="namespacemode__budget__phy.html#a865df6090077e33576dd3b4866709b87">budget_store_add_phy</a>(d, tbudgets(idx), <span class="stringliteral">&#39;ACC&#39;</span>,   ztot_cr_acc(:, :, :) * zrhodjontstep(:, :, :) )</div>
<div class="line"><a name="l02408"></a><span class="lineno"> 2408</span>&#160;       <span class="keyword">call </span><a class="code" href="namespacemode__budget__phy.html#a865df6090077e33576dd3b4866709b87">budget_store_add_phy</a>(d, tbudgets(idx), <span class="stringliteral">&#39;CFRZ&#39;</span>,  ztot_cr_cfrz(:, :, :) * zrhodjontstep(:, :, :) )</div>
<div class="line"><a name="l02409"></a><span class="lineno"> 2409</span>&#160;       <span class="keyword">call </span><a class="code" href="namespacemode__budget__phy.html#a865df6090077e33576dd3b4866709b87">budget_store_add_phy</a>(d, tbudgets(idx), <span class="stringliteral">&#39;WETG&#39;</span>,  ztot_cr_wetg(:, :, :) * zrhodjontstep(:, :, :) )</div>
<div class="line"><a name="l02410"></a><span class="lineno"> 2410</span>&#160;       <span class="keyword">call </span><a class="code" href="namespacemode__budget__phy.html#a865df6090077e33576dd3b4866709b87">budget_store_add_phy</a>(d, tbudgets(idx), <span class="stringliteral">&#39;DRYG&#39;</span>,  ztot_cr_dryg(:, :, :) * zrhodjontstep(:, :, :) )</div>
<div class="line"><a name="l02411"></a><span class="lineno"> 2411</span>&#160;       <span class="keyword">call </span><a class="code" href="namespacemode__budget__phy.html#a865df6090077e33576dd3b4866709b87">budget_store_add_phy</a>(d, tbudgets(idx), <span class="stringliteral">&#39;GMLT&#39;</span>,  ztot_cr_gmlt(:, :, :) * zrhodjontstep(:, :, :) )</div>
<div class="line"><a name="l02412"></a><span class="lineno"> 2412</span>&#160;       <span class="keyword">call </span><a class="code" href="namespacemode__budget__phy.html#a865df6090077e33576dd3b4866709b87">budget_store_add_phy</a>(d, tbudgets(idx), <span class="stringliteral">&#39;CVRC&#39;</span>,  ztot_cr_cvrc(:, :, :) * zrhodjontstep(:, :, :) )</div>
<div class="line"><a name="l02413"></a><span class="lineno"> 2413</span>&#160;       <span class="keyword">call </span><a class="code" href="namespacemode__budget__phy.html#a865df6090077e33576dd3b4866709b87">budget_store_add_phy</a>(d, tbudgets(idx), <span class="stringliteral">&#39;CORR2&#39;</span>, ztot_cr_corr2(:, :, :) * zrhodjontstep(:, :, :) )</div>
<div class="line"><a name="l02414"></a><span class="lineno"> 2414</span>&#160;       <span class="keyword">call </span><a class="code" href="namespacemode__budget__phy.html#a865df6090077e33576dd3b4866709b87">budget_store_add_phy</a>(d, tbudgets(idx), <span class="stringliteral">&#39;WETH&#39;</span>,  ztot_cr_weth(:, :, :) * zrhodjontstep(:, :, :) )</div>
<div class="line"><a name="l02415"></a><span class="lineno"> 2415</span>&#160;       <span class="keyword">call </span><a class="code" href="namespacemode__budget__phy.html#a865df6090077e33576dd3b4866709b87">budget_store_add_phy</a>(d, tbudgets(idx), <span class="stringliteral">&#39;HMLT&#39;</span>,  ztot_cr_hmlt(:, :, :) * zrhodjontstep(:, :, :) )</div>
<div class="line"><a name="l02416"></a><span class="lineno"> 2416</span>&#160;<span class="keywordflow">    end if</span></div>
<div class="line"><a name="l02417"></a><span class="lineno"> 2417</span>&#160;    <span class="comment">!</span></div>
<div class="line"><a name="l02418"></a><span class="lineno"> 2418</span>&#160;    <span class="comment">! Ice crystals</span></div>
<div class="line"><a name="l02419"></a><span class="lineno"> 2419</span>&#160;    <span class="comment">!</span></div>
<div class="line"><a name="l02420"></a><span class="lineno"> 2420</span>&#160;    <span class="keywordflow">if</span> (<a class="code" href="namespacemodd__param__lima.html#ab11c5caa054b5039171a4f10908abea1">nmom_i</a>.ge.2) <span class="keywordflow">then</span></div>
<div class="line"><a name="l02421"></a><span class="lineno"> 2421</span>&#160;       idx = <a class="code" href="namespacemodd__budget.html#aab05ad1db5848733632fdbcefeb4a0a0">nbudget_sv1</a> - 1 + <a class="code" href="namespacemodd__nsv.html#a42ef78d1d5be64b40c0969a07598e268">nsv_lima_ni</a></div>
<div class="line"><a name="l02422"></a><span class="lineno"> 2422</span>&#160;       <span class="keyword">call </span><a class="code" href="namespacemode__budget__phy.html#a865df6090077e33576dd3b4866709b87">budget_store_add_phy</a>(d, tbudgets(idx), <span class="stringliteral">&#39;HONC&#39;</span>,  -ztot_cc_honc(:, :, :) * zrhodjontstep(:, :, :) )</div>
<div class="line"><a name="l02423"></a><span class="lineno"> 2423</span>&#160;       <span class="keyword">call </span><a class="code" href="namespacemode__budget__phy.html#a865df6090077e33576dd3b4866709b87">budget_store_add_phy</a>(d, tbudgets(idx), <span class="stringliteral">&#39;CNVI&#39;</span>,   ztot_ci_cnvi(:, :, :) * zrhodjontstep(:, :, :) )</div>
<div class="line"><a name="l02424"></a><span class="lineno"> 2424</span>&#160;       <span class="keyword">call </span><a class="code" href="namespacemode__budget__phy.html#a865df6090077e33576dd3b4866709b87">budget_store_add_phy</a>(d, tbudgets(idx), <span class="stringliteral">&#39;CNVS&#39;</span>,   ztot_ci_cnvs(:, :, :) * zrhodjontstep(:, :, :) )</div>
<div class="line"><a name="l02425"></a><span class="lineno"> 2425</span>&#160;       <span class="keyword">call </span><a class="code" href="namespacemode__budget__phy.html#a865df6090077e33576dd3b4866709b87">budget_store_add_phy</a>(d, tbudgets(idx), <span class="stringliteral">&#39;AGGS&#39;</span>,   ztot_ci_aggs(:, :, :) * zrhodjontstep(:, :, :) )</div>
<div class="line"><a name="l02426"></a><span class="lineno"> 2426</span>&#160;       <span class="keyword">call </span><a class="code" href="namespacemode__budget__phy.html#a865df6090077e33576dd3b4866709b87">budget_store_add_phy</a>(d, tbudgets(idx), <span class="stringliteral">&#39;IMLT&#39;</span>,  -ztot_cc_imlt(:, :, :) * zrhodjontstep(:, :, :) )</div>
<div class="line"><a name="l02427"></a><span class="lineno"> 2427</span>&#160;       <span class="keyword">call </span><a class="code" href="namespacemode__budget__phy.html#a865df6090077e33576dd3b4866709b87">budget_store_add_phy</a>(d, tbudgets(idx), <span class="stringliteral">&#39;HMS&#39;</span>,    ztot_ci_hms(:, :, :) * zrhodjontstep(:, :, :) )</div>
<div class="line"><a name="l02428"></a><span class="lineno"> 2428</span>&#160;       <span class="keyword">call </span><a class="code" href="namespacemode__budget__phy.html#a865df6090077e33576dd3b4866709b87">budget_store_add_phy</a>(d, tbudgets(idx), <span class="stringliteral">&#39;CFRZ&#39;</span>,   ztot_ci_cfrz(:, :, :) * zrhodjontstep(:, :, :) )</div>
<div class="line"><a name="l02429"></a><span class="lineno"> 2429</span>&#160;       <span class="keyword">call </span><a class="code" href="namespacemode__budget__phy.html#a865df6090077e33576dd3b4866709b87">budget_store_add_phy</a>(d, tbudgets(idx), <span class="stringliteral">&#39;CIBU&#39;</span>,   ztot_ci_cibu(:, :, :) * zrhodjontstep(:, :, :) )</div>
<div class="line"><a name="l02430"></a><span class="lineno"> 2430</span>&#160;       <span class="keyword">call </span><a class="code" href="namespacemode__budget__phy.html#a865df6090077e33576dd3b4866709b87">budget_store_add_phy</a>(d, tbudgets(idx), <span class="stringliteral">&#39;RDSF&#39;</span>,   ztot_ci_rdsf(:, :, :) * zrhodjontstep(:, :, :) )</div>
<div class="line"><a name="l02431"></a><span class="lineno"> 2431</span>&#160;       <span class="keyword">call </span><a class="code" href="namespacemode__budget__phy.html#a865df6090077e33576dd3b4866709b87">budget_store_add_phy</a>(d, tbudgets(idx), <span class="stringliteral">&#39;WETG&#39;</span>,   ztot_ci_wetg(:, :, :) * zrhodjontstep(:, :, :) )</div>
<div class="line"><a name="l02432"></a><span class="lineno"> 2432</span>&#160;       <span class="keyword">call </span><a class="code" href="namespacemode__budget__phy.html#a865df6090077e33576dd3b4866709b87">budget_store_add_phy</a>(d, tbudgets(idx), <span class="stringliteral">&#39;DRYG&#39;</span>,   ztot_ci_dryg(:, :, :) * zrhodjontstep(:, :, :) )</div>
<div class="line"><a name="l02433"></a><span class="lineno"> 2433</span>&#160;       <span class="keyword">call </span><a class="code" href="namespacemode__budget__phy.html#a865df6090077e33576dd3b4866709b87">budget_store_add_phy</a>(d, tbudgets(idx), <span class="stringliteral">&#39;HMG&#39;</span>,    ztot_ci_hmg(:, :, :) * zrhodjontstep(:, :, :) )</div>
<div class="line"><a name="l02434"></a><span class="lineno"> 2434</span>&#160;       <span class="keyword">call </span><a class="code" href="namespacemode__budget__phy.html#a865df6090077e33576dd3b4866709b87">budget_store_add_phy</a>(d, tbudgets(idx), <span class="stringliteral">&#39;CORR2&#39;</span>,  ztot_ci_corr2(:, :, :) * zrhodjontstep(:, :, :) )</div>
<div class="line"><a name="l02435"></a><span class="lineno"> 2435</span>&#160;       <span class="keyword">call </span><a class="code" href="namespacemode__budget__phy.html#a865df6090077e33576dd3b4866709b87">budget_store_add_phy</a>(d, tbudgets(idx), <span class="stringliteral">&#39;WETH&#39;</span>,   ztot_ci_weth(:, :, :) * zrhodjontstep(:, :, :) )</div>
<div class="line"><a name="l02436"></a><span class="lineno"> 2436</span>&#160;<span class="keywordflow">    end if</span></div>
<div class="line"><a name="l02437"></a><span class="lineno"> 2437</span>&#160;    <span class="comment">!</span></div>
<div class="line"><a name="l02438"></a><span class="lineno"> 2438</span>&#160;    <span class="comment">! Snow</span></div>
<div class="line"><a name="l02439"></a><span class="lineno"> 2439</span>&#160;    <span class="comment">!</span></div>
<div class="line"><a name="l02440"></a><span class="lineno"> 2440</span>&#160;    <span class="keywordflow">if</span> (<a class="code" href="namespacemodd__param__lima.html#a63b4f80fe043e01602ef78b2caf0e487">nmom_s</a>.ge.2) <span class="keywordflow">then</span></div>
<div class="line"><a name="l02441"></a><span class="lineno"> 2441</span>&#160;       idx = <a class="code" href="namespacemodd__budget.html#aab05ad1db5848733632fdbcefeb4a0a0">nbudget_sv1</a> - 1 + <a class="code" href="namespacemodd__nsv.html#a88f9a0bd54e36147cedeb35da2648aac">nsv_lima_ns</a></div>
<div class="line"><a name="l02442"></a><span class="lineno"> 2442</span>&#160;       <span class="keyword">call </span><a class="code" href="namespacemode__budget__phy.html#a865df6090077e33576dd3b4866709b87">budget_store_add_phy</a>(d, tbudgets(idx), <span class="stringliteral">&#39;CNVI&#39;</span>,  -ztot_ci_cnvi(:, :, :) * zrhodjontstep(:, :, :) )</div>
<div class="line"><a name="l02443"></a><span class="lineno"> 2443</span>&#160;       <span class="keyword">call </span><a class="code" href="namespacemode__budget__phy.html#a865df6090077e33576dd3b4866709b87">budget_store_add_phy</a>(d, tbudgets(idx), <span class="stringliteral">&#39;CNVS&#39;</span>,  -ztot_ci_cnvs(:, :, :) * zrhodjontstep(:, :, :) )</div>
<div class="line"><a name="l02444"></a><span class="lineno"> 2444</span>&#160;       <span class="keyword">call </span><a class="code" href="namespacemode__budget__phy.html#a865df6090077e33576dd3b4866709b87">budget_store_add_phy</a>(d, tbudgets(idx), <span class="stringliteral">&#39;RIM&#39;</span>,    ztot_cs_rim(:, :, :)  * zrhodjontstep(:, :, :) )</div>
<div class="line"><a name="l02445"></a><span class="lineno"> 2445</span>&#160;       <span class="keyword">call </span><a class="code" href="namespacemode__budget__phy.html#a865df6090077e33576dd3b4866709b87">budget_store_add_phy</a>(d, tbudgets(idx), <span class="stringliteral">&#39;ACC&#39;</span>,    ztot_cs_acc(:, :, :)  * zrhodjontstep(:, :, :) )</div>
<div class="line"><a name="l02446"></a><span class="lineno"> 2446</span>&#160;       <span class="keyword">call </span><a class="code" href="namespacemode__budget__phy.html#a865df6090077e33576dd3b4866709b87">budget_store_add_phy</a>(d, tbudgets(idx), <span class="stringliteral">&#39;CMEL&#39;</span>,   ztot_cs_cmel(:, :, :) * zrhodjontstep(:, :, :) )</div>
<div class="line"><a name="l02447"></a><span class="lineno"> 2447</span>&#160;       <span class="keyword">call </span><a class="code" href="namespacemode__budget__phy.html#a865df6090077e33576dd3b4866709b87">budget_store_add_phy</a>(d, tbudgets(idx), <span class="stringliteral">&#39;SSC&#39;</span>,    ztot_cs_ssc(:, :, :)  * zrhodjontstep(:, :, :) )</div>
<div class="line"><a name="l02448"></a><span class="lineno"> 2448</span>&#160;       <span class="keyword">call </span><a class="code" href="namespacemode__budget__phy.html#a865df6090077e33576dd3b4866709b87">budget_store_add_phy</a>(d, tbudgets(idx), <span class="stringliteral">&#39;WETG&#39;</span>,   ztot_cs_wetg(:, :, :) * zrhodjontstep(:, :, :) )</div>
<div class="line"><a name="l02449"></a><span class="lineno"> 2449</span>&#160;       <span class="keyword">call </span><a class="code" href="namespacemode__budget__phy.html#a865df6090077e33576dd3b4866709b87">budget_store_add_phy</a>(d, tbudgets(idx), <span class="stringliteral">&#39;DRYG&#39;</span>,   ztot_cs_dryg(:, :, :) * zrhodjontstep(:, :, :) )</div>
<div class="line"><a name="l02450"></a><span class="lineno"> 2450</span>&#160;       <span class="keyword">call </span><a class="code" href="namespacemode__budget__phy.html#a865df6090077e33576dd3b4866709b87">budget_store_add_phy</a>(d, tbudgets(idx), <span class="stringliteral">&#39;WETH&#39;</span>,   ztot_cs_weth(:, :, :) * zrhodjontstep(:, :, :) )</div>
<div class="line"><a name="l02451"></a><span class="lineno"> 2451</span>&#160;<span class="keywordflow">    end if</span></div>
<div class="line"><a name="l02452"></a><span class="lineno"> 2452</span>&#160;    <span class="comment">!</span></div>
<div class="line"><a name="l02453"></a><span class="lineno"> 2453</span>&#160;    <span class="comment">! Graupel</span></div>
<div class="line"><a name="l02454"></a><span class="lineno"> 2454</span>&#160;    <span class="comment">!</span></div>
<div class="line"><a name="l02455"></a><span class="lineno"> 2455</span>&#160;    <span class="keywordflow">if</span> (<a class="code" href="namespacemodd__param__lima.html#acd76d6876dec7668fc081a4380690182">nmom_g</a>.ge.2) <span class="keywordflow">then</span></div>
<div class="line"><a name="l02456"></a><span class="lineno"> 2456</span>&#160;       idx = <a class="code" href="namespacemodd__budget.html#aab05ad1db5848733632fdbcefeb4a0a0">nbudget_sv1</a> - 1 + <a class="code" href="namespacemodd__nsv.html#a822424cae100267f4e55c551af04dae9">nsv_lima_ng</a></div>
<div class="line"><a name="l02457"></a><span class="lineno"> 2457</span>&#160;       <span class="keyword">call </span><a class="code" href="namespacemode__budget__phy.html#a865df6090077e33576dd3b4866709b87">budget_store_add_phy</a>(d, tbudgets(idx), <span class="stringliteral">&#39;RIM&#39;</span>,   -ztot_cs_rim(:, :, :)  * zrhodjontstep(:, :, :) )</div>
<div class="line"><a name="l02458"></a><span class="lineno"> 2458</span>&#160;       <span class="keyword">call </span><a class="code" href="namespacemode__budget__phy.html#a865df6090077e33576dd3b4866709b87">budget_store_add_phy</a>(d, tbudgets(idx), <span class="stringliteral">&#39;ACC&#39;</span>,   -ztot_cs_acc(:, :, :)  * zrhodjontstep(:, :, :) )</div>
<div class="line"><a name="l02459"></a><span class="lineno"> 2459</span>&#160;       <span class="keyword">call </span><a class="code" href="namespacemode__budget__phy.html#a865df6090077e33576dd3b4866709b87">budget_store_add_phy</a>(d, tbudgets(idx), <span class="stringliteral">&#39;CMEL&#39;</span>,  -ztot_cs_cmel(:, :, :) * zrhodjontstep(:, :, :) )</div>
<div class="line"><a name="l02460"></a><span class="lineno"> 2460</span>&#160;       <span class="keyword">call </span><a class="code" href="namespacemode__budget__phy.html#a865df6090077e33576dd3b4866709b87">budget_store_add_phy</a>(d, tbudgets(idx), <span class="stringliteral">&#39;CFRZ&#39;</span>,  -ztot_cr_cfrz(:, :, :) * zrhodjontstep(:, :, :) )</div>
<div class="line"><a name="l02461"></a><span class="lineno"> 2461</span>&#160;       <span class="keyword">call </span><a class="code" href="namespacemode__budget__phy.html#a865df6090077e33576dd3b4866709b87">budget_store_add_phy</a>(d, tbudgets(idx), <span class="stringliteral">&#39;WETG&#39;</span>,   ztot_cg_wetg(:, :, :) * zrhodjontstep(:, :, :) )</div>
<div class="line"><a name="l02462"></a><span class="lineno"> 2462</span>&#160;       <span class="keyword">call </span><a class="code" href="namespacemode__budget__phy.html#a865df6090077e33576dd3b4866709b87">budget_store_add_phy</a>(d, tbudgets(idx), <span class="stringliteral">&#39;GMLT&#39;</span>,   ztot_cg_gmlt(:, :, :) * zrhodjontstep(:, :, :) )</div>
<div class="line"><a name="l02463"></a><span class="lineno"> 2463</span>&#160;       <span class="keyword">call </span><a class="code" href="namespacemode__budget__phy.html#a865df6090077e33576dd3b4866709b87">budget_store_add_phy</a>(d, tbudgets(idx), <span class="stringliteral">&#39;WETH&#39;</span>,   ztot_cg_weth(:, :, :) * zrhodjontstep(:, :, :) )</div>
<div class="line"><a name="l02464"></a><span class="lineno"> 2464</span>&#160;       <span class="keyword">call </span><a class="code" href="namespacemode__budget__phy.html#a865df6090077e33576dd3b4866709b87">budget_store_add_phy</a>(d, tbudgets(idx), <span class="stringliteral">&#39;COHG&#39;</span>,   ztot_cg_cohg(:, :, :) * zrhodjontstep(:, :, :) )</div>
<div class="line"><a name="l02465"></a><span class="lineno"> 2465</span>&#160;<span class="keywordflow">    end if</span></div>
<div class="line"><a name="l02466"></a><span class="lineno"> 2466</span>&#160;    <span class="comment">!</span></div>
<div class="line"><a name="l02467"></a><span class="lineno"> 2467</span>&#160;    <span class="comment">! Hail</span></div>
<div class="line"><a name="l02468"></a><span class="lineno"> 2468</span>&#160;    <span class="comment">!</span></div>
<div class="line"><a name="l02469"></a><span class="lineno"> 2469</span>&#160;    <span class="keywordflow">if</span> (<a class="code" href="namespacemodd__param__lima.html#a8a40a50a7778130438208e2974634384">nmom_h</a>.ge.2) <span class="keywordflow">then</span></div>
<div class="line"><a name="l02470"></a><span class="lineno"> 2470</span>&#160;       idx = <a class="code" href="namespacemodd__budget.html#aab05ad1db5848733632fdbcefeb4a0a0">nbudget_sv1</a> - 1 + <a class="code" href="namespacemodd__nsv.html#aee0d9e88c097894c400536f6199a19c3">nsv_lima_nh</a></div>
<div class="line"><a name="l02471"></a><span class="lineno"> 2471</span>&#160;       <span class="keyword">call </span><a class="code" href="namespacemode__budget__phy.html#a865df6090077e33576dd3b4866709b87">budget_store_add_phy</a>(d, tbudgets(idx), <span class="stringliteral">&#39;WETG&#39;</span>,  -ztot_cg_wetg(:, :, :) * zrhodjontstep(:, :, :) )</div>
<div class="line"><a name="l02472"></a><span class="lineno"> 2472</span>&#160;       <span class="keyword">call </span><a class="code" href="namespacemode__budget__phy.html#a865df6090077e33576dd3b4866709b87">budget_store_add_phy</a>(d, tbudgets(idx), <span class="stringliteral">&#39;COHG&#39;</span>,  -ztot_cg_cohg(:, :, :) * zrhodjontstep(:, :, :) )</div>
<div class="line"><a name="l02473"></a><span class="lineno"> 2473</span>&#160;       <span class="keyword">call </span><a class="code" href="namespacemode__budget__phy.html#a865df6090077e33576dd3b4866709b87">budget_store_add_phy</a>(d, tbudgets(idx), <span class="stringliteral">&#39;HMLT&#39;</span>,   ztot_ch_hmlt(:, :, :) * zrhodjontstep(:, :, :) )</div>
<div class="line"><a name="l02474"></a><span class="lineno"> 2474</span>&#160;<span class="keywordflow">    end if</span></div>
<div class="line"><a name="l02475"></a><span class="lineno"> 2475</span>&#160; </div>
<div class="line"><a name="l02476"></a><span class="lineno"> 2476</span>&#160;    <span class="keywordflow">do</span> ii = 1, <a class="code" href="namespacemodd__param__lima.html#a2b98a3f23053acfd971d523a0778f209">nmod_ifn</a></div>
<div class="line"><a name="l02477"></a><span class="lineno"> 2477</span>&#160;      idx = <a class="code" href="namespacemodd__budget.html#aab05ad1db5848733632fdbcefeb4a0a0">nbudget_sv1</a> - 1 + <a class="code" href="namespacemodd__nsv.html#a519df160018b4cf7fe248a758edba5b9">nsv_lima_ifn_nucl</a> + ii - 1</div>
<div class="line"><a name="l02478"></a><span class="lineno"> 2478</span>&#160;      <span class="keyword">call </span><a class="code" href="namespacemode__budget__phy.html#a865df6090077e33576dd3b4866709b87">budget_store_add_phy</a>(d, tbudgets(idx), <span class="stringliteral">&#39;IMLT&#39;</span>, ztot_ifnn_imlt(:, :, :, ii) * zrhodjontstep(:, :, :) )</div>
<div class="line"><a name="l02479"></a><span class="lineno"> 2479</span>&#160;<span class="keywordflow">    end do</span></div>
<div class="line"><a name="l02480"></a><span class="lineno"> 2480</span>&#160;<span class="keywordflow">  end if</span></div>
<div class="line"><a name="l02481"></a><span class="lineno"> 2481</span>&#160; </div>
<div class="line"><a name="l02482"></a><span class="lineno"> 2482</span>&#160;  <span class="keyword">deallocate</span>( zrhodjontstep )</div>
<div class="line"><a name="l02483"></a><span class="lineno"> 2483</span>&#160;<span class="keywordflow">end if</span></div>
<div class="line"><a name="l02484"></a><span class="lineno"> 2484</span>&#160;<span class="comment">!</span></div>
<div class="line"><a name="l02485"></a><span class="lineno"> 2485</span>&#160;<span class="keyword">END SUBROUTINE </span><a class="code" href="lima_8F90.html#a2fc9b9d056ed2dbe01597d9f1d42ae4d">lima</a></div>
<div class="ttc" id="alima_8F90_html_a2fc9b9d056ed2dbe01597d9f1d42ae4d"><div class="ttname"><a href="lima_8F90.html#a2fc9b9d056ed2dbe01597d9f1d42ae4d">lima</a></div><div class="ttdeci">subroutine lima(D, CST, ICED, ICEP, ELECD, ELECP, BUCONF, TBUDGETS, KBUDGETS, PTSTEP, OELEC, PRHODREF, PEXNREF, PDZZ, PTHVREFZIKB, PRHODJ, PPABST, NCCN, NIFN, NIMM, PDTHRAD, PTHT, PRT, PSVT, PW_NU, PTHS, PRS, PSVS, PINPRC, PINDEP, PINPRR, PINPRI, PINPRS, PINPRG, PINPRH, PEVAP3D, PCLDFR, PICEFR, PPRCFR, PFPR, PLATHAM_IAGGS, PEFIELDW, PSV_ELEC_T, PSV_ELEC_S)</div><div class="ttdef"><b>Definition:</b> <a href="lima_8F90_source.html#l00007">lima.F90:17</a></div></div>
<div class="ttc" id="anamespacemodd__budget_html"><div class="ttname"><a href="namespacemodd__budget.html">modd_budget</a></div><div class="ttdef"><b>Definition:</b> <a href="modd__budget_8F90_source.html#l00002">modd_budget.F90:2</a></div></div>
<div class="ttc" id="anamespacemodd__budget_html_a032a9fef7c9e0c47fa34eae42fc05279"><div class="ttname"><a href="namespacemodd__budget.html#a032a9fef7c9e0c47fa34eae42fc05279">modd_budget::nbudget_rv</a></div><div class="ttdeci">integer, parameter nbudget_rv</div><div class="ttdef"><b>Definition:</b> <a href="modd__budget_8F90_source.html#l00052">modd_budget.F90:52</a></div></div>
<div class="ttc" id="anamespacemodd__budget_html_a07dc15edaf8cd68c1036451fc7b536b9"><div class="ttname"><a href="namespacemodd__budget.html#a07dc15edaf8cd68c1036451fc7b536b9">modd_budget::nbudget_rh</a></div><div class="ttdeci">integer, parameter nbudget_rh</div><div class="ttdef"><b>Definition:</b> <a href="modd__budget_8F90_source.html#l00058">modd_budget.F90:58</a></div></div>
<div class="ttc" id="anamespacemodd__budget_html_a0d120a8b4c8fb6af560c814c1d3c2c19"><div class="ttname"><a href="namespacemodd__budget.html#a0d120a8b4c8fb6af560c814c1d3c2c19">modd_budget::nbudget_th</a></div><div class="ttdeci">integer, parameter nbudget_th</div><div class="ttdef"><b>Definition:</b> <a href="modd__budget_8F90_source.html#l00050">modd_budget.F90:50</a></div></div>
<div class="ttc" id="anamespacemodd__budget_html_a4e4985c2c538a46dd511258704757086"><div class="ttname"><a href="namespacemodd__budget.html#a4e4985c2c538a46dd511258704757086">modd_budget::nbudget_rs</a></div><div class="ttdeci">integer, parameter nbudget_rs</div><div class="ttdef"><b>Definition:</b> <a href="modd__budget_8F90_source.html#l00056">modd_budget.F90:56</a></div></div>
<div class="ttc" id="anamespacemodd__budget_html_a4ea4532bcfa769b5ed97e4d1e68a8113"><div class="ttname"><a href="namespacemodd__budget.html#a4ea4532bcfa769b5ed97e4d1e68a8113">modd_budget::nbudget_ri</a></div><div class="ttdeci">integer, parameter nbudget_ri</div><div class="ttdef"><b>Definition:</b> <a href="modd__budget_8F90_source.html#l00055">modd_budget.F90:55</a></div></div>
<div class="ttc" id="anamespacemodd__budget_html_a685847647e25e21af43ab48da13b1797"><div class="ttname"><a href="namespacemodd__budget.html#a685847647e25e21af43ab48da13b1797">modd_budget::nbudget_rc</a></div><div class="ttdeci">integer, parameter nbudget_rc</div><div class="ttdef"><b>Definition:</b> <a href="modd__budget_8F90_source.html#l00053">modd_budget.F90:53</a></div></div>
<div class="ttc" id="anamespacemodd__budget_html_aab05ad1db5848733632fdbcefeb4a0a0"><div class="ttname"><a href="namespacemodd__budget.html#aab05ad1db5848733632fdbcefeb4a0a0">modd_budget::nbudget_sv1</a></div><div class="ttdeci">integer, parameter nbudget_sv1</div><div class="ttdef"><b>Definition:</b> <a href="modd__budget_8F90_source.html#l00059">modd_budget.F90:59</a></div></div>
<div class="ttc" id="anamespacemodd__budget_html_aac4cd9c30fac3b66cb3078dad55fb1e2"><div class="ttname"><a href="namespacemodd__budget.html#aac4cd9c30fac3b66cb3078dad55fb1e2">modd_budget::nbudget_rr</a></div><div class="ttdeci">integer, parameter nbudget_rr</div><div class="ttdef"><b>Definition:</b> <a href="modd__budget_8F90_source.html#l00054">modd_budget.F90:54</a></div></div>
<div class="ttc" id="anamespacemodd__budget_html_aef76ce44ca163871fcb14427eae825a9"><div class="ttname"><a href="namespacemodd__budget.html#aef76ce44ca163871fcb14427eae825a9">modd_budget::nbudget_rg</a></div><div class="ttdeci">integer, parameter nbudget_rg</div><div class="ttdef"><b>Definition:</b> <a href="modd__budget_8F90_source.html#l00057">modd_budget.F90:57</a></div></div>
<div class="ttc" id="anamespacemodd__cst_html"><div class="ttname"><a href="namespacemodd__cst.html">modd_cst</a></div><div class="ttdef"><b>Definition:</b> <a href="modd__cst_8F90_source.html#l00007">modd_cst.F90:7</a></div></div>
<div class="ttc" id="anamespacemodd__dimphyex_html"><div class="ttname"><a href="namespacemodd__dimphyex.html">modd_dimphyex</a></div><div class="ttdef"><b>Definition:</b> <a href="modd__dimphyexn_8F90_source.html#l00007">modd_dimphyexn.F90:7</a></div></div>
<div class="ttc" id="anamespacemodd__elec__descr_html"><div class="ttname"><a href="namespacemodd__elec__descr.html">modd_elec_descr</a></div><div class="ttdef"><b>Definition:</b> <a href="modd__elec__descr_8F90_source.html#l00007">modd_elec_descr.F90:7</a></div></div>
<div class="ttc" id="anamespacemodd__elec__param_html"><div class="ttname"><a href="namespacemodd__elec__param.html">modd_elec_param</a></div><div class="ttdef"><b>Definition:</b> <a href="modd__elec__param_8F90_source.html#l00007">modd_elec_param.F90:7</a></div></div>
<div class="ttc" id="anamespacemodd__nsv_html"><div class="ttname"><a href="namespacemodd__nsv.html">modd_nsv</a></div><div class="ttdef"><b>Definition:</b> <a href="modd__nsv_8F90_source.html#l00007">modd_nsv.F90:7</a></div></div>
<div class="ttc" id="anamespacemodd__nsv_html_a0f254b896adb763119f451ed055d2463"><div class="ttname"><a href="namespacemodd__nsv.html#a0f254b896adb763119f451ed055d2463">modd_nsv::nsv_lima_nr</a></div><div class="ttdeci">integer, pointer nsv_lima_nr</div><div class="ttdef"><b>Definition:</b> <a href="modd__nsv_8F90_source.html#l00383">modd_nsv.F90:383</a></div></div>
<div class="ttc" id="anamespacemodd__nsv_html_a2716603ec6e0fb69695c2b3e0e166e6f"><div class="ttname"><a href="namespacemodd__nsv.html#a2716603ec6e0fb69695c2b3e0e166e6f">modd_nsv::nsv_lima_ccn_acti</a></div><div class="ttdeci">integer, pointer nsv_lima_ccn_acti</div><div class="ttdef"><b>Definition:</b> <a href="modd__nsv_8F90_source.html#l00383">modd_nsv.F90:383</a></div></div>
<div class="ttc" id="anamespacemodd__nsv_html_a40a6809489f33d2332c09e3cdf634f64"><div class="ttname"><a href="namespacemodd__nsv.html#a40a6809489f33d2332c09e3cdf634f64">modd_nsv::nsv_lima_nc</a></div><div class="ttdeci">integer, pointer nsv_lima_nc</div><div class="ttdef"><b>Definition:</b> <a href="modd__nsv_8F90_source.html#l00383">modd_nsv.F90:383</a></div></div>
<div class="ttc" id="anamespacemodd__nsv_html_a42ef78d1d5be64b40c0969a07598e268"><div class="ttname"><a href="namespacemodd__nsv.html#a42ef78d1d5be64b40c0969a07598e268">modd_nsv::nsv_lima_ni</a></div><div class="ttdeci">integer, pointer nsv_lima_ni</div><div class="ttdef"><b>Definition:</b> <a href="modd__nsv_8F90_source.html#l00383">modd_nsv.F90:383</a></div></div>
<div class="ttc" id="anamespacemodd__nsv_html_a519df160018b4cf7fe248a758edba5b9"><div class="ttname"><a href="namespacemodd__nsv.html#a519df160018b4cf7fe248a758edba5b9">modd_nsv::nsv_lima_ifn_nucl</a></div><div class="ttdeci">integer, pointer nsv_lima_ifn_nucl</div><div class="ttdef"><b>Definition:</b> <a href="modd__nsv_8F90_source.html#l00383">modd_nsv.F90:383</a></div></div>
<div class="ttc" id="anamespacemodd__nsv_html_a5608d5ba016412097d360f6598df7811"><div class="ttname"><a href="namespacemodd__nsv.html#a5608d5ba016412097d360f6598df7811">modd_nsv::nsv_lima_ifn_free</a></div><div class="ttdeci">integer, pointer nsv_lima_ifn_free</div><div class="ttdef"><b>Definition:</b> <a href="modd__nsv_8F90_source.html#l00383">modd_nsv.F90:383</a></div></div>
<div class="ttc" id="anamespacemodd__nsv_html_a6893062dccf1eaf4b3c7176ed79bf69c"><div class="ttname"><a href="namespacemodd__nsv.html#a6893062dccf1eaf4b3c7176ed79bf69c">modd_nsv::nsv_lima_ccn_free</a></div><div class="ttdeci">integer, pointer nsv_lima_ccn_free</div><div class="ttdef"><b>Definition:</b> <a href="modd__nsv_8F90_source.html#l00383">modd_nsv.F90:383</a></div></div>
<div class="ttc" id="anamespacemodd__nsv_html_a822424cae100267f4e55c551af04dae9"><div class="ttname"><a href="namespacemodd__nsv.html#a822424cae100267f4e55c551af04dae9">modd_nsv::nsv_lima_ng</a></div><div class="ttdeci">integer, pointer nsv_lima_ng</div><div class="ttdef"><b>Definition:</b> <a href="modd__nsv_8F90_source.html#l00383">modd_nsv.F90:383</a></div></div>
<div class="ttc" id="anamespacemodd__nsv_html_a864b10357f60be51dc3ecd1ffad90ccf"><div class="ttname"><a href="namespacemodd__nsv.html#a864b10357f60be51dc3ecd1ffad90ccf">modd_nsv::nsv_elecbeg</a></div><div class="ttdeci">integer, pointer nsv_elecbeg</div><div class="ttdef"><b>Definition:</b> <a href="modd__nsv_8F90_source.html#l00383">modd_nsv.F90:383</a></div></div>
<div class="ttc" id="anamespacemodd__nsv_html_a88f9a0bd54e36147cedeb35da2648aac"><div class="ttname"><a href="namespacemodd__nsv.html#a88f9a0bd54e36147cedeb35da2648aac">modd_nsv::nsv_lima_ns</a></div><div class="ttdeci">integer, pointer nsv_lima_ns</div><div class="ttdef"><b>Definition:</b> <a href="modd__nsv_8F90_source.html#l00383">modd_nsv.F90:383</a></div></div>
<div class="ttc" id="anamespacemodd__nsv_html_a8c00f36702d1825185256967b62b74fa"><div class="ttname"><a href="namespacemodd__nsv.html#a8c00f36702d1825185256967b62b74fa">modd_nsv::nsv_lima_beg</a></div><div class="ttdeci">integer, pointer nsv_lima_beg</div><div class="ttdef"><b>Definition:</b> <a href="modd__nsv_8F90_source.html#l00383">modd_nsv.F90:383</a></div></div>
<div class="ttc" id="anamespacemodd__nsv_html_a9ac00e065d57a5a8d3a6ba7565274e98"><div class="ttname"><a href="namespacemodd__nsv.html#a9ac00e065d57a5a8d3a6ba7565274e98">modd_nsv::nsv_lima_hom_haze</a></div><div class="ttdeci">integer, pointer nsv_lima_hom_haze</div><div class="ttdef"><b>Definition:</b> <a href="modd__nsv_8F90_source.html#l00383">modd_nsv.F90:383</a></div></div>
<div class="ttc" id="anamespacemodd__nsv_html_ae44e7d7392e3e216eefb2dc5e11be202"><div class="ttname"><a href="namespacemodd__nsv.html#ae44e7d7392e3e216eefb2dc5e11be202">modd_nsv::nsv_lima_imm_nucl</a></div><div class="ttdeci">integer, pointer nsv_lima_imm_nucl</div><div class="ttdef"><b>Definition:</b> <a href="modd__nsv_8F90_source.html#l00383">modd_nsv.F90:383</a></div></div>
<div class="ttc" id="anamespacemodd__nsv_html_aee0d9e88c097894c400536f6199a19c3"><div class="ttname"><a href="namespacemodd__nsv.html#aee0d9e88c097894c400536f6199a19c3">modd_nsv::nsv_lima_nh</a></div><div class="ttdeci">integer, pointer nsv_lima_nh</div><div class="ttdef"><b>Definition:</b> <a href="modd__nsv_8F90_source.html#l00383">modd_nsv.F90:383</a></div></div>
<div class="ttc" id="anamespacemodd__param__lima_html"><div class="ttname"><a href="namespacemodd__param__lima.html">modd_param_lima</a></div><div class="ttdef"><b>Definition:</b> <a href="modd__param__lima_8F90_source.html#l00007">modd_param_lima.F90:7</a></div></div>
<div class="ttc" id="anamespacemodd__param__lima_html_a06ed3012b0f8fd4872b87c1b4207600b"><div class="ttname"><a href="namespacemodd__param__lima.html#a06ed3012b0f8fd4872b87c1b4207600b">modd_param_lima::lsedc</a></div><div class="ttdeci">logical, pointer lsedc</div><div class="ttdef"><b>Definition:</b> <a href="modd__param__lima_8F90_source.html#l00231">modd_param_lima.F90:231</a></div></div>
<div class="ttc" id="anamespacemodd__param__lima_html_a0b11d7560a8fc0aa79bb054ab51fea88"><div class="ttname"><a href="namespacemodd__param__lima.html#a0b11d7560a8fc0aa79bb054ab51fea88">modd_param_lima::lhhoni</a></div><div class="ttdeci">logical, pointer lhhoni</div><div class="ttdef"><b>Definition:</b> <a href="modd__param__lima_8F90_source.html#l00231">modd_param_lima.F90:231</a></div></div>
<div class="ttc" id="anamespacemodd__param__lima_html_a19683462cda57db522fcb0b8988b8d27"><div class="ttname"><a href="namespacemodd__param__lima.html#a19683462cda57db522fcb0b8988b8d27">modd_param_lima::nmod_ccn</a></div><div class="ttdeci">integer, pointer nmod_ccn</div><div class="ttdef"><b>Definition:</b> <a href="modd__param__lima_8F90_source.html#l00256">modd_param_lima.F90:256</a></div></div>
<div class="ttc" id="anamespacemodd__param__lima_html_a26311f544ad0754b05441ca002035b5e"><div class="ttname"><a href="namespacemodd__param__lima.html#a26311f544ad0754b05441ca002035b5e">modd_param_lima::lfeedbackt</a></div><div class="ttdeci">logical, pointer lfeedbackt</div><div class="ttdef"><b>Definition:</b> <a href="modd__param__lima_8F90_source.html#l00231">modd_param_lima.F90:231</a></div></div>
<div class="ttc" id="anamespacemodd__param__lima_html_a2b98a3f23053acfd971d523a0778f209"><div class="ttname"><a href="namespacemodd__param__lima.html#a2b98a3f23053acfd971d523a0778f209">modd_param_lima::nmod_ifn</a></div><div class="ttdeci">integer, pointer nmod_ifn</div><div class="ttdef"><b>Definition:</b> <a href="modd__param__lima_8F90_source.html#l00256">modd_param_lima.F90:256</a></div></div>
<div class="ttc" id="anamespacemodd__param__lima_html_a4c82daf9a772a83a3f85b392b0ec8ca1"><div class="ttname"><a href="namespacemodd__param__lima.html#a4c82daf9a772a83a3f85b392b0ec8ca1">modd_param_lima::xctmin</a></div><div class="ttdeci">real, dimension(:), pointer xctmin</div><div class="ttdef"><b>Definition:</b> <a href="modd__param__lima_8F90_source.html#l00306">modd_param_lima.F90:306</a></div></div>
<div class="ttc" id="anamespacemodd__param__lima_html_a5ba3388c0be2ffe78c0b41f36f8002a9"><div class="ttname"><a href="namespacemodd__param__lima.html#a5ba3388c0be2ffe78c0b41f36f8002a9">modd_param_lima::lsedi</a></div><div class="ttdeci">logical, pointer lsedi</div><div class="ttdef"><b>Definition:</b> <a href="modd__param__lima_8F90_source.html#l00231">modd_param_lima.F90:231</a></div></div>
<div class="ttc" id="anamespacemodd__param__lima_html_a63b4f80fe043e01602ef78b2caf0e487"><div class="ttname"><a href="namespacemodd__param__lima.html#a63b4f80fe043e01602ef78b2caf0e487">modd_param_lima::nmom_s</a></div><div class="ttdeci">integer, pointer nmom_s</div><div class="ttdef"><b>Definition:</b> <a href="modd__param__lima_8F90_source.html#l00256">modd_param_lima.F90:256</a></div></div>
<div class="ttc" id="anamespacemodd__param__lima_html_a67bee94fe370e1412c94db0e58b0b06a"><div class="ttname"><a href="namespacemodd__param__lima.html#a67bee94fe370e1412c94db0e58b0b06a">modd_param_lima::xvdepoc</a></div><div class="ttdeci">real, pointer xvdepoc</div><div class="ttdef"><b>Definition:</b> <a href="modd__param__lima_8F90_source.html#l00273">modd_param_lima.F90:273</a></div></div>
<div class="ttc" id="anamespacemodd__param__lima_html_a773a34608ac83913168a35ea1a39332a"><div class="ttname"><a href="namespacemodd__param__lima.html#a773a34608ac83913168a35ea1a39332a">modd_param_lima::nmod_imm</a></div><div class="ttdeci">integer, pointer nmod_imm</div><div class="ttdef"><b>Definition:</b> <a href="modd__param__lima_8F90_source.html#l00256">modd_param_lima.F90:256</a></div></div>
<div class="ttc" id="anamespacemodd__param__lima_html_a7accc5c4a0a391c040a1de5e966eea04"><div class="ttname"><a href="namespacemodd__param__lima.html#a7accc5c4a0a391c040a1de5e966eea04">modd_param_lima::nmom_r</a></div><div class="ttdeci">integer, pointer nmom_r</div><div class="ttdef"><b>Definition:</b> <a href="modd__param__lima_8F90_source.html#l00256">modd_param_lima.F90:256</a></div></div>
<div class="ttc" id="anamespacemodd__param__lima_html_a8a40a50a7778130438208e2974634384"><div class="ttname"><a href="namespacemodd__param__lima.html#a8a40a50a7778130438208e2974634384">modd_param_lima::nmom_h</a></div><div class="ttdeci">integer, pointer nmom_h</div><div class="ttdef"><b>Definition:</b> <a href="modd__param__lima_8F90_source.html#l00256">modd_param_lima.F90:256</a></div></div>
<div class="ttc" id="anamespacemodd__param__lima_html_a95606fe7b31187a9c1e64d68309835b9"><div class="ttname"><a href="namespacemodd__param__lima.html#a95606fe7b31187a9c1e64d68309835b9">modd_param_lima::nmaxiter</a></div><div class="ttdeci">integer, pointer nmaxiter</div><div class="ttdef"><b>Definition:</b> <a href="modd__param__lima_8F90_source.html#l00256">modd_param_lima.F90:256</a></div></div>
<div class="ttc" id="anamespacemodd__param__lima_html_aaad997be2c66fe3610699ba4c79f46f4"><div class="ttname"><a href="namespacemodd__param__lima.html#aaad997be2c66fe3610699ba4c79f46f4">modd_param_lima::xtstep_ts</a></div><div class="ttdeci">real, pointer xtstep_ts</div><div class="ttdef"><b>Definition:</b> <a href="modd__param__lima_8F90_source.html#l00273">modd_param_lima.F90:273</a></div></div>
<div class="ttc" id="anamespacemodd__param__lima_html_ab0c8298b017b75cbd419d8b1980b0053"><div class="ttname"><a href="namespacemodd__param__lima.html#ab0c8298b017b75cbd419d8b1980b0053">modd_param_lima::nmom_c</a></div><div class="ttdeci">integer, pointer nmom_c</div><div class="ttdef"><b>Definition:</b> <a href="modd__param__lima_8F90_source.html#l00256">modd_param_lima.F90:256</a></div></div>
<div class="ttc" id="anamespacemodd__param__lima_html_ab11c5caa054b5039171a4f10908abea1"><div class="ttname"><a href="namespacemodd__param__lima.html#ab11c5caa054b5039171a4f10908abea1">modd_param_lima::nmom_i</a></div><div class="ttdeci">integer, pointer nmom_i</div><div class="ttdef"><b>Definition:</b> <a href="modd__param__lima_8F90_source.html#l00256">modd_param_lima.F90:256</a></div></div>
<div class="ttc" id="anamespacemodd__param__lima_html_ac8bffc7c7ac478bc8ec56c0d66c22ca6"><div class="ttname"><a href="namespacemodd__param__lima.html#ac8bffc7c7ac478bc8ec56c0d66c22ca6">modd_param_lima::xmrstep</a></div><div class="ttdeci">real, pointer xmrstep</div><div class="ttdef"><b>Definition:</b> <a href="modd__param__lima_8F90_source.html#l00273">modd_param_lima.F90:273</a></div></div>
<div class="ttc" id="anamespacemodd__param__lima_html_acd76d6876dec7668fc081a4380690182"><div class="ttname"><a href="namespacemodd__param__lima.html#acd76d6876dec7668fc081a4380690182">modd_param_lima::nmom_g</a></div><div class="ttdeci">integer, pointer nmom_g</div><div class="ttdef"><b>Definition:</b> <a href="modd__param__lima_8F90_source.html#l00256">modd_param_lima.F90:256</a></div></div>
<div class="ttc" id="anamespacemodd__param__lima_html_aefc493a9b25fa3023153181d64911a68"><div class="ttname"><a href="namespacemodd__param__lima.html#aefc493a9b25fa3023153181d64911a68">modd_param_lima::xrtmin</a></div><div class="ttdeci">real, dimension(:), pointer xrtmin</div><div class="ttdef"><b>Definition:</b> <a href="modd__param__lima_8F90_source.html#l00306">modd_param_lima.F90:306</a></div></div>
<div class="ttc" id="anamespacemodd__param__lima_html_af6ffb8236514eaf51d5b82367c6dec79"><div class="ttname"><a href="namespacemodd__param__lima.html#af6ffb8236514eaf51d5b82367c6dec79">modd_param_lima::ldepoc</a></div><div class="ttdeci">logical, pointer ldepoc</div><div class="ttdef"><b>Definition:</b> <a href="modd__param__lima_8F90_source.html#l00231">modd_param_lima.F90:231</a></div></div>
<div class="ttc" id="anamespacemodd__rain__ice__descr__n_html"><div class="ttname"><a href="namespacemodd__rain__ice__descr__n.html">modd_rain_ice_descr_n</a></div><div class="ttdef"><b>Definition:</b> <a href="modd__rain__ice__descrn_8F90_source.html#l00006">modd_rain_ice_descrn.F90:6</a></div></div>
<div class="ttc" id="anamespacemodd__rain__ice__param__n_html"><div class="ttname"><a href="namespacemodd__rain__ice__param__n.html">modd_rain_ice_param_n</a></div><div class="ttdef"><b>Definition:</b> <a href="modd__rain__ice__paramn_8F90_source.html#l00006">modd_rain_ice_paramn.F90:6</a></div></div>
<div class="ttc" id="anamespacemode__budget__phy_html"><div class="ttname"><a href="namespacemode__budget__phy.html">mode_budget_phy</a></div><div class="ttdef"><b>Definition:</b> <a href="mode__budget__phy_8F90_source.html#l00001">mode_budget_phy.F90:1</a></div></div>
<div class="ttc" id="anamespacemode__budget__phy_html_a618f66dd5a60cc85cb7470daae98cc3e"><div class="ttname"><a href="namespacemode__budget__phy.html#a618f66dd5a60cc85cb7470daae98cc3e">mode_budget_phy::budget_store_init_phy</a></div><div class="ttdeci">subroutine budget_store_init_phy(D, TPBUDGET, HSOURCE, PVARS)</div><div class="ttdef"><b>Definition:</b> <a href="mode__budget__phy_8F90_source.html#l00012">mode_budget_phy.F90:13</a></div></div>
<div class="ttc" id="anamespacemode__budget__phy_html_a865df6090077e33576dd3b4866709b87"><div class="ttname"><a href="namespacemode__budget__phy.html#a865df6090077e33576dd3b4866709b87">mode_budget_phy::budget_store_add_phy</a></div><div class="ttdeci">subroutine budget_store_add_phy(D, TPBUDGET, HSOURCE, PVARS)</div><div class="ttdef"><b>Definition:</b> <a href="mode__budget__phy_8F90_source.html#l00036">mode_budget_phy.F90:37</a></div></div>
<div class="ttc" id="anamespacemode__budget__phy_html_a9a2b3c894fd97b1caeef3dc8c7049411"><div class="ttname"><a href="namespacemode__budget__phy.html#a9a2b3c894fd97b1caeef3dc8c7049411">mode_budget_phy::budget_store_end_phy</a></div><div class="ttdeci">subroutine budget_store_end_phy(D, TPBUDGET, HSOURCE, PVARS)</div><div class="ttdef"><b>Definition:</b> <a href="mode__budget__phy_8F90_source.html#l00027">mode_budget_phy.F90:28</a></div></div>
<div class="ttc" id="anamespacemode__elec__tendencies_html"><div class="ttname"><a href="namespacemode__elec__tendencies.html">mode_elec_tendencies</a></div><div class="ttdef"><b>Definition:</b> <a href="mode__elec__tendencies_8F90_source.html#l00006">mode_elec_tendencies.F90:6</a></div></div>
<div class="ttc" id="anamespacemode__elec__tendencies_html_a7b9c94cea6e8bcbfca43adef1031fb44"><div class="ttname"><a href="namespacemode__elec__tendencies.html#a7b9c94cea6e8bcbfca43adef1031fb44">mode_elec_tendencies::elec_tendencies</a></div><div class="ttdeci">subroutine elec_tendencies(D, CST, ICED, ICEP, ELECD, ELECP, KRR, KMICRO, PTSTEP, ODMICRO, BUCONF, TBUDGETS, KBUDGETS, HCLOUD, PTHVREFZIKB, PRHODREF, PRHODJ, PZT, PCIT, PRVT, PRCT, PRRT, PRIT, PRST, PRGT, PQPIT, PQCT, PQRT, PQIT, PQST, PQGT, PQNIT, PQPIS, PQCS, PQRS, PQIS, PQSS, PQGS, PQNIS, PRVHENI, PRRHONG, PRIMLTC, PRCHONI, PRVDEPS, PRIAGGS, PRIAUTS, PRVDEPG, PRCAUTR, PRCACCR, PRREVAV, PRCRIMSS, PRCRIMSG, PRSRIMCG, PRRACCSS, PRRACCSG, PRSACCRG, PRSMLTG, PRICFRRG, PRRCFRIG, PRCWETG, PRIWETG, PRRWETG, PRSWETG, PRCDRYG, PRIDRYG, PRRDRYG, PRSDRYG, PRGMLTR, PRCBERI, PRCMLTSR, PRICFRR, PCCT, PCRT, PCST, PCGT, PRVHENC, PRCHINC, PRVHONH, PRRCVRC, PRICNVI, PRVDEPI, PRSHMSI, PRGHMGI, PRICIBU, PRIRDSF, PRCCORR2, PRRCORR2, PRICORR2, PRWETGH, PRCWETH, PRIWETH, PRSWETH, PRGWETH, PRRWETH, PRCDRYH, PRIDRYH, PRSDRYH, PRRDRYH, PRGDRYH, PRHMLTR, PRDRYHG, PRHT, PRHS, PCHT, PQHT, PQHS)</div><div class="ttdef"><b>Definition:</b> <a href="mode__elec__tendencies_8F90_source.html#l00012">mode_elec_tendencies.F90:38</a></div></div>
<div class="ttc" id="anamespacemode__lima__compute__cloud__fractions_html"><div class="ttname"><a href="namespacemode__lima__compute__cloud__fractions.html">mode_lima_compute_cloud_fractions</a></div><div class="ttdef"><b>Definition:</b> <a href="mode__lima__compute__cloud__fractions_8F90_source.html#l00006">mode_lima_compute_cloud_fractions.F90:6</a></div></div>
<div class="ttc" id="anamespacemode__lima__compute__cloud__fractions_html_a9b4b0f198611ec0fcdb7ba57060bec04"><div class="ttname"><a href="namespacemode__lima__compute__cloud__fractions.html#a9b4b0f198611ec0fcdb7ba57060bec04">mode_lima_compute_cloud_fractions::lima_compute_cloud_fractions</a></div><div class="ttdeci">subroutine lima_compute_cloud_fractions(D, PCCT, PRCT, PCRT, PRRT, PCIT, PRIT, PCST, PRST, PCGT, PRGT, PCHT, PRHT, PCLDFR, PICEFR, PPRCFR)</div><div class="ttdef"><b>Definition:</b> <a href="mode__lima__compute__cloud__fractions_8F90_source.html#l00010">mode_lima_compute_cloud_fractions.F90:18</a></div></div>
<div class="ttc" id="anamespacemode__lima__inst__procs_html"><div class="ttname"><a href="namespacemode__lima__inst__procs.html">mode_lima_inst_procs</a></div><div class="ttdef"><b>Definition:</b> <a href="mode__lima__inst__procs_8F90_source.html#l00006">mode_lima_inst_procs.F90:6</a></div></div>
<div class="ttc" id="anamespacemode__lima__inst__procs_html_ad1cb4d142928d7af0554b9d16b3bf80a"><div class="ttname"><a href="namespacemode__lima__inst__procs.html#ad1cb4d142928d7af0554b9d16b3bf80a">mode_lima_inst_procs::lima_inst_procs</a></div><div class="ttdeci">subroutine lima_inst_procs(PTSTEP, LDCOMPUTE, PEXNREF, PPABST, PTHT, PRVT, PRCT, PRRT, PRIT, PRST, PRGT, PCCT, PCRT, PCIT, PINT, P_CR_BRKU, P_TH_HONR, P_RR_HONR, P_CR_HONR, P_TH_IMLT, P_RC_IMLT, P_CC_IMLT, PB_TH, PB_RV, PB_RC, PB_RR, PB_RI, PB_RG, PB_CC, PB_CR, PB_CI, PB_IFNN, PCF1D, PIF1D, PPF1D)</div><div class="ttdef"><b>Definition:</b> <a href="mode__lima__inst__procs_8F90_source.html#l00010">mode_lima_inst_procs.F90:22</a></div></div>
<div class="ttc" id="anamespacemode__lima__nucleation__procs_html"><div class="ttname"><a href="namespacemode__lima__nucleation__procs.html">mode_lima_nucleation_procs</a></div><div class="ttdef"><b>Definition:</b> <a href="mode__lima__nucleation__procs_8F90_source.html#l00006">mode_lima_nucleation_procs.F90:6</a></div></div>
<div class="ttc" id="anamespacemode__lima__nucleation__procs_html_a5b69aa75f91239168e58d5081abd4d7e"><div class="ttname"><a href="namespacemode__lima__nucleation__procs.html#a5b69aa75f91239168e58d5081abd4d7e">mode_lima_nucleation_procs::lima_nucleation_procs</a></div><div class="ttdeci">subroutine lima_nucleation_procs(D, CST, BUCONF, TBUDGETS, KBUDGETS, PTSTEP, PRHODJ, PRHODREF, PEXNREF, PPABST, PT, PDTHRAD, PW_NU, PTHT, PRVT, PRCT, PRRT, PRIT, PRST, PRGT, PRHT, PCCT, PCRT, PCIT, PNFT, PNAT, PIFT, PINT, PNIT, PNHT, PCLDFR, PICEFR, PPRCFR, PTOT_RV_HENU, PTOT_RC_HINC, PTOT_RI_HIND, PTOT_RV_HONH)</div><div class="ttdef"><b>Definition:</b> <a href="mode__lima__nucleation__procs_8F90_source.html#l00010">mode_lima_nucleation_procs.F90:19</a></div></div>
<div class="ttc" id="anamespacemode__lima__sedimentation_html"><div class="ttname"><a href="namespacemode__lima__sedimentation.html">mode_lima_sedimentation</a></div><div class="ttdef"><b>Definition:</b> <a href="mode__lima__sedimentation_8F90_source.html#l00006">mode_lima_sedimentation.F90:6</a></div></div>
<div class="ttc" id="anamespacemode__lima__sedimentation_html_a964e14d529764f1a85ca486687463413"><div class="ttname"><a href="namespacemode__lima__sedimentation.html#a964e14d529764f1a85ca486687463413">mode_lima_sedimentation::lima_sedimentation</a></div><div class="ttdeci">subroutine lima_sedimentation(D, CST, HPHASE, KMOMENTS, KID, KSPLITG, PTSTEP, OELEC, PDZZ, PRHODREF, PTHVREFZIKB, PPABST, PT, PRT_SUM, PCPT, PRS, PCS, PINPR, PFPR, PEFIELDW, PQS)</div><div class="ttdef"><b>Definition:</b> <a href="mode__lima__sedimentation_8F90_source.html#l00010">mode_lima_sedimentation.F90:15</a></div></div>
<div class="ttc" id="anamespacemode__lima__tendencies_html"><div class="ttname"><a href="namespacemode__lima__tendencies.html">mode_lima_tendencies</a></div><div class="ttdef"><b>Definition:</b> <a href="mode__lima__tendencies_8F90_source.html#l00006">mode_lima_tendencies.F90:6</a></div></div>
<div class="ttc" id="anamespacemode__lima__tendencies_html_ad5cd63b41ca201209913ffcf730450f6"><div class="ttname"><a href="namespacemode__lima__tendencies.html#ad5cd63b41ca201209913ffcf730450f6">mode_lima_tendencies::lima_tendencies</a></div><div class="ttdeci">subroutine lima_tendencies(PTSTEP, LDCOMPUTE, PEXNREF, PRHODREF, PPABST, PTHT, PRVT, PRCT, PRRT, PRIT, PRST, PRGT, PRHT, PCCT, PCRT, PCIT, PCST, PCGT, PCHT, P_TH_HONC, P_RC_HONC, P_CC_HONC, P_CC_SELF, P_RC_AUTO, P_CC_AUTO, P_CR_AUTO, P_RC_ACCR, P_CC_ACCR, P_CR_SCBU, P_TH_EVAP, P_RR_EVAP, P_CR_EVAP, P_RI_CNVI, P_CI_CNVI, P_TH_DEPS, P_RS_DEPS, P_TH_DEPI, P_RI_DEPI, P_RI_CNVS, P_CI_CNVS, P_CS_SSC, P_RI_AGGS, P_CI_AGGS, P_TH_DEPG, P_RG_DEPG, P_TH_BERFI, P_RC_BERFI, P_TH_RIM, P_CC_RIM, P_CS_RIM, P_RC_RIMSS, P_RC_RIMSG, P_RS_RIMCG, P_RI_HMS, P_CI_HMS, P_RS_HMS, P_TH_ACC, P_CR_ACC, P_CS_ACC, P_RR_ACCSS, P_RR_ACCSG, P_RS_ACCRG, P_RS_CMEL, P_CS_CMEL, P_TH_CFRZ, P_RR_CFRZ, P_CR_CFRZ, P_RI_CFRZ, P_CI_CFRZ, P_RI_CIBU, P_CI_CIBU, P_RI_RDSF, P_CI_RDSF, P_TH_WETG, P_RC_WETG, P_CC_WETG, P_RR_WETG, P_CR_WETG, P_RI_WETG, P_CI_WETG, P_RS_WETG, P_CS_WETG, P_RG_WETG, P_CG_WETG, P_RH_WETG, P_TH_DRYG, P_RC_DRYG, P_CC_DRYG, P_RR_DRYG, P_CR_DRYG, P_RI_DRYG, P_CI_DRYG, P_RS_DRYG, P_CS_DRYG, P_RG_DRYG, P_RI_HMG, P_CI_HMG, P_RG_HMG, P_TH_GMLT, P_RR_GMLT, P_CR_GMLT, P_CG_GMLT, P_TH_DEPH, P_RH_DEPH, P_TH_WETH, P_RC_WETH, P_CC_WETH, P_RR_WETH, P_CR_WETH, P_RI_WETH, P_CI_WETH, P_RS_WETH, P_CS_WETH, P_RG_WETH, P_CG_WETH, P_RH_WETH, P_RG_COHG, P_CG_COHG, P_TH_HMLT, P_RR_HMLT, P_CR_HMLT, P_CH_HMLT, PA_TH, PA_RV, PA_RC, PA_CC, PA_RR, PA_CR, PA_RI, PA_CI, PA_RS, PA_CS, PA_RG, PA_CG, PA_RH, PA_CH, PEVAP3D, PCF1D, PIF1D, PPF1D, PLATHAM_IAGGS)</div><div class="ttdef"><b>Definition:</b> <a href="mode__lima__tendencies_8F90_source.html#l00010">mode_lima_tendencies.F90:55</a></div></div>
<div class="ttc" id="anamespacemode__tools_html"><div class="ttname"><a href="namespacemode__tools.html">mode_tools</a></div><div class="ttdef"><b>Definition:</b> <a href="tools_8F90_source.html#l00008">tools.F90:8</a></div></div>
<div class="ttc" id="astructmodd__budget_1_1tbudgetconf__t_html"><div class="ttname"><a href="structmodd__budget_1_1tbudgetconf__t.html">modd_budget::tbudgetconf_t</a></div><div class="ttdef"><b>Definition:</b> <a href="modd__budget_8F90_source.html#l00065">modd_budget.F90:65</a></div></div>
<div class="ttc" id="astructmodd__budget_1_1tbudgetdata_html"><div class="ttname"><a href="structmodd__budget_1_1tbudgetdata.html">modd_budget::tbudgetdata</a></div><div class="ttdef"><b>Definition:</b> <a href="modd__budget_8F90_source.html#l00061">modd_budget.F90:61</a></div></div>
<div class="ttc" id="astructmodd__cst_1_1cst__t_html"><div class="ttname"><a href="structmodd__cst_1_1cst__t.html">modd_cst::cst_t</a></div><div class="ttdef"><b>Definition:</b> <a href="modd__cst_8F90_source.html#l00053">modd_cst.F90:53</a></div></div>
<div class="ttc" id="astructmodd__dimphyex_1_1dimphyex__t_html"><div class="ttname"><a href="structmodd__dimphyex_1_1dimphyex__t.html">modd_dimphyex::dimphyex_t</a></div><div class="ttdef"><b>Definition:</b> <a href="modd__dimphyexn_8F90_source.html#l00038">modd_dimphyexn.F90:38</a></div></div>
<div class="ttc" id="astructmodd__elec__descr_1_1elec__descr__t_html"><div class="ttname"><a href="structmodd__elec__descr_1_1elec__descr__t.html">modd_elec_descr::elec_descr_t</a></div><div class="ttdef"><b>Definition:</b> <a href="modd__elec__descr_8F90_source.html#l00162">modd_elec_descr.F90:162</a></div></div>
<div class="ttc" id="astructmodd__elec__param_1_1elec__param__t_html"><div class="ttname"><a href="structmodd__elec__param_1_1elec__param__t.html">modd_elec_param::elec_param_t</a></div><div class="ttdef"><b>Definition:</b> <a href="modd__elec__param_8F90_source.html#l00168">modd_elec_param.F90:168</a></div></div>
<div class="ttc" id="astructmodd__rain__ice__descr__n_1_1rain__ice__descr__t_html"><div class="ttname"><a href="structmodd__rain__ice__descr__n_1_1rain__ice__descr__t.html">modd_rain_ice_descr_n::rain_ice_descr_t</a></div><div class="ttdef"><b>Definition:</b> <a href="modd__rain__ice__descrn_8F90_source.html#l00057">modd_rain_ice_descrn.F90:57</a></div></div>
<div class="ttc" id="astructmodd__rain__ice__param__n_1_1rain__ice__param__t_html"><div class="ttname"><a href="structmodd__rain__ice__param__n_1_1rain__ice__param__t.html">modd_rain_ice_param_n::rain_ice_param_t</a></div><div class="ttdef"><b>Definition:</b> <a href="modd__rain__ice__paramn_8F90_source.html#l00045">modd_rain_ice_paramn.F90:45</a></div></div>
</div><!-- fragment --></div><!-- contents -->
<!-- start footer part -->
<hr class="footer"/><address class="footer"><small>
Generated by&#160;<a href="https://www.doxygen.org/index.html"><img class="footer" src="doxygen.svg" width="104" height="31" alt="doxygen"/></a> 1.9.1
</small></address>
</body>
</html>
